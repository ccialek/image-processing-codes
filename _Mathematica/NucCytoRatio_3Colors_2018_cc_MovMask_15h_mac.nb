(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    475328,      10349]
NotebookOptionsPosition[    460466,      10104]
NotebookOutlinePosition[    460850,      10121]
CellTagsIndexPosition[    460807,      10118]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Log", "Section",
 CellChangeTimes->{{3.652215360972802*^9, 
  3.652215361253603*^9}},ExpressionUUID->"2e059330-20ef-40cf-981b-\
b2d80297422c"],

Cell["\<\
07/27/2016 TM-- Updated the following features
\t\t\tFile format for saving all parameters was changed to mathematica file \
from excel file.
\t\t\tReading in Parameters section was added.
\t\t\tPairConnect3 was added. This function connects the nearest spot instead \
of the first encountered near enough spot.
\t\t\t\tSlower than PairConnect2, about a double the speed, but there should \
not be error.
\t\t\tPairConnect4 was added. This fucntion gets rid of diversion of tracks.
\t\t\tLinkTrack2 was added. This function gets rid of tracks which last \
shorter than threshold. And asign new track numbers.
\t\t\t\tThis avoids very big track numbers.

07/23/2016 TS -- Updated to match ParticleTracking_for_puro_2Colors.nb, which \
is what TM used in the Science translation paper. 

9/25/2015 TS -- Updated 3-color Find Red/Green/Blue Particles so that it \
shows the first \[OpenCurlyDoubleQuote]10\[CloseCurlyDoubleQuote] \
(endtest-starttest) and last \
\[OpenCurlyDoubleQuote]10\[CloseCurlyDoubleQuote] frames of movies to see if \
the threshhold works well for the entire movie. 

10/01/18 CC -- merged myROI with particle track code so I can shift mask \
throughout the movie---it works!!! holy shittt\
\>", "Text",
 CellChangeTimes->{{3.6522153655592103`*^9, 3.6522154663197875`*^9}, {
  3.678312147583539*^9, 3.678312185902731*^9}, {3.6783219579446597`*^9, 
  3.6783219785338373`*^9}, {3.6786316276437817`*^9, 3.678632063908735*^9}, {
  3.747406042613427*^9, 3.747406077940878*^9}, {3.747419395501915*^9, 
  3.747419399305642*^9}, {3.7474201829689293`*^9, 
  3.747420189123258*^9}},ExpressionUUID->"d76171a6-3ad2-4d2a-82f6-\
2b663503147a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Initialize", "Section",
 CellChangeTimes->{{3.6484703923691845`*^9, 
  3.648470403792838*^9}},ExpressionUUID->"28c4e0b0-ada2-4d05-bd49-\
ff30b6635e01"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$HistoryLength", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
 RowBox[{"Off", "[", 
  RowBox[{
   RowBox[{"General", "::", "spell"}], ",", " ", 
   RowBox[{"General", "::", "spell1"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.642167939244282*^9, 3.6421679399873247`*^9}, {
  3.6514954254104395`*^9, 3.65149564868221*^9}, {3.6514957496829867`*^9, 
  3.651495786850113*^9}, {3.6514985885093584`*^9, 3.6514986184050684`*^9}, {
  3.651520636239416*^9, 3.651520636918455*^9}},
 CellLabel->
  "In[12657]:=",ExpressionUUID->"e69bf2d1-8952-4a9a-b9bd-9801f3a5fe8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7148638296045837`*^9, 3.7148638450365524`*^9}},
 CellLabel->
  "In[12660]:=",ExpressionUUID->"dc733b09-8dae-42e7-9f28-818e144150b5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions and PSF", "Section",
 CellChangeTimes->{{3.575085645362406*^9, 3.5750856463124075`*^9}, {
  3.5774930265230093`*^9, 
  3.5774930278830867`*^9}},ExpressionUUID->"456580d0-4b24-4a8b-bb33-\
1f27c6528439"],

Cell[CellGroupData[{

Cell["MyROI[{img, img, ...},outfile]", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.543902343799969*^9, 3.543902349540779*^9}, {
  3.5441344624597664`*^9, 3.544134464923476*^9}, {3.544135561931566*^9, 
  3.5441355686678905`*^9}, {3.5441356420237923`*^9, 3.5441356426679974`*^9}, {
  3.544138757241422*^9, 3.5441387583958244`*^9}, {3.544142277820612*^9, 
  3.544142280828374*^9}, {3.5441527424248085`*^9, 3.5441527475452394`*^9}, {
  3.5441534274971266`*^9, 3.544153483384877*^9}, {3.54422492803025*^9, 
  3.544224930838561*^9}, {3.544225044639053*^9, 3.544225048621418*^9}, {
  3.5445704181968117`*^9, 3.544570425685158*^9}, {3.716316843832747*^9, 
  3.716316845140623*^9}, {3.7474073422395887`*^9, 
  3.7474073432563953`*^9}},ExpressionUUID->"38fa3d32-7af0-407e-8b26-\
568f7691a5f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyROI", "[", 
   RowBox[{
    RowBox[{"allimage", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "ImageQ"}], ".."}], "}"}]}], ",", 
    RowBox[{"outfile_", "?", "StringQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"allimg", "=", "allimage"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"DynamicModule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Nimg", "=", 
         RowBox[{"Length", "[", "allimg", "]"}]}], ",", "thold", ",", 
        RowBox[{"myt", "=", "1"}], ",", 
        RowBox[{"y", "=", "1"}], ",", 
        RowBox[{"myflag", "=", "\"\<  Ready.\>\""}], ",", 
        RowBox[{"Colors", "=", 
         RowBox[{"{", 
          RowBox[{
          "Black", ",", "Red", ",", "Green", ",", "Blue", ",", "Purple", ",", 
           "Orange", ",", "Brown", ",", "Gray", ",", "Pink", ",", "Cyan"}], 
          "}"}]}], ",", "w", ",", "h", ",", "mymask", ",", "mymaska", ",", 
        "mymaskb", ",", "mynewmask", ",", "zoom", ",", "mymaskc", ",", 
        "mytable", ",", "mytemptable", ",", "myCentroid", ",", "myroi", ",", 
        "chN", ",", "mycurpoints", ",", "mysavepoints", ",", "mytemppoints", 
        ",", 
        RowBox[{"r", "=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], ",", "cury", ",", "numy", ",", 
        RowBox[{"roin", "=", "30"}], ",", "roit", ",", "myshape", ",", "p1", 
        ",", "p2", ",", "Size", ",", "Ns", ",", "roic", ",", "mydata", ",", 
        "bd", ",", " ", "tholdch", ",", "tholdsize", ",", 
        RowBox[{"myflag2", "=", "\"\< \>\""}], ",", 
        RowBox[{"sizemean", "=", "1"}], ",", "mycc"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mynewmask", "=", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"thold", "=", "0.8"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tholdsize", "=", "9"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tholdch", "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"w", ",", "h"}], "}"}], "=", 
        RowBox[{
         RowBox[{
         "allimg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "//",
          "ImageDimensions"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mytable", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "h", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "w", ",", "1"}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"bd", "=", 
        RowBox[{
         RowBox[{
         "allimg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "//",
          "ImageType"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"chN", "=", 
        RowBox[{
         RowBox[{
         "allimg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "//",
          "ImageChannels"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mysavepoints", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1.", ",", "1."}], "}"}], "}"}], ",", "1.", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"chN", ">", "1"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{"1.", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "chN", ",", "1"}], "}"}]}], 
               "]"}], ",", "1"}], "]"}], ",", "1."}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "30", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "Nimg", ",", "1"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"mycurpoints", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1.", ",", "1."}], "}"}], "}"}], ",", "1.", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"chN", ">", "1"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{"1.", ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "chN", ",", "1"}], "}"}]}], 
               "]"}], ",", "1"}], "]"}], ",", "1."}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "30", ",", "1"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "CHECK", " ", "FOR", " ", "PREVIOUS", " ", "ROI", " ", "FILES"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"FileNames", "[", "outfile", "]"}], "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mytemppoints", "=", 
           RowBox[{"(", 
            RowBox[{"<<", 
             RowBox[{"(", "outfile", ")"}]}], ")"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Ns", "=", 
           RowBox[{"Length", "[", 
            RowBox[{
            "mytemppoints", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Ns", "\[LessEqual]", "Nimg"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"1", ";;", "All"}], ",", 
                RowBox[{"1", ";;", "Ns"}]}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"mytemppoints", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"1", ";;", "All"}], ",", 
                RowBox[{"1", ";;", "Ns"}]}], "\[RightDoubleBracket]"}]}], 
             ";"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"1", ";;", "All"}], ",", 
                RowBox[{"1", ";;", "Nimg"}]}], "\[RightDoubleBracket]"}], "=", 
              RowBox[{"mytemppoints", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"1", ";;", "All"}], ",", 
                RowBox[{"1", ";;", "Nimg"}]}], "\[RightDoubleBracket]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Clear", "[", "mytemppoints", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"CONTROLS", "..."}], "..."}], "..."}], "..."}], 
              "..."}], "..."}], "..."}], "..."}], "..."}], "."}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Column", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<ROI:\>\"", " ", 
               RowBox[{"PopupMenu", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", "y", "]"}], ",", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Background\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Cytoplasm\>\""}], ",", 
                    RowBox[{"3", "\[Rule]", "\"\<Nucleus\>\""}], ",", 
                    RowBox[{"4", "\[Rule]", "\"\<Nucleoli\>\""}], ",", 
                    RowBox[{"5", "\[Rule]", "\"\<Array\>\""}], ",", 
                    RowBox[{"6", "\[Rule]", "\"\<ROI6\>\""}]}], "}"}], ",", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"i", "\[Rule]", 
                    RowBox[{"\"\<ROI\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "7", ",", "roin", ",", "1"}], "}"}]}], 
                    "]"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"\"\<  Type:\>\"", " ", 
               RowBox[{"PopupMenu", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", "roit", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "\[Rule]", "\"\<Polygon\>\""}], ",", 
                   RowBox[{"2", "\[Rule]", "\"\<Rectangle\>\""}], ",", 
                   RowBox[{"3", "\[Rule]", "\"\<Circle\>\""}]}], "}"}]}], 
                "]"}]}], ",", 
              RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{
               "\"\<EXPORT ROI CALC FILE\>\"", ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"FileNames", "[", "outfile", "]"}], "\[Equal]", 
                   RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"mysavepoints", ">>", 
                    RowBox[{"(", "outfile", ")"}]}], ";", " ", 
                   RowBox[{"myflag", "=", 
                    RowBox[{"outfile", "<>", "\"\<  File saved.\>\""}]}]}], 
                  ",", 
                  RowBox[{
                  "myflag", "=", "\"\<   ROIs file already exists.\>\""}]}], 
                 "\[IndentingNewLine]", "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{
               "\"\<DELETE ROI CALC FILE\>\"", ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"FileNames", "[", "outfile", "]"}], "\[NotEqual]", 
                   RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"DeleteFile", "[", "outfile", "]"}], ";", 
                   RowBox[{"myflag", "=", "\"\<  File deleted.\>\""}]}], ",", 
                  RowBox[{
                   RowBox[{"myflag", "=", "\"\<   No ROIs file found.\>\""}], 
                   ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{
               "\"\<CALCULATE AUTO ROI\>\"", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"mymaska", "=", 
                  RowBox[{"Binarize", "@", 
                   RowBox[{"Image", "[", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"White", ",", "myshape"}], "}"}], ",", 
                    RowBox[{"Background", "\[Rule]", "Black"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"w", ",", "h"}], "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "w"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "h"}], "}"}]}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"ColorSpace", "\[Rule]", "\"\<Grayscale\>\""}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"mynewmask", "=", "mymaska"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"mymaskb", "=", 
                  RowBox[{"Binarize", "[", 
                   RowBox[{
                    RowBox[{"ImageMultiply", "[", 
                    RowBox[{"mymaska", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ColorSeparate", "[", 
                    RowBox[{
                    "allimg", "\[LeftDoubleBracket]", "myt", 
                    "\[RightDoubleBracket]"}], "]"}], "\[LeftDoubleBracket]", 
                    "tholdch", "\[RightDoubleBracket]"}], "//", 
                    "ImageAdjust"}]}], "]"}], ",", "thold"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"myCentroid", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"mymaskb", "//", "ImageData"}], ",", "1"}], "]"}],
                     "//", "Mean"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"roit", "=", "3"}], ";", "\[IndentingNewLine]", 
                 RowBox[{"mymaskc", "=", 
                  RowBox[{"Binarize", "@", 
                   RowBox[{"Image", "[", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"White", ",", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "myCentroid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"h", "-", 
                    RowBox[{
                    "myCentroid", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", "1"}]}], "}"}], ",", 
                    "tholdsize"}], "]"}]}], "}"}], ",", 
                    RowBox[{"Background", "\[Rule]", "Black"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"w", ",", "h"}], "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "w"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "h"}], "}"}]}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"ColorSpace", "\[Rule]", "\"\<Grayscale\>\""}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"mymask", "=", 
                  RowBox[{"ImageSubtract", "[", 
                   RowBox[{"mymaskc", ",", "mymaskb"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                   RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "myCentroid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"h", "-", 
                    RowBox[{
                    "myCentroid", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", "1"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "myCentroid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"h", "-", 
                    RowBox[{
                    "myCentroid", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", "1"}]}], "}"}], "+", 
                    RowBox[{"{", 
                    RowBox[{"tholdsize", ",", "0"}], "}"}]}]}], "}"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                   RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
                  RowBox[{
                   RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"mymaskc", "//", "ImageData"}], "//", "Chop"}], "//",
                     "Flatten"}], ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{"x", "\[NotEqual]", " ", "0."}]}]}], "]"}], "//", 
                   "N"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                   RowBox[{"y", ",", "myt", ",", 
                    RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], 
                  "=", 
                  RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                   RowBox[{"y", ",", 
                    RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                   RowBox[{"y", ",", "myt", ",", "3"}], 
                   "\[RightDoubleBracket]"}], "=", 
                  RowBox[{
                   RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ImageData", "[", 
                    RowBox[{
                    RowBox[{"ImageMultiply", "[", 
                    RowBox[{"mymaskc", ",", 
                    RowBox[{
                    "allimg", "\[LeftDoubleBracket]", "myt", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "bd"}], "]"}], "//", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ")"}]}], "/", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}], 
                    "\[Equal]", "0"}], ",", "100000000.", ",", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                   RowBox[{"y", ",", "myt", ",", "4"}], 
                   "\[RightDoubleBracket]"}], "=", "3"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              "\"\< Threshhold: \>\"", ",", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "thold", "]"}], ",", 
                RowBox[{"FieldSize", "\[Rule]", "3"}]}], "]"}], ",", 
              RowBox[{"\"\<  Channel:\>\"", " ", 
               RowBox[{"PopupMenu", "[", 
                RowBox[{
                 RowBox[{"Dynamic", "[", "tholdch", "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"1", "\[Rule]", "\"\<1, red\>\""}], ",", 
                   RowBox[{"2", "\[Rule]", "\"\<2, green\>\""}], ",", 
                   RowBox[{"3", "\[Rule]", "\"\<3, blue\>\""}]}], "}"}]}], 
                "]"}]}], ",", "\"\<  ROI Size: \>\"", ",", 
              RowBox[{"InputField", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "tholdsize", "]"}], ",", 
                RowBox[{"FieldSize", "\[Rule]", "3"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{
               "\"\<CACULATE AUTO ROI FORWARD\>\"", ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"mymaska", "=", 
                  RowBox[{"Binarize", "@", 
                   RowBox[{"Image", "[", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"White", ",", "myshape"}], "}"}], ",", 
                    RowBox[{"Background", "\[Rule]", "Black"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"w", ",", "h"}], "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "w"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "h"}], "}"}]}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"ColorSpace", "\[Rule]", "\"\<Grayscale\>\""}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"mymaskb", "=", 
                    RowBox[{"Binarize", "[", 
                    RowBox[{
                    RowBox[{"ImageMultiply", "[", 
                    RowBox[{"mymaska", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ColorSeparate", "[", 
                    RowBox[{
                    "allimg", "\[LeftDoubleBracket]", "tt", 
                    "\[RightDoubleBracket]"}], "]"}], "\[LeftDoubleBracket]", 
                    "tholdch", "\[RightDoubleBracket]"}], "//", 
                    "ImageAdjust"}]}], "]"}], ",", "thold"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"myCentroid", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Round", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"mymaskb", "//", "ImageData"}], ",", "1"}], "]"}],
                     "//", "Mean"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"roit", "=", "3"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"mymaskc", "=", 
                    RowBox[{"Binarize", "@", 
                    RowBox[{"Image", "[", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"White", ",", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "myCentroid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"h", "-", 
                    RowBox[{
                    "myCentroid", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", "1"}]}], "}"}], ",", 
                    "tholdsize"}], "]"}]}], "}"}], ",", 
                    RowBox[{"Background", "\[Rule]", "Black"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"w", ",", "h"}], "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "w"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "h"}], "}"}]}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"ColorSpace", "\[Rule]", "\"\<Grayscale\>\""}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"mymask", "=", 
                    RowBox[{"ImageSubtract", "[", 
                    RowBox[{"mymaskc", ",", "mymaskb"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "myCentroid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"h", "-", 
                    RowBox[{
                    "myCentroid", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", "1"}]}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "myCentroid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"h", "-", 
                    RowBox[{
                    "myCentroid", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", "1"}]}], "}"}], "+", 
                    RowBox[{"{", 
                    RowBox[{"tholdsize", ",", "0"}], "}"}]}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"mymaskc", "//", "ImageData"}], "//", "Chop"}], "//",
                     "Flatten"}], ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{"x", "\[NotEqual]", " ", "0."}]}]}], "]"}], "//", 
                    "N"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "tt", ",", 
                    RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], 
                    "=", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", 
                    RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "tt", ",", "3"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ImageData", "[", 
                    RowBox[{
                    RowBox[{"ImageMultiply", "[", 
                    RowBox[{"mymaskc", ",", 
                    RowBox[{
                    "allimg", "\[LeftDoubleBracket]", "tt", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "bd"}], "]"}], "//", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ")"}]}], "/", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}], 
                    "\[Equal]", "0"}], ",", "100000000.", ",", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "tt", ",", "4"}], 
                    "\[RightDoubleBracket]"}], "=", "roit"}], ";"}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"{", 
                    RowBox[{"tt", ",", "myt", ",", "Nimg", ",", "1"}], 
                    "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Dynamic", "[", "myflag", "]"}], ",", 
              RowBox[{"Dynamic", "[", "myflag2", "]"}], ","}], 
             "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Button", "[", 
               RowBox[{
               "\"\<CALCULATE ROI BACK\>\"", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"mymask", "=", 
                  RowBox[{"Binarize", "@", 
                   RowBox[{"Image", "[", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"White", ",", "myshape"}], "}"}], ",", 
                    RowBox[{"Background", "\[Rule]", "Black"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"w", ",", "h"}], "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "w"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "h"}], "}"}]}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"ColorSpace", "\[Rule]", "\"\<Grayscale\>\""}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                   RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
                  RowBox[{
                   RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mymask", "//", "ImageData"}], "//", "Flatten"}], 
                    ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{"x", "\[NotEqual]", "0"}]}]}], "]"}], "//", 
                   "N"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "tt", ",", 
                    RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], 
                    "=", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", 
                    RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "tt", ",", "3"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ImageData", "[", 
                    RowBox[{
                    RowBox[{"ImageMultiply", "[", 
                    RowBox[{"mymask", ",", 
                    RowBox[{
                    "allimg", "\[LeftDoubleBracket]", "tt", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "bd"}], "]"}], "//", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ")"}]}], "/", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}], 
                    "\[Equal]", "0"}], ",", "100000000.", ",", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "tt", ",", "4"}], 
                    "\[RightDoubleBracket]"}], "=", "roit"}], ";"}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"{", 
                    RowBox[{"tt", ",", "myt", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<CALCULATE ROI\>\"", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"mymask", "=", 
                  RowBox[{"Binarize", "@", 
                   RowBox[{"Image", "[", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"White", ",", "myshape"}], "}"}], ",", 
                    RowBox[{"Background", "\[Rule]", "Black"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"w", ",", "h"}], "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "w"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "h"}], "}"}]}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"ColorSpace", "\[Rule]", "\"\<Grayscale\>\""}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                   RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
                  RowBox[{
                   RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mymask", "//", "ImageData"}], "//", "Flatten"}], 
                    ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{"x", "\[NotEqual]", "0"}]}]}], "]"}], "//", 
                   "N"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                   RowBox[{"y", ",", "myt", ",", 
                    RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], 
                  "=", 
                  RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                   RowBox[{"y", ",", 
                    RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                   RowBox[{"y", ",", "myt", ",", "3"}], 
                   "\[RightDoubleBracket]"}], "=", 
                  RowBox[{
                   RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ImageData", "[", 
                    RowBox[{
                    RowBox[{"ImageMultiply", "[", 
                    RowBox[{"mymask", ",", 
                    RowBox[{
                    "allimg", "\[LeftDoubleBracket]", "myt", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "bd"}], "]"}], "//", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ")"}]}], "/", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}], 
                    "\[Equal]", "0"}], ",", "100000000.", ",", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                   RowBox[{"y", ",", "myt", ",", "4"}], 
                   "\[RightDoubleBracket]"}], "=", "roit"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{
               "\"\<CALCULATE ROI FORWARD\>\"", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"mymask", "=", 
                  RowBox[{"Binarize", "@", 
                   RowBox[{"Image", "[", 
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"White", ",", "myshape"}], "}"}], ",", 
                    RowBox[{"Background", "\[Rule]", "Black"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"w", ",", "h"}], "}"}]}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "w"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "h"}], "}"}]}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"ColorSpace", "\[Rule]", "\"\<Grayscale\>\""}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                   RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
                  RowBox[{
                   RowBox[{"Count", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mymask", "//", "ImageData"}], "//", "Flatten"}], 
                    ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{"x", "\[NotEqual]", "0"}]}]}], "]"}], "//", 
                   "N"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "tt", ",", 
                    RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}], 
                    "=", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", 
                    RowBox[{"1", ";;", "2"}]}], "\[RightDoubleBracket]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "tt", ",", "3"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ImageData", "[", 
                    RowBox[{
                    RowBox[{"ImageMultiply", "[", 
                    RowBox[{"mymask", ",", 
                    RowBox[{
                    "allimg", "\[LeftDoubleBracket]", "tt", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "bd"}], "]"}], "//", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ")"}]}], "/", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}], 
                    "\[Equal]", "0"}], ",", "100000000.", ",", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "tt", ",", "4"}], 
                    "\[RightDoubleBracket]"}], "=", "roit"}], ";"}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"{", 
                    RowBox[{"tt", ",", "myt", ",", "Nimg", ",", "1"}], 
                    "}"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<CLEAR ROI\>\"", ",", 
                RowBox[{"Dynamic", "[", 
                 RowBox[{
                  RowBox[{
                  "mycurpoints", "\[LeftDoubleBracket]", "y", 
                   "\[RightDoubleBracket]"}], "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "}"}], ",", "1", ",", 
                    "0"}], "}"}]}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<SHOW ROI\>\"", ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"FileNames", "[", "outfile", "]"}], "\[NotEqual]", 
                   RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"mytemppoints", "=", 
                    RowBox[{"(", 
                    RowBox[{"<<", 
                    RowBox[{"(", "outfile", ")"}]}], ")"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Ns", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "mytemppoints", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"myt", "\[LessEqual]", "Ns"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "mycurpoints", "\[LeftDoubleBracket]", "y", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"mytemppoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "myt"}], "\[RightDoubleBracket]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"roit", "=", 
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "myt", ",", "4"}], 
                    "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"myflag", "=", "\"\<  Imported ROI.\>\""}]}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myflag", "=", "\"\<  No ROI saved.\>\""}], 
                    ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], ",", 
                  RowBox[{"myflag", "=", "\"\<  No ROI file found.\>\""}]}], 
                 "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<<\>\"", ",", 
                   RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "&"}], "/@", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
                   ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"17", ",", "17"}], "}"}]}], ",", 
                   RowBox[{"BaselinePosition", "\[Rule]", "Center"}]}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Column", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<^\>\"", ",", 
                    RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "+", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], ")"}], "&"}], "/@", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
                    ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"17", ",", "17"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<\[Vee]\>\"", ",", 
                    RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], ")"}], "&"}], "/@", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
                    ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"17", ",", "17"}], "}"}]}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"BaselinePosition", "\[Rule]", "Center"}]}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<>\>\"", ",", 
                   RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "+", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], ")"}], "&"}], "/@", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
                   ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"17", ",", "17"}], "}"}]}], ",", 
                   RowBox[{"BaselinePosition", "\[Rule]", "Center"}]}], 
                  "]"}]}], "}"}], "//", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}]}], "]"}], 
                "&"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Spacer", "[", "10", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<\[DoubleLeftArrow]\>\"", ",", 
                   RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{"{", 
                    RowBox[{"30", ",", "0"}], "}"}]}], ")"}], "&"}], "/@", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
                   ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"17", ",", "17"}], "}"}]}], ",", 
                   RowBox[{"BaselinePosition", "\[Rule]", "Center"}]}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Column", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<\[DoubleUpArrow]\>\"", ",", 
                    RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "+", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "30"}], "}"}]}], ")"}], "&"}], "/@", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
                    ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"17", ",", "17"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<\[DoubleDownArrow]\>\"", ",", 
                    RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "-", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "30"}], "}"}]}], ")"}], "&"}], "/@", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
                    ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"17", ",", "17"}], "}"}]}]}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"BaselinePosition", "\[Rule]", "Center"}]}], "]"}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<\[DoubleRightArrow]\>\"", ",", 
                   RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#", "+", 
                    RowBox[{"{", 
                    RowBox[{"30", ",", "0"}], "}"}]}], ")"}], "&"}], "/@", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
                   ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"17", ",", "17"}], "}"}]}], ",", 
                   RowBox[{"BaselinePosition", "\[Rule]", "Center"}]}], 
                  "]"}]}], "}"}], "//", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}]}], "]"}], 
                "&"}]}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Dynamically", " ", "updated", " ", "content"}], 
                    "..."}], "..."}], "..."}], "..."}], "..."}], "..."}], 
              "..."}], "..."}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "myt", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "Nimg", ",", "1"}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"600", ",", "20"}], "}"}]}]}], "]"}], " ", ",", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<-\>\"", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"myt", ">", "1"}], ",", 
                  RowBox[{"myt", "=", 
                   RowBox[{"myt", "-", "1"}]}]}], "]"}]}], "]"}], ",", 
              RowBox[{"Button", "[", 
               RowBox[{"\"\<+\>\"", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"myt", "<", "Nimg"}], ",", 
                  RowBox[{"myt", "=", 
                   RowBox[{"myt", "+", "1"}]}]}], "]"}]}], "]"}], ",", 
              RowBox[{"Spacer", "[", "10", "]"}], ",", 
              RowBox[{"Dynamic", "[", "myt", "]"}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"Slider", "[", 
              RowBox[{
               RowBox[{"Dynamic", "[", "zoom", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"300", ",", "1500", ",", "10"}], "}"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"600", ",", "20"}], "}"}]}]}], "]"}], " ", "}"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Choose Channel: \>\"", 
              RowBox[{"PopupMenu", "[", 
               RowBox[{
                RowBox[{"Dynamic", "[", "mycc", "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"i", "\[Rule]", 
                   RowBox[{"\"\<Channel \>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "0", ",", "chN", ",", "1"}], "}"}]}], 
                 "]"}]}], "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Manipulate", "[", 
               RowBox[{
                RowBox[{"LocatorPane", "[", 
                 RowBox[{
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}], "]"}],
                   ",", "\[IndentingNewLine]", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"mycc", ">", "0"}], ",", 
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"ColorSeparate", "[", 
                    RowBox[{
                    "allimg", "\[LeftDoubleBracket]", "myt", 
                    "\[RightDoubleBracket]"}], "]"}], "\[LeftDoubleBracket]", 
                    "mycc", "\[RightDoubleBracket]"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    "allimg", "\[LeftDoubleBracket]", "myt", 
                    "\[RightDoubleBracket]"}], "]"}]}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "zoom", "}"}]}]}], "]"}], ",", 
                  RowBox[{"LocatorAutoCreate", "\[Rule]", "True"}], ",", 
                  RowBox[{
                  "Appearance", "\[Rule]", 
                   "\"\<\!\(\*StyleBox[\"+\",FontColor->RGBColor[1, 1, \
0]]\)\>\""}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"br", ",", "30"}], "}"}], ",", "0.1", ",", "100", 
                  ",", "0.01"}], "}"}], ",", 
                RowBox[{"ControlType", "\[Rule]", 
                 RowBox[{"{", "VerticalSlider", "}"}]}], ",", 
                RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "]"}], ",",
               "\[IndentingNewLine]", 
              RowBox[{"Spacer", "[", "10", "]"}], ",", 
              RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
               RowBox[{"GraphicsColumn", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "//", "ImageAdjust"}], "//", 
                    RowBox[{
                    RowBox[{"Show", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"EdgeForm", "[", 
                    RowBox[{"Directive", "[", "Yellow", "]"}], "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"myshape", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"roit", "==", "1"}], ",", 
                    RowBox[{"Polygon", "[", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1"}], "\[RightDoubleBracket]"}], "]"}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"roit", "\[Equal]", "2"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"p1", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1", ",", 
                    RowBox[{"1", ";;", "All"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1", ",", 
                    RowBox[{"1", ";;", "All"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"p2", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1", ",", 
                    RowBox[{"1", ";;", "All"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1", ",", 
                    RowBox[{"1", ";;", "All"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"myflag", "=", 
                    RowBox[{"\"\<  dim=\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"Round", "[", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"p1", "-", "p2"}], "]"}], ",", "1"}], "]"}], 
                    "]"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Rectangle", "[", 
                    RowBox[{"p1", ",", "p2"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"roit", "\[Equal]", "3"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"p1", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Max", "[", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1", ",", 
                    RowBox[{"1", ";;", "All"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1", ",", 
                    RowBox[{"1", ";;", "All"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], ";", 
                    RowBox[{"p2", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Min", "[", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1", ",", 
                    RowBox[{"1", ";;", "All"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1", ",", 
                    RowBox[{"1", ";;", "All"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Size", "=", 
                    SqrtBox[
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"p1", "-", "p2"}], ")"}], ".", 
                    RowBox[{"(", 
                    RowBox[{"p1", "-", "p2"}], ")"}]}]]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"myflag", "=", 
                    RowBox[{"\"\<  radius=\>\"", "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Size", ",", "1"}], "]"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"mycurpoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "Size"}], "]"}]}]}], 
                    "]"}]}], "]"}]}], "]"}]}]}], "}"}], "]"}]}], "}"}], "]"}],
                     "&"}]}], ")"}], "&"}], "/@", 
                  RowBox[{"ColorSeparate", "[", 
                   RowBox[{
                   "allimg", "\[LeftDoubleBracket]", "myt", 
                    "\[RightDoubleBracket]"}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Background", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "Red", ",", "Green", ",", "Blue", ",", "Orange", ",", 
                    "Purple", ",", "Pink", ",", "Black", ",", "Gray", ",", 
                    "Brown"}], "}"}]}], ",", 
                 RowBox[{"ImageSize", "\[Rule]", 
                  RowBox[{"{", "500", "}"}]}]}], "]"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"mydata", "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"sizemean", "\[Equal]", "1"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"chN", "\[Equal]", "1"}], ",", 
                    FractionBox[
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", 
                    RowBox[{"1", ";;", "All"}], ",", "3"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"cury", "\[Equal]", "0"}], ",", "1", ",", 
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"cury", ",", 
                    RowBox[{"1", ";;", "All"}], ",", "3"}], 
                    "\[RightDoubleBracket]"}]}], "]"}]], ",", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", 
                    RowBox[{"1", ";;", "All"}], ",", "3"}], 
                    "\[RightDoubleBracket]"}], 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"cury", "\[Equal]", "0"}], ",", "1", ",", 
                    RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"cury", ",", 
                    RowBox[{"1", ";;", "All"}], ",", "3"}], 
                    "\[RightDoubleBracket]"}]}], "]"}]], "//", 
                    "Transpose"}]}], "]"}], ",", 
                   RowBox[{"mysavepoints", "\[LeftDoubleBracket]", 
                    RowBox[{"y", ",", 
                    RowBox[{"1", ";;", "All"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Column", "[", 
                 RowBox[{
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Spacer", "[", "130", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<ROI /\>\"", 
                    RowBox[{"PopupMenu", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "cury", "]"}], ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0", "\[Rule]", "\"\<Choose Divider\>\""}], ",", 
                    RowBox[{"1", "\[Rule]", "\"\<Background\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Cytoplasm\>\""}], ",", 
                    RowBox[{"3", "\[Rule]", "\"\<Nucleus\>\""}], ",", 
                    RowBox[{"4", "\[Rule]", "\"\<Nucleoli\>\""}], ",", 
                    RowBox[{"5", "\[Rule]", "\"\<Array\>\""}], ",", 
                    RowBox[{"6", "\[Rule]", "\"\<ROI6\>\""}]}], "}"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"i", "\[Rule]", 
                    RowBox[{"\"\<ROI\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "7", ",", "30", ",", "1"}], "}"}]}], 
                    "]"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "}"}],
                     "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Spacer", "[", "130", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"\"\<Measure:\>\"", 
                    RowBox[{"PopupMenu", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "sizemean", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"0", "\[Rule]", "\"\<ROI Size\>\""}], ",", 
                    RowBox[{"1", "\[Rule]", "\"\<ROI Mean Int.\>\""}]}], 
                    "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "}"}], "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"ListPlot", "[", 
                    RowBox[{"mydata", ",", 
                    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
                    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
                    RowBox[{"FrameTicks", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"All", ",", "All"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"All", ",", "All"}], "}"}]}], "}"}]}], ",", 
                    RowBox[{"FrameLabel", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Image #\>\"", ",", " ", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"sizemean", "\[Equal]", "1"}], ",", 
                    "\"\<Mean Int.\>\"", ",", "\"\<ROI Size (pixels)\>\""}], 
                    "]"}]}], "}"}]}], ",", 
                    RowBox[{"PlotMarkers", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"Automatic", ",", "8"}], "}"}]}], " ", ",", 
                    RowBox[{"PlotStyle", "\[Rule]", 
                    RowBox[{"Colors", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ";;", "All"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"AxesOrigin", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "Automatic"}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
                    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"Nimg", "+", "1"}]}], "}"}], ",", "All"}], 
                    "}"}]}]}], "]"}], "//", 
                    RowBox[{
                    RowBox[{"Show", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Purple", ",", "Dashed", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"myt", ",", 
                    RowBox[{"-", "1000"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"myt", ",", "1000"}], "}"}]}], "}"}], "]"}]}], 
                    "}"}], "]"}]}], "}"}], "]"}], "&"}]}]}], 
                   "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", 
                  RowBox[{"Dynamic", "[", "mymask", "]"}]}], "]"}]}], "]"}]}],
              "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
          "}"}], "]"}], "//", "Panel"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5637923595188*^9, 3.5637923676288114`*^9}, {
   3.563792446528922*^9, 3.563792448408924*^9}, {3.5637925393490515`*^9, 
   3.5637925410590544`*^9}, {3.5637926264191737`*^9, 
   3.5637926436091976`*^9}, {3.5637927468493423`*^9, 
   3.5637927790793877`*^9}, {3.563792827219455*^9, 3.5637928360594673`*^9}, {
   3.5637929157595787`*^9, 3.5637929178795815`*^9}, {3.563793064319787*^9, 
   3.563793069709794*^9}, {3.5637931146798573`*^9, 3.5637931207998657`*^9}, {
   3.563793194479969*^9, 3.5637932106199913`*^9}, {3.563793317990142*^9, 
   3.5637933634402056`*^9}, {3.563793428170296*^9, 3.5637934539995403`*^9}, {
   3.5637935033560176`*^9, 3.563793507046023*^9}, 3.5637936045261593`*^9, {
   3.563793704576299*^9, 3.5637937668463864`*^9}, {3.563794008187078*^9, 
   3.563794009127079*^9}, {3.5637940773471746`*^9, 3.5637941027172103`*^9}, {
   3.56379417405731*^9, 3.5637941749473114`*^9}, {3.5637942471174126`*^9, 
   3.5637942520974197`*^9}, {3.5637943801475987`*^9, 
   3.5637943938276176`*^9}, {3.5637944269176645`*^9, 3.56379450947778*^9}, {
   3.5637945731678686`*^9, 3.563794608107918*^9}, {3.5637946424079657`*^9, 
   3.5637946770580144`*^9}, {3.5637948414982443`*^9, 
   3.5637948971983223`*^9}, {3.563794932018371*^9, 3.56379495967841*^9}, {
   3.563795022998499*^9, 3.5637950335985136`*^9}, {3.563795066078559*^9, 
   3.5637951542286825`*^9}, {3.5637952055887547`*^9, 
   3.5637952213687763`*^9}, {3.563795262648834*^9, 3.563795263908836*^9}, {
   3.563795325258922*^9, 3.5637953264589233`*^9}, 3.5637953963390217`*^9, {
   3.5637954557091045`*^9, 3.5637955080191774`*^9}, {3.5637956158693285`*^9, 
   3.563795629129347*^9}, {3.5637956810194197`*^9, 3.5637957408495035`*^9}, {
   3.5637957715695467`*^9, 3.5637957868195677`*^9}, {3.5637958913997145`*^9, 
   3.563795931789771*^9}, {3.5637959978898635`*^9, 3.5637959994198656`*^9}, {
   3.563796122500038*^9, 3.5637961365200577`*^9}, {3.563796198260144*^9, 
   3.563796215600168*^9}, {3.5637962461702113`*^9, 3.563796390130413*^9}, {
   3.5637964486114945`*^9, 3.5637964758015327`*^9}, {3.5637969942722583`*^9, 
   3.5637969986322646`*^9}, {3.563797154662483*^9, 3.5637971563424854`*^9}, {
   3.563797192012535*^9, 3.563797234792595*^9}, {3.5637972650226374`*^9, 
   3.5637973028026905`*^9}, {3.5637973344727345`*^9, 3.563797350882758*^9}, {
   3.56379746665292*^9, 3.563797468032922*^9}, {3.5637975947930994`*^9, 
   3.563797605393114*^9}, 3.563797771363346*^9, {3.563797811643403*^9, 
   3.56379786680348*^9}, {3.5637979949036593`*^9, 3.563798012483684*^9}, {
   3.563798221563977*^9, 3.563798222093978*^9}, {3.5638352389144773`*^9, 
   3.5638352736045256`*^9}, {3.5638355726429453`*^9, 3.563835583752961*^9}, {
   3.5638358633933525`*^9, 3.5638359394434595`*^9}, {3.5638360131535625`*^9, 
   3.5638360160935664`*^9}, {3.563836096613679*^9, 3.563836186083804*^9}, {
   3.5638362205738525`*^9, 3.563836223903857*^9}, {3.5638362935339546`*^9, 
   3.563836388114087*^9}, {3.563836438804158*^9, 3.563836469274201*^9}, {
   3.5638366011843853`*^9, 3.5638366019243865`*^9}, 3.5638366326144295`*^9, {
   3.563836813194682*^9, 3.5638368253746996`*^9}, {3.563836895624798*^9, 
   3.5638369033748083`*^9}, {3.5638370069149537`*^9, 3.563837012864962*^9}, {
   3.5638370649250345`*^9, 3.563837072265045*^9}, {3.5638371339251313`*^9, 
   3.563837136595135*^9}, {3.5638372772253323`*^9, 3.5638372859253445`*^9}, {
   3.5638373216853943`*^9, 3.5638373474754305`*^9}, {3.5638373789954743`*^9, 
   3.5638374082655153`*^9}, {3.563837527795683*^9, 3.563837527915683*^9}, {
   3.5638376095267973`*^9, 3.5638376465068493`*^9}, {3.563837698596922*^9, 
   3.5638377245769587`*^9}, {3.563837757807005*^9, 3.5638378186770897`*^9}, 
   3.5638379508372755`*^9, {3.5638379932873344`*^9, 3.5638380011273456`*^9}, {
   3.5638380385773983`*^9, 3.5638380461974087`*^9}, {3.56383809713748*^9, 
   3.5638381203275127`*^9}, {3.5638383164117875`*^9, 
   3.5638383397118206`*^9}, {3.5638383790718756`*^9, 
   3.5638383968319006`*^9}, {3.5638384561719837`*^9, 
   3.5638384564519835`*^9}, {3.5638387564824038`*^9, 3.563838831652509*^9}, {
   3.563838873022567*^9, 3.563838873682568*^9}, {3.5638389550426817`*^9, 
   3.5638389919727335`*^9}, {3.563839038172798*^9, 3.563839095292878*^9}, {
   3.563839194323017*^9, 3.563839256453104*^9}, {3.563839433873352*^9, 
   3.5638394616433907`*^9}, {3.563839582953561*^9, 3.5638396306636276`*^9}, {
   3.563839736513776*^9, 3.563839757363805*^9}, {3.563839855363942*^9, 
   3.563839915304026*^9}, {3.563840055844223*^9, 3.5638400592342277`*^9}, {
   3.584423420208854*^9, 3.584423455870517*^9}, 3.5844238506614103`*^9, {
   3.584423900721898*^9, 3.584423916524726*^9}, {3.5844241605091543`*^9, 
   3.5844242509581137`*^9}, {3.592220451368591*^9, 3.5922204516186*^9}, {
   3.593193755143792*^9, 3.5931940137973585`*^9}, {3.5931940550025425`*^9, 
   3.5931940918481383`*^9}, {3.593194129084377*^9, 3.5931941306625786`*^9}, {
   3.5932598135612946`*^9, 3.5932598206085196`*^9}, {3.5933427348988204`*^9, 
   3.5933427369301734`*^9}, {3.5935457629774027`*^9, 
   3.5935458381844454`*^9}, {3.5935459096019974`*^9, 3.593545941951522*^9}, {
   3.593545974093524*^9, 3.5935459752292814`*^9}, {3.593546148937395*^9, 
   3.593546154183885*^9}, {3.5935462234429693`*^9, 3.5935462390723686`*^9}, {
   3.5937830442450027`*^9, 3.593783053701302*^9}, {3.593783096527791*^9, 
   3.593783101480093*^9}, {3.5937831390401144`*^9, 3.59378318332362*^9}, {
   3.5937832583538513`*^9, 3.5937835760320272`*^9}, {3.5937836746762333`*^9, 
   3.5937836818620205`*^9}, {3.5937837190387893`*^9, 
   3.5937837584527483`*^9}, {3.593783789921714*^9, 3.5937838142339115`*^9}, {
   3.5937838617145567`*^9, 3.593783888919922*^9}, {3.5937839411637287`*^9, 
   3.593783980274786*^9}, {3.5937840719531136`*^9, 3.5937840754324293`*^9}, {
   3.5937841707427607`*^9, 3.5937841744582357`*^9}, 3.5937842602193737`*^9, {
   3.593785680155939*^9, 3.593785681111577*^9}, 3.5937861483707056`*^9, {
   3.5941472644592333`*^9, 3.5941473091917057`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"1c6fd0fa-09b1-404d-b6b7-c1eafc74146b"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyNumString", "Subsection",
 InitializationCell->True,
 CellChangeTimes->{{3.4945628646757*^9, 
  3.494562866906504*^9}},ExpressionUUID->"4c8c1466-134c-4442-8f78-\
be8467706fad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyNumString", "[", 
    RowBox[{"myn_", ",", "L_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"myn", ">", 
      RowBox[{
       SuperscriptBox["10", "L"], "-", "1"}]}], ",", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"myn", ",", "10", ",", 
       RowBox[{"L", "+", "1"}]}], "]"}], ",", 
     RowBox[{"IntegerString", "[", 
      RowBox[{"myn", ",", "10", ",", "L"}], "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4934388235276003`*^9, 3.4934389526070004`*^9}, {
   3.493873344913*^9, 3.49387339683*^9}, 3.702431547454364*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"c1460593-48f2-4102-bf04-1f06972ed5d0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MyNumString", "[", 
  RowBox[{"30", ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.7024315503672934`*^9, 3.702431562774232*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"76fb10be-a6ea-424d-b050-62acd2f7dde2"],

Cell[BoxData["\<\"030\"\>"], "Output",
 CellChangeTimes->{
  3.7024315631023607`*^9, {3.7025877568947344`*^9, 3.7025877613166513`*^9}, 
   3.702587834891323*^9, 3.702642821585232*^9, 3.702669351849676*^9, 
   3.7026744985640516`*^9, 3.7027374432988715`*^9, 3.7028602384262505`*^9, 
   3.70291098643779*^9, 3.703342372138914*^9, 3.7034368281340604`*^9, 
   3.703440262493255*^9, 3.7064782230606384`*^9, 3.706581189382634*^9, 
   3.7070007657578287`*^9, 3.708246189333047*^9, 3.708380840483123*^9, 
   3.7088139578572874`*^9, 3.708858822074026*^9, 3.708858894909833*^9, 
   3.708858966545637*^9, 3.708863170958912*^9, 3.7089242062491984`*^9, 
   3.7135424319382167`*^9, 3.7136133097656016`*^9, 3.7136536705649786`*^9, 
   3.7142202159680634`*^9, 3.7142229012884407`*^9, 3.7144112721458607`*^9, 
   3.714829368297881*^9, 3.7153634768440456`*^9, 3.716837317526435*^9, 
   3.716927087572035*^9, 3.7169938032644677`*^9, 3.7171698253909063`*^9, 
   3.7172862395235453`*^9, 3.7177622150338063`*^9, 3.717765732072321*^9, 
   3.71785038794233*^9, 3.7178650085721874`*^9, 3.71882504142666*^9, 
   3.7188907418372254`*^9, 3.721693980991993*^9, 3.7216945773924446`*^9, 
   3.7217022327874064`*^9, 3.7227962461923656`*^9, 3.7228125179563007`*^9, 
   3.7228748134595585`*^9, 3.72287727877323*^9, 3.72288025983521*^9, 
   3.7229579486202927`*^9, 3.722959609163374*^9, 3.7229604056387386`*^9, 
   3.7229668797485247`*^9, 3.7229681983211737`*^9, 3.7229686984966*^9, 
   3.722968760174966*^9, {3.7229692257448916`*^9, 3.722969231933135*^9}, 
   3.7229694663179054`*^9, 3.7229748734539948`*^9, 3.7229759164382987`*^9, 
   3.722976425194959*^9, 3.723314339960978*^9, 3.724530492507553*^9, 
   3.7362604110395155`*^9, 3.736771143799841*^9, 3.7371361946779547`*^9, 
   3.737136291766358*^9, 3.737211605676162*^9, 3.737904759441576*^9, {
   3.746203825653063*^9, 3.7462038512534437`*^9}, 3.746712622891281*^9, 
   3.747406018161984*^9, {3.747407349377625*^9, 3.7474073626337357`*^9}, 
   3.74740803650646*^9, 3.747412984840871*^9, 3.7474173062075033`*^9, 
   3.74742019611773*^9, 3.747496810826527*^9, 3.747511657920101*^9, 
   3.7475300115011683`*^9, 3.747583118878162*^9, 3.747659033160427*^9, 
   3.748022839284794*^9, 3.748052430464628*^9, 3.748136036027885*^9, 
   3.7485268228288383`*^9, 3.7523652820326843`*^9, 3.752457258385825*^9, 
   3.756600738912743*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"02af4616-1525-427f-9fba-19d5cc6d9197"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["BandPass", "Subsection",
 CellChangeTimes->{{3.5781169365680165`*^9, 
  3.57811693907802*^9}},ExpressionUUID->"82419f90-f334-4b7b-a564-\
9cc5f70750f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BandPass", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgb", ",", "imgc"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgb", "=", 
      RowBox[{"ImageConvolve", "[", 
       RowBox[{"img", ",", 
        RowBox[{"GaussianMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"hi", ",", "lo"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"imgc", "=", 
        RowBox[{"ImageConvolve", "[", 
         RowBox[{"img", ",", 
          FractionBox[
           RowBox[{"BoxMatrix", "[", "hi", "]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "hi"}], "+", "1"}], ")"}], "2"]]}], "]"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"imgc", "=", 
      RowBox[{"ImageConvolve", "[", 
       RowBox[{"img", ",", 
        FractionBox[
         RowBox[{"DiskMatrix", "[", "hi", "]"}], 
         RowBox[{"Plus", "@@", 
          RowBox[{"Plus", "@@", 
           RowBox[{"DiskMatrix", "[", "hi", "]"}]}]}]]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSubtract", "[", 
      RowBox[{"imgb", ",", "imgc"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5750965858018923`*^9, 3.5750966952420454`*^9}, {
  3.5751516881187415`*^9, 3.5751517415788164`*^9}, {3.5787952659665294`*^9, 
  3.578795266902531*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"b0867705-130d-4338-b28c-1664233347ed"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"BandPass", "[", 
    RowBox[{
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxc3XezbVWZx/uuui+io0gDksydg6STz9777JM5gKG77aBtEyQniYIoAqIe
lCgoSUREBbSRjKKAWTF29T/9Su73jk/NUdRdVXvV2mvNOeYIz3jC7wnjz99/
1p73/z9/8Ad/cH9/z/f3/33+wAc+8O53v/vAgQObN2/etm3bCSecsL6+vmfP
nu3bt//DP/zDysrKe9/73r7ZuHHj2trarl27Nm3atGHDhr//+7/fO179dNxx
x/Xe59NOO211dfVtb3tbt//zP//zSSed9B//8R99v2XLFld2++mnn/5v//Zv
Pah23ve+95188smnnHJKT+/9gx/8YP92TQ/dunVr19SHPmt8586d28ernvzd
3/1dV9bCvn376nAPqg9d2UDqZN3up63j1ZVvfetb+6kO++aYY47p167/x3/8
x/6t5R07duj8/v37Deev/uqvukafu/c973lPD2pQJqfHdW/TVeN90+P0ttt7
r/8nnnhiw+knw6xBs6fPW8br/e9/f3cdffTRTVdNnXrqqU3C2Wef3QVNeM9q
Jmu55/7rv/5rHWiuuqAu/dM//dN//ud/1o1/+Zd/Oeywwz70oQ8df/zxPVTH
+lyzZkmXGku/9mH37t21UyNd0BNruX52V73693//927pifvGq870uRb6vp40
lt67uBt7RO/NVZd1Qe30TW32iDrWhDS0Bl6bzWpzHqmYYTPTq7vqRp3pygbY
hx7XKOpnH2q81qLJPnTBnvHq3jkDzUYP6kN9+/CHP2xpoo0eUT+7qwmsV/W/
lntc9/bEuvHOd76zpfyLv/iLFqIvW8Fa7uJm4B/Hq3+7vuWIQrqgVajlvjGf
f/u3f9vtXdazaqH3Btt7z6qRHlcHehB66Ke+7Jt+tTTmthb6ppmswf3j1WVN
Zt/0XrPd0qh7epNmyK5H0qeMV9c05/W227vsr//6r7vF1oskkGh9bvjdWJt9
rmPd2LzVYFNR+01417dM9arJbFztnT53V//63F0tSq3VeB1u6v7mb/4GgXXj
scce23vt13LvNdvy1du62rQ00q7sp4bf7b3vHC+01xBqtrt63DnnnBNDqD/1
Sgt1ssnvS2TTNd1Yby1cPWn4LVMT0vfdMje7nrSzoo3a6VdbpoE0XX2uKWNE
aX3oEQje3PZlLAuN1W176l3veldjqTULXcv1oSv7tTXqvX+tXRdH861+1NLn
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
        "], {{0, 165}, {192, 0}}, {0, 255},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->{78., Automatic},
      ImageSizeRaw->{192, 165},
      PlotRange->{{0, 192}, {0, 165}}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "12"}], "}"}]}], "]"}], "//", "ImageAdjust"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.575096671242012*^9, 3.575096685632032*^9}, {
  3.575151552048551*^9, 3.575151584238596*^9}, {3.5751527213321905`*^9, 
  3.575152738242214*^9}, {3.5787952704749374`*^9, 3.5787952717229395`*^9}, {
  3.648226188532628*^9, 3.6482261920908318`*^9}, {3.648226491268944*^9, 
  3.648226494211112*^9}, {3.6482313009610424`*^9, 3.6482313029911585`*^9}, {
  3.6482314723518453`*^9, 3.648231474766983*^9}, {3.6483038949211793`*^9, 
  3.6483038979373517`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"22b0b9c3-d0b2-4ca5-951a-b5e78a4f5565"]
}, Closed]],

Cell[CellGroupData[{

Cell["FindParticles (updated to remove adjacentbordercounts)", "Subsection",
 CellChangeTimes->{{3.578116942838025*^9, 3.5781169456080294`*^9}, {
  3.706478182893057*^9, 
  3.706478194310189*^9}},ExpressionUUID->"d438ec39-0e88-415c-9af1-\
550f42c9553e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindParticlesWeighted", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}], ",", "max_", ",", "th_", ",", 
    "imgmask_", ",", 
    RowBox[{"{", 
     RowBox[{"small_", ",", "large_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgb", ",", "imgc", ",", "pos"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgb", "=", 
      RowBox[{"BandPass", "[", 
       RowBox[{"img", ",", 
        RowBox[{"{", 
         RowBox[{"lo", ",", "hi"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"imgc", "=", 
      RowBox[{"SelectComponents", "[", 
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{
          RowBox[{"imgb", "//", 
           RowBox[{
            RowBox[{"Binarize", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"max", " ", "th"}]}], "]"}], "&"}]}], ",", "imgmask"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Count\>\"", ",", "\"\<AdjacentBorderCount\>\""}], "}"}],
         ",", 
        RowBox[{
         RowBox[{
          RowBox[{"small", "<", "#1", "<", "large"}], "&&", 
          RowBox[{"#2", "\[Equal]", "0"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ComponentMeasurements", "[", 
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{"img", ",", "imgc"}], "]"}], ",", 
        RowBox[{"{", "\"\<IntensityCentroid\>\"", "}"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Color", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Circle", "[", 
              RowBox[{"#", ",", 
               RowBox[{"hi", " ", "1.5"}]}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{"pos", "=", 
              RowBox[{
               RowBox[{"ComponentMeasurements", "[", 
                RowBox[{"imgc", ",", 
                 RowBox[{"{", "\"\<Centroid\>\"", "}"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2", ",", "1"}], "]"}], "]"}]}], 
             ")"}]}]}], "}"}], "]"}]}], "]"}], ",", "pos"}], "}"}], "*)"}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5751527958022947`*^9, 3.5751528802924128`*^9}, {
   3.575152925492476*^9, 3.575153061152666*^9}, {3.5751531432227807`*^9, 
   3.5751531438627815`*^9}, {3.575153188922845*^9, 3.575153245352924*^9}, {
   3.5751533274730387`*^9, 3.5751533584830823`*^9}, {3.575153416033163*^9, 
   3.575153416743164*^9}, {3.575153718293586*^9, 3.5751537187735863`*^9}, {
   3.575157436595137*^9, 3.575157459425169*^9}, {3.5751582558262844`*^9, 
   3.5751582568962855`*^9}, {3.575166234180505*^9, 3.5751662566605363`*^9}, {
   3.5752405029781218`*^9, 3.5752405155081396`*^9}, 3.5752409476101503`*^9, {
   3.575241075013016*^9, 3.575241093953043*^9}, {3.575241128623091*^9, 
   3.5752411288630915`*^9}, {3.575241197793188*^9, 3.5752411981431885`*^9}, {
   3.5752413495734005`*^9, 3.5752413764734383`*^9}, {3.608917991298159*^9, 
   3.608917992241254*^9}, {3.6464847677413335`*^9, 3.646484783389229*^9}, {
   3.6485836816759624`*^9, 3.648583758596362*^9}, {3.6485838271562834`*^9, 
   3.6485838425561647`*^9}, {3.648584935277664*^9, 3.648584935773693*^9}, {
   3.653239142652603*^9, 3.653239166804985*^9}, {3.653239283964686*^9, 
   3.6532393084690876`*^9}, {3.6550415999770727`*^9, 
   3.6550416069970846`*^9}, {3.655041804633832*^9, 3.655041805772634*^9}, {
   3.6550418792175627`*^9, 3.6550418826339693`*^9}, {3.655059163882098*^9, 
   3.655059163986104*^9}, {3.655059211210805*^9, 3.655059211353813*^9}, {
   3.6552216016280055`*^9, 3.655221607020314*^9}, {3.6552232897335596`*^9, 
   3.6552232946458406`*^9}, {3.6552233416135273`*^9, 3.655223392261424*^9}, {
   3.6552241750611973`*^9, 3.65522418961403*^9}, {3.6553853018305316`*^9, 
   3.6553853463590784`*^9}, {3.7064175117925706`*^9, 
   3.7064175278289895`*^9}, {3.7064175826179943`*^9, 
   3.7064175944213734`*^9}, {3.708250397120329*^9, 3.708250404106188*^9}, {
   3.7082504460739756`*^9, 3.7082504507957506`*^9}, 3.7082516795254517`*^9, {
   3.7082520161449137`*^9, 3.708252025649684*^9}, {3.708252308189315*^9, 
   3.708252309186164*^9}, 3.7082569876100755`*^9, 3.7083825965615287`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"9f197d38-b966-4cd8-9833-f8046edd83c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindParticlesWeightedMask", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}], ",", "max_", ",", "th_", ",", 
    "imgmask_", ",", 
    RowBox[{"{", 
     RowBox[{"small_", ",", "large_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgb", ",", "imgc", ",", "pos"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgb", "=", 
      RowBox[{"BandPass", "[", 
       RowBox[{"img", ",", 
        RowBox[{"{", 
         RowBox[{"lo", ",", "hi"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"imgc", "=", 
      RowBox[{"SelectComponents", "[", 
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{
          RowBox[{"imgb", "//", 
           RowBox[{
            RowBox[{"Binarize", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"max", " ", "th"}]}], "]"}], "&"}]}], ",", "imgmask"}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Count\>\"", ",", "\"\<AdjacentBorderCount\>\""}], "}"}],
         ",", 
        RowBox[{
         RowBox[{
          RowBox[{"small", "<", "#1", "<", "large"}], "&&", 
          RowBox[{"#2", "\[Equal]", "0"}]}], "&"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5751527958022947`*^9, 3.5751528802924128`*^9}, {
   3.575152925492476*^9, 3.575153061152666*^9}, {3.5751531432227807`*^9, 
   3.5751531438627815`*^9}, {3.575153188922845*^9, 3.575153245352924*^9}, {
   3.5751533274730387`*^9, 3.5751533584830823`*^9}, {3.575153416033163*^9, 
   3.575153416743164*^9}, {3.575153718293586*^9, 3.5751537187735863`*^9}, {
   3.575157436595137*^9, 3.575157459425169*^9}, {3.5751582558262844`*^9, 
   3.5751582568962855`*^9}, {3.575166234180505*^9, 3.5751662566605363`*^9}, {
   3.5752405029781218`*^9, 3.5752405155081396`*^9}, 3.5752409476101503`*^9, {
   3.575241075013016*^9, 3.575241093953043*^9}, {3.575241128623091*^9, 
   3.5752411288630915`*^9}, {3.575241197793188*^9, 3.5752411981431885`*^9}, {
   3.5752413495734005`*^9, 3.5752413764734383`*^9}, {3.608917991298159*^9, 
   3.608917992241254*^9}, {3.6464847677413335`*^9, 3.646484783389229*^9}, {
   3.6485836816759624`*^9, 3.648583758596362*^9}, {3.6485838271562834`*^9, 
   3.6485838425561647`*^9}, {3.648584935277664*^9, 3.648584935773693*^9}, {
   3.653239142652603*^9, 3.653239166804985*^9}, {3.653239283964686*^9, 
   3.6532393084690876`*^9}, {3.6550415999770727`*^9, 
   3.6550416069970846`*^9}, {3.655041804633832*^9, 3.655041805772634*^9}, {
   3.6550418792175627`*^9, 3.6550418826339693`*^9}, {3.655059163882098*^9, 
   3.655059163986104*^9}, {3.655059211210805*^9, 3.655059211353813*^9}, {
   3.6552216016280055`*^9, 3.655221607020314*^9}, {3.6552232897335596`*^9, 
   3.6552232946458406`*^9}, {3.6552233416135273`*^9, 3.655223392261424*^9}, {
   3.6552241750611973`*^9, 3.65522418961403*^9}, {3.6553853018305316`*^9, 
   3.6553853463590784`*^9}, {3.7064175117925706`*^9, 
   3.7064175278289895`*^9}, {3.7064175826179943`*^9, 
   3.7064175944213734`*^9}, {3.708250397120329*^9, 3.708250404106188*^9}, {
   3.7082504460739756`*^9, 3.7082504507957506`*^9}, 3.7082516795254517`*^9, {
   3.7082520161449137`*^9, 3.708252025649684*^9}, {3.708252308189315*^9, 
   3.708252309186164*^9}, {3.7082566948533335`*^9, 3.7082567064482007`*^9}, {
   3.708510282112838*^9, 3.7085102832053924`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"b16826d6-b21d-4622-9b41-47aae6a6b6fa"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
PairConnect2 (still one small error, but doesn\[CloseCurlyQuote]t seem to \
mess up stuff)\
\>", "Subsection",
 CellChangeTimes->{{3.578373737283985*^9, 3.578373754802816*^9}, {
  3.6425405298598948`*^9, 3.6425405335598993`*^9}, {3.642540631241037*^9, 
  3.6425406446910553`*^9}, {3.6483824557337046`*^9, 
  3.648382456997307*^9}},ExpressionUUID->"ac9ecbf5-8db4-4ec6-a67f-\
08256e707124"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PairConnect2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ticker_", ",", "anolist1t_"}], "}"}], ",", "list2t_", ",", 
    "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newticker", ",", "finalticker", ",", "list1", ",", "list2", ",", "flag",
       ",", "out", ",", "newTracks", ",", "mypos", ",", "myind", ",", "myl", 
      ",", "out2", ",", "out3"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newticker", "=", "ticker"}], ";", "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"anolist1t", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
          RowBox[{"#2", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"Sort", "@", "list2t"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"flag", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"myind", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"mypos", "=", 
          RowBox[{"list2", "\[LeftDoubleBracket]", 
           RowBox[{"myind", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Reap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"While", "[", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
               RowBox[{"list1", "\[LeftDoubleBracket]", 
                RowBox[{"m", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
               "-", "dist"}], "\[LessEqual]"}], " ", "*)"}], 
            RowBox[{
             RowBox[{
              RowBox[{"mypos", "\[LessEqual]", 
               RowBox[{
                RowBox[{"list1", "\[LeftDoubleBracket]", 
                 RowBox[{"m", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}],
                 "+", "dist"}]}], " ", "&&", 
              RowBox[{"myind", "\[LessEqual]", " ", 
               RowBox[{"Length", "@", "list2"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"EuclideanDistance", "[", 
                  RowBox[{
                   RowBox[{
                   "list2", "\[LeftDoubleBracket]", "myind", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"list1", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                  "]"}], "\[LessEqual]", "dist"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Sow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"list1", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "list2", "\[LeftDoubleBracket]", "myind", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"list2", "=", 
                  RowBox[{"Delete", "[", 
                   RowBox[{"list2", ",", "myind"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"myind", "=", 
                  RowBox[{"myind", "-", "1"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"flag", "=", 
                  RowBox[{"flag", "+", "1"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myind", "=", 
               RowBox[{"myind", "+", "1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", "list2"}], ">", "0"}], "&&", 
                 RowBox[{"myind", "\[LessEqual]", 
                  RowBox[{"Length", "@", "list2"}]}]}], ",", 
                RowBox[{"mypos", "=", 
                 RowBox[{"list2", "\[LeftDoubleBracket]", 
                  RowBox[{"myind", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                ",", 
                RowBox[{"m", "=", 
                 RowBox[{"Length", "@", "list1"}]}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", 
          RowBox[{"Length", "@", "list1"}], ",", "1"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"out", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}]}], ",", "Null"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "list2"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"finalticker", "=", 
         RowBox[{"newticker", "+", 
          RowBox[{"Length", "[", "list2", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newTracks", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"newticker", "+", "1"}], ",", "finalticker"}], "]"}], 
            ",", "list2"}], "}"}], "//", "Transpose"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"out3", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"out2", ",", "newTracks"}], "]"}]}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"finalticker", "=", "newticker"}], ";", "\[IndentingNewLine]", 
        RowBox[{"out3", "=", "out2"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"finalticker", ",", "out3"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.578278483426984*^9, 3.578278527017045*^9}, {
   3.578278617567171*^9, 3.578278812177444*^9}, {3.578278860177511*^9, 
   3.578278958617649*^9}, {3.5782790527777805`*^9, 3.5782791306678896`*^9}, {
   3.578279228338026*^9, 3.5782792824481025`*^9}, {3.578279331708171*^9, 
   3.57827937375923*^9}, {3.5782797231797194`*^9, 3.5782797524497604`*^9}, {
   3.5782798062098355`*^9, 3.578279820769856*^9}, {3.578279860929912*^9, 
   3.578279877759936*^9}, {3.5782800389101615`*^9, 3.5782800426101665`*^9}, {
   3.5782801504503174`*^9, 3.5782802956605206`*^9}, {3.5782803604306116`*^9, 
   3.5782803672306213`*^9}, {3.5782804440807285`*^9, 3.578280470540766*^9}, {
   3.5782805111508226`*^9, 3.5782805168008304`*^9}, {3.5782805968509426`*^9, 
   3.5782805970109425`*^9}, {3.5782806657110386`*^9, 
   3.5782806854210663`*^9}, {3.5782807162611094`*^9, 
   3.5782807175111113`*^9}, {3.5782807897512126`*^9, 3.578280792511216*^9}, {
   3.5782808529913015`*^9, 3.5782808624313145`*^9}, 3.578280908081378*^9, {
   3.5782809467514324`*^9, 3.5782810046925135`*^9}, {3.5782810446625695`*^9, 
   3.5782810505625772`*^9}, {3.5782811481127143`*^9, 
   3.5782811696327443`*^9}, {3.578281283622904*^9, 3.5782812974929237`*^9}, {
   3.578281465663159*^9, 3.578281465853159*^9}, {3.578281551223279*^9, 
   3.578281564433297*^9}, {3.5782816376533995`*^9, 3.578281646533412*^9}, {
   3.578282025693943*^9, 3.5782820302239494`*^9}, {3.5782822587442694`*^9, 
   3.578282264654278*^9}, {3.5782823233143597`*^9, 3.57828232345436*^9}, {
   3.5782825197346344`*^9, 3.578282525154642*^9}, {3.578282604784754*^9, 
   3.5782826048347535`*^9}, {3.5782826819758615`*^9, 
   3.5782826900358734`*^9}, {3.5782827276359253`*^9, 3.578282894096159*^9}, {
   3.578282962536255*^9, 3.5782829667562604`*^9}, {3.5782831375564995`*^9, 
   3.5782831679665422`*^9}, {3.578283206996597*^9, 3.5782832870267086`*^9}, {
   3.578283348096794*^9, 3.578283367776822*^9}, {3.578283470656966*^9, 
   3.578283492016996*^9}, {3.5782839458876314`*^9, 3.5782839944376993`*^9}, {
   3.5782841031378517`*^9, 3.578284113677866*^9}, {3.5782842223180184`*^9, 
   3.5782842223880186`*^9}, {3.5782843294291687`*^9, 
   3.5782843302791696`*^9}, {3.5782844209192963`*^9, 3.578284457309347*^9}, {
   3.578284550769478*^9, 3.5782845508994784`*^9}, {3.578284822663619*^9, 
   3.57828484069565*^9}, {3.5782853893969555`*^9, 3.578285423857003*^9}, {
   3.578285545237173*^9, 3.578285545617174*^9}, {3.5782858759376364`*^9, 
   3.578285897557667*^9}, {3.578286003598815*^9, 3.5782860371688623`*^9}, {
   3.5782861572790303`*^9, 3.57828615737903*^9}, {3.5782862077491007`*^9, 
   3.5782862166091137`*^9}, {3.5782862581791716`*^9, 3.5782862847992086`*^9}, 
   3.578286325379266*^9, {3.578286401229372*^9, 3.5782864672294645`*^9}, {
   3.578286510369525*^9, 3.578286511389526*^9}, {3.5782870152702312`*^9, 
   3.578287016370233*^9}, {3.5782872721305914`*^9, 3.5782873117806463`*^9}, {
   3.5782874462608347`*^9, 3.5782874467208357`*^9}, {3.5782874911708975`*^9, 
   3.5782874941909018`*^9}, {3.5782876928021803`*^9, 3.578287701252192*^9}, {
   3.5782877771222982`*^9, 3.578287777862299*^9}, {3.578288352623104*^9, 
   3.578288353153105*^9}, {3.578288429383211*^9, 3.578288430623213*^9}, {
   3.5782885667834034`*^9, 3.5782885799034224`*^9}, {3.578288708243602*^9, 
   3.5782887524836636`*^9}, {3.578288898613868*^9, 3.578288905053877*^9}, {
   3.5782893486954985`*^9, 3.5782893521655035`*^9}, {3.578291437249422*^9, 
   3.5782914925594997`*^9}, 3.578291604639657*^9, {3.6425306412239523`*^9, 
   3.642530683860013*^9}, {3.642530742362096*^9, 3.6425308047651834`*^9}, {
   3.642531019962491*^9, 3.642531020132491*^9}, {3.6425311360136547`*^9, 
   3.642531166125697*^9}, {3.64253121132876*^9, 3.6425312242587786`*^9}, {
   3.642531293833877*^9, 3.642531297573882*^9}, {3.6425314082820387`*^9, 
   3.64253150795218*^9}, {3.6425315514062414`*^9, 3.6425315622862563`*^9}, {
   3.6425315928842998`*^9, 3.6425316444823723`*^9}, {3.642531691449439*^9, 
   3.6425317249694867`*^9}, {3.6425319206627626`*^9, 
   3.6425319318037777`*^9}, {3.642532056447954*^9, 3.6425320886969995`*^9}, {
   3.642532138244069*^9, 3.6425321476280828`*^9}, 3.642532244681219*^9, {
   3.6425323095393105`*^9, 3.6425323484653654`*^9}, {3.6425323843774157`*^9, 
   3.642532444282503*^9}, {3.642532501847584*^9, 3.6425325024575853`*^9}, {
   3.6425325615806684`*^9, 3.642532601869725*^9}, {3.642532707053873*^9, 
   3.6425327454539275`*^9}, {3.6425327819739795`*^9, 
   3.6425327821139793`*^9}, {3.642532815416026*^9, 3.6425328677931004`*^9}, {
   3.6425329233521786`*^9, 3.642532926542183*^9}, {3.642533062098374*^9, 
   3.642533259736653*^9}, {3.642533571219092*^9, 3.642533595639126*^9}, {
   3.642533784734393*^9, 3.64253385364149*^9}, {3.6425339204625874`*^9, 
   3.642533928552599*^9}, {3.642533971415659*^9, 3.642533983913677*^9}, {
   3.642534058391782*^9, 3.642534134649889*^9}, 3.6425342296930227`*^9, {
   3.642534352895197*^9, 3.6425345223634353`*^9}, {3.642534700581686*^9, 
   3.6425347028516893`*^9}, {3.642534759857769*^9, 3.6425347601777697`*^9}, {
   3.6425348824019413`*^9, 3.6425348994869657`*^9}, {3.642535074718212*^9, 
   3.6425352725904903`*^9}, {3.6425353223105607`*^9, 
   3.6425353314005733`*^9}, {3.6425353699746275`*^9, 
   3.6425353984366674`*^9}, {3.64253546901377*^9, 3.642535556605893*^9}, {
   3.642535660427039*^9, 3.6425356605370398`*^9}, {3.642535706873105*^9, 
   3.6425357137931147`*^9}, {3.6425384922410283`*^9, 3.642538496281034*^9}, 
   3.6785566714495325`*^9, {3.6785587960190516`*^9, 3.6785588947867002`*^9}, {
   3.6785593039071007`*^9, 3.678559305379185*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"09689079-c025-481f-9b5d-3c78297d7c6d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
PairConnect3 (Connect a dot in frame(n) to the nearest dot in frame(n-1) \
which is less than the determined jumping distance > there is no conversion, \
but diversion) \
\>", "Subsection",
 CellChangeTimes->{{3.678559583698104*^9, 3.678559593562668*^9}, {
  3.6785687791460533`*^9, 3.6785688974738216`*^9}, {3.6785689412813272`*^9, 
  3.678568949921821*^9}},ExpressionUUID->"856a67cb-2647-4efb-ace1-\
d402123e1bf5"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "is", " ", "used", " ", "with", " ", 
     "LinkTracks", " ", "or", " ", "LinkTracks2", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", "A", " ", "cordinate", " ", "of", " ", 
     "each", " ", "dots", " ", "at", " ", "frame", "#", " ", "N"}], "+", 
    RowBox[{
    "1", " ", "is", " ", "compared", " ", "with", " ", "dots", " ", "at", " ",
      "frame", "#", " ", "N", " ", "by", " ", "Table", " ", "function", 
     "\[IndentingNewLine]", "\t", "Those", " ", "dots", " ", "located"}], " ",
     "+", 
    RowBox[{
     RowBox[{"/", 
      RowBox[{"-", " ", "\"\<dist_\>\""}]}], " ", "are", " ", "listed", " ", 
     "as", " ", "\"\<potentialDots\>\"", "\[IndentingNewLine]", "\t", "If", 
     " ", "the", " ", "nearest", " ", "dots", " ", "in", " ", 
     "\"\<potentialDots\>\"", " ", "is", " ", "actually", " ", "less", " ", 
     "than", " ", "\"\<dist_\>\"", "\[IndentingNewLine]", "\t", "the", " ", 
     "track", " ", "number", " ", "of", " ", "the", " ", "dot", " ", "is", 
     " ", "given", " ", "to", " ", "the", " ", "current", " ", "dot", " ", 
     "at", " ", "frame", "#", " ", "N"}], "+", 
    RowBox[{
    "1", "\[IndentingNewLine]", "\t", "This", " ", "will", " ", "ensure", " ",
      "there", " ", "is", " ", "no", " ", "conversion", " ", "in", " ", 
     "tracks", "\[IndentingNewLine]", "\t", "If", " ", "there", " ", "is", 
     " ", "no", " ", "dots", " ", "closeby", " ", "in", " ", "frame", " ", 
     "#N"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "the", " ", "current", " ", "dot", " ", "gets", " ", "the", " ", "new", 
     " ", "track", " ", "number", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{
     "list1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ":", 
    " ", 
    RowBox[{"the", " ", "latest", " ", 
     RowBox[{"(", "biggest", ")"}], " ", "track", " ", "number", " ", "being",
      " ", "used", " ", 
     RowBox[{"(", "newticker", ")"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{
     "list1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ":", 
    " ", 
    RowBox[{
    "the", " ", "list", " ", "of", " ", "cordinate", " ", "of", " ", "points",
      " ", "with", " ", "a", " ", "track", " ", "number", " ", "at", " ", 
     "frame", "#", " ", "N", " ", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"list2", ":", "    ", 
      RowBox[{
       RowBox[{
       "the", " ", "list", " ", "of", " ", "cordinate", " ", "of", " ", 
        "points", " ", "at", " ", "frame", "#", " ", "N"}], "+", 
       RowBox[{
       "1", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t ", "out"}]}], 
      ":", "      ", 
      RowBox[{
       RowBox[{
       "the", " ", "list", " ", "of", " ", "cordinate", " ", "of", " ", 
        "points", " ", "with", " ", "a", " ", "track", " ", "number", " ", 
        "at", " ", "frame", "#", " ", "N"}], "+", "1"}]}]}]}]}], 
  "\[IndentingNewLine]", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6786311463602543`*^9, 3.6786316118118763`*^9}, {
  3.6786336143174133`*^9, 3.6786336993652773`*^9}, {3.6786337329091964`*^9, 
  3.6786338276456146`*^9}, {3.6786442408382154`*^9, 3.67864462992647*^9}, {
  3.678644735598514*^9, 3.678644831406994*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"e29bd05a-cd43-4ec0-81b0-b62159bd7246"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PairConnect3", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ticker_", ",", "anolist1t_"}], "}"}], ",", "list2t_", ",", 
    "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newticker", ",", "list1", ",", "list2", ",", "out", ",", "mypos"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newticker", "=", "ticker"}], ";", "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"anolist1t", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
          RowBox[{"#2", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"Sort", "@", "list2t"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mypos", "=", 
          RowBox[{
          "list2", "\[LeftDoubleBracket]", "myi", "\[RightDoubleBracket]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"potentialDots", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"list1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "-", "dist"}], "<", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "+", "dist"}]}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "-", "dist"}], "<", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<", 
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "+", "dist"}]}]}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"potentialDots", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newticker", "+=", "1"}], ";", 
            RowBox[{"out", "=", 
             RowBox[{"{", 
              RowBox[{"newticker", ",", "mypos"}], "}"}]}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"potentialDot", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"potentialDots", ",", 
                 RowBox[{"x_", "/;", 
                  RowBox[{
                   RowBox[{
                   "x", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"potentialDots", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",",
                     "mypos"}], "]"}]}]}]}]}], "]"}], ",", "1"}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"EuclideanDistance", "[", 
                RowBox[{"mypos", ",", 
                 RowBox[{
                 "potentialDot", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ">", "dist"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{"newticker", "+=", "1"}], ";", 
               RowBox[{"out", "=", 
                RowBox[{"{", 
                 RowBox[{"newticker", ",", "mypos"}], "}"}]}], ";"}], ",", 
              RowBox[{
               RowBox[{"out", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "potentialDot", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "mypos"}], "}"}]}], 
               ";"}]}], "]"}]}]}], "]"}], ";", "out"}], ",", 
        RowBox[{"{", 
         RowBox[{"myi", ",", "1", ",", 
          RowBox[{"Length", "@", "list2"}], ",", "1"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newticker", ",", "out"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.678559612091728*^9, 3.678559616794997*^9}, {
   3.6785597764591293`*^9, 3.678559889284582*^9}, {3.6785600026430664`*^9, 
   3.6785600028040757`*^9}, {3.6785645606417685`*^9, 3.6785646495908566`*^9}, 
   3.6785661846406565`*^9, 3.6785662164474754`*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"1d7fe270-8221-42d8-ba56-911ce856434d"]
}, Closed]],

Cell[CellGroupData[{

Cell["PairConnect4 (PairConnect3 + removing diversion)", "Subsection",
 CellChangeTimes->{{3.678559583698104*^9, 3.678559593562668*^9}, {
  3.67856877593787*^9, 3.678568776041876*^9}, {3.678568958833331*^9, 
  3.6785689735461726`*^9}},ExpressionUUID->"2eb3e65b-79f7-4754-8461-\
6b0684db1de4"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "is", " ", "used", " ", "with", " ", 
     "LinkTracks", " ", "or", " ", "LinkTracks2", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", "After", " ", "connecting", " ", "all", " ",
      "dots", " ", "at", " ", "frame", "#", " ", "N"}], "+", 
    RowBox[{
    "1", " ", "to", " ", "dots", " ", "at", " ", "frame", "#", " ", "N", 
     "\[IndentingNewLine]", "\t", "finding", " ", "redundant", " ", "track", 
     " ", "numbers", " ", "by", " ", "using", " ", "RedundantTrack", " ", 
     "function", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"RedundantTrack", "[", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "5", ",", "1", ",", "6", ",", "7", ",", "2", ",", 
        "2", ",", "5"}], "}"}], "]"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "5", ",", "6", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "4", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "2", "}"}], ",", 
           RowBox[{"{", "7", "}"}], ",", 
           RowBox[{"{", "8", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "3", "}"}], ",", 
           RowBox[{"{", "9", "}"}]}], "}"}]}], "}"}]}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "redundant", " ", 
     "track", " ", "numbers", " ", "means", " ", "track", " ", "gets", " ", 
     "split", " ", "at", " ", "frame", "#", " ", "N"}], "+", 
    RowBox[{
    "1", "\[IndentingNewLine]", "\t", "in", " ", "order", " ", "to", " ", 
     "avoid", " ", "this"}]}], ",", " ", 
   RowBox[{
   "choosing", " ", "the", " ", "nearest", " ", "point", " ", "and", " ", 
    "assign", " ", "a", " ", "new", " ", "track", " ", "number", " ", "to", 
    " ", "the", " ", "other", " ", "points"}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.678644657461045*^9, 3.6786447316622887`*^9}, {
  3.678644841734585*^9, 3.678644919664042*^9}, {3.678644955945117*^9, 
  3.678645062191194*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"dabfc3dc-56aa-48ec-a19c-2d1bcd33858c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RedundantTrack", "[", 
   RowBox[{"list_", ",", 
    RowBox[{"test_:", " ", "Identity"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Composition", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"list", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
       "}"}], "&"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", "_", "}"}]}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], "&"}],
      ",", 
     RowBox[{
      RowBox[{"GatherBy", "[", 
       RowBox[{"#", ",", "test"}], "]"}], "&"}]}], "]"}], "[", "list", 
   "]"}]}]], "Input",
 CellLabel->"In[24]:=",ExpressionUUID->"4ec01059-f622-4410-a1c3-86d7d04babf0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PairConnect4", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ticker_", ",", "anolist1t_"}], "}"}], ",", "list2t_", ",", 
    "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newticker", ",", "list1", ",", "list2", ",", "out", ",", "mypos", ",", 
      "myRedundant", ",", "null", ",", "tempOriginalPoint", ",", 
      "tempNewPoints", ",", "tempTruePoint", ",", "tempOutlierPointPosi"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newticker", "=", "ticker"}], ";", "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"anolist1t", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
          RowBox[{"#2", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"Sort", "@", "list2t"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mypos", "=", 
          RowBox[{
          "list2", "\[LeftDoubleBracket]", "myi", "\[RightDoubleBracket]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"potentialDots", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"list1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "-", "dist"}], "<", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "+", "dist"}]}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "-", "dist"}], "<", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<", 
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "+", "dist"}]}]}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"potentialDots", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newticker", "+=", "1"}], ";", 
            RowBox[{"out", "=", 
             RowBox[{"{", 
              RowBox[{"newticker", ",", "mypos"}], "}"}]}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"potentialDot", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"potentialDots", ",", 
                 RowBox[{"x_", "/;", 
                  RowBox[{
                   RowBox[{
                   "x", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"potentialDots", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",",
                     "mypos"}], "]"}]}]}]}]}], "]"}], ",", "1"}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"EuclideanDistance", "[", 
                RowBox[{"mypos", ",", 
                 RowBox[{
                 "potentialDot", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ">", "dist"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{"newticker", "+=", "1"}], ";", 
               RowBox[{"out", "=", 
                RowBox[{"{", 
                 RowBox[{"newticker", ",", "mypos"}], "}"}]}], ";"}], ",", 
              RowBox[{
               RowBox[{"out", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "potentialDot", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "mypos"}], "}"}]}], 
               ";"}]}], "]"}]}]}], "]"}], ";", "out"}], ",", 
        RowBox[{"{", 
         RowBox[{"myi", ",", "1", ",", 
          RowBox[{"Length", "@", "list2"}], ",", "1"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"myRedundant", "=", 
      RowBox[{"RedundantTrack", "[", 
       RowBox[{"out", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"null", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempOriginalPoint", "=", 
          RowBox[{"Extract", "[", 
           RowBox[{"list1", ",", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"list1", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"myRedundant", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "myj"}], "\[RightDoubleBracket]"}]}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tempNewPoints", "=", 
          RowBox[{"out", "\[LeftDoubleBracket]", 
           RowBox[{"Flatten", "@", 
            RowBox[{"myRedundant", "\[LeftDoubleBracket]", 
             RowBox[{"3", ",", "myj"}], "\[RightDoubleBracket]"}]}], 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tempTruePoint", "=", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"tempNewPoints", ",", 
             RowBox[{"Flatten", "@", 
              RowBox[{"Nearest", "[", 
               RowBox[{
                RowBox[{"tempNewPoints", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"tempOriginalPoint", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
               "]"}]}]}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempOutlierPointPosi", "=", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"myRedundant", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "myj"}], "\[RightDoubleBracket]"}], ",", 
             "tempTruePoint"}], "]"}], "//", "Flatten"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"newticker", "+", "1"}], ",", 
           RowBox[{"newticker", "+", 
            RowBox[{"Length", "@", "tempOutlierPointPosi"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"out", "\[LeftDoubleBracket]", 
           RowBox[{"tempOutlierPointPosi", ",", "1"}], 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"newticker", "+", "1"}], ",", 
            RowBox[{"newticker", "+", 
             RowBox[{"Length", "@", "tempOutlierPointPosi"}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"newticker", "=", 
          RowBox[{"newticker", "+", 
           RowBox[{"Length", "@", "tempOutlierPointPosi"}]}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"myj", ",", "1", ",", 
          RowBox[{"Length", "@", 
           RowBox[{
           "myRedundant", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newticker", ",", "out"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.678559612091728*^9, 3.678559616794997*^9}, {
   3.6785597764591293`*^9, 3.678559889284582*^9}, {3.6785600026430664`*^9, 
   3.6785600028040757`*^9}, {3.6785645606417685`*^9, 3.6785646495908566`*^9}, 
   3.6785661846406565`*^9, 3.6785662164474754`*^9, {3.6785691452029905`*^9, 
   3.6785691752347083`*^9}, {3.6786294864193106`*^9, 
   3.6786294970029163`*^9}, {3.6786295295627785`*^9, 
   3.6786295693700557`*^9}, {3.6786296000998135`*^9, 3.678629674828087*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"83ff820d-da7a-4ede-b383-ae81e8360b6b"]
}, Closed]],

Cell[CellGroupData[{

Cell["LinkTracks", "Subsection",
 CellChangeTimes->{{3.6425406972561293`*^9, 3.642540699196132*^9}, {
  3.6425407307771764`*^9, 3.642540734629182*^9}, {3.6483824467792892`*^9, 
  3.648382447886891*^9}},ExpressionUUID->"52775ca3-8f49-442c-9ef4-\
d048aed8b88f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkTracks", "[", 
   RowBox[{"testgreenP_", ",", "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list1", ",", "list2", ",", "listResult", ",", "listResultFrame", ",", 
      "listResultTrack"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list1", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", 
           RowBox[{
           "testgreenP", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{"Sort", "@", 
          RowBox[{
          "testgreenP", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Length", "@", "list1"}], ",", "list1"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"testgreenP", "\[LeftDoubleBracket]", 
       RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"listResult", "=", 
      RowBox[{"FoldList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PairConnect4", "[", 
          RowBox[{"#1", ",", "#2", ",", "dist"}], "]"}], "&"}], ",", "list1", 
        ",", "list2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listResultFrame", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{
          "listResult", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "i", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "j", ",", "2", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"listResult", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
              "1"}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "listResult"}], ",", "1"}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"listResultTrack", "=", 
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"listResultFrame", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "Sort"}], ",", 
        "First"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"listResultFrame", ",", "listResultTrack"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.642537218408235*^9, 3.642537264040299*^9}, {
   3.642537296025344*^9, 3.6425373967124853`*^9}, {3.6425375490676994`*^9, 
   3.6425375491776996`*^9}, {3.6428863768161287`*^9, 
   3.6428863815353985`*^9}, {3.642886462952055*^9, 3.642886463968113*^9}, {
   3.642939120294883*^9, 3.642939135121731*^9}, {3.64293926676126*^9, 
   3.6429392677223153`*^9}, {3.6429393414655333`*^9, 
   3.6429393421455717`*^9}, {3.6430564615444183`*^9, 
   3.6430564648156056`*^9}, {3.678556682570169*^9, 3.678556741576544*^9}, {
   3.6785567816588364`*^9, 3.6785567968567057`*^9}, {3.6785568671847286`*^9, 
   3.6785568723050213`*^9}, 3.678556966680419*^9, {3.6785646596314306`*^9, 
   3.6785646597424374`*^9}, {3.678564878566953*^9, 3.6785648786709595`*^9}, {
   3.6785659857122784`*^9, 3.678565985832285*^9}, {3.6785672838895297`*^9, 
   3.678567283976535*^9}, {3.678567339273698*^9, 3.678567339384704*^9}, {
   3.6786298277868357`*^9, 3.6786298278828416`*^9}, {3.6786455094707775`*^9, 
   3.6786455421916485`*^9}, {3.6786456047912292`*^9, 3.678645677591393*^9}, {
   3.6786458595918026`*^9, 3.6786458778638477`*^9}, {3.6786459520160894`*^9, 
   3.67864598315987*^9}, {3.6786460706318736`*^9, 3.6786460973284006`*^9}, {
   3.67864615028743*^9, 3.6786461816002207`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"f1fe01d3-64e6-40c9-a66c-9c09a63c1755"]
}, Closed]],

Cell[CellGroupData[{

Cell["LinkTracks2", "Subsection",
 CellChangeTimes->{{3.6786311154964886`*^9, 
  3.678631122754904*^9}},ExpressionUUID->"77eaa6d1-8676-4e6c-8f16-\
b6130e6b6c2a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "get", " ", "rid", " ", "of", " ", "tracks", " ", "which", " ", "last", 
    " ", "only", " ", "1", " ", "or", " ", "2", " ", "frame", 
    RowBox[{"(", "s", ")"}], " ", "and", " ", "re"}], "-", 
   RowBox[{"assign", " ", "consecutive", " ", "track", " ", "numbers"}]}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6786451804919605`*^9, 3.6786452852309513`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"87ccae87-4b32-41d5-9d61-1b1a96ff9fff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkTracks2", "[", 
   RowBox[{"testgreenP_", ",", "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list1", ",", "list2", ",", "listResult", ",", "listResultFrame", ",", 
      "listResultTrack", ",", "listResultTrackL"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list1", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", 
           RowBox[{
           "testgreenP", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{"Sort", "@", 
          RowBox[{
          "testgreenP", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Length", "@", "list1"}], ",", "list1"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"testgreenP", "\[LeftDoubleBracket]", 
       RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"listResult", "=", 
      RowBox[{"FoldList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PairConnect4", "[", 
          RowBox[{"#1", ",", "#2", ",", "dist"}], "]"}], "&"}], ",", "list1", 
        ",", "list2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listResultFrame", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{
          "listResult", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "i", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "j", ",", "2", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"listResult", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
              "1"}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "listResult"}], ",", "1"}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"listResultTrack", "=", 
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"listResultFrame", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "Sort"}], ",", 
        "First"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listResultTrackL", "=", 
      RowBox[{"Extract", "[", 
       RowBox[{"listResultTrack", ",", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Length", "/@", "listResultTrack"}], ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", ">", "2"}]}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listResultTrackL", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "listResultTrackL"}]}]}], ";", 
     "\[IndentingNewLine]", "listResultTrackL"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.678645143510845*^9, {3.6786462319861026`*^9, 3.6786462430877376`*^9}, {
   3.678646706939268*^9, 3.678646782449587*^9}, {3.67864688984873*^9, 
   3.678646931857133*^9}, 3.6786469851691823`*^9, {3.6786471294484344`*^9, 
   3.6786471353687735`*^9}, {3.678648850050847*^9, 3.6786488527139997`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"d74b26eb-9735-4f3a-844e-3329afb47bde"]
}, Closed]],

Cell[CellGroupData[{

Cell["Relinking", "Subsection",
 CellChangeTimes->{{3.6429485555685496`*^9, 
  3.642948561607895*^9}},ExpressionUUID->"acfc757a-3196-4781-a4f5-\
8a05ee2de22b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Only", " ", "the", " ", "longest", " ", "path", " ", "will", " ", "be", 
   " ", "taken", " ", "for", " ", "the", " ", "last", " ", "frame", " ", "if",
    " ", "the", " ", "track", " ", "split", " ", "in", " ", "the", " ", 
   "middle"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6430559206934834`*^9, 3.6430559317251143`*^9}, {
  3.6431167430053205`*^9, 3.6431168098051414`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"ef65d7c3-baaa-457e-acd8-7577e28da918"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Relinking", "[", 
   RowBox[{
   "sortedbyframe_", ",", "sortedbytrack_", ",", "gap_", ",", "distance_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ftrackList", ",", "ltrackList", ",", "linkinglist", ",", "mytrack", ",",
       "mytrackN", ",", "myt", ",", "mypos", ",", "newrange", ",", "flag", 
      ",", "targetFrame", ",", "targetTracks", ",", "candidateTracks", ",", 
      "closestTrack", ",", "out", ",", "newlinkinglist", ",", 
      "newsortedbytrack", ",", "oldtrackN", ",", "newtrackN", ",", 
      "newsortedbyframe", ",", "oldtrackPos"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "extracting", " ", "the", " ", "begining", " ", "and", " ", "the", " ", 
      "ending", " ", "of", " ", "all", " ", "tracks"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ftrackList", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"First", "/@", 
          RowBox[{
          "sortedbytrack", "\[LeftDoubleBracket]", "All", 
           "\[RightDoubleBracket]"}]}], ")"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "}"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ftrackList", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"ftrackList", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "\[LessEqual]",
           "2"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ltrackList", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"Last", "/@", 
         RowBox[{
         "sortedbytrack", "\[LeftDoubleBracket]", "All", 
          "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "}"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "relinking", " ", "tracks", " ", "and", " ", "making", " ", "a", " ", 
       "list"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"linkinglist", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mytrack", "=", 
         RowBox[{
         "ftrackList", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mytrackN", "=", 
         RowBox[{
         "mytrack", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"myt", "=", 
         RowBox[{"mytrack", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypos", "=", 
         RowBox[{"mytrack", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", 
           RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newrange", "=", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"myt", "-", "gap", "-", "1"}], ",", 
            RowBox[{"myt", "-", "2"}], ",", "1"}], "]"}], "//", "Reverse"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"flag", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"targetFrame", "=", 
            RowBox[{
            "newrange", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"flag", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"targetTracks", "=", 
               RowBox[{"Extract", "[", 
                RowBox[{"ltrackList", ",", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"ltrackList", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "targetFrame"}], "]"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"candidateTracks", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"targetTracks", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"EuclideanDistance", "[", 
                    RowBox[{
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], 
                    ",", "mypos"}], "]"}], "<", "distance"}], "&"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "candidateTracks", "]"}], ">", "0"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "candidateTracks", "]"}], 
                   "\[Equal]", "1"}], ",", 
                  RowBox[{
                   RowBox[{"out", "=", 
                    RowBox[{"{", 
                    RowBox[{"mytrackN", ",", 
                    RowBox[{"candidateTracks", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], ";", 
                   RowBox[{
                    RowBox[{"ltrackList", "\[LeftDoubleBracket]", 
                    RowBox[{"mytrackN", ",", "1"}], "\[RightDoubleBracket]"}],
                     "=", 
                    RowBox[{"candidateTracks", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                   RowBox[{"flag", "=", "1"}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"closestTrack", "=", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"candidateTracks", ",", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"x", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"#", ",", "mypos"}], "]"}], "&"}], "/@", 
                    RowBox[{"candidateTracks", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", 
                    RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}]}],
                     ",", 
                    RowBox[{"Min", "[", "x", "]"}]}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"out", "=", 
                    RowBox[{"{", 
                    RowBox[{"mytrackN", ",", 
                    RowBox[{"closestTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], ";", 
                   RowBox[{
                    RowBox[{"ltrackList", "\[LeftDoubleBracket]", 
                    RowBox[{"mytrackN", ",", "1"}], "\[RightDoubleBracket]"}],
                     "=", 
                    RowBox[{"closestTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                   RowBox[{"flag", "=", "1"}], ";"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"out", "=", 
                  RowBox[{"{", "}"}]}], ";", 
                 RowBox[{"flag", "=", "0"}]}]}], "]"}]}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "newrange", "]"}], ",", "1"}], "}"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"linkinglist", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"linkinglist", ",", "out"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ftrackList", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "convert", " ", "old", " ", "track", " ", "numbers", " ", "to", " ", 
       "new", " ", "track", " ", "numbers", " ", "in", " ", 
       "\"\<sortedbytrack\>\"", " ", "and", " ", "\"\<sortedbyframe\>\""}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"newlinkinglist", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"linkinglist", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newsortedbytrack", "=", "sortedbytrack"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newsortedbyframe", "=", "sortedbyframe"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"oldtrackN", "=", 
         RowBox[{"newlinkinglist", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newtrackN", "=", 
         RowBox[{"newlinkinglist", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newsortedbytrack", "\[LeftDoubleBracket]", 
          RowBox[{"oldtrackN", ",", "All", ",", "1"}], 
          "\[RightDoubleBracket]"}], "=", "newtrackN"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"oldtrackPos", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"newsortedbyframe", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2", ",", "All", ",", "1"}], 
                "\[RightDoubleBracket]"}], ",", "oldtrackN"}], "]"}], "//", 
             "Flatten"}], "//", 
            RowBox[{
             RowBox[{"Riffle", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{"#", ",", "4"}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newsortedbyframe", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"newsortedbyframe", ",", 
           RowBox[{"oldtrackPos", " ", "\[Rule]", " ", "newtrackN"}]}], 
          "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "newlinkinglist", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newsortedbytrack", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"newsortedbytrack", "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "Sort"}], "//", 
       RowBox[{
        RowBox[{"SplitBy", "[", 
         RowBox[{"#", ",", "First"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "newsortedbyframe", ",", "newsortedbytrack", ",", "newlinkinglist"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.643045022540145*^9, 3.643045216993267*^9}, {
   3.6430452488580894`*^9, 3.643045276385664*^9}, {3.6430453376271667`*^9, 
   3.6430453986246557`*^9}, {3.6430569720696187`*^9, 
   3.6430570220844793`*^9}, {3.64305706195576*^9, 3.6430571061472874`*^9}, {
   3.6430573628279686`*^9, 3.6430573771327868`*^9}, {3.643057427907691*^9, 
   3.6430574393803473`*^9}, {3.6431331820155783`*^9, 
   3.6431332581189313`*^9}, {3.643136544192884*^9, 3.643136634932074*^9}, 
   3.6431370498418055`*^9, {3.643137451493778*^9, 3.6431374541959333`*^9}, {
   3.643137698250892*^9, 3.6431377016580873`*^9}, {3.643138000046154*^9, 
   3.6431380084446344`*^9}, {3.643138079340689*^9, 3.6431380961476507`*^9}, {
   3.6431381850367346`*^9, 3.643138198147485*^9}, {3.643139144227597*^9, 
   3.6431393006865463`*^9}, {3.6431398221283712`*^9, 
   3.6431398241664877`*^9}, {3.6431407049758673`*^9, 
   3.6431407055348988`*^9}, {3.643471534892849*^9, 3.643471536684952*^9}, {
   3.643471617238559*^9, 3.6434716488853693`*^9}, {3.6434717183183403`*^9, 
   3.6434717592526817`*^9}, 3.649472570771883*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"3d1603e5-b5ac-4c2b-b516-b83738bc58de"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sortedbyframe", ",", "sortedbytrack"}], "}"}], "=", 
    RowBox[{"LinkTracks", "[", 
     RowBox[{"testgreenP", ",", "1"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.643140617018836*^9, 3.6431406198890004`*^9}, {
  3.648304096465707*^9, 3.6483040988408427`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"a62c2d03-cd86-42f2-b31f-9fd5cbbfddb7"]
}, Closed]],

Cell[CellGroupData[{

Cell["ParticleFitting", "Subsection",
 CellChangeTimes->{{3.6515211610224323`*^9, 
  3.651521163990602*^9}},ExpressionUUID->"9288ed2f-2279-4df1-a7c2-\
f62bc1de11d1"],

Cell["\<\
When raw images are used for fitting, avgFrameN_ is used to shift frames such \
that the middle frame of running average is used for fitting.
For example when avgFrameN is 3, the centroid at the first time point in \
mylongtrack is determined from the average image of frame 1, 2 and 3. So \
frame 2 should be fitted with this initial guess.
When running averaged images are used for fitting, enter \
\[OpenCurlyDoubleQuote]1\[CloseCurlyDoubleQuote] at the last input instead of \
avgFrameN.\
\>", "Text",
 CellChangeTimes->{{3.6557286003930864`*^9, 
  3.655728889600628*^9}},ExpressionUUID->"d60ef27e-50f7-41bf-a056-\
538381aadeac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParticleFittingSee", "[", 
   RowBox[{
   "myColMovie_", ",", "channel_", ",", "mylongtrack_", ",", "pad_", ",", 
    "myTrimSize_", ",", "avgFrameN_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tempTime", ",", "tempCenter", ",", "frameShift"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tempTime", "=", 
        RowBox[{"mylongtrack", "\[LeftDoubleBracket]", 
         RowBox[{"t", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tempCenter", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"mylongtrack", "\[LeftDoubleBracket]", 
          RowBox[{"t", ",", "2", ",", 
           RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"frameShift", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ImageTrim", "[", 
        RowBox[{
         RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
          RowBox[{"channel", ",", 
           RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"tempCenter", "-", "pad"}], ",", 
           RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}], "]"}]}],
       "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1", ",", 
        RowBox[{"Length", "[", "mylongtrack", "]"}], ",", "1"}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
  3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
  3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
  3.655581282500985*^9, 3.6555813891080823`*^9}, {3.6555814330835977`*^9, 
  3.65558148994785*^9}, {3.655581570579462*^9, 3.655581605779475*^9}, {
  3.655581714731707*^9, 3.6555817416352463`*^9}, {3.6556456138785295`*^9, 
  3.6556456600301685`*^9}, {3.655645691237954*^9, 3.6556457099260225`*^9}, {
  3.655646442718936*^9, 3.6556464690944448`*^9}, {3.6556603618410645`*^9, 
  3.655660361961071*^9}, {3.6557217222026763`*^9, 3.6557218284757547`*^9}, {
  3.6557218930834503`*^9, 3.6557219581311707`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"4a467329-bd15-47e8-b342-634ca3848213"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParticleFitting", "[", 
   RowBox[{
   "myColMovie_", ",", "channel_", ",", "mylongtracks_", ",", "pad_", ",", 
    "myTrimSize_", ",", "avgFrameN_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myAllParametersEach", ",", "myTrimImgs", ",", "myOrigins", ",", 
      "tempTime", ",", "tempCenter", ",", "frameShift", ",", "myImgs", ",", 
      "myData", ",", "myFits", ",", "tempData3D", ",", "myFit", ",", "myPos", 
      ",", "myPosImgCoordn", ",", "myAbsPos", ",", "myIntBGSigma", ",", 
      "myPos90Conf", ",", "myPos90ConfImgCoordn", ",", "myAbsPos90Conf", ",", 
      "myIntBGSigma90Conf", ",", "myFitData", ",", "CC", ",", "A", ",", "x0", 
      ",", "a", ",", "y0", ",", "b", ",", "x", ",", "y"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myAllParametersEach", ",", "myPos", ",", "myFitData"}], "}"}],
       "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "t", ",", "2", ",", "1"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "t", ",", "2", ",", 
                   RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"frameShift", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mylongtracks", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", 
                "x", ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"b", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"b", ",", "1"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "6"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBGSigma", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2", ",", "5", ",", "7"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "5"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBGSigma90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1", ",", "4", ",", "6"}], "}"}]}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myAllParametersEach", "=", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "2", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "myAbsPos", ",", 
                 "myIntBGSigma", ",", "myAbsPos90Conf", ",", 
                 "myIntBGSigma90Conf", ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "3"}], 
                  "\[RightDoubleBracket]"}]}], "}"}]}]}]}], ",", "myPos", ",",
             "myData"}], "}"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "mylongtracks", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myAllParametersEach", "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "myPos", ",", 
       "myFitData"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.655834242142449*^9, 
   3.655834341613138*^9}, {3.6561793737004633`*^9, 3.656179378164719*^9}, 
   3.6838989198137875`*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"89bd7b7d-9cb3-449c-b8c7-79667447072e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParticleFittingFixedSigma", "[", 
   RowBox[{
   "myColMovie_", ",", "channel_", ",", "mylongtracks_", ",", "pad_", ",", 
    "myTrimSize_", ",", "sigma_", ",", "avgFrameN_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myAllParametersEach", ",", "myTrimImgs", ",", "myOrigins", ",", 
      "tempTime", ",", "tempCenter", ",", "frameShift", ",", "myImgs", ",", 
      "myData", ",", "myFits", ",", "tempData3D", ",", "myFit", ",", "myPos", 
      ",", "myPosImgCoordn", ",", "myAbsPos", ",", "myIntBG", ",", 
      "myPos90Conf", ",", "myPos90ConfImgCoordn", ",", "myAbsPos90Conf", ",", 
      "myIntBG90Conf", ",", "myFitData", ",", "CC", ",", "A", ",", "x0", ",", 
      "y0", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myAllParametersEach", ",", "myPos", ",", "myFitData"}], "}"}],
       "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "t", ",", "2", ",", "1"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "t", ",", "2", ",", 
                   RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"frameShift", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mylongtracks", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "A", ",", "x0", ",", "y0", ",", "x", ",", "y"}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "5"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myAllParametersEach", "=", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "2", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "myAbsPos", ",", "myIntBG", 
                 ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"sigma", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "myFits", "]"}], ",", "2"}], 
                    "}"}]}], "]"}], ",", "myAbsPos90Conf", ",", 
                 "myIntBG90Conf", ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "myFits", "]"}], ",", "4"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "3"}], 
                  "\[RightDoubleBracket]"}]}], "}"}]}]}]}], ",", "myPos", ",",
             "myData"}], "}"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "mylongtracks", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myAllParametersEach", "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "myPos", ",", 
       "myFitData"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.6558217347800684`*^9, 
   3.655821738523283*^9}, {3.655821772268213*^9, 3.6558218199079375`*^9}, {
   3.6558220477879715`*^9, 3.655822098179854*^9}, {3.655822176491333*^9, 
   3.6558222037238903`*^9}, {3.6558251922148223`*^9, 
   3.6558251961030445`*^9}, {3.6558252647589717`*^9, 
   3.6558252785097585`*^9}, {3.655825327463558*^9, 3.65582555844777*^9}, {
   3.6558273393006287`*^9, 3.6558273978079753`*^9}, {3.655834316381695*^9, 
   3.655834318069792*^9}, {3.6558443721728535`*^9, 3.6558444445739946`*^9}, {
   3.655844977494476*^9, 3.6558449788855553`*^9}, {3.6558453738731475`*^9, 
   3.655845391423151*^9}, {3.663965324194535*^9, 3.663965335002153*^9}, 
   3.663965615067172*^9, {3.6838988788284435`*^9, 3.68389888575784*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"54be78c8-fcb0-4e1e-808b-677b03ec837f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParticleFittingFixedSigmaInclinedBG", "[", 
   RowBox[{
   "myColMovie_", ",", "channel_", ",", "mylongtracks_", ",", "pad_", ",", 
    "myTrimSize_", ",", "sigma_", ",", "avgFrameN_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myAllParametersEach", ",", "myTrimImgs", ",", "myOrigins", ",", 
      "tempTime", ",", "tempCenter", ",", "frameShift", ",", "myImgs", ",", 
      "myData", ",", "myFits", ",", "tempData3D", ",", "myFit", ",", "myPos", 
      ",", "myPosImgCoordn", ",", "myAbsPos", ",", "myIntBG", ",", 
      "myInclinedBG", ",", "myPos90Conf", ",", "myPos90ConfImgCoordn", ",", 
      "myAbsPos90Conf", ",", "myIntBG90Conf", ",", "myInclinedBG90conf", ",", 
      "myFitData", ",", "CC", ",", "BGa", ",", "BGb", ",", "A", ",", "x0", 
      ",", "y0", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myAllParametersEach", ",", "myPos", ",", "myFitData"}], "}"}],
       "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "t", ",", "2", ",", "1"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "t", ",", "2", ",", 
                   RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"frameShift", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mylongtracks", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "BGa", ",", "BGb", ",", "A", ",", "x0", ",", "y0", 
                ",", "x", ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", " ", "+", " ", 
                  RowBox[{"BGa", " ", "x"}], " ", "+", " ", 
                  RowBox[{"BGb", " ", "y"}], "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"BGa", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"BGb", ",", "0.01"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "5"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myInclinedBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "7"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myInclinedBG90conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "6"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myAllParametersEach", "=", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "2", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "myAbsPos", ",", "myIntBG", 
                 ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"sigma", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "myFits", "]"}], ",", "2"}], 
                    "}"}]}], "]"}], ",", "myAbsPos90Conf", ",", 
                 "myIntBG90Conf", ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "myFits", "]"}], ",", "4"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "3"}], 
                  "\[RightDoubleBracket]"}], ",", "myInclinedBG", ",", 
                 "myInclinedBG90conf"}], "}"}]}]}]}], ",", "myPos", ",", 
            "myData"}], "}"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "mylongtracks", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myAllParametersEach", "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "myPos", ",", 
       "myFitData"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.6558217347800684`*^9, 
   3.655821738523283*^9}, {3.655821772268213*^9, 3.6558218199079375`*^9}, {
   3.6558220477879715`*^9, 3.655822098179854*^9}, {3.655822176491333*^9, 
   3.6558222037238903`*^9}, {3.6558251922148223`*^9, 
   3.6558251961030445`*^9}, {3.6558252647589717`*^9, 
   3.6558252785097585`*^9}, {3.655825327463558*^9, 3.65582555844777*^9}, {
   3.6558273393006287`*^9, 3.6558273978079753`*^9}, {3.655834316381695*^9, 
   3.655834318069792*^9}, {3.6558443721728535`*^9, 3.6558444445739946`*^9}, {
   3.655844977494476*^9, 3.6558449788855553`*^9}, {3.6558453738731475`*^9, 
   3.655845391423151*^9}, {3.663965485538763*^9, 3.6639655359626474`*^9}, 
   3.6639656173703036`*^9, {3.6639657258505087`*^9, 3.663965767234875*^9}, {
   3.6639658125564675`*^9, 3.6639658154426327`*^9}, {3.6639660619637327`*^9, 
   3.6639661631625214`*^9}, {3.663966219218727*^9, 3.6639662361706967`*^9}, {
   3.6639663351493583`*^9, 3.663966338347541*^9}, 3.68389895482279*^9},
 CellLabel->"In[35]:=",ExpressionUUID->"82a4c8d7-5087-45ae-a49f-cf93b702ac9f"]
}, Closed]],

Cell[CellGroupData[{

Cell["BeadsFitting", "Subsection",
 CellChangeTimes->{{3.651523106216691*^9, 
  3.6515231119520187`*^9}},ExpressionUUID->"83372367-5348-4386-be4e-\
e7ce8056936c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeadsFitting", "[", 
   RowBox[{"myRefBeadsImg_", ",", "myPosGuess_", ",", "pad_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myTrimSize", ",", "myTrimImgs", ",", "myOrigins", ",", "tempCenter", 
      ",", "myImgs", ",", "myData", ",", "myFits", ",", "tempData3D", ",", 
      "myFit", ",", "CC", ",", "A", ",", "x", ",", "x0", ",", "a", ",", "y", 
      ",", "y0", ",", "b", ",", "myPos", ",", "myPosImgCoordn", ",", 
      "myAbsPos"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myTrimSize", "=", 
      RowBox[{
       RowBox[{"2", "*", "pad"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tempCenter", "=", 
           RowBox[{"Ceiling", "[", 
            RowBox[{
            "myPosGuess", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myImgs", "=", 
             RowBox[{"ImageTrim", "[", 
              RowBox[{"myRefBeadsImg", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"tempCenter", "-", "pad"}], ",", 
                 RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"myOrigins", "=", 
             RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "myPosGuess", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myData", "=", 
      RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myFits", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempData3D", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"MapIndexed", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  ",", 
                 RowBox[{
                 "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                  ",", "#1"}], "}"}], "&"}], ",", 
              RowBox[{
              "myData", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Clear", "[", 
          RowBox[{
          "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", "x", 
           ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"myFit", "=", 
          RowBox[{"NonlinearModelFit", "[", 
           RowBox[{"tempData3D", ",", 
            RowBox[{"CC", "+", 
             RowBox[{"A", " ", 
              RowBox[{"E", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", 
                    RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", 
                    RowBox[{"b", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"CC", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"A", ",", 
                RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                  ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x0", ",", 
                RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y0", ",", 
                RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "1"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"myFit", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
            "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myPos", "=", 
      RowBox[{"myFits", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}], ",", "2"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myPosImgCoordn", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"myPos", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", "0.5"}],
          ",", 
         RowBox[{"myTrimSize", "-", 
          RowBox[{"myPos", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
          "0.5"}]}], "}"}], "//", "Thread"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myAbsPos", "=", 
      RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6483906843449163`*^9, 3.6483906948281345`*^9}, {
  3.6483907313009987`*^9, 3.64839074897783*^9}, {3.648390922446535*^9, 
  3.648391064072584*^9}, {3.6483911220930867`*^9, 3.648391274564155*^9}, {
  3.6483913389338684`*^9, 3.648391349604287*^9}, {3.648391401635379*^9, 
  3.6483914032577815`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"d6b2ca9a-fb9d-4d23-b267-0dd2f36fcbc1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeadsSorting", "[", 
   RowBox[{"myRedAbsPos_", ",", "myGreenAbsPos_", ",", "dist_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myRedAbsPosSort", ",", "distanceOriginal", ",", "idx", ",", 
      "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myRedAbsPosSort", "=", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{"myRedAbsPos", ",", "myGreenAbsPos"}], "]"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"distanceOriginal", "=", 
      RowBox[{"EuclideanDistance", "@@@", 
       RowBox[{"Thread", "@", 
        RowBox[{"{", 
         RowBox[{"myGreenAbsPos", ",", "myRedAbsPosSort"}], "}"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"distanceOriginal", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"x", ">", "dist"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Delete", "[", 
         RowBox[{"#", ",", "idx"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "myRedAbsPosSort", ",", "myGreenAbsPos", ",", "distanceOriginal"}], 
        "}"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6483909446005745`*^9, 3.648390951901387*^9}, {
  3.6483915027763567`*^9, 3.648391714274162*^9}, {3.6515238560495787`*^9, 
  3.6515239184811497`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"bf272181-6928-4628-86b6-599f9e1bbf21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeadsTransform", "[", 
   RowBox[{"myRedAbsPos_", ",", "myGreenAbsPos_", ",", "dist_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw", ",", 
      "myTfFuncError", ",", "myTfFunc", ",", "myRedCorrPos", ",", 
      "distanceCorrected"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw"}], 
       "}"}], "=", 
      RowBox[{"BeadsSorting", "[", 
       RowBox[{"myRedAbsPos", ",", "myGreenAbsPos", ",", "dist"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myTfFuncError", ",", "myTfFunc"}], "}"}], "=", 
      RowBox[{"FindGeometricTransform", "[", 
       RowBox[{"myGreenAbsPos4Calc", ",", "myRedAbsPos4Calc"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myRedCorrPos", "=", 
      RowBox[{"myTfFunc", "[", "myRedAbsPos4Calc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"distanceCorrected", "=", 
      RowBox[{"EuclideanDistance", "@@@", 
       RowBox[{"Thread", "@", 
        RowBox[{"{", 
         RowBox[{"myGreenAbsPos4Calc", ",", "myRedCorrPos"}], "}"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "myTfFuncError", ",", "myTfFunc", ",", "distanceRaw", ",", 
       "distanceCorrected"}], "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.648392120969268*^9, 3.648392151951922*^9}, {
  3.6483921960239997`*^9, 3.6483921962424*^9}, {3.6484004568741035`*^9, 
  3.648400590161727*^9}, {3.648400991802699*^9, 3.6484010666779823`*^9}, {
  3.651523934337057*^9, 3.6515240057701426`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"3acb93d4-d3a1-412e-bae1-601b700b40e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeadsCheck", "[", 
   RowBox[{"myRedAbsPos_", ",", "myGreenAbsPos_", ",", "dist_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw", ",", 
      "myRedCorrPos", ",", "distanceCorrected"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw"}], 
       "}"}], "=", 
      RowBox[{"BeadsSorting", "[", 
       RowBox[{"myRedAbsPos", ",", "myGreenAbsPos", ",", "dist"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myRedCorrPos", "=", 
      RowBox[{"myTfFunc", "[", "myRedAbsPos4Calc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"distanceCorrected", "=", 
      RowBox[{"EuclideanDistance", "@@@", 
       RowBox[{"Thread", "@", 
        RowBox[{"{", 
         RowBox[{"myGreenAbsPos4Calc", ",", "myRedCorrPos"}], "}"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Insert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"distanceRaw", ",", "distanceCorrected"}], "}"}], "//", 
         "Transpose"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Distance Before Correction\>\"", ",", 
          "\"\<Distance After Correction\>\""}], "}"}], ",", "1"}], "]"}], "//",
       "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6484012753809195`*^9, 3.648401405682372*^9}, 
   3.6515236689298763`*^9, 3.6515237173296447`*^9, {3.651524011241455*^9, 
   3.6515240637694597`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"685ff480-475d-47f7-aa93-f6f18e4903ed"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
FindOverlapDistance[track1,track2,\[Tau]] (measures average distance between \
two tracks when they overlap in time for at least time \[Tau], otherwise \
outputs -1)\
\>", "Subsection",
 CellChangeTimes->{{3.6792547892990313`*^9, 3.6792548292263145`*^9}, {
  3.6792560996119766`*^9, 3.6792561534200544`*^9}, {3.679256196156499*^9, 
  3.679256207268134*^9}},ExpressionUUID->"5cfa164d-1ff7-4e72-8c5b-\
bbc8b0796cd3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindOverlapDist", "[", 
   RowBox[{"track1_", ",", "track2_", ",", "\[Tau]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t1", ",", "t2", ",", "ol", ",", "avgpos1", ",", "avgpos2"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"makes", " ", "tracks", " ", "have", " ", 
       RowBox[{"form", ":", " ", "t1"}]}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"track", "#"}], ",", "time1", ",", "x1", ",", "y1"}], "}"}],
         ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"track", "#"}], ",", "time2", ",", "x2", ",", "y2"}], 
          "}"}], " ", "..."}]}], "}"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t1", "=", 
      RowBox[{
       RowBox[{"track1", "//", "Flatten"}], "//", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", "7"}], "]"}], "&"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"t2", "=", 
      RowBox[{
       RowBox[{"track2", "//", "Flatten"}], "//", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", "7"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "The", " ", "following", " ", "just", " ", "sorts", " ", "by", " ", 
        "time", " ", "rather", " ", "than", " ", "track", " ", "#", " ", 
        "and", " ", 
        RowBox[{"splits", ".", " ", "If"}], " ", "the", " ", "two", " ", 
        "tracks", " ", "have", " ", "overlapping", " ", "time"}], ",", " ", 
       RowBox[{
       "then", " ", "the", " ", "split", " ", "will", " ", "contain", " ", 
        "2", " ", 
        RowBox[{"elements", ".", " ", "Thus"}]}], ",", " ", 
       RowBox[{
       "DeleteCases", " ", "eliminates", " ", "all", " ", "parts", " ", "of", 
        " ", "the", " ", "track", " ", "that", " ", "do", " ", "not", " ", 
        RowBox[{"overlap", ".", " ", "Finally"}]}], ",", " ", 
       RowBox[{
       "the", " ", "Transpose", " ", "command", " ", "gives", " ", "back", 
        " ", "a", " ", "list", " ", "of", " ", "overlapping", " ", "segments",
         " ", "of", " ", 
        RowBox[{"tracks", ":", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"segment", " ", "from", " ", "t1"}], ",", " ", 
            RowBox[{"segment", " ", "from", " ", "t2"}]}], "}"}], " ", "so", 
          " ", "the", " ", "mean", " ", "can", " ", "be", " ", "computed", 
          " ", "for", " ", 
          RowBox[{"each", "."}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"ol", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"t1", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{
               "2", ",", "1", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
                "7"}], "}"}]}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"t2", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", 
              RowBox[{"{", 
               RowBox[{
               "2", ",", "1", ",", "3", ",", "4", ",", "5", ",", "6", ",", 
                "7"}], "}"}]}], "\[RightDoubleBracket]"}]}], "}"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "Sort"}], "//", 
        RowBox[{
         RowBox[{"SplitBy", "[", 
          RowBox[{"#", ",", "First"}], "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{"#", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{"Length", "[", "x", "]"}], "<", "2"}]}]}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "ol", "]"}], ">", "\[Tau]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"avgpos1", ",", "avgpos2"}], "}"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Mean", "/@", 
            RowBox[{"(", 
             RowBox[{"Transpose", "[", "ol", "]"}], ")"}]}], ")"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", 
           RowBox[{"3", ";;", "4"}]}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"EuclideanDistance", "[", 
         RowBox[{"avgpos1", ",", "avgpos2"}], "]"}]}], ",", 
       RowBox[{"-", "1"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6786456735071197`*^9, 3.67864569624042*^9}, {
   3.678649737790583*^9, 3.678649747421134*^9}, {3.678649849596978*^9, 
   3.6786498560923495`*^9}, 3.678649893780505*^9, {3.678651646039729*^9, 
   3.678651754831951*^9}, {3.6786518947939568`*^9, 3.678651906719639*^9}, {
   3.678654891133279*^9, 3.678655133120904*^9}, {3.678655265255536*^9, 
   3.678655271542347*^9}, {3.678655312398819*^9, 3.678655481487516*^9}, {
   3.6786590429146595`*^9, 3.678659058140286*^9}, 3.678659148324044*^9, {
   3.678659360531217*^9, 3.678659413025309*^9}, {3.6786594573761873`*^9, 
   3.6786595006038632`*^9}, {3.678661648900236*^9, 3.6786616602726564`*^9}, {
   3.6786617455580063`*^9, 3.678661846568184*^9}, {3.678908725814332*^9, 
   3.678908744530402*^9}, {3.6792561705500345`*^9, 3.679256182637726*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"2c98d8ee-0599-45cb-b95e-f13e754763e8"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
ColorLinker[gbtrackpairs, greentracklist, blueflag] \[Rule] bluetracklist \
connected to greentracklist\
\>", "Subsection",
 CellChangeTimes->{{3.6806246269012165`*^9, 3.680624764997115*^9}, {
  3.6806247965259185`*^9, 
  3.680624857013378*^9}},ExpressionUUID->"09581180-0d2c-42fa-aedc-\
7d1b8f7a0787"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"This", " ", "returns", " ", "all", " ", "green", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"or", " ", "blue"}], ",", " ", 
      RowBox[{
       RowBox[{"specified", " ", "by", " ", "colorN"}], " ", "=", " ", 
       RowBox[{
       "1", " ", "for", " ", "green", " ", "and", " ", "2", " ", "for", " ", 
        "blue"}]}]}], ")"}], " ", "elements", " ", "of", " ", "gbpairs", " ", 
    "whose", " ", "blue", " ", 
    RowBox[{"(", 
     RowBox[{"or", " ", "green"}], ")"}], " ", "element", " ", "is", " ", "a",
     " ", "member", " ", "of", " ", "colorList"}], "  ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ColorLinker", "[", 
    RowBox[{"pairs_", ",", "colorList_", ",", "colorN_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"pairs", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"colorList", ",", 
            RowBox[{"x", "\[LeftDoubleBracket]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"colorN", "\[Equal]", "1"}], ",", "2", ",", "1"}], 
              "]"}], "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "colorN"}], "\[RightDoubleBracket]"}], "//", 
      "Union"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6805740062990694`*^9, 3.6805740406204433`*^9}, {
   3.6805741188562174`*^9, 3.6805741787253094`*^9}, {3.6805742783761835`*^9, 
   3.6805744551618032`*^9}, {3.680574568875996*^9, 3.6805745770167227`*^9}, {
   3.6805746087046037`*^9, 3.680574638548729*^9}, {3.6805746814887447`*^9, 
   3.680574736205081*^9}, {3.6805747827626133`*^9, 3.6805747852001743`*^9}, {
   3.6805752554891725`*^9, 3.6805752772550993`*^9}, {3.680575586323535*^9, 
   3.680575588370466*^9}, {3.6805756485840797`*^9, 3.6805756489434566`*^9}, {
   3.6805757700250216`*^9, 3.6805757790564346`*^9}, {3.680577674705389*^9, 
   3.6805778461890535`*^9}, {3.6805780041356936`*^9, 3.680578086949133*^9}, 
   3.680580011546554*^9, {3.680582146697378*^9, 3.680582190295504*^9}, {
   3.680582634441224*^9, 3.680582676237847*^9}, {3.680611589887657*^9, 
   3.680611591153296*^9}, {3.6806117919141035`*^9, 3.680611804492385*^9}, {
   3.6806144134000797`*^9, 3.6806144195720625`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"92567c1a-feb8-43d5-b290-81249e4d2e96"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
CrossPairFinder[gbtrackpairs] \[Rule] list of green tracks gi connected to \
list of blue tracks bi : {{g1,b1}, {g2, b2}, ...}\
\>", "Subsection",
 CellChangeTimes->{{3.6805823863330293`*^9, 3.6805823912862163`*^9}, 
   3.680624601365756*^9, {3.68062478274113*^9, 3.6806247899335413`*^9}, {
   3.6806248648218246`*^9, 3.6806249434613223`*^9}, 
   3.6806252236703496`*^9},ExpressionUUID->"6e43622c-7b66-4ba4-98c8-\
2b4d629d1c03"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CrossPairFinder", "[", "myGBpairs_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"b1", ",", "g1", ",", "seed", ",", 
      RowBox[{"myFlag", "=", "0"}], ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"seed", "=", 
         RowBox[{"{", 
          RowBox[{"myGBpairs", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "}"}]}], ";", 
        " ", 
        RowBox[{"(*", 
         RowBox[{
         "seed", " ", "with", " ", "ith", " ", "green", " ", "element", " ", 
          "from", " ", "pair", " ", "list"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"myFlag", "\[Equal]", "0"}], " ", ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"b1", "=", 
            RowBox[{
             RowBox[{"ColorLinker", "[", 
              RowBox[{"myGBpairs", ",", "seed", ",", "2"}], "]"}], "//", 
             "Union"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{
            "bluelist", " ", "b1", " ", "connected", " ", "to", " ", 
             "greenlist", " ", "seed"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"g1", "=", 
            RowBox[{
             RowBox[{"ColorLinker", "[", 
              RowBox[{"myGBpairs", ",", "b1", ",", "1"}], "]"}], "//", 
             "Union"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{
            "greenlist", " ", "g1", " ", "connected", " ", "to", " ", 
             "bluelist", " ", "b1"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"g1", "\[Equal]", "seed"}], ",", 
             RowBox[{"myFlag", "=", "1"}], ",", " ", 
             RowBox[{"seed", "=", "g1"}]}], "]"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{
            "exit", " ", "if", " ", "greenlist", " ", "g1", " ", "is", " ", 
             "the", " ", "same", " ", "as", " ", "seed"}], ";", " ", 
            RowBox[{"if", " ", "not"}]}], ",", " ", 
           RowBox[{"g1", " ", "becomes", " ", "new", " ", "seed"}]}], "*)"}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"myFlag", "=", "0"}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "repeat", " ", "loop", " ", "for", " ", "all", " ", "possible", " ", 
          "green", " ", "seeds"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"g1", ",", "b1"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "myGBpairs", "]"}], ",", "1"}], "}"}]}], 
      "]"}], "//", "Union"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6805804083588796`*^9, 3.680580496547429*^9}, {
   3.6805806479556093`*^9, 3.6805806957530966`*^9}, {3.6805808476007257`*^9, 
   3.680580847819522*^9}, {3.680580927929554*^9, 3.6805809299138975`*^9}, {
   3.6805822183190556`*^9, 3.6805823167853155`*^9}, {3.680582445147624*^9, 
   3.680582489650468*^9}, 3.6805825196701097`*^9, {3.6805826935160985`*^9, 
   3.6805827655538387`*^9}, {3.68061140063095*^9, 3.680611502910879*^9}, {
   3.6806115504808807`*^9, 3.680611563652952*^9}, {3.680611606508988*^9, 
   3.68061164941532*^9}, {3.680611719298317*^9, 3.680611763017613*^9}, {
   3.6806118326217384`*^9, 3.680611837434298*^9}, {3.6806118732598915`*^9, 
   3.6806119010954266`*^9}, {3.680612028677389*^9, 3.6806120313336725`*^9}, {
   3.680612125630992*^9, 3.6806121606332965`*^9}, {3.680612400194989*^9, 
   3.680612531452464*^9}, {3.680612562975997*^9, 3.680612651693954*^9}, {
   3.680612698670108*^9, 3.680612704732683*^9}, {3.680612737749642*^9, 
   3.6806127839376864`*^9}, {3.6806128376774015`*^9, 3.68061283875551*^9}, {
   3.6806129034791393`*^9, 3.680612931182576*^9}, {3.680612991955402*^9, 
   3.6806130150338707`*^9}, {3.680613258192689*^9, 3.680613259848961*^9}, {
   3.680613998596075*^9, 3.680614023940117*^9}, {3.680614216257804*^9, 
   3.6806142169140077`*^9}, {3.6806144254002414`*^9, 
   3.6806144270565624`*^9}, {3.680623480818158*^9, 3.6806235013184032`*^9}, 
   3.680624604283923*^9},
 CellLabel->"In[42]:=",ExpressionUUID->"1ea48a73-204e-47f8-94ac-a862a1e58d5d"]
}, Closed]],

Cell[CellGroupData[{

Cell["ConnectByColor", "Subsection",
 CellChangeTimes->{{3.68184476959031*^9, 3.681844775966675*^9}, {
  3.681844807942504*^9, 3.681844812318754*^9}, {3.6818451029743786`*^9, 
  3.68184510719862*^9}, {3.681848738193301*^9, 
  3.681848741585495*^9}},ExpressionUUID->"67559df4-9479-4774-9481-\
451a827af675"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Connect2Colors", "[", 
   RowBox[{
   "track1_", ",", "track2_", ",", "minOverlapTime_", ",", 
    "maxOverlapDistance_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "idxTrack1", ",", "idxTrack2", ",", "myAllLink", ",", "tempTrack1", ",", 
      "tempTrack2", ",", "myLinkList", ",", "newTrack1", ",", "newTrack2", 
      ",", "myMergedTrack", ",", "bigTrack1", ",", "bigTrack2"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", 
     RowBox[{
     "Getting", " ", "color", " ", "index", " ", "assuming", " ", "the", " ", 
      "tracks", " ", "have", " ", "never", " ", "been", " ", "connected", " ",
       "with", " ", "any", " ", "other", " ", "colors"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"idxTrack1", "=", 
      RowBox[{"track1", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"idxTrack2", "=", 
      RowBox[{"track2", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"Creating", " ", "linking", " ", "pair", " ", "list"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"myAllLink", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempTrack1", "=", 
          RowBox[{
          "track1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"tempTrack2", "=", 
          RowBox[{
          "track2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"FindOverlapDist", "[", 
          RowBox[{"tempTrack1", ",", "tempTrack2", ",", "minOverlapTime"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "track1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "@", "track2"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myLinkList", "=", 
      RowBox[{"CrossPairFinder", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"myAllLink", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"0", "\[LessEqual]", "x", "<", "maxOverlapDistance"}]}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"Preparing", " ", "output", " ", "track"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"newTrack1", "=", "track1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTrack2", "=", "track2"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"Connecting", " ", "tracks"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"myMergedTrack", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"track1", "\[LeftDoubleBracket]", 
               RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"track2", "\[LeftDoubleBracket]", 
               RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}]}], "}"}], "//", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&"}]}], 
             "]"}], "&"}]}], "//", 
          RowBox[{
           RowBox[{"SplitBy", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"#", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&"}]}], 
            "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"bigTrack1", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "2"}], ",", " ", 
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"x_", "/;", 
                 RowBox[{
                  RowBox[{
                  "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                   "\[Equal]", "idxTrack1"}]}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
                " ", "#", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "]"}], "&"}], "/@", 
           "myMergedTrack"}], ")"}]}], ";", "  ", 
        RowBox[{"(*", 
         RowBox[{
         "Note", " ", "that", " ", "this", " ", "automatically", " ", 
          "deletes", " ", "times", " ", "where", " ", "three", " ", "or", " ",
           "more", " ", "points", " ", "appears", " ", "at", " ", "once"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"bigTrack1", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"bigTrack1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{"Length", "@", "x"}], ">", "1"}]}]}], "]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "Note", " ", "that", " ", "this", " ", "automatically", " ", 
          "deletes", " ", "times", " ", "where", " ", "there", " ", "is", " ",
           "overlap", " ", "in", " ", "multiple", " ", "tracks", " ", "in", 
          " ", "track1"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
         " ", 
        RowBox[{"(*", 
         RowBox[{
         "Choose", " ", "to", " ", "label", " ", "big", " ", "track", " ", 
          "as", " ", "lowest", " ", 
          RowBox[{"#", "'"}], "d", " ", "track1"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"idxTrack1", "+", "idxTrack2"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "Change", " ", "color", " ", "index", " ", "to", " ", "two", " ", 
          "colors", " ", "from", " ", "one", " ", "color"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}], "=", "bigTrack1"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ">", "1"}],
           ",", 
          RowBox[{
           RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "lowest", " ", "#", " ", "track1", " ", "that", " ", "should", " ", 
           "be", " ", "linked", " ", "is", " ", "replaced", " ", "with", " ", 
           "bigTrack1"}], ";", " ", 
          RowBox[{"others", " ", "become", " ", 
           RowBox[{"{", "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"bigTrack2", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "2"}], ",", " ", 
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"x_", "/;", 
                 RowBox[{
                  RowBox[{
                  "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                   "\[Equal]", "idxTrack2"}]}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
                " ", "#", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "]"}], "&"}], "/@", 
           "myMergedTrack"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bigTrack2", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"bigTrack2", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{"Length", "@", "x"}], ">", "1"}]}]}], "]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack2", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack2", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"idxTrack1", "+", "idxTrack2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newTrack2", "\[LeftDoubleBracket]", 
          RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}], "=", "bigTrack2"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ">", "1"}],
           ",", 
          RowBox[{
           RowBox[{"newTrack2", "\[LeftDoubleBracket]", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{"{", "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "myLinkList"}], ",", "1"}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newTrack1", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newTrack1", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"Now", " ", "get", " ", "rid", " ", "of", " ", "the", " ", 
       RowBox[{"{", "}"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTrack1"}]}]}], ";", 
     RowBox[{"(*", "renumber", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"newTrack2", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newTrack2", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTrack2", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTrack2"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newTrack1", ",", "newTrack2"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6818477833286858`*^9, 3.6818479300650787`*^9}, 
   3.681847962152914*^9, {3.6818480224173613`*^9, 3.681848083193837*^9}, {
   3.681848114416623*^9, 3.6818481247852163`*^9}, {3.6818487447936783`*^9, 
   3.6818487458577394`*^9}, {3.6818533936295767`*^9, 3.681853409781501*^9}, {
   3.682708447520831*^9, 3.6827084621686687`*^9}, {3.6827085690727835`*^9, 
   3.6827086288092003`*^9}, {3.6827087069206676`*^9, 3.68270872880892*^9}, {
   3.682766907607557*^9, 3.6827669156630173`*^9}, {3.68276707498313*^9, 
   3.6827671445201073`*^9}, {3.682768646177997*^9, 3.6827686940657363`*^9}, {
   3.6827687722172065`*^9, 3.682768776041425*^9}, {3.6827688265133123`*^9, 
   3.6827688825615177`*^9}, {3.6827689192496157`*^9, 3.682768923001831*^9}, {
   3.682769039177476*^9, 3.6827691459455824`*^9}, {3.682770721506699*^9, 
   3.682770737554617*^9}, {3.682860302066414*^9, 3.6828603066736774`*^9}, {
   3.6828603498911495`*^9, 3.682860543546226*^9}, {3.6828605761940937`*^9, 
   3.6828605966112614`*^9}, {3.682861188652124*^9, 3.6828612173707666`*^9}, {
   3.6828614396034775`*^9, 3.6828617892354755`*^9}, {3.682861825644558*^9, 
   3.6828618869800663`*^9}, 3.682862876700675*^9, {3.682863100068451*^9, 
   3.6828631120611367`*^9}, 3.6828635003333445`*^9, {3.6828721540043063`*^9, 
   3.6828721618757563`*^9}, {3.682885069295019*^9, 3.68288507107012*^9}, {
   3.6832990650866437`*^9, 3.6832990971674786`*^9}, {3.6832991433351192`*^9, 
   3.6832991439671555`*^9}, {3.6832995779349775`*^9, 
   3.6832996392954865`*^9}, {3.6832996727033978`*^9, 3.683299686272174*^9}, {
   3.683299717889982*^9, 3.6832997212561746`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"32cec282-b416-4885-81cc-d9efc58b851a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Connect2ColorsFor3", "[", 
   RowBox[{
   "track1_", ",", "track2_", ",", "minOverlapTime_", ",", 
    "maxOverlapDistance_", ",", "track1Color_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "idxTrack1", ",", "idxTrack2", ",", "myAllLink", ",", "tempTrack1", ",", 
      "tempTrack2", ",", "myLinkList", ",", "newTrack1", ",", "newTrack2", 
      ",", "myMergedTrack", ",", "bigTrack1", ",", "bigTrack2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myAllLink", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempTrack1", "=", 
          RowBox[{
          "track1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"tempTrack2", "=", 
          RowBox[{
          "track2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"FindOverlapDist", "[", 
          RowBox[{"tempTrack1", ",", "tempTrack2", ",", "minOverlapTime"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "track1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "@", "track2"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myLinkList", "=", 
      RowBox[{"CrossPairFinder", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"myAllLink", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"0", "\[LessEqual]", "x", "<", "maxOverlapDistance"}]}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTrack1", "=", "track1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"myMergedTrack", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"track1", "\[LeftDoubleBracket]", 
               RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"track2", "\[LeftDoubleBracket]", 
               RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}]}], "}"}], "//", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&"}]}], 
             "]"}], "&"}]}], "//", 
          RowBox[{
           RowBox[{"SplitBy", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"#", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&"}]}], 
            "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bigTrack1", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "2"}], ",", " ", 
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"x_", "/;", 
                 RowBox[{
                  RowBox[{"x", "\[LeftDoubleBracket]", 
                   RowBox[{"3", ",", "track1Color"}], 
                   "\[RightDoubleBracket]"}], "\[Equal]", "1"}]}]}], "]"}], 
              ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
                " ", "#", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "]"}], "&"}], "/@", 
           "myMergedTrack"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bigTrack1", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"bigTrack1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{"Length", "@", "x"}], ">", "1"}]}]}], "]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{"idxTrack1", "=", 
         RowBox[{"Total", "@", 
          RowBox[{"track1", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", "1", 
            ",", "3"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"idxTrack2", "=", 
         RowBox[{"Total", "@", 
          RowBox[{"track2", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", "1", 
            ",", "3"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"idxTrack1", "+", "idxTrack2"}], ")"}], "/.", 
          RowBox[{
           RowBox[{"x_", "/;", 
            RowBox[{"x", ">", "0"}]}], "\[Rule]", "1"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}], "=", "bigTrack1"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ">", "1"}],
           ",", 
          RowBox[{
           RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{"{", "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "myLinkList"}], ",", "1"}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"newTrack1", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newTrack1", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTrack1"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTrack2", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"track2", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "#", "}"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "//", 
            "Flatten"}], "//", "Sort"}], ")"}]}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTrack2", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTrack2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newTrack1", ",", "newTrack2"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6833889497817545`*^9, 3.683389048590406*^9}, {
  3.6833892503099437`*^9, 3.6833892517180243`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"ab81c138-211c-46b9-99e4-e1c5a838764c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Connect3Colors", "[", 
   RowBox[{
   "trackr_", ",", "trackg_", ",", "trackb_", ",", "minOverlapTime_", ",", 
    "maxOverlapDistance_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "trackgb", ",", "trackbAlone", ",", "trackrgb", ",", "newTrackr", ",", 
      "trackbr", ",", "trackrAlone1", ",", "trackgbr", ",", "newTrackg", ",", 
      "trackgr", ",", "trackrAlone2", ",", "trackbgr", ",", "newTrackb", ",", 
      "dum"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackgb", ",", "trackbAlone"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackg", ",", "trackb", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackrgb", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackr", ",", "trackgb", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newTrackr", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackrgb", ",", "trackbAlone", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackbr", ",", "trackrAlone1"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackb", ",", "trackr", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackgbr", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackg", ",", "trackbr", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newTrackg", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackgbr", ",", "trackrAlone1", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackgr", ",", "trackrAlone2"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackg", ",", "trackr", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackbgr", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackb", ",", "trackgr", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newTrackb", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackbgr", ",", "trackrAlone2", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newTrackr", ",", "newTrackg", ",", "newTrackb"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6833890896927567`*^9, 3.6833892422454824`*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"7617eea5-7332-4c61-99ae-0b4065bcad2b"]
}, Closed]],

Cell[CellGroupData[{

Cell["ConnectTracks[tracks_,listConnectTracks, (renumberQ)]", "Subsection",
 CellChangeTimes->{{3.67925864456554*^9, 3.6792586589813643`*^9}, {
  3.679260491399173*^9, 
  3.6792605037188773`*^9}},ExpressionUUID->"61fe7ff1-20ee-482d-802e-\
f160a81cfe1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConnectTracks", "[", 
   RowBox[{"tracksList_", ",", "listConnectTracks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "newTracksList", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newTracksList", "=", "tracksList"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", "All", ",", 
        "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"tracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{
        "listConnectTracks", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", "1", ",", "1"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTracksList", "=", 
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{"Sort", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"newTracksList", ",", "1"}], "]"}]}], ",", "First"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTracksList"}]}]}], ";", 
     "\[IndentingNewLine]", "newTracksList"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.679260438412142*^9, 3.679260486195875*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"719118c6-2230-4562-822c-44478d5a68be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConnectTracks", "[", 
   RowBox[{"tracksList_", ",", "listConnectTracks_", ",", "renumberQ_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "newTracksList", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newTracksList", "=", "tracksList"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", "All", ",", 
        "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"tracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{
        "listConnectTracks", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", "1", ",", "1"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"renumberQ", ",", 
       RowBox[{
        RowBox[{"newTracksList", "=", 
         RowBox[{"SplitBy", "[", 
          RowBox[{
           RowBox[{"Sort", "@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"newTracksList", ",", "1"}], "]"}]}], ",", "First"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "newTracksList"}]}]}]}], ",", 
       "newTracksList"}], "]"}], ";", "\[IndentingNewLine]", 
     "newTracksList"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.679260438412142*^9, 3.679260467243791*^9}, {
  3.6792605093571997`*^9, 3.67926051250838*^9}, {3.679260779604657*^9, 
  3.6792608012368946`*^9}, {3.679260951305478*^9, 3.6792609531485834`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"a37c1806-5ace-41f5-8418-f44926b396bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConnectTracksFilled", "[", 
   RowBox[{"tracksList_", ",", "listConnectTracks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newTracksList", ",", "spotEnd", ",", "spotStart", ",", "missingNum", 
      ",", "fillingNum", ",", "fillingPos", ",", "fillingSpots"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newTracksList", "=", "tracksList"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"spotEnd", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Last", "@", 
            RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
             RowBox[{
             "listConnectTracks", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], ")"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"spotStart", "=", 
         RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
            RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], ",", "1", ",",
            "2"}], "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"missingNum", "=", 
         RowBox[{
          RowBox[{
          "spotStart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "-", 
          RowBox[{
          "spotEnd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"missingNum", ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fillingNum", "=", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "spotEnd", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "+", "1"}], ",", 
              RowBox[{
               RowBox[{
               "spotStart", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "-", "1"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"fillingPos", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Plus", "[", 
               RowBox[{"#", ",", 
                RowBox[{"spotEnd", "\[LeftDoubleBracket]", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}]}],
                "]"}], "&"}], "/@", 
             RowBox[{"Outer", "[", 
              RowBox[{"Times", ",", 
               RowBox[{
                RowBox[{"Range", "@", "missingNum"}], "/", 
                RowBox[{"(", 
                 RowBox[{"missingNum", "+", "1"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"spotStart", "\[LeftDoubleBracket]", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}], 
                "-", 
                RowBox[{"spotEnd", "\[LeftDoubleBracket]", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}], 
                 "\[RightDoubleBracket]"}]}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"fillingSpots", "=", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"Last", "@", 
               RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
                RowBox[{
                "listConnectTracks", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], ",", 
              "missingNum"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fillingSpots", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{"fillingNum", ",", "fillingPos"}], "}"}]}], "//", 
              "Flatten"}], "//", 
             RowBox[{
              RowBox[{"Partition", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "&"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
             RowBox[{
             "listConnectTracks", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{"PadRight", "[", 
             RowBox[{
              RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
               RowBox[{
               "listConnectTracks", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "listConnectTracks", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], "+",
                "missingNum"}], ",", "fillingSpots"}], "]"}]}]}]}], "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "@", "listConnectTracks"}], "-", "1"}], ",", 
         "1"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", "All", ",", 
        "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"tracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{
        "listConnectTracks", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", "1", ",", "1"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTracksList", "=", 
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{"Sort", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"newTracksList", ",", "1"}], "]"}]}], ",", "First"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTracksList"}]}]}], ";", 
     "\[IndentingNewLine]", "newTracksList"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6818437818788157`*^9, 3.681843790654318*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"0a2d8c66-a6f7-4f20-8d3a-724d0f41542b"]
}, Closed]],

Cell[CellGroupData[{

Cell["TrackFiller", "Subsection",
 CellChangeTimes->{{3.681819224690225*^9, 
  3.68181922983352*^9}},ExpressionUUID->"f79524e6-639c-4244-b72d-\
ed5779731f40"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "This", " ", "module", " ", "fills", " ", "any", " ", "gaps", " ", "in", 
   " ", "tracks", " ", "by", " ", "interpolating", " ", "the", " ", 
   "position", " ", "from", " ", "the", " ", "last", " ", "postion", " ", 
   "before", " ", "the", " ", "gap", " ", "and", " ", "the", " ", "first", 
   " ", "position", " ", "after", " ", "the", " ", "gap"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.681839614018428*^9, 3.681839638313818*^9}, {
  3.681839694090008*^9, 3.681839739850625*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"494bc971-4e2d-4b6b-aa60-73772d5e4e44"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TrackFiller", "[", "tracksList_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "filledTracksList", ",", "myIdx", ",", "missingStart", ",", "missingNum",
       ",", "missingStartShifted", ",", "spotEnd", ",", "spotStart", ",", 
      "fillingNum", ",", "fillingPos", ",", "fillingSpots", ","}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"filledTracksList", "=", "tracksList"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"myIdx", "=", 
         RowBox[{
          RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", 
            RowBox[{"2", ";;"}], ",", "2", ",", "1"}], 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", 
            RowBox[{";;", 
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{
               "filledTracksList", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "-", "1"}]}], ",", "2", ",", 
            "1"}], "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"missingStart", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"myIdx", ",", 
             RowBox[{"x_", "/;", 
              RowBox[{"x", ">", "1"}]}]}], "]"}], "+", "1"}], "//", 
          "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"missingNum", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"myIdx", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{"x", ">", "1"}]}]}], "]"}], "-", "1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"missingStart", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"missingStartShifted", "=", "missingStart"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"missingStartShifted", "\[LeftDoubleBracket]", 
             RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{"missingStart", "\[LeftDoubleBracket]", 
              RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"FoldList", "[", 
                RowBox[{"Plus", ",", "missingNum"}], "]"}], ")"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{";;", 
               RowBox[{
                RowBox[{"Length", "@", "missingNum"}], "-", "1"}]}], 
              "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"spotEnd", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{
                    "missingStartShifted", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], 
                  "\[RightDoubleBracket]"}], ")"}], "\[LeftDoubleBracket]", 
                "2", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"spotStart", "=", 
               RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", 
                 RowBox[{
                 "missingStartShifted", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], ",", "2"}], 
                "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"fillingNum", "=", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "spotEnd", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "+", "1"}], ",", 
                 RowBox[{
                  RowBox[{
                  "spotStart", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "-", "1"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fillingPos", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Plus", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"spotEnd", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], 
                    "\[RightDoubleBracket]"}]}], "]"}], "&"}], "/@", 
                RowBox[{"Outer", "[", 
                 RowBox[{"Times", ",", 
                  RowBox[{
                   RowBox[{"Range", "@", 
                    RowBox[{
                    "missingNum", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "missingNum", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "+", "1"}], ")"}]}], ",", 
                  RowBox[{
                   RowBox[{"spotStart", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}],
                    "-", 
                   RowBox[{"spotEnd", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fillingSpots", "=", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{
                    "missingStartShifted", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "missingNum", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fillingSpots", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Thread", "@", 
                  RowBox[{"{", 
                   RowBox[{"fillingNum", ",", "fillingPos"}], "}"}]}], "//", 
                 "Flatten"}], "//", 
                RowBox[{
                 RowBox[{"Partition", "[", 
                  RowBox[{"#", ",", "3"}], "]"}], "&"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "filledTracksList", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "=", 
                 RowBox[{"Insert", "[", 
                  RowBox[{
                   RowBox[{
                   "filledTracksList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "fillingSpots", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                    RowBox[{
                    "missingStartShifted", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "+", "k", "-", "1"}]}], 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", 
                  RowBox[{
                  "missingNum", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], ",", "1"}], "}"}]}], "]"}], 
              ";"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "@", "missingStart"}], ",", "1"}], "}"}]}], 
            "]"}], ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "filledTracksList"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "filledTracksList"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.681819232566676*^9, 3.681819281457472*^9}, {
  3.681836758312091*^9, 3.681836906328557*^9}, {3.681836938336388*^9, 
  3.681836980535802*^9}, {3.681837014016717*^9, 3.681837143512123*^9}, {
  3.6818371739048615`*^9, 3.6818373862010045`*^9}, {3.6818390382424955`*^9, 
  3.68183903989859*^9}, {3.681839128498658*^9, 3.6818391529510565`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"88aef07b-19d9-42ee-ac8c-eb8e3743e876"]
}, Closed]],

Cell[CellGroupData[{

Cell["FindConnectableTracks", "Subsection",
 CellChangeTimes->{{3.679313898838685*^9, 
  3.6793139041269875`*^9}},ExpressionUUID->"ada456d6-1d9c-4b38-816e-\
3ccf12fe85dc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindConnectableTracks2", "[", 
   RowBox[{
   "tracksList_", ",", "myMaxN_", ",", "dist_", ",", "time_", ",", 
    "trackNumber_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "allTracksStart", ",", "timeEnd", ",", "posiEnd", ",", "afterTracks", 
      ",", "listConnectTracks", ",", "tempConnectTracks", ",", 
      "tempConnectTracks2", ",", "tempConnectTracks3", ",", 
      "posiConnectTracks", ",", "tempTrack", ",", "tempFrame"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"allTracksStart", "=", 
      RowBox[{"tracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"trackNumber", "+", "1"}], ")"}], ";;"}], ",", "1"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"timeEnd", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Last", "@", 
         RowBox[{
         "tracksList", "\[LeftDoubleBracket]", "trackNumber", 
          "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posiEnd", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Last", "@", 
         RowBox[{
         "tracksList", "\[LeftDoubleBracket]", "trackNumber", 
          "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"afterTracks", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"allTracksStart", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"timeEnd", "<", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], 
           "\[LessEqual]", 
           RowBox[{"timeEnd", "+", "time"}]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
            "posiEnd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "-", "dist"}], "<", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<", 
           RowBox[{
            RowBox[{
            "posiEnd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "+", "dist"}]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
            "posiEnd", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
             "-", "dist"}], "<", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "<", 
           RowBox[{
            RowBox[{
            "posiEnd", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
             "+", "dist"}]}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listConnectTracks", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", 
        RowBox[{"trackNumber", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"afterTracks", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"afterTracks", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tempConnectTracks", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
        "tracksList", "\[LeftDoubleBracket]", "listConnectTracks", 
         "\[RightDoubleBracket]"}], "//", "Flatten"}], "//", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"tracksList", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tempConnectTracks", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"tempConnectTracks", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tempConnectTracks2", "=", 
      RowBox[{
       RowBox[{"tempConnectTracks", "//", "Sort"}], "//", 
       RowBox[{
        RowBox[{"SplitBy", "[", 
         RowBox[{"#", ",", "First"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tempConnectTracks3", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tempConnectTracks2", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"tempConnectTracks2", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", 
           RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}]}], "}"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"posiConnectTracks", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "@", "myMaxN"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
           "myMaxN"}], "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tempFrame", "=", 
         RowBox[{"tempConnectTracks3", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{
         RowBox[{"posiConnectTracks", "\[LeftDoubleBracket]", 
          RowBox[{"tempFrame", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"tempConnectTracks3", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "tempConnectTracks3"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"listConnectTracks", ",", "posiConnectTracks"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6787314149002867`*^9, 3.678731473628646*^9}, {
   3.678731527835746*^9, 3.678731651943845*^9}, {3.67873192075622*^9, 
   3.678731925884513*^9}, {3.6787323688368483`*^9, 3.678732492620929*^9}, {
   3.6787335929338627`*^9, 3.678733599774254*^9}, {3.6787336336611924`*^9, 
   3.6787336361663356`*^9}, 3.6790900466130695`*^9, {3.679090105420433*^9, 
   3.6790901372212524`*^9}, {3.67909033683667*^9, 3.6790904911094933`*^9}, {
   3.6791367729136615`*^9, 3.67913678355427*^9}, {3.6791370766180325`*^9, 
   3.6791371439218817`*^9}, {3.6791371846022086`*^9, 
   3.6791372102186737`*^9}, {3.6791372727062483`*^9, 3.679137333898748*^9}, {
   3.679137417098507*^9, 3.6791374283151484`*^9}, {3.6791501942853203`*^9, 
   3.6791502799182177`*^9}, {3.679152732282485*^9, 3.6791527339295793`*^9}, {
   3.6792419937019463`*^9, 3.679242050430191*^9}, {3.679250900469384*^9, 
   3.679250901061418*^9}, {3.679258064987171*^9, 3.6792580677713304`*^9}, {
   3.6792585280766582`*^9, 3.6792585508039584`*^9}, {3.6792616162782936`*^9, 
   3.6792616315821686`*^9}, {3.6792620662780323`*^9, 3.679262089254346*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"71dbcf64-a30e-4685-935a-ab6705494cff"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MyCrossCorrelatePlotter[myColorParameters_,listHead_,colN1_,colN2_,color_\
optional]\
\>", "Subsection",
 CellChangeTimes->{{3.703275782599066*^9, 
  3.7032758061427093`*^9}},ExpressionUUID->"b81bb2a7-c2c9-4d8a-8b17-\
8f13c1c3ed06"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyCrossCorrelatePlotter", "[", 
   RowBox[{
   "myColorParameters_", ",", "listHead_", ",", "colN1_", ",", "colN2_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myColorParameters", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "All"}], ",", "All", ",", 
        RowBox[{"colN1", ";;", "colN2", ";;", 
         RowBox[{"(", 
          RowBox[{"colN2", "-", "colN1"}], ")"}]}]}], "]"}], "]"}], "//", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"listHead", "[", 
            RowBox[{"[", "colN1", "]"}], "]"}], ",", 
           RowBox[{"listHead", "[", 
            RowBox[{"[", "colN2", "]"}], "]"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"PointSize", "[", "0.007", "]"}]}]}], "]"}], "&"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.703274674140876*^9, 3.7032747392387104`*^9}, {
   3.7032747968973637`*^9, 3.7032748616902075`*^9}, 3.7032751970156884`*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"e98d3c78-47c0-4443-b473-a4823c7e3dc9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyCrossCorrelatePlotter", "[", 
   RowBox[{
   "myColorParameters_", ",", "listHead_", ",", "colN1_", ",", "colN2_", ",", 
    "color_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myColorParameters", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"1", ";;", "All"}], ",", "All", ",", 
        RowBox[{"colN1", ";;", "colN2", ";;", 
         RowBox[{"(", 
          RowBox[{"colN2", "-", "colN1"}], ")"}]}]}], "]"}], "]"}], "//", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "color"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"listHead", "[", 
            RowBox[{"[", "colN1", "]"}], "]"}], ",", 
           RowBox[{"listHead", "[", 
            RowBox[{"[", "colN2", "]"}], "]"}]}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"PointSize", "[", "0.007", "]"}]}]}], "]"}], "&"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.703274674140876*^9, 3.7032747392387104`*^9}, {
   3.7032747968973637`*^9, 3.7032748616902075`*^9}, 3.7032751970156884`*^9, {
   3.703275630504817*^9, 3.7032756482653213`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"0ca9d9c3-e6a4-4b37-a7d4-d509a413b2e4"]
}, Closed]],

Cell[CellGroupData[{

Cell["TickFormat[xmin_,xmax_,digits_,divisions_]", "Subsection",
 CellChangeTimes->{{3.703358407462393*^9, 3.703358409042426*^9}, {
  3.703358439210065*^9, 
  3.7033584441361666`*^9}},ExpressionUUID->"61f6a415-821b-4948-9dad-\
7963d18bd10c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TickFormat", "[", 
    RowBox[{"xmin_", ",", "xmax_", ",", "digits_", ",", 
     RowBox[{"divisions_:", " ", "10"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{"tickNumber", ",", 
      RowBox[{"{", 
       RowBox[{"tickNumber", ",", 
        RowBox[{"PaddedForm", "[", 
         RowBox[{
          RowBox[{"Round", "[", 
           RowBox[{"tickNumber", ",", "0.01"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Max", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{"IntegerDigits", "@", 
                  RowBox[{"IntegerPart", "[", "#", "]"}]}]}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"10", "^", "digits"}], " ", 
                 RowBox[{"{", 
                  RowBox[{"xmin", ",", "xmax"}], "}"}]}], ")"}]}], ")"}]}], 
            ",", "digits"}], "}"}]}], "]"}]}], "}"}]}], "]"}], "/@", 
    RowBox[{"FindDivisions", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"xmin", ",", "xmax"}], "}"}], ",", "divisions"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7033584100124474`*^9, 3.7033584147265472`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"82bd3861-bdaf-4fba-94c3-d10ca8f6a214"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
MyHistogramPlotter[myColorParameter_,listHead_,col_,color_,bins_optional]\
\>", "Subsection",
 CellChangeTimes->{{3.703347014331491*^9, 
  3.7033470305826864`*^9}},ExpressionUUID->"4e3722c9-cac0-45ce-9344-\
8f07a405af1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyHistogramPlotter", "[", 
   RowBox[{
   "myColorParameter_", ",", "listHead_", ",", "col_", ",", "color_"}], "]"}],
   ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"myList", ",", "myMed", ",", "mybinsize"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"myColorParameter", "\[NotEqual]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"myList", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Flatten", "[", 
           RowBox[{"myColorParameter", ",", "1"}], "]"}], ")"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "col"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "myList", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "\[NotEqual]", "\"\<\>\""}], ",", 
         RowBox[{"myMed", "=", 
          RowBox[{"Median", "[", 
           RowBox[{"myList", "//", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", 
               RowBox[{"x_", "/;", 
                RowBox[{"x", "\[Equal]", "\"\<\>\""}]}]}], "]"}], "&"}]}], 
           "]"}]}], ",", 
         RowBox[{"myMed", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"myMed", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mybinsize", "=", 
           RowBox[{"myMed", "/", "20"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myList", "//", 
           RowBox[{
            RowBox[{"Histogram", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"mybinsize", " ", "i"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "60", ",", "1"}], "}"}]}], 
                "]"}], "}"}], ",", "\"\<Probability\>\"", ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "listHead", "\[LeftDoubleBracket]", "col", 
                  "\[RightDoubleBracket]"}], ",", "\"\<\>\""}], "}"}]}], ",", 
              RowBox[{"FrameTicks", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"TickFormat", "[", 
                    RowBox[{"#1", ",", "#2", ",", "2", ",", "4"}], "]"}], 
                    "&"}], ")"}], ",", "None"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"BaseStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
                 RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
              RowBox[{"ChartStyle", "\[Rule]", "color"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "250"}]}], "]"}], "&"}]}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7033453968476095`*^9, 3.7033456017408676`*^9}, {
   3.703345690238285*^9, 3.7033458191282563`*^9}, {3.703345873413062*^9, 
   3.703345894108388*^9}, {3.703345981093774*^9, 3.703346016106325*^9}, {
   3.7033460780712643`*^9, 3.7033460994455795`*^9}, {3.703346166582602*^9, 
   3.7033462159563966`*^9}, {3.7033463000426383`*^9, 
   3.7033463140848665`*^9}, {3.7033463606945405`*^9, 
   3.7033464081352506`*^9}, {3.7033585202398043`*^9, 3.703358540818222*^9}, {
   3.703358600870448*^9, 3.7033586136397057`*^9}, {3.703358644942337*^9, 
   3.703358657284584*^9}, {3.703358723769965*^9, 3.703358723823965*^9}, {
   3.703358795953441*^9, 3.703358804128601*^9}, 3.7033590514415994`*^9, {
   3.703361587852375*^9, 3.703361605516774*^9}, {3.703361638652496*^9, 
   3.7033616501067543`*^9}, {3.7033618063961444`*^9, 3.703361831989685*^9}, {
   3.7033618848697786`*^9, 3.703361910100312*^9}, {3.703362341703863*^9, 
   3.7033623943320017`*^9}, {3.703362485782957*^9, 3.7033624883070083`*^9}, {
   3.7033625395840573`*^9, 3.70336257076271*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"29049d6e-41f8-49c7-a7d3-bcfa5c95f1e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyHistogramPlotter", "[", 
   RowBox[{
   "myColorParameter_", ",", "listHead_", ",", "col_", ",", "color_", ",", 
    "bins_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"myList", ",", "myMed", ",", "mybinsize"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"myColorParameter", "\[NotEqual]", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"myList", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Flatten", "[", 
           RowBox[{"myColorParameter", ",", "1"}], "]"}], ")"}], 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "col"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "myList", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "\[NotEqual]", "\"\<\>\""}], ",", 
         RowBox[{"myMed", "=", 
          RowBox[{"Median", "[", 
           RowBox[{"myList", "//", 
            RowBox[{
             RowBox[{"DeleteCases", "[", 
              RowBox[{"#", ",", 
               RowBox[{"x_", "/;", 
                RowBox[{"x", "\[Equal]", "\"\<\>\""}]}]}], "]"}], "&"}]}], 
           "]"}]}], ",", 
         RowBox[{"myMed", "=", "0"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"myMed", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mybinsize", "=", 
           RowBox[{"myMed", "/", "20"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myList", "//", 
           RowBox[{
            RowBox[{"Histogram", "[", 
             RowBox[{"#", ",", 
              RowBox[{"{", "bins", "}"}], ",", "\"\<Probability\>\"", ",", 
              RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"FrameLabel", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "listHead", "\[LeftDoubleBracket]", "col", 
                  "\[RightDoubleBracket]"}], ",", "\"\<\>\""}], "}"}]}], ",", 
              RowBox[{"FrameTicks", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"TickFormat", "[", 
                    RowBox[{"#1", ",", "#2", ",", "2", ",", "4"}], "]"}], 
                    "&"}], ")"}], ",", "None"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", "None"}], "}"}]}], "}"}]}], ",", 
              RowBox[{"BaseStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
                 RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
              RowBox[{"ChartStyle", "\[Rule]", "color"}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "250"}]}], "]"}], "&"}]}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7033453968476095`*^9, 3.7033456017408676`*^9}, {
   3.703345690238285*^9, 3.7033458191282563`*^9}, {3.703345873413062*^9, 
   3.703345894108388*^9}, {3.703345981093774*^9, 3.703346016106325*^9}, {
   3.7033460780712643`*^9, 3.7033460994455795`*^9}, {3.703346166582602*^9, 
   3.7033462159563966`*^9}, {3.7033463000426383`*^9, 
   3.7033463140848665`*^9}, {3.7033463606945405`*^9, 
   3.7033464081352506`*^9}, {3.703346732549771*^9, 3.7033467431699276`*^9}, {
   3.7033468075528164`*^9, 3.703346809363845*^9}, {3.7033584884151525`*^9, 
   3.7033585318370404`*^9}, {3.703358591793267*^9, 3.70335864167127*^9}, {
   3.7033587212929087`*^9, 3.70335872137591*^9}, {3.7033588810271482`*^9, 
   3.703358882944187*^9}, {3.7033589201549244`*^9, 3.703359059365768*^9}, {
   3.703361607820819*^9, 3.703361656398898*^9}, 3.7033618409068685`*^9, {
   3.703361919104509*^9, 3.7033619226515884`*^9}, {3.703362402527178*^9, 
   3.7033624090863256`*^9}, {3.703362456080333*^9, 3.703362482219881*^9}, 
   3.7033625800409193`*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"b9193d75-bcde-44d5-8abc-b609284c6a5b"]
}, Closed]],

Cell[CellGroupData[{

Cell["TXYDiffusionPlotter[txylsits,maxt,color,shapeN,size]", "Subsection",
 CellChangeTimes->{{3.7148656178431544`*^9, 
  3.7148656407825317`*^9}},ExpressionUUID->"390ccb0c-3538-42c3-952e-\
16e7b25e37ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TXYDiffusionPlotter", "[", 
   RowBox[{
   "txylists_", ",", "maxt_", ",", "color_", ",", "shapeN_", ",", "size_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"msds", ",", "p1", ",", "p2", ",", "msds2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"msds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
              ")"}], "2"]}], "}"}], "&"}], "/@", 
         RowBox[{"Differences", "[", 
          RowBox[{
           RowBox[{
           "txylists", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
            ",", "1", ",", "j"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "txylists", "]"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "maxt", ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Mean", "/@", 
          RowBox[{"msds", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "msds", "]"}], ",", "1"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"ErrorListPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", 
          RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Frame #\>\"", ",", 
             "\"\<MSD (\!\(\*SuperscriptBox[\(pix\), \(2\)]\))\>\""}], 
            "}"}]}], ",", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}]}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"msds2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"msds", "//", "Flatten"}], "//", 
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", "Union"}], "//", 
       RowBox[{
        RowBox[{"SplitBy", "[", 
         RowBox[{"#", ",", "First"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Mean", "/@", "msds2"}], ")"}], ",", 
          RowBox[{"ErrorBar", "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              FractionBox[
               RowBox[{"StandardDeviation", "[", "#", "]"}], 
               SqrtBox[
                RowBox[{"Length", "[", "#", "]"}]]], "&"}], "/@", 
             RowBox[{"msds2", "\[LeftDoubleBracket]", 
              RowBox[{"All", ",", "All", ",", "2"}], 
              "\[RightDoubleBracket]"}]}], ")"}]}]}], "}"}], "//", 
        "Transpose"}], "//", 
       RowBox[{
        RowBox[{"ErrorListPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", 
          RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"maxt", "-", "1"}]}], "}"}], ",", "All"}], "}"}]}], 
          ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Graphics`PlotMarkers", "[", "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"shapeN", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             "size"}], "}"}]}], "\n", ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Frame #\>\"", ",", 
             "\"\<MSD (\!\(\*SuperscriptBox[\(pix\), \(2\)]\))\>\""}], 
            "}"}]}], ",", 
          RowBox[{"BaseStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "color"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"p1", ",", "p2"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7148648249721494`*^9, 3.7148649737870293`*^9}, {
  3.7148654437669964`*^9, 3.7148655251818724`*^9}, {3.714866422364873*^9, 
  3.714866425576295*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"f23e08f0-16d4-4d00-89ea-13391b259136"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
InteractionAnalyzer[componentAnalysisList_,column_(3=red,4=green,5=blue),\
shapeN,size]\
\>", "Subsection",
 CellChangeTimes->{{3.7148681650656333`*^9, 3.714868208670328*^9}, {
  3.714869979361375*^9, 3.714869983188116*^9}, {3.714874224676405*^9, 
  3.7148742255990944`*^9}},ExpressionUUID->"688a2350-76d5-4f97-9f57-\
fe0416bc729d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InteractionAnalyzer", "[", 
   RowBox[{"ca_", ",", "column_", ",", "shapeN_", ",", "size_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "goodi", ",", "redis", ",", "p1", ",", "greenis", ",", "p2", ",", 
      "blueis", ",", "p3", ",", "myAvgBlueis", ",", "myAvgRedis", ",", 
      "myAvgGreenis", ",", "mySizes", ",", "p4", ",", "p5", ",", "p6", ",", 
      "p4d", ",", "p5d", ",", "p6d", ",", "p7"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "We", " ", "need", " ", "to", " ", "delete", " ", "those", " ", "cases",
        " ", "when", " ", "we", " ", "cannot", " ", "see"}], ",", " ", 
      RowBox[{"eg", "."}], ",", " ", 
      RowBox[{"blue", " ", "in", " ", "every", " ", "track", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
         "assuming", " ", "blue", " ", "is", " ", "the", " ", "seed", " ", 
          "column", " ", "for", " ", "the", " ", "track"}], ")"}], ".", " ", 
        "In"}], " ", "other", " ", "words"}], ",", " ", 
      RowBox[{
      "sometimes", " ", "we", " ", "cannot", " ", "match", " ", "up", " ", 
       "the", " ", "centroid", " ", "to", " ", "a", " ", "specific", " ", 
       RowBox[{"track", ".", " ", "In"}], " ", "that", " ", "case"}], ",", 
      " ", 
      RowBox[{
      "we", " ", "will", " ", "not", " ", "include", " ", "in", " ", "the", 
       " ", 
       RowBox[{"analysis", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"goodi", "=", 
      RowBox[{
       RowBox[{"1", "+", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"Count", "[", 
              RowBox[{
               RowBox[{"MovingAverage", "[", 
                RowBox[{
                 RowBox[{"ca", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "All", ",", "column"}], "]"}], "]"}], 
                 ",", "2"}], "]"}], ",", 
               RowBox[{"x_", "/;", 
                RowBox[{
                 RowBox[{
                  RowBox[{"NumericQ", "[", "x", "]"}], "\[Equal]", "True"}], "&&", 
                 RowBox[{"x", "\[NotEqual]", "0"}]}]}]}], "]"}], 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{
               "ca", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
               "]"}], "-", "1"}]], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"Length", "[", "ca", "]"}], ",", "1"}], "}"}]}], "]"}], 
          ",", "1"}], "]"}]}], "//", "Flatten"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"redis", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Length", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", ">", "0"}], ",", "1", ",", "0"}], "]"}], "&"}], 
              "/@", 
              RowBox[{"MovingAverage", "[", 
               RowBox[{
                RowBox[{"ca", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                   "goodi", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "All", ",", "3"}], "]"}], 
                 "]"}], ",", "2"}], "]"}]}], ")"}], "//", 
            RowBox[{
             RowBox[{"SplitBy", "[", 
              RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"DeleteCases", "[", 
             RowBox[{"#", ",", 
              RowBox[{"x_", "/;", 
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "==", "0"}]}]}], "]"}], 
            "&"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "goodi", "]"}], ",", "1"}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"p1", "=", 
      RowBox[{
       RowBox[{"redis", "//", "Flatten"}], "//", 
       RowBox[{
        RowBox[{"Histogram", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", "10", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Log\>\"", ",", "\"\<Probability\>\""}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "300"}], "}"}], ",", "All"}], "}"}]}], ",", 
          RowBox[{"ChartStyle", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"column", "\[Equal]", "5"}], ",", "Purple", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"column", "\[Equal]", "4"}], ",", 
               RowBox[{"Darker", "[", 
                RowBox[{"Yellow", ",", "0.13"}], "]"}], ",", "Red"}], "]"}]}],
             "]"}]}], ",", 
          RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Interaction time (frames)\>\"", ",", "\"\<Percentage\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"\"\<Red to \>\"", "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"column", "\[Equal]", "5"}], ",", "\"\<Blue\>\"", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"column", "\[Equal]", "4"}], ",", "\"\<Green\>\"", 
                ",", "\"\<Red\>\""}], "]"}]}], "]"}], "<>", 
            "\"\< Interactions\>\""}]}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"greenis", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Length", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", ">", "0"}], ",", "1", ",", "0"}], "]"}], "&"}], 
              "/@", 
              RowBox[{"MovingAverage", "[", 
               RowBox[{
                RowBox[{"ca", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                   "goodi", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "All", ",", "4"}], "]"}], 
                 "]"}], ",", "2"}], "]"}]}], ")"}], "//", 
            RowBox[{
             RowBox[{"SplitBy", "[", 
              RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"DeleteCases", "[", 
             RowBox[{"#", ",", 
              RowBox[{"x_", "/;", 
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "==", "0"}]}]}], "]"}], 
            "&"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "goodi", "]"}], ",", "1"}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"p2", "=", 
      RowBox[{
       RowBox[{"greenis", "//", "Flatten"}], "//", 
       RowBox[{
        RowBox[{"Histogram", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", "10", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Log\>\"", ",", "\"\<Probability\>\""}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "300"}], "}"}], ",", "All"}], "}"}]}], ",", 
          RowBox[{"ChartStyle", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"column", "\[Equal]", "5"}], ",", "Cyan", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"column", "\[Equal]", "4"}], ",", "Green", ",", 
               RowBox[{"Darker", "[", 
                RowBox[{"Yellow", ",", "0.13"}], "]"}]}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Interaction time (frames)\>\"", ",", "\"\<Percentage\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"\"\<Green to \>\"", "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"column", "\[Equal]", "5"}], ",", "\"\<Blue\>\"", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"column", "\[Equal]", "4"}], ",", "\"\<Green\>\"", 
                ",", "\"\<Red\>\""}], "]"}]}], "]"}], "<>", 
            "\"\< Interactions\>\""}]}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"blueis", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Length", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"#", ">", "0"}], ",", "1", ",", "0"}], "]"}], "&"}], 
              "/@", 
              RowBox[{"MovingAverage", "[", 
               RowBox[{
                RowBox[{"ca", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                   "goodi", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "All", ",", "5"}], "]"}], 
                 "]"}], ",", "2"}], "]"}]}], ")"}], "//", 
            RowBox[{
             RowBox[{"SplitBy", "[", 
              RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"DeleteCases", "[", 
             RowBox[{"#", ",", 
              RowBox[{"x_", "/;", 
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "==", "0"}]}]}], "]"}], 
            "&"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "goodi", "]"}], ",", "1"}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"p3", "=", 
      RowBox[{
       RowBox[{"blueis", "//", "Flatten"}], "//", 
       RowBox[{
        RowBox[{"Histogram", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", "10", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Log\>\"", ",", "\"\<Probability\>\""}], "}"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "300"}], "}"}], ",", "All"}], "}"}]}], ",", 
          RowBox[{"ChartStyle", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"column", "\[Equal]", "5"}], ",", "Blue", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"column", "\[Equal]", "4"}], ",", "Cyan", ",", 
               "Purple"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Interaction time (frames)\>\"", ",", "\"\<Percentage\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"\"\<Blue to \>\"", "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"column", "\[Equal]", "5"}], ",", "\"\<Blue\>\"", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"column", "\[Equal]", "4"}], ",", "\"\<Green\>\"", 
                ",", "\"\<Red\>\""}], "]"}]}], "]"}], "<>", 
            "\"\< Interactions\>\""}]}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myAvgRedis", "=", 
      RowBox[{"Mean", "/@", "redis"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myAvgGreenis", "=", 
      RowBox[{"Mean", "/@", "greenis"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myAvgBlueis", "=", 
      RowBox[{"Mean", "/@", "blueis"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mySizes", "=", 
      RowBox[{"N", "[", 
       RowBox[{"Mean", "/@", 
        RowBox[{"ca", "\[LeftDoubleBracket]", 
         RowBox[{"goodi", ",", 
          RowBox[{"1", ";;", "All"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"column", "==", "5"}], ",", "8", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"column", "\[Equal]", "4"}], ",", "7", ",", "6"}], 
             "]"}]}], "]"}]}], "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p4d", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myAvgRedis", ",", "mySizes"}], "}"}], "//", "Transpose"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"p4", "=", 
      RowBox[{"p4d", "//", 
       RowBox[{
        RowBox[{"ListLogLogPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
          RowBox[{"PlotLabel", "->", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"column", "\[Equal]", "5"}], ",", "\"\<Blue\>\"", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"column", "\[Equal]", "4"}], ",", "\"\<Green\>\"", 
                ",", "\"\<Red\>\""}], "]"}]}], "]"}], "<>", 
            "\"\< Size vs. Red Int'n Time\>\""}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Avg. red int'n time (frames)\>\"", ",", " ", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"column", "\[Equal]", "5"}], ",", "\"\<Blue\>\"", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"column", "\[Equal]", "4"}], ",", "\"\<Green\>\"", 
                  ",", "\"\<Red\>\""}], "]"}]}], "]"}], "<>", 
              "\"\< size (pixels)\>\""}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"column", "\[Equal]", "5"}], ",", "Purple", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"column", "\[Equal]", "4"}], ",", 
               RowBox[{"Darker", "[", 
                RowBox[{"Yellow", ",", "0.13"}], "]"}], ",", "Red"}], "]"}]}],
             "]"}]}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Graphics`PlotMarkers", "[", "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"shapeN", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             "size"}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p5d", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myAvgGreenis", ",", "mySizes"}], "}"}], "//", 
       "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"p5", "=", 
      RowBox[{"p5d", "//", 
       RowBox[{
        RowBox[{"ListLogLogPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
          RowBox[{"PlotLabel", "->", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"column", "\[Equal]", "5"}], ",", "\"\<Blue\>\"", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"column", "\[Equal]", "4"}], ",", "\"\<Green\>\"", 
                ",", "\"\<Red\>\""}], "]"}]}], "]"}], "<>", 
            "\"\< Size vs. Green Int'n Time\>\""}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Avg. green int'n time (frames)\>\"", ",", " ", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"column", "\[Equal]", "5"}], ",", "\"\<Blue\>\"", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"column", "\[Equal]", "4"}], ",", "\"\<Green\>\"", 
                  ",", "\"\<Red\>\""}], "]"}]}], "]"}], "<>", 
              "\"\< size (pixels)\>\""}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"column", "\[Equal]", "5"}], ",", "Cyan", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"column", "\[Equal]", "4"}], ",", "Green", ",", 
               RowBox[{"Darker", "[", 
                RowBox[{"Yellow", ",", "0.13"}], "]"}]}], "]"}]}], "]"}]}], 
          ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Graphics`PlotMarkers", "[", "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"shapeN", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             "size"}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p6d", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"myAvgBlueis", ",", "mySizes"}], "}"}], "//", "Transpose"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"p6", "=", 
      RowBox[{"p6d", "//", 
       RowBox[{
        RowBox[{"ListLogLogPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
          RowBox[{"PlotLabel", "->", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"column", "\[Equal]", "5"}], ",", "\"\<Blue\>\"", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"column", "\[Equal]", "4"}], ",", "\"\<Green\>\"", 
                ",", "\"\<Red\>\""}], "]"}]}], "]"}], "<>", 
            "\"\< Size vs. Blue Int'n Time\>\""}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Avg. blue int'n time (frames)\>\"", ",", " ", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"column", "\[Equal]", "5"}], ",", "\"\<Blue\>\"", ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"column", "\[Equal]", "4"}], ",", "\"\<Green\>\"", 
                  ",", "\"\<Red\>\""}], "]"}]}], "]"}], "<>", 
              "\"\< size (pixels)\>\""}]}], "}"}]}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"column", "\[Equal]", "5"}], ",", "Blue", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"column", "\[Equal]", "4"}], ",", "Cyan", ",", 
               "Purple"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Graphics`PlotMarkers", "[", "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"shapeN", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             "size"}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"p7", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"MovingAverage", "[", 
           RowBox[{"#", ",", "3"}], "]"}], "&"}], "/@", 
         RowBox[{"ca", "[", 
          RowBox[{"[", 
           RowBox[{"goodi", ",", "All", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"column", "\[Equal]", "5"}], ",", "8", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"column", "\[Equal]", "4"}], ",", "7", ",", "6"}], 
               "]"}]}], "]"}]}], "]"}], "]"}]}], ")"}], "//", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", 
          RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", 
           RowBox[{"\"\<Size of Tracked \>\"", "<>", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"column", "\[Equal]", "5"}], ",", "\"\<Blue\>\"", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"column", "\[Equal]", "4"}], ",", "\"\<Green\>\"", 
                ",", "\"\<Red\>\""}], "]"}]}], "]"}], "<>", 
            "\"\< Clusters\>\""}]}], ",", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Time (frames)\>\"", ",", "\"\<Size (pixels)\>\""}], 
            "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Graphics`PlotMarkers", "[", "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{"shapeN", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             "size"}], "}"}]}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"column", "\[Equal]", "5"}], ",", 
       RowBox[{"p6", "=", "p7"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"column", "\[Equal]", "4"}], ",", 
         RowBox[{"p5", "=", "p7"}], ",", 
         RowBox[{"p4", "=", "p7"}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"redis", "//", "Flatten"}], "//", 
        RowBox[{
         RowBox[{"HistogramList", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", "10", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Log\>\"", ",", "\"\<Probability\>\""}], "}"}]}], 
          "]"}], "&"}]}], ",", 
       RowBox[{
        RowBox[{"greenis", "//", "Flatten"}], "//", 
        RowBox[{
         RowBox[{"HistogramList", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", "10", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Log\>\"", ",", "\"\<Probability\>\""}], "}"}]}], 
          "]"}], "&"}]}], ",", 
       RowBox[{
        RowBox[{"blueis", "//", "Flatten"}], "//", 
        RowBox[{
         RowBox[{"HistogramList", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", "10", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Log\>\"", ",", "\"\<Probability\>\""}], "}"}]}], 
          "]"}], "&"}]}], ",", "p4d", ",", "p5d", ",", "p6d", ",", "p1", ",", 
       "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7148663589136086`*^9, 3.714866399161956*^9}, {
   3.714866711895192*^9, 3.714866780691734*^9}, {3.7148668121412334`*^9, 
   3.7148668689354105`*^9}, {3.714866956679863*^9, 3.7148669795672345`*^9}, {
   3.7148670108684216`*^9, 3.714867026879645*^9}, {3.7148672661030645`*^9, 
   3.7148673153978496`*^9}, {3.714867371600808*^9, 3.7148673731272197`*^9}, {
   3.7148674109306126`*^9, 3.7148674852717037`*^9}, {3.714867525914439*^9, 
   3.7148676032245636`*^9}, {3.7148676788210187`*^9, 3.714867693828062*^9}, {
   3.7148678547763624`*^9, 3.714867939709343*^9}, {3.714869097125493*^9, 
   3.714869161492153*^9}, {3.7148692193133345`*^9, 3.7148692778306665`*^9}, {
   3.7148693144624586`*^9, 3.7148693660649257`*^9}, {3.7148694246534843`*^9, 
   3.7148694768953123`*^9}, {3.714869510657062*^9, 3.7148696619457407`*^9}, {
   3.7148697003228264`*^9, 3.714869701715408*^9}, {3.7148698800622215`*^9, 
   3.71486989951765*^9}, {3.714869987827759*^9, 3.714870005652917*^9}, {
   3.714870099419832*^9, 3.7148701223276515`*^9}, {3.714870159037259*^9, 
   3.714870247192369*^9}, {3.714870483755911*^9, 3.714870510033523*^9}, {
   3.714870615162213*^9, 3.714870689770999*^9}, {3.7148709149804387`*^9, 
   3.7148709519475393`*^9}, {3.714871003027008*^9, 3.714871088299404*^9}, {
   3.714871181299794*^9, 3.71487119821546*^9}, {3.7148712445910754`*^9, 
   3.7148712673896213`*^9}, {3.7148716312980437`*^9, 3.714871683696317*^9}, {
   3.714872755478606*^9, 3.714872795109131*^9}, {3.7148728792573404`*^9, 
   3.714872951979105*^9}, {3.7148729841333036`*^9, 3.7148730041631365`*^9}, {
   3.714873119612674*^9, 3.714873120192691*^9}, {3.7148732050108237`*^9, 
   3.7148732138892107`*^9}, {3.7148732504872637`*^9, 
   3.7148732556885395`*^9}, {3.714873306242494*^9, 3.7148733406025476`*^9}, {
   3.71487337653651*^9, 3.7148733786116543`*^9}, {3.7148734690195*^9, 
   3.714873471258546*^9}, {3.714876048890197*^9, 3.714876059124128*^9}, {
   3.714876121842641*^9, 3.714876122281663*^9}, 3.716994438408414*^9, {
   3.7169945148656673`*^9, 3.716994515203226*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"3b8039fd-3356-45f0-93d1-c0a01421ab38"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyMSDPlotter[myColorParameter_,color_]", "Subsection",
 CellChangeTimes->{{3.7033634332791195`*^9, 3.703363436122175*^9}, 
   3.7033635200950136`*^9},ExpressionUUID->"98210668-a556-466f-9d3b-\
c3a718135c27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyMSDPlotter", "[", 
   RowBox[{"myColorParameter_", ",", "color_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"msds", ",", "p1", ",", "p2", ",", "poz"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mycol", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"color", "\[Equal]", "\"\<Red\>\""}], "||", 
         RowBox[{"color", "\[Equal]", "\"\<Darker[Yellow,0.2]\>\""}], "||", 
         RowBox[{"color", "\[Equal]", "\"\<Purple\>\""}], "||", 
         RowBox[{"color", "\[Equal]", "\"\<White\>\""}]}], ",", "13", ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"color", "\[Equal]", "\"\<Green\>\""}], "||", 
           RowBox[{"color", "\[Equal]", "\"\<Cyan\>\""}]}], ",", "15", ",", 
          "17"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"myColorParameter", "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"msds", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"poz", "=", 
             RowBox[{"myColorParameter", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", 
                RowBox[{"1", ";;", "All"}], ",", 
                RowBox[{"mycol", ";;", 
                 RowBox[{"mycol", "+", "1"}]}]}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Mean", "[", 
               RowBox[{"Total", "/@", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Differences", "[", 
                    RowBox[{"#", ",", "1", ",", "i"}], "]"}], "&"}], "@", 
                   "poz"}], ")"}], "2"]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "poz", "]"}], "-", "1"}]}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "myColorParameter", "]"}], ",", "1"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p1", "=", 
         RowBox[{
          RowBox[{"msds", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "All"}], "]"}], "]"}], "//", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Frame #\>\"", ",", 
                "\"\<MSD (\!\(\*SuperscriptBox[\(pix\), \(2\)]\))\>\""}], 
               "}"}]}], ",", 
             RowBox[{"BaseStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
                RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}]}], "]"}], 
           "&"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"p2", "=", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"msds", ",", 
                RowBox[{"x_", "/;", 
                 RowBox[{
                  RowBox[{"Length", "[", "x", "]"}], ">", "i"}]}]}], "]"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"1", ";;", "All"}], ",", "i"}], 
              "\[RightDoubleBracket]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
               RowBox[{"Max", "@", 
                RowBox[{"(", 
                 RowBox[{"Length", "/@", "msds"}], ")"}]}], "/", "2"}], ",", 
              "1"}], "}"}]}], "]"}], "//", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotTheme", "\[Rule]", "\"\<Detailed\>\""}], ",", 
             RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
             RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
             RowBox[{"FrameLabel", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Frame #\>\"", ",", 
                "\"\<MSD (\!\(\*SuperscriptBox[\(pix\), \(2\)]\))\>\""}], 
               "}"}]}], ",", 
             RowBox[{"BaseStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}], ",", 
                RowBox[{"FontSize", "\[Rule]", "12"}]}], "}"}]}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"ToExpression", "[", "color", "]"}]}]}], "]"}], 
           "&"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"p2", ",", "p1"}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7033633976363707`*^9, 3.7033634043065166`*^9}, {
   3.7033634446063566`*^9, 3.703363494452468*^9}, {3.7033635582688527`*^9, 
   3.7033635793863087`*^9}, {3.703363719328355*^9, 3.7033638044862194`*^9}, {
   3.7088575637578373`*^9, 3.7088576490150914`*^9}, 3.708857830351329*^9, {
   3.708857923733378*^9, 3.7088579251766176`*^9}, {3.708858271321045*^9, 
   3.7088583576365824`*^9}, {3.7088584038471575`*^9, 3.708858502638214*^9}, {
   3.708858582381677*^9, 3.708858630781037*^9}, {3.7088586952449894`*^9, 
   3.7088587157962065`*^9}, {3.708858994354885*^9, 3.708858994964552*^9}, {
   3.708859280523344*^9, 3.7088592855260754`*^9}, {3.708859617696069*^9, 
   3.708859639859785*^9}, {3.7088596820381384`*^9, 3.708859701508578*^9}, {
   3.7088597351643853`*^9, 3.70885977992908*^9}, {3.7088598123956695`*^9, 
   3.7088598133515635`*^9}, 3.7088633626552286`*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"f080d4e2-9682-4fd5-a5f8-6c42ed499483"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.708859809880732*^9},
 CellLabel->"In[60]:=",ExpressionUUID->"a1fe6c81-d9c7-4688-8ae6-3c1133c54371"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
My3DImager[dir_, fileNameHead_, myt_, myx_, myy_, myc_, dimxy_, dz_, rangez_] \
dz in nanometers, assuming pixels are 130 nm\
\>", "Subsection",
 CellChangeTimes->{{3.702597482382226*^9, 
  3.7025975603424044`*^9}},ExpressionUUID->"82b73e89-3e04-4197-b14c-\
d1cb718fe1bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"My3DImager", "[", 
   RowBox[{
   "dir_", ",", "fileNameHead_", ",", "myt_", ",", "myx_", ",", "myy_", ",", 
    "myc_", ",", "dimxy_", ",", "dz_", ",", "rangez_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"myImg3D", ",", "myGrid"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myImg3D", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ImageTrim", "[", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{
            "dir", "<>", "\"\<\\\\\>\"", "<>", "fileNameHead", "<>", 
             "\"\<_t\>\"", "<>", 
             RowBox[{"MyNumString", "[", 
              RowBox[{"myt", ",", "3"}], "]"}], "<>", "\"\<_z\>\"", "<>", 
             RowBox[{"MyNumString", "[", 
              RowBox[{"myz", ",", "3"}], "]"}], "<>", "\"\<_c\>\"", "<>", 
             RowBox[{"MyNumString", "[", 
              RowBox[{"myc", ",", "3"}], "]"}], "<>", "\"\<.tif\>\""}], "]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"myx", "-", "dimxy"}], ",", 
               RowBox[{"myy", "-", "dimxy"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"myx", "+", "dimxy"}], ",", 
               RowBox[{"myy", "+", "dimxy"}]}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"myz", ",", 
           RowBox[{
           "rangez", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", 
           RowBox[{
           "rangez", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           ",", "1"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Image3D", "[", 
         RowBox[{"#", ",", 
          RowBox[{"ColorFunction", "\[Rule]", "\"\<XRay\>\""}], ",", 
          RowBox[{"Background", "\[Rule]", "Black"}], ",", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1.3", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "dimxy"}], "+", "1"}], ")"}]}], ",", 
             RowBox[{"1.3", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "dimxy"}], "+", "1"}], ")"}]}], ",", 
             RowBox[{"5", "*", "dimz"}]}], "}"}]}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myGrid", "=", 
      RowBox[{"Grid", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"myImg3D", "//", 
               RowBox[{
                RowBox[{"Image3DProjection", "[", 
                 RowBox[{"#", ",", "\"\<YZ\>\""}], "]"}], "&"}]}], "//", 
              "ImageAdjust"}], "//", 
             RowBox[{
              RowBox[{"ImageResize", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1.3", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "dimxy"}], "+", "1"}], ")"}]}], ",", 
                  RowBox[{"5", "*", "dimz"}]}], "}"}]}], "]"}], "&"}]}], "//", 
            RowBox[{
             RowBox[{"ImageRotate", "[", 
              RowBox[{"#", ",", 
               RowBox[{
                RowBox[{"-", "\[Pi]"}], "/", "2"}]}], "]"}], "&"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"myImg3D", "//", 
              RowBox[{
               RowBox[{"Image3DProjection", "[", 
                RowBox[{"#", ",", "\"\<XY\>\""}], "]"}], "&"}]}], "//", 
             "ImageAdjust"}], "//", 
            RowBox[{
             RowBox[{"ImageResize", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1.3", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", "dimxy"}], "+", "1"}], ")"}]}], ",", 
                 RowBox[{"1.3", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", " ", "dimxy"}], " ", "+", "1"}], ")"}]}]}], 
                " ", "}"}]}], "]"}], "&"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"myImg3D", "//", 
               RowBox[{
                RowBox[{"Image3DProjection", "[", 
                 RowBox[{"#", ",", "\"\<XZ\>\""}], "]"}], "&"}]}], "//", 
              "ImageAdjust"}], "//", 
             RowBox[{
              RowBox[{"ImageResize", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"1.3", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "dimxy"}], "+", "1"}], ")"}]}], ",", 
                  RowBox[{"5", "*", "dimz"}]}], "}"}]}], "]"}], "&"}]}], "//", 
            RowBox[{
             RowBox[{"ImageReflect", "[", 
              RowBox[{"#", ",", 
               RowBox[{"Left", "\[Rule]", "Right"}]}], "]"}], "&"}]}]}], 
          "}"}]}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7025966134765973`*^9, 3.7025967014998627`*^9}, {
  3.7025968024916396`*^9, 3.702596806741683*^9}, {3.702596871519726*^9, 
  3.702596882303732*^9}, {3.702597085170679*^9, 3.702597102280223*^9}, {
  3.70259718262298*^9, 3.7025971948978977`*^9}, {3.7025972506998143`*^9, 
  3.7025972635593166`*^9}, {3.702597298754261*^9, 3.7025973357679443`*^9}, {
  3.7026437600039062`*^9, 3.702643773139658*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"44ef4ac3-e13c-4656-8cbe-1c69c15e13eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"My3DImagerRaw", "[", 
   RowBox[{
   "dir_", ",", "fileNameHead_", ",", "myt_", ",", "myx_", ",", "myy_", ",", 
    "myc_", ",", "dimxy_", ",", "dz_", ",", "rangez_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"myImg3D", ",", "myGrid"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"myImg3D", "=", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ImageTrim", "[", 
         RowBox[{
          RowBox[{"Import", "[", 
           RowBox[{
           "dir", "<>", "\"\<\\\\\>\"", "<>", "fileNameHead", "<>", 
            "\"\<_t\>\"", "<>", 
            RowBox[{"MyNumString", "[", 
             RowBox[{"myt", ",", "3"}], "]"}], "<>", "\"\<_z\>\"", "<>", 
            RowBox[{"MyNumString", "[", 
             RowBox[{"myz", ",", "3"}], "]"}], "<>", "\"\<_c\>\"", "<>", 
            RowBox[{"MyNumString", "[", 
             RowBox[{"myc", ",", "3"}], "]"}], "<>", "\"\<.tif\>\""}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"myx", "-", "dimxy"}], ",", 
              RowBox[{"myy", "-", "dimxy"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"myx", "+", "dimxy"}], ",", 
              RowBox[{"myy", "+", "dimxy"}]}], "}"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"myz", ",", 
          RowBox[{
          "rangez", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{
          "rangez", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          ",", "1"}], "}"}]}], "]"}], "//", 
      RowBox[{
       RowBox[{"Image3D", "[", 
        RowBox[{"#", ",", 
         RowBox[{"ColorFunction", "\[Rule]", "\"\<XRay\>\""}], ",", 
         RowBox[{"Background", "\[Rule]", "Black"}], ",", 
         RowBox[{"BoxRatios", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1.3", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "dimxy"}], "+", "1"}], ")"}]}], ",", 
            RowBox[{"1.3", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "dimxy"}], "+", "1"}], ")"}]}], ",", 
            RowBox[{"5", "*", "dimz"}]}], "}"}]}]}], "]"}], "&"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7025966134765973`*^9, 3.7025967014998627`*^9}, {
   3.7025968024916396`*^9, 3.702596806741683*^9}, {3.702596871519726*^9, 
   3.702596882303732*^9}, {3.702597085170679*^9, 3.702597102280223*^9}, {
   3.70259718262298*^9, 3.7025971948978977`*^9}, {3.7025972506998143`*^9, 
   3.7025972635593166`*^9}, {3.702597298754261*^9, 3.7025973357679443`*^9}, {
   3.702604441189641*^9, 3.7026044659555087`*^9}, {3.702643792443762*^9, 
   3.702643796370987*^9}, 3.702644225862552*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"68d1159a-88e4-46ba-9347-ccb34350f301"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyAutoCorrelate[list]", "Subsection",
 CellChangeTimes->{{3.7150441741339645`*^9, 3.715044176770223*^9}, {
  3.715049716751989*^9, 
  3.7150497209256177`*^9}},ExpressionUUID->"3251f51f-4997-47db-950b-\
c7108a395b32"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ml", "=", 
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c", ",", "d", ",", "e"}], "}"}]}], ";", 
  RowBox[{"ListCorrelate", "[", 
   RowBox[{"ml", ",", "ml", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.715043668097666*^9, 3.7150436851108894`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"7cdbab8f-98d6-4d81-b005-66f32ca9a881"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["a", "2"], "+", 
    SuperscriptBox["b", "2"], "+", 
    SuperscriptBox["c", "2"], "+", 
    SuperscriptBox["d", "2"], "+", 
    SuperscriptBox["e", "2"]}], ",", 
   RowBox[{
    RowBox[{"a", " ", "b"}], "+", 
    RowBox[{"b", " ", "c"}], "+", 
    RowBox[{"c", " ", "d"}], "+", 
    RowBox[{"d", " ", "e"}]}], ",", 
   RowBox[{
    RowBox[{"a", " ", "c"}], "+", 
    RowBox[{"b", " ", "d"}], "+", 
    RowBox[{"c", " ", "e"}]}], ",", 
   RowBox[{
    RowBox[{"a", " ", "d"}], "+", 
    RowBox[{"b", " ", "e"}]}], ",", 
   RowBox[{"a", " ", "e"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7150436856968913`*^9, 3.7151965389798203`*^9, 3.7170055251262164`*^9, 
   3.7171698264285097`*^9, 3.717286240305153*^9, 3.717762216241936*^9, 
   3.7177657327574053`*^9, 3.717850388526904*^9, 3.7178650091883335`*^9, 
   3.718825042196524*^9, 3.718890742885953*^9, 3.721693981560832*^9, 
   3.721694578092947*^9, 3.7217022335886536`*^9, 3.722796246723682*^9, 
   3.722812518346964*^9, 3.722874813975237*^9, 3.7228772791639004`*^9, 
   3.722880260225901*^9, 3.722957949120313*^9, 3.7229596095228205`*^9, 
   3.722960405982554*^9, 3.722966880170441*^9, 3.7229681987274594`*^9, 
   3.7229686989966555`*^9, 3.7229687606906447`*^9, {3.7229692262918243`*^9, 
   3.7229692323393354`*^9}, 3.7229694667085404`*^9, 3.722974874052753*^9, 
   3.722975916969576*^9, 3.722976425726266*^9, 3.723314341545073*^9, 
   3.724530493933852*^9, 3.736260411773969*^9, 3.7367711451105433`*^9, 
   3.737136196038212*^9, 3.737136293831121*^9, 3.7372116071433287`*^9, 
   3.73790476095438*^9, {3.74620382755455*^9, 3.746203852381907*^9}, 
   3.746712624048295*^9, 3.747406019752819*^9, {3.7474073502790833`*^9, 
   3.747407363692069*^9}, 3.7474080376072702`*^9, 3.747412987043189*^9, 
   3.747417307664221*^9, 3.747420197249509*^9, 3.747496812305406*^9, 
   3.747511658831736*^9, 3.747530013283349*^9, 3.747583121297077*^9, 
   3.747659034125161*^9, 3.748022840096887*^9, 3.7480524313748493`*^9, 
   3.748136037595374*^9, 3.74852682403417*^9, 3.752365283310423*^9, 
   3.752457259130589*^9, 3.756600740240803*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"828d2d82-f87e-4666-946c-a5e2a916149c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyAutoCorrelate", "[", "list_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     FractionBox["1", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"Mean", "[", "list", "]"}], ")"}], "2"]], 
     RowBox[{"ListCorrelate", "[", 
      RowBox[{
       RowBox[{"list", "-", 
        RowBox[{"Mean", "[", "list", "]"}]}], ",", 
       RowBox[{"list", "-", 
        RowBox[{"Mean", "[", "list", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", "0"}], "]"}], " ", 
     RowBox[{"Reverse", "[", 
      RowBox[{"1", "/", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "list", "]"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.715043726410861*^9, 3.7150437671157713`*^9}, {
  3.7150438183203297`*^9, 3.715043846820463*^9}, {3.715043885145093*^9, 
  3.7150438902197905`*^9}, {3.7150440093059425`*^9, 3.7150440133438544`*^9}, {
  3.715044064493587*^9, 3.715044088671769*^9}, {3.7150441424591384`*^9, 
  3.7150441475632544`*^9}, {3.7150442922709064`*^9, 3.715044294722311*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"546fea86-4971-45f1-872b-d275d1861de4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyAutoCorrelate", "[", "ml", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.715043864600862*^9, 3.715043869995079*^9}, 
   3.715044153671643*^9},
 CellLabel->"In[65]:=",ExpressionUUID->"a6f7404f-f4b3-4994-8d27-218f87d32ef1"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Analysis", "Section",
 CellChangeTimes->{{3.6483041433283873`*^9, 
  3.6483041519288793`*^9}},ExpressionUUID->"3a221e5b-3b24-4968-bc89-\
9cd3c6343234"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Reading in Images ",
 FontColor->RGBColor[0, 0, 1]]], "Subsection",
 CellChangeTimes->{{3.5831236302316623`*^9, 3.5831236326916656`*^9}, {
   3.6097111426870265`*^9, 3.6097111439581537`*^9}, {3.6422513183492937`*^9, 
   3.642251333965187*^9}, {3.6783136569918723`*^9, 3.6783136621191654`*^9}, 
   3.678316094481289*^9},ExpressionUUID->"ba88c470-c371-4902-8e1b-\
8069f85d0586"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"FileNameSetter", "[", 
    RowBox[{"Dynamic", "[", "mymoviefile", "]"}], "]"}], ",", 
   RowBox[{"Dynamic", "[", "mymoviefile", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.651503548625061*^9, 3.651503549729124*^9}, {
  3.6515036971455555`*^9, 3.6515037273852854`*^9}, {3.6515038052497387`*^9, 
  3.651503807864888*^9}, {3.6515048066830177`*^9, 3.6515048169146028`*^9}, {
  3.6515052946509275`*^9, 3.651505295114954*^9}, {3.6515053260127215`*^9, 
  3.651505326890772*^9}, {3.651521020023368*^9, 3.651521093823589*^9}, {
  3.747407718291576*^9, 3.747407721534466*^9}},
 CellLabel->
  "In[842]:=",ExpressionUUID->"b3c6f0f4-9a0a-48b8-a087-285b6a7482a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{Dynamic[$CellContext`mymoviefile],"Open",All},
    "FileNameSetterBoxes"], ",", 
   DynamicBox[ToBoxes[$CellContext`mymoviefile, StandardForm],
    ImageSizeCache->{561., {3., 7.}}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.747407467966155*^9, {3.7474077390353727`*^9, 3.747407749435337*^9}, 
   3.7474173041720047`*^9, 3.747496808184731*^9, 3.747502002807933*^9, 
   3.747503175592581*^9, 3.747504840649027*^9, 3.74751165594237*^9, 
   3.747511825471712*^9, 3.747512983066045*^9, 3.747514385039235*^9, {
   3.747515501395771*^9, 3.7475155033804407`*^9}, 3.7475156280040207`*^9, 
   3.7475187162918587`*^9, 3.747530189910252*^9, 3.747530220674148*^9, 
   3.74753178117185*^9, 3.7475337365645247`*^9, 3.747534015088048*^9, 
   3.747537356461973*^9, 3.747537403705763*^9, 3.747539136350272*^9, 
   3.747583139138094*^9, 3.7475844122602787`*^9, 3.7475881893688087`*^9, 
   3.7475984248374968`*^9, 3.747659035787678*^9, 3.747663553257864*^9, 
   3.747663683787064*^9, 3.7476723599789963`*^9, 3.748022870462893*^9, 
   3.748023378114555*^9, 3.748052428610783*^9, 3.748053656244009*^9, 
   3.748053722311316*^9, 3.7480889518340397`*^9, 3.74813604843887*^9, 
   3.748137575808852*^9, 3.748139048369595*^9, 3.7485268282318697`*^9, 
   3.748526861678215*^9, 3.748529195620862*^9, 3.748530575060831*^9, 
   3.74853448631478*^9, 3.748538925328539*^9, 3.748543366413919*^9, 
   3.748544399656329*^9, 3.752457376075933*^9, 3.752458461919031*^9, 
   3.7524585516471777`*^9, 3.752459493409368*^9, 3.752460280536244*^9, 
   3.752461147949587*^9, 3.752462086567933*^9, 3.756600686910905*^9, 
   3.75660173159135*^9, 3.756601988191238*^9, 3.756602133866219*^9, 
   3.7566023172871847`*^9, 3.7566024898500443`*^9, 3.75660264480042*^9, 
   3.7566033300758543`*^9, 3.756603545454811*^9, 3.756603707702387*^9, 
   3.756603921052003*^9, 3.756604137596443*^9, 3.756604481932912*^9, 
   3.756604677054867*^9, 3.756604821881513*^9, 3.756605014085775*^9, 
   3.756605157221277*^9, 3.7566054081609983`*^9, 3.756605577468039*^9, 
   3.7566081517913446`*^9, 3.7566084614217167`*^9, 3.756608642624371*^9, 
   3.756608836405764*^9, 3.756609028045497*^9, 3.756609382213204*^9, 
   3.756609579750902*^9, 3.756609747551263*^9, 3.756610018681538*^9, 
   3.756610180032638*^9, 3.756610405136471*^9, 3.756610552336082*^9, 
   3.756610668149219*^9, 3.7566108024972973`*^9, 3.756611085265378*^9, 
   3.7566112730295553`*^9, 3.756611431996191*^9},
 CellLabel->
  "Out[842]=",ExpressionUUID->"a453ef81-15c6-4e2a-960d-6fbdb163fd2b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mymoviefile", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringTake", "[", 
       RowBox[{
        RowBox[{"FileBaseName", "[", "mymoviefile", "]"}], ",", "4"}], "]"}], 
      "\[Equal]", "\"\<AVG_\>\""}], ",", 
     RowBox[{"StringReplace", "[", 
      RowBox[{"mymoviefile", ",", 
       RowBox[{"\"\<AVG_\>\"", "\[Rule]", "\"\<\>\""}]}], "]"}], ",", 
     "mymoviefile"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7474077127293587`*^9, 3.747407715126721*^9}, {
  3.7474079128868647`*^9, 3.747407918339115*^9}},
 CellLabel->
  "In[843]:=",ExpressionUUID->"84568daa-98a4-4e27-8788-55b3fbda201d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myColMovie", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Import", "[", "mymoviefile", "]"}], "//", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", "3"}], "]"}], "&"}]}], "//", "Transpose"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"analysisFolder", "=", 
     RowBox[{
      RowBox[{"DirectoryName", "[", "mymoviefile", "]"}], "<>", 
      "\"\<Analysis/\>\"", "<>", 
      RowBox[{"StringDrop", "[", 
       RowBox[{
        RowBox[{"StringDelete", "[", 
         RowBox[{"mymoviefile", ",", 
          RowBox[{"DirectoryName", "[", "mymoviefile", "]"}]}], "]"}], ",", 
        RowBox[{"-", "4"}]}], "]"}]}]}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{"Use", " ", "this", " ", "for", " ", "a", " ", "mac"}], " ", 
    ";"}], ")"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.747407896555244*^9, 3.7474079240544863`*^9}},
 CellLabel->
  "In[844]:=",ExpressionUUID->"da217a5f-cbcd-49a2-aa60-37ad8ef316e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myColMovie", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Import", "[", "mymoviefile", "]"}], "//", 
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"#", ",", "3"}], "]"}], "&"}]}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"analysisFolder", "=", 
   RowBox[{
    RowBox[{"DirectoryName", "[", "mymoviefile", "]"}], "<>", 
    "\"\<Analysis/\>\"", "<>", 
    RowBox[{"StringDrop", "[", 
     RowBox[{
      RowBox[{"StringDelete", "[", 
       RowBox[{"mymoviefile", ",", 
        RowBox[{"DirectoryName", "[", "mymoviefile", "]"}]}], "]"}], ",", 
      RowBox[{"-", "4"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6515063970679827`*^9, 3.651506411178789*^9}, {
   3.6515066477483206`*^9, 3.6515066488673844`*^9}, {3.6515067054626217`*^9, 
   3.6515067061716623`*^9}, {3.6515265140116053`*^9, 3.651526514107611*^9}, {
   3.6783130580806165`*^9, 3.6783130585136414`*^9}, 3.723314398460951*^9, {
   3.747407724313442*^9, 3.747407735026651*^9}},
 CellLabel->
  "In[845]:=",ExpressionUUID->"5ce07a94-a438-44af-bee4-ea6834bb68c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Determine ROI", "Subsection",
 CellChangeTimes->{{3.678650616049817*^9, 3.6786506203690643`*^9}, {
  3.678650695665371*^9, 3.678650698023505*^9}, {3.7029286067245507`*^9, 
  3.702928608107577*^9}, {3.747407275130247*^9, 3.7474072764352016`*^9}, {
  3.747515546643601*^9, 
  3.747515554772488*^9}},ExpressionUUID->"c51f2ed7-62e2-4a00-b383-\
f12ba16af33f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mymovie", " ", "=", " ", 
   RowBox[{"Import", "[", "mymoviefile", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.747407692882972*^9, 3.7474076951945333`*^9}, {
  3.747407933326687*^9, 3.7474079485727377`*^9}},
 CellLabel->
  "In[847]:=",ExpressionUUID->"871b832f-b66c-4d98-a62f-6c5f18668b2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ch1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageSubtract", "[", 
      RowBox[{"#", ",", 
       RowBox[{"500", "/", 
        SuperscriptBox["2", "16"]}]}], "]"}], "&"}], "/@", 
    RowBox[{"mymovie", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "All", ";;", "3"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ch2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageSubtract", "[", 
      RowBox[{"#", ",", 
       RowBox[{"500", "/", 
        SuperscriptBox["2", "16"]}]}], "]"}], "&"}], "/@", 
    RowBox[{"mymovie", "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;", "All", ";;", "3"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ch3", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ImageSubtract", "[", 
      RowBox[{"#", ",", 
       RowBox[{"500", "/", 
        SuperscriptBox["2", "16"]}]}], "]"}], "&"}], "/@", 
    RowBox[{"mymovie", "[", 
     RowBox[{"[", 
      RowBox[{"3", ";;", "All", ";;", "3"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myColCombMov", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ColorCombine", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ch1", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"ch2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"ch3", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "ch1", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.747407634903091*^9, 3.747407657541966*^9}, {
  3.747407974217367*^9, 3.747407980880207*^9}, {3.747408011686853*^9, 
  3.747408012081394*^9}},
 CellLabel->
  "In[848]:=",ExpressionUUID->"ddcb7aa2-8919-4c4c-9e1a-ef31d345e63b"],

Cell["\<\
***If you have trouble with the myROI, a possible solution is that you \
already have a data file with the same name... 
***Try deleting the file manually in file explorer and shift+enter the myROI \
code again\
\>", "Text",
 CellChangeTimes->{{3.747360815884214*^9, 
  3.747360867229609*^9}},ExpressionUUID->"99bed588-3034-447b-922c-\
addbb7ee5f66"],

Cell[BoxData[
 RowBox[{"MyROI", "[", 
  RowBox[{"myColCombMov", ",", 
   RowBox[{"analysisFolder", "<>", "\"\<_myROI.dat\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.74736058649921*^9, 3.7473606006752777`*^9}, {
  3.747360723083191*^9, 3.7473607237776814`*^9}, {3.747417323246407*^9, 
  3.747417323696965*^9}},
 CellLabel->
  "In[852]:=",ExpressionUUID->"53ef1dc3-23bd-4227-8f8c-4e0c3cb17578"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Show change in nuc/cyto signal, background subtracted, 1 cell\
\>", "Subsection",
 CellChangeTimes->{{3.678650616049817*^9, 3.6786506203690643`*^9}, {
  3.678650695665371*^9, 3.678650698023505*^9}, {3.7029286067245507`*^9, 
  3.702928608107577*^9}, {3.747407275130247*^9, 3.7474072764352016`*^9}, {
  3.7475155298151817`*^9, 3.747515533981523*^9}, {3.756642931151948*^9, 
  3.756642949664473*^9}},ExpressionUUID->"3d2ba228-e178-47c6-999f-\
7433ea4b06b0"],

Cell["\<\

***Import mask file:\
\>", "Text",
 CellChangeTimes->{{3.747358807604846*^9, 3.747358854932384*^9}, {
  3.747359061987955*^9, 
  3.7473590653964043`*^9}},ExpressionUUID->"520f76f0-2f84-4b28-9cdc-\
630e08b2ce7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mymaskfile", " ", "=", " ", 
   RowBox[{"<<", 
    RowBox[{"(", 
     RowBox[{"analysisFolder", "<>", "\"\<_myROI.dat\>\""}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.747360761309847*^9, 3.747360787071369*^9}, {
  3.747513759290778*^9, 3.747513760436648*^9}, {3.756602081745943*^9, 
  3.7566020824729757`*^9}},
 CellLabel->
  "In[867]:=",ExpressionUUID->"799d74b0-9bb7-4611-82a6-460622d6a194"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mymaskfile", "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "All", ",", "3"}], "]"}], "]"}], "//", 
  "Transpose"}]], "Input",
 CellChangeTimes->{3.756601347890225*^9},
 CellLabel->
  "In[868]:=",ExpressionUUID->"787b1de9-8a64-4202-a7f1-8ae164e32500"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"480.52395255699327`", ",", "471.9355576483251`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5039.815542205792`", ",", "3911.591192430154`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"765.6664356130623`", ",", "915.784564330239`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7566013483259773`*^9, 3.75660185519656*^9, 3.756602090729164*^9, 
   3.7566022715026817`*^9, {3.756602452199049*^9, 3.756602460634982*^9}, 
   3.7566025990386047`*^9, {3.756602807804104*^9, 3.756602814398748*^9}, 
   3.756602887480199*^9, 3.756603443739102*^9, 3.756603672790517*^9, 
   3.7566038916037703`*^9, 3.75660410465582*^9, 3.756604417562381*^9, 
   3.756604610315946*^9, 3.756604793057914*^9, {3.7566049310682383`*^9, 
   3.7566049537036963`*^9}, 3.756605137277563*^9, 3.756605376219077*^9, 
   3.7566055249570503`*^9, {3.756605736443861*^9, 3.756605763170534*^9}, 
   3.7566084058800173`*^9, 3.7566086030245667`*^9, 3.7566087938265133`*^9, 
   3.756608981875485*^9, 3.756609302048073*^9, 3.756609545385497*^9, 
   3.7566097230799522`*^9, 3.75660985173886*^9, 3.756609902257924*^9, 
   3.756609959204194*^9, 3.7566101415061197`*^9, 3.756610292163851*^9, 
   3.756610333853271*^9, 3.7566103738263474`*^9, 3.756610524490982*^9, 
   3.756610644401204*^9, 3.7566107655682783`*^9, 3.7566109038859663`*^9, {
   3.7566111912034597`*^9, 3.756611220026906*^9}, 3.756611252494087*^9, 
   3.756611389166712*^9, {3.756611535348866*^9, 3.7566115704086*^9}},
 CellLabel->
  "Out[868]=",ExpressionUUID->"83c01723-fffd-4953-a9e5-bb971fd68587"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"bkgGInt", " ", "=", " ", 
  RowBox[{"mymaskfile", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "All", ",", "3", ",", "2"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cytoGInt", " ", "=", " ", 
  RowBox[{"mymaskfile", "[", 
   RowBox[{"[", 
    RowBox[{"2", ",", "All", ",", "3", ",", "2"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"nucGInt", " ", "=", " ", 
  RowBox[{"mymaskfile", "[", 
   RowBox[{"[", 
    RowBox[{"3", ",", "All", ",", "3", ",", "2"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.756601463679564*^9, 3.756601516845582*^9}},
 CellLabel->
  "In[869]:=",ExpressionUUID->"c92094e2-c529-413f-863a-3c3f6b0962d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"546.3142340168878`", ",", "256.41556091676716`"}], "}"}]], "Output",
 CellChangeTimes->{{3.756601457907239*^9, 3.7566015173571253`*^9}, 
   3.7566018596918297`*^9, 3.7566020915823298`*^9, 3.756602272364468*^9, {
   3.756602452311842*^9, 3.756602460728239*^9}, 3.756602599134508*^9, {
   3.7566028079004517`*^9, 3.756602814473978*^9}, 3.756602887545532*^9, 
   3.7566034438180304`*^9, 3.756603672890822*^9, 3.756603891700273*^9, 
   3.7566041047272778`*^9, 3.7566044176483393`*^9, 3.756604610401709*^9, 
   3.75660479312647*^9, {3.756604931133396*^9, 3.756604953771645*^9}, 
   3.7566051373573103`*^9, 3.756605376296846*^9, 3.756605525057012*^9, {
   3.75660573652591*^9, 3.756605763245488*^9}, 3.756608405984378*^9, 
   3.756608603120117*^9, 3.7566087939152603`*^9, 3.756608981975307*^9, 
   3.7566093021456327`*^9, 3.756609545464205*^9, 3.7566097231674767`*^9, 
   3.756609851834094*^9, 3.7566099023442163`*^9, 3.756609959296359*^9, 
   3.756610141608535*^9, 3.756610292251111*^9, 3.756610333934116*^9, 
   3.756610373894413*^9, 3.756610524594124*^9, 3.756610644507793*^9, 
   3.7566107656718283`*^9, 3.756610903954471*^9, {3.7566111912567387`*^9, 
   3.7566112201088057`*^9}, 3.7566112525780687`*^9, 3.7566113892701893`*^9, {
   3.756611535431608*^9, 3.756611570470077*^9}},
 CellLabel->
  "Out[869]=",ExpressionUUID->"a5994bcd-0c02-4b9e-a183-a5054d4eea77"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5039.815542205792`", ",", "3911.591192430154`"}], "}"}]], "Output",
 CellChangeTimes->{{3.756601457907239*^9, 3.7566015173571253`*^9}, 
   3.7566018596918297`*^9, 3.7566020915823298`*^9, 3.756602272364468*^9, {
   3.756602452311842*^9, 3.756602460728239*^9}, 3.756602599134508*^9, {
   3.7566028079004517`*^9, 3.756602814473978*^9}, 3.756602887545532*^9, 
   3.7566034438180304`*^9, 3.756603672890822*^9, 3.756603891700273*^9, 
   3.7566041047272778`*^9, 3.7566044176483393`*^9, 3.756604610401709*^9, 
   3.75660479312647*^9, {3.756604931133396*^9, 3.756604953771645*^9}, 
   3.7566051373573103`*^9, 3.756605376296846*^9, 3.756605525057012*^9, {
   3.75660573652591*^9, 3.756605763245488*^9}, 3.756608405984378*^9, 
   3.756608603120117*^9, 3.7566087939152603`*^9, 3.756608981975307*^9, 
   3.7566093021456327`*^9, 3.756609545464205*^9, 3.7566097231674767`*^9, 
   3.756609851834094*^9, 3.7566099023442163`*^9, 3.756609959296359*^9, 
   3.756610141608535*^9, 3.756610292251111*^9, 3.756610333934116*^9, 
   3.756610373894413*^9, 3.756610524594124*^9, 3.756610644507793*^9, 
   3.7566107656718283`*^9, 3.756610903954471*^9, {3.7566111912567387`*^9, 
   3.7566112201088057`*^9}, 3.7566112525780687`*^9, 3.7566113892701893`*^9, {
   3.756611535431608*^9, 3.756611570483122*^9}},
 CellLabel->
  "Out[870]=",ExpressionUUID->"3e3829d6-ee5d-4f5d-8269-09bd91b91487"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7808.70911221799`", ",", "5356.586840347361`"}], "}"}]], "Output",
 CellChangeTimes->{{3.756601457907239*^9, 3.7566015173571253`*^9}, 
   3.7566018596918297`*^9, 3.7566020915823298`*^9, 3.756602272364468*^9, {
   3.756602452311842*^9, 3.756602460728239*^9}, 3.756602599134508*^9, {
   3.7566028079004517`*^9, 3.756602814473978*^9}, 3.756602887545532*^9, 
   3.7566034438180304`*^9, 3.756603672890822*^9, 3.756603891700273*^9, 
   3.7566041047272778`*^9, 3.7566044176483393`*^9, 3.756604610401709*^9, 
   3.75660479312647*^9, {3.756604931133396*^9, 3.756604953771645*^9}, 
   3.7566051373573103`*^9, 3.756605376296846*^9, 3.756605525057012*^9, {
   3.75660573652591*^9, 3.756605763245488*^9}, 3.756608405984378*^9, 
   3.756608603120117*^9, 3.7566087939152603`*^9, 3.756608981975307*^9, 
   3.7566093021456327`*^9, 3.756609545464205*^9, 3.7566097231674767`*^9, 
   3.756609851834094*^9, 3.7566099023442163`*^9, 3.756609959296359*^9, 
   3.756610141608535*^9, 3.756610292251111*^9, 3.756610333934116*^9, 
   3.756610373894413*^9, 3.756610524594124*^9, 3.756610644507793*^9, 
   3.7566107656718283`*^9, 3.756610903954471*^9, {3.7566111912567387`*^9, 
   3.7566112201088057`*^9}, 3.7566112525780687`*^9, 3.7566113892701893`*^9, {
   3.756611535431608*^9, 3.756611570493354*^9}},
 CellLabel->
  "Out[871]=",ExpressionUUID->"435f149f-74e2-4f79-9fad-cb84fccb9334"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myRatio", " ", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"nucGInt", "-", "bkgGInt"}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"cytoGInt", "-", "bkgGInt"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.756600969445778*^9, 3.756600993266961*^9}, {
  3.7566010258858147`*^9, 3.756601182276492*^9}, {3.7566012127290993`*^9, 
  3.756601335312808*^9}, {3.7566013771663857`*^9, 3.7566013896208572`*^9}, {
  3.756601443403082*^9, 3.75660144357421*^9}, {3.756601525513072*^9, 
  3.7566015775150547`*^9}},
 CellLabel->
  "In[872]:=",ExpressionUUID->"d29fbd7f-1d53-4b40-bb1b-52d7b629cafa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.6161995691346966`", ",", "1.3953286499994864`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.75660131091705*^9, 3.7566013356041613`*^9}, {
   3.756601380034564*^9, 3.756601389894163*^9}, 3.756601443896158*^9, {
   3.756601535022403*^9, 3.7566015777368937`*^9}, 3.756601861484593*^9, 
   3.7566020926995153`*^9, 3.756602275311002*^9, {3.756602452435766*^9, 
   3.756602460817944*^9}, 3.756602599253614*^9, {3.756602808040711*^9, 
   3.756602814556015*^9}, 3.756602887627636*^9, 3.756603443921824*^9, 
   3.756603673023074*^9, 3.756603891816429*^9, 3.7566041048274183`*^9, 
   3.756604417746509*^9, 3.756604610501318*^9, 3.7566047932089577`*^9, {
   3.756604931233584*^9, 3.7566049538885927`*^9}, 3.756605137457432*^9, 
   3.7566053763995113`*^9, 3.7566055251702423`*^9, {3.756605736634926*^9, 
   3.7566057633441963`*^9}, 3.756608406116683*^9, 3.7566086032536077`*^9, 
   3.756608794024952*^9, 3.756608982095083*^9, 3.756609302260211*^9, 
   3.756609545592442*^9, 3.7566097232849503`*^9, 3.7566098519499607`*^9, 
   3.756609902458632*^9, 3.756609959412779*^9, 3.756610141742073*^9, 
   3.756610292369162*^9, 3.756610334053431*^9, 3.7566103739759493`*^9, 
   3.756610524704886*^9, 3.756610644642826*^9, 3.75661076578765*^9, 
   3.7566109040363407`*^9, {3.756611191354824*^9, 3.7566112202038727`*^9}, 
   3.756611252694043*^9, 3.756611389400971*^9, {3.756611535537163*^9, 
   3.756611570553961*^9}},
 CellLabel->
  "Out[872]=",ExpressionUUID->"d4a5965e-935f-4e27-8951-694e8968882b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"myRatio", ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "6.5"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.756601189341354*^9, 3.7566011919561157`*^9}, {
  3.75660158632259*^9, 3.75660160505506*^9}, {3.756601951334468*^9, 
  3.756601957127078*^9}, {3.756602605757934*^9, 3.756602606008288*^9}, {
  3.756605530316873*^9, 3.756605537518429*^9}, {3.756608615135467*^9, 
  3.756608615536014*^9}},
 CellLabel->
  "In[873]:=",ExpressionUUID->"7e3575c9-2df9-4141-9811-a6fcb66b9260"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6], 
     LineBox[{{1., 1.6161995691346966`}, {2., 
      1.3953286499994864`}}]}}, {}, {}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 2.}, {0, 6.5}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.756605537949813*^9, {3.756605736737258*^9, 3.7566057634720907`*^9}, 
   3.75660840626565*^9, {3.7566086034434557`*^9, 3.756608615873232*^9}, 
   3.756608794141458*^9, 3.756608982221229*^9, 3.756609302442458*^9, 
   3.756609545742818*^9, 3.7566097234158688`*^9, 3.7566098520796824`*^9, 
   3.756609902577693*^9, 3.7566099595470877`*^9, 3.7566101419377413`*^9, 
   3.756610292547535*^9, 3.756610334183564*^9, 3.7566103740728073`*^9, 
   3.756610524817582*^9, 3.756610644779948*^9, 3.7566107658952637`*^9, 
   3.756610904159734*^9, {3.756611191450839*^9, 3.7566112203507442`*^9}, 
   3.756611252806538*^9, 3.756611389549506*^9, {3.756611535711725*^9, 
   3.756611570665073*^9}},
 CellLabel->
  "Out[873]=",ExpressionUUID->"098f9967-d643-48d2-ac67-ae3f71c12389"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Show change in nuc/cyto signal, background subtracted, all cells\
\>", "Subsection",
 CellChangeTimes->{{3.678650616049817*^9, 3.6786506203690643`*^9}, {
  3.678650695665371*^9, 3.678650698023505*^9}, {3.7029286067245507`*^9, 
  3.702928608107577*^9}, {3.747407275130247*^9, 3.7474072764352016`*^9}, {
  3.7475155298151817`*^9, 3.747515533981523*^9}, {3.756642931151948*^9, 
  3.7566429602970877`*^9}},ExpressionUUID->"adeccb3a-6a9f-4d00-a651-\
2ad94ebf2949"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.756642955563416*^9, 
  3.756642957778211*^9}},ExpressionUUID->"7f9bc9d9-ca1d-441c-9f29-\
f452e532a224"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"StringDrop", "[", 
  RowBox[{"analysisFolder", ",", 
   RowBox[{"-", "8"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.75661162463547*^9, 3.756611666603537*^9}},
 CellLabel->
  "In[877]:=",ExpressionUUID->"0d7b7665-b15b-4161-a0f4-c01a3856c400"],

Cell[BoxData["\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_\
TA_TL_NT_15h/4h_12h_only/Analysis/\"\>"], "Output",
 CellChangeTimes->{{3.756611657754356*^9, 3.756611666798424*^9}},
 CellLabel->
  "Out[877]=",ExpressionUUID->"79b1404e-f059-4866-90a2-ffa8fc4c018b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"filesNT", " ", "=", " ", 
  RowBox[{"FileNames", "[", 
   RowBox[{
    RowBox[{"StringDrop", "[", 
     RowBox[{"analysisFolder", ",", 
      RowBox[{"-", "8"}]}], "]"}], " ", "<>", " ", "\"\<*NT*ROI.dat\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"filesTA", " ", "=", " ", 
  RowBox[{"FileNames", "[", 
   RowBox[{
    RowBox[{"StringDrop", "[", 
     RowBox[{"analysisFolder", ",", 
      RowBox[{"-", "8"}]}], "]"}], " ", "<>", " ", "\"\<*TA*ROI.dat\>\""}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.756611703449287*^9, 3.7566117753660593`*^9}},
 CellLabel->
  "In[883]:=",ExpressionUUID->"f61fa399-7c87-400d-917c-b3e43f45de11"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_\
TL_NT_15h/4h_12h_only/Analysis/MAX_NT01_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT02_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT03_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT04_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT05_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT08_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT12_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT13_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT14_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT16_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT17_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT18_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT20_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT22_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT23_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT25_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT26_3cells_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_NT27_myROI.dat\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.756611719881341*^9, 3.756611775611764*^9}},
 CellLabel->
  "Out[883]=",ExpressionUUID->"4d7acab2-4dc2-4d3c-8c3a-ac7a9042d145"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_\
TL_NT_15h/4h_12h_only/Analysis/MAX_TA01_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA04_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA05_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA06_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA08_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA12_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA13_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA14_shitton_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA16_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA17_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA18_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA19_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA20_sick_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA21_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA22_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA25_myROI.dat\"\>", 
   ",", "\<\"/Volumes/BITTY/_long_timeframe_transient_mini/20181025_27_TA_TL_\
NT_15h/4h_12h_only/Analysis/MAX_TA28_myROI.dat\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.756611719881341*^9, 3.756611775623823*^9}},
 CellLabel->
  "Out[884]=",ExpressionUUID->"562291ff-e804-485b-8737-6c0c5da3d06f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mymaskfiles", "  ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"<<", 
      RowBox[{"(", 
       RowBox[{"filesNT", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", "filesNT"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "/@", "mymaskfiles"}], "\[IndentingNewLine]", 
 RowBox[{"bkgGInt", " ", "=", 
  RowBox[{"mymaskfiles", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "1", ",", 
     RowBox[{"1", ";;", "2"}], ",", "3", ",", "2"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cytoGInt", " ", "=", 
  RowBox[{"mymaskfiles", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "2", ",", 
     RowBox[{"1", ";;", "2"}], ",", "3", ",", "2"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"nucGInt", " ", "=", 
  RowBox[{"mymaskfiles", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "3", ",", 
     RowBox[{"1", ";;", "2"}], ",", "3", ",", "2"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.756612245564149*^9, 3.756612433464747*^9}, {
  3.756612476615491*^9, 3.756612562015809*^9}, {3.756612862978096*^9, 
  3.756612871565749*^9}, {3.756612953873321*^9, 3.756612967263844*^9}, {
  3.756613001779808*^9, 3.756613009791958*^9}, {3.75664299182766*^9, 
  3.7566429919862957`*^9}, {3.756643030371036*^9, 3.75664310556815*^9}, {
  3.756643186550128*^9, 3.7566431890175753`*^9}, {3.756644226260201*^9, 
  3.756644228632259*^9}},
 CellLabel->
  "In[1179]:=",ExpressionUUID->"55988fc3-aee7-4655-b948-fe849759c3e0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "30", ",", "30", ",", "30", ",", "30", ",", "30", ",", "30", ",", "30", ",",
    "30", ",", "30", ",", "30", ",", "30", ",", "30", ",", "30", ",", "30", 
   ",", "30", ",", "30", ",", "30", ",", "30"}], "}"}]], "Output",
 CellChangeTimes->{{3.7566122498192863`*^9, 3.756612433803961*^9}, {
   3.7566124792626123`*^9, 3.7566125626292677`*^9}, {3.756612863408914*^9, 
   3.756612915505015*^9}, {3.756612967563633*^9, 3.7566129768000393`*^9}, 
   3.756613010309519*^9, {3.756642992246057*^9, 3.7566429996067123`*^9}, {
   3.7566430378751707`*^9, 3.756643077706814*^9}, 3.756643127359857*^9, 
   3.756643189594791*^9, {3.7566442019521637`*^9, 3.756644228960649*^9}},
 CellLabel->
  "Out[1180]=",ExpressionUUID->"581a18e0-3a05-42ee-9e9e-8e6d9eb6788f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"331.432336543335`", ",", "171.77141409021795`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"334.7996781979083`", ",", "269.4127111826227`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"83.52197265625`", ",", "98.46875`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"257.74326986211423`", ",", "180.86474064346683`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"113.44251766217083`", ",", "100.13937058445728`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"88.90055865921786`", ",", "232.86368715083796`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"232.22361809045228`", ",", "225.54438860971524`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"163.4558823529412`", ",", "243.1527149321267`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"256.4431924882629`", ",", "362.53427230046947`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"142.015503875969`", ",", "414.7885443583118`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"189.05434782608694`", ",", "128.49223602484471`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"630.4445260837618`", ",", "395.1719324026451`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"228.63216957605985`", ",", "734.8379052369077`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"73.5`", ",", "84.48333333333333`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"216.36271676300578`", ",", "120.52962427745665`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"190.64584787159802`", ",", "662.2766922540125`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"693.7889273356402`", ",", "1153.2612456747406`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"159.3575810692375`", ",", "169.5530236634531`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7566122498192863`*^9, 3.756612433803961*^9}, {
   3.7566124792626123`*^9, 3.7566125626292677`*^9}, {3.756612863408914*^9, 
   3.756612915505015*^9}, {3.756612967563633*^9, 3.7566129768000393`*^9}, 
   3.756613010309519*^9, {3.756642992246057*^9, 3.7566429996067123`*^9}, {
   3.7566430378751707`*^9, 3.756643077706814*^9}, 3.756643127359857*^9, 
   3.756643189594791*^9, {3.7566442019521637`*^9, 3.7566442289763327`*^9}},
 CellLabel->
  "Out[1181]=",ExpressionUUID->"bb53ced5-119c-446b-aac6-42d83ce069be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"7850.714351005485`", ",", "4576.6694752968215`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4143.420042268404`", ",", "2813.350586216757`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2201.131822048147`", ",", "1833.5178431993247`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3468.6474419482724`", ",", "2484.2534851301116`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4971.788827501535`", ",", "2891.222041426624`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3809.798676492078`", ",", "3590.893943808533`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"756.1435946603731`", ",", "559.3315116829467`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1467.6594889090672`", ",", "1136.388340807175`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2989.9622754491015`", ",", "1396.6337308803081`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3391.0198276381607`", ",", "1705.4135413082538`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2377.663062367252`", ",", "1661.547312335604`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6317.103274559194`", ",", "4932.042027334852`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5070.892838373704`", ",", "2466.8861496011036`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4410.121279572628`", ",", "4106.462252378724`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3214.5954709902185`", ",", "2688.044722938936`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4719.637988087359`", ",", "4305.717106302322`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4764.527154663519`", ",", "3780.07215232914`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3405.0435251244676`", ",", "2237.065010381614`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7566122498192863`*^9, 3.756612433803961*^9}, {
   3.7566124792626123`*^9, 3.7566125626292677`*^9}, {3.756612863408914*^9, 
   3.756612915505015*^9}, {3.756612967563633*^9, 3.7566129768000393`*^9}, 
   3.756613010309519*^9, {3.756642992246057*^9, 3.7566429996067123`*^9}, {
   3.7566430378751707`*^9, 3.756643077706814*^9}, 3.756643127359857*^9, 
   3.756643189594791*^9, {3.7566442019521637`*^9, 3.7566442289872017`*^9}},
 CellLabel->
  "Out[1182]=",ExpressionUUID->"0a208d9e-5c5b-4ba7-81f1-8d76f7c336c6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"11311.368666525334`", ",", "7357.791877854952`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4703.993036055263`", ",", "7643.959168990017`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3951.7306930049704`", ",", "4137.659602178546`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6041.931057822471`", ",", "3874.3525106729007`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5727.465192358021`", ",", "10080.38887992687`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8028.703709452119`", ",", "5179.1710473434605`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1139.880025987151`", ",", "1430.6817336181355`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1932.6397315436243`", ",", "2101.7363881105434`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3179.366440933032`", ",", "5289.131895057671`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4125.674105331494`", ",", "3275.851735437705`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3001.5342819104676`", ",", "3068.831691798135`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7116.148369822019`", ",", "5980.613625333657`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6949.721325883609`", ",", "5459.417659586716`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7201.09831937694`", ",", "5438.139705882353`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4492.7619000199165`", ",", "3044.6456709210074`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8603.96576889661`", ",", "7162.94961841935`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7581.13649186857`", ",", "14826.944302067317`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4336.432260346657`", ",", "3422.165192320294`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7566122498192863`*^9, 3.756612433803961*^9}, {
   3.7566124792626123`*^9, 3.7566125626292677`*^9}, {3.756612863408914*^9, 
   3.756612915505015*^9}, {3.756612967563633*^9, 3.7566129768000393`*^9}, 
   3.756613010309519*^9, {3.756642992246057*^9, 3.7566429996067123`*^9}, {
   3.7566430378751707`*^9, 3.756643077706814*^9}, 3.756643127359857*^9, 
   3.756643189594791*^9, {3.7566442019521637`*^9, 3.7566442289978*^9}},
 CellLabel->
  "Out[1183]=",ExpressionUUID->"1e841f13-3217-4e74-9aae-837fc658d814"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", "  ", 
  RowBox[{"myRatio", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"nucGInt", "-", "bkgGInt"}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"cytoGInt", "-", "bkgGInt"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.756644187464951*^9, 
  3.756644187761491*^9}},ExpressionUUID->"7ec674c1-e86f-4f33-a636-\
4cd438e75ca7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.0433507624949974`", ",", "2.1631172103165595`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.3966526388697074`", ",", "6.523819385207293`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.6902796201148746`", ",", "1.5336116217592364`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.3721511972823215`", ",", "1.1204718957893165`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.094682956696017`", ",", "1.8726000444681348`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.6539406013442748`", ",", "1.5075321956033403`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.7010053266410163`", ",", "1.5119670332615536`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1695799336031052`", ",", "2.1318243881964833`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1882182913283534`", ",", "2.3343078489268665`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.6817635408163758`", ",", "1.4786684458350596`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2844462310088958`", ",", "2.385469590113704`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.621891185335697`", ",", "1.5748190799389892`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.66386217446733`", ",", "1.8752776952412327`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1309076948146786`", ",", "1.3249642257236423`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.4098436095241327`", ",", "1.9747383580581213`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.3107982958094662`", ",", "1.5483964679689266`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.6161995691346966`", ",", "1.3953286499994864`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.7566125645495863`*^9, 3.756612880967128*^9, 
  3.756612917684154*^9, 3.756613016615155*^9, 3.756643140717799*^9, 
  3.756643191459179*^9},
 CellLabel->
  "Out[1128]=",ExpressionUUID->"c03813ca-c028-4a13-afe5-2fdddf4bb918"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myRatioTime", " ", "=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"nucGInt", "-", "bkgGInt"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"cytoGInt", "-", "bkgGInt"}], ")"}]}], "}"}], " ", "//", "  ", 
   RowBox[{
    RowBox[{"Table", "[", "   ", 
     RowBox[{
      RowBox[{"Transpose", "[", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "15"}], "}"}], ",", " ", 
         RowBox[{"#", " ", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "i"}], "]"}], "]"}]}], "}"}], "  ", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "@", "nucGInt"}]}], "}"}]}], "]"}], "&"}], 
   " "}]}]], "Input",
 CellChangeTimes->{{3.756643522119257*^9, 3.75664357856318*^9}, {
  3.7566436329518948`*^9, 3.756643672987026*^9}, {3.75664415082751*^9, 
  3.756644153889826*^9}},
 CellLabel->
  "In[1184]:=",ExpressionUUID->"bdb77d2d-fc2b-4eb6-b1b8-ad89dc2062d0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.4602373350093567`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "1.631370434437776`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.1471853165191137`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "2.8988704992288556`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.8266862148660357`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "2.3279980191975578`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.8014202473698582`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "1.6035017010785124`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.1555418894956198`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "3.5757627724910863`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "2.1338405135954734`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "1.4729787947520658`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.7324332884557716`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "3.6104968157924366`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.35652427297175`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "2.080731689757309`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.0692894981654109`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "4.764142928305032`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.2261167436190539`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "2.2168044147918837`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.2850537948598124`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "1.917960744664901`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.1405122288157428`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "1.2311222442031313`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.3880064738390936`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "2.7277414296760063`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.6435833013482242`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "1.3311000580330492`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.426306605858938`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "1.1388895232468068`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.8576583179109252`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "1.7842127734819444`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.6919161046260487`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "5.20543105015803`"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "1.2869620632668153`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "1.5732011178420466`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.756643543555744*^9, {3.756643635446385*^9, 3.756643657120305*^9}, 
   3.7566441545415697`*^9, {3.7566442071287622`*^9, 3.756644233875139*^9}},
 CellLabel->
  "Out[1184]=",ExpressionUUID->"d4f534bb-b63b-4a7e-ad01-9f200b22da88"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"plotsNT", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"ListLinePlot", "[", 
       RowBox[{"#", ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Darker", "[", "Red", "]"}], "}"}]}]}], "]"}], "&"}], "/@", 
     "myRatioTime"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"GraphicsRow", "[", 
  RowBox[{"{", "  ", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{"plotsTA", ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "15.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "6"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AxesOrigin", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", " ", 
      RowBox[{
      "PlotLabel", "\[Rule]", "\"\<TA nuc/cyto ratio at 4h and 15h\>\""}]}], 
     " ", "]"}], "  ", ",", "  ", 
    RowBox[{"Show", "[", 
     RowBox[{"plotsNT", ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "15.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "6"}], "}"}]}], "}"}]}], ",", 
      RowBox[{"AxesOrigin", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", 
      RowBox[{
      "PlotLabel", "\[Rule]", "\"\<NT nuc/cyto ratio at 4h and 15h\>\""}]}], 
     "]"}]}], "  ", "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.756612568984034*^9, 3.7566127377759237`*^9}, {
  3.7566127704917583`*^9, 3.756612846263803*^9}, {3.7566128777695513`*^9, 
  3.756612883247805*^9}, {3.7566431456138678`*^9, 3.7566432366822968`*^9}, {
  3.756643273403658*^9, 3.756643329551126*^9}, {3.756644161159944*^9, 
  3.756644175772612*^9}, {3.756644220156826*^9, 3.756644290166018*^9}},
 CellLabel->
  "In[1195]:=",ExpressionUUID->"20ede4ef-3bc1-4ebc-b063-af594f1d6aa8"],

Cell[BoxData[
 GraphicsBox[{{}, {InsetBox[
     GraphicsBox[{{{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.0433507624949974`}, {15., 
           2.1631172103165595`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.3966526388697074`}, {15., 
           6.523819385207293}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.6902796201148746`}, {15., 
           1.5336116217592364`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.3721511972823215`}, {15., 
           1.1204718957893165`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.094682956696017}, {15., 
           1.8726000444681348`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.6539406013442748`}, {15., 
           1.5075321956033403`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.7010053266410163`}, {15., 
           1.5119670332615536`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.1695799336031052`}, {15., 
           2.1318243881964833`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.1882182913283534`}, {15., 
           2.3343078489268665`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.6817635408163758`}, {15., 
           1.4786684458350596`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.2844462310088958`}, {15., 
           2.385469590113704}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.621891185335697}, {15., 
           1.5748190799389892`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.66386217446733}, {15., 
           1.8752776952412327`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.1309076948146786`}, {15., 
           1.3249642257236423`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.4098436095241327`}, {15., 
           1.9747383580581213`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.3107982958094662`}, {15., 
           1.5483964679689266`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[0, 0, 
           NCache[
            Rational[2, 3], 0.6666666666666666]], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.6161995691346966`}, {15., 
           1.3953286499994864`}}]}}, {}, {}, {}, {}}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{0, 0},
      DisplayFunction->Identity,
      Frame->{{False, False}, {False, False}},
      FrameLabel->{{None, None}, {None, None}},
      FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImagePadding->All,
      Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& )}},
      PlotLabel->FormBox[
       "\"TA nuc/cyto ratio at 4h and 15h\"", TraditionalForm],
      PlotRange->{{4, 15.1}, {0, 6}},
      PlotRangeClipping->True,
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.02], 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}], {192., -116.80842387373012}, 
     ImageScaled[{0.5, 0.5}], {360., 222.49223594996212}], InsetBox[
     GraphicsBox[{{{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.4602373350093567`}, {15., 
           1.631370434437776}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.1471853165191137`}, {15., 
           2.8988704992288556`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.8266862148660357`}, {15., 
           2.3279980191975578`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.8014202473698582`}, {15., 
           1.6035017010785124`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.1555418894956198`}, {15., 
           3.5757627724910863`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 2.1338405135954734`}, {15., 
           1.4729787947520658`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.7324332884557716`}, {15., 
           3.6104968157924366`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.35652427297175}, {15., 
           2.080731689757309}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.0692894981654109`}, {15., 
           4.764142928305032}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.2261167436190539`}, {15., 
           2.2168044147918837`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.2850537948598124`}, {15., 
           1.917960744664901}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.1405122288157428`}, {15., 
           1.2311222442031313`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.3880064738390936`}, {15., 
           2.7277414296760063`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.6435833013482242`}, {15., 
           1.3311000580330492`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.426306605858938}, {15., 
           1.1388895232468068`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.8576583179109252`}, {15., 
           1.7842127734819444`}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.6919161046260487`}, {15., 
           5.20543105015803}}]}}, {}, {}, {}, {}}, {{}, {{}, {}, 
         {RGBColor[
           NCache[
            Rational[2, 3], 0.6666666666666666], 0, 0], PointSize[
           NCache[
            Rational[7, 360], 0.019444444444444445`]], AbsoluteThickness[1.6],
           LineBox[{{4., 1.2869620632668153`}, {15., 
           1.5732011178420466`}}]}}, {}, {}, {}, {}}},
      AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
      Axes->{True, True},
      AxesLabel->{None, None},
      AxesOrigin->{0, 0},
      DisplayFunction->Identity,
      Frame->{{False, False}, {False, False}},
      FrameLabel->{{None, None}, {None, None}},
      FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImagePadding->All,
      Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& )}},
      PlotLabel->FormBox[
       "\"NT nuc/cyto ratio at 4h and 15h\"", TraditionalForm],
      PlotRange->{{4, 15.1}, {0, 6}},
      PlotRangeClipping->True,
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}], {576., -116.80842387373012}, 
     ImageScaled[{0.5, 0.5}], {360., 222.49223594996212}]}, {}},
  ContentSelectable->True,
  ImageSize->{624.7135416666661, Automatic},
  PlotRangePadding->{6, 5}]], "Output",
 CellChangeTimes->{{3.756643317883582*^9, 3.756643330502276*^9}, {
  3.756644162269042*^9, 3.756644176406279*^9}, {3.7566442087084*^9, 
  3.7566442908328876`*^9}},
 CellLabel->
  "Out[1196]=",ExpressionUUID->"99f2f0e7-0043-4bdc-9751-442573f7e6a7"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 753},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.75 Inherited,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 148, 3, 51, "Section",ExpressionUUID->"2e059330-20ef-40cf-981b-b2d80297422c"],
Cell[731, 27, 1660, 32, 9, "Text",ExpressionUUID->"d76171a6-3ad2-4d2a-82f6-2b663503147a"]
}, Closed]],
Cell[CellGroupData[{
Cell[2428, 64, 157, 3, 41, "Section",ExpressionUUID->"28c4e0b0-ada2-4d05-bd49-ff30b6635e01"],
Cell[2588, 69, 669, 14, 9, "Input",ExpressionUUID->"e69bf2d1-8952-4a9a-b9bd-9801f3a5fe8e"],
Cell[3260, 85, 252, 5, 9, "Input",ExpressionUUID->"dc733b09-8dae-42e7-9f28-818e144150b5"]
}, Closed]],
Cell[CellGroupData[{
Cell[3549, 95, 217, 4, 41, "Section",ExpressionUUID->"456580d0-4b24-4a8b-bb33-1f27c6528439"],
Cell[CellGroupData[{
Cell[3791, 103, 802, 12, 23, "Subsection",ExpressionUUID->"38fa3d32-7af0-407e-8b26-568f7691a5f9",
 InitializationCell->True],
Cell[4596, 117, 77716, 1582, 9, "Input",ExpressionUUID->"1c6fd0fa-09b1-404d-b6b7-c1eafc74146b"]
}, Closed]],
Cell[CellGroupData[{
Cell[82349, 1704, 184, 4, 16, "Subsection",ExpressionUUID->"4c8c1466-134c-4442-8f78-be8467706fad",
 InitializationCell->True],
Cell[82536, 1710, 721, 18, 9, "Input",ExpressionUUID->"c1460593-48f2-4102-bf04-1f06972ed5d0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[83282, 1732, 235, 4, 9, "Input",ExpressionUUID->"76fb10be-a6ea-424d-b050-62acd2f7dde2"],
Cell[83520, 1738, 2421, 34, 70, "Output",ExpressionUUID->"02af4616-1525-427f-9fba-19d5cc6d9197"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[85990, 1778, 157, 3, 16, "Subsection",ExpressionUUID->"82419f90-f334-4b7b-a564-9cc5f70750f3"],
Cell[86150, 1783, 1663, 45, 9, "Input",ExpressionUUID->"b0867705-130d-4338-b28c-1664233347ed"],
Cell[87816, 1830, 51134, 845, 9, "Input",ExpressionUUID->"22b0b9c3-d0b2-4ca5-951a-b5e78a4f5565"]
}, Closed]],
Cell[CellGroupData[{
Cell[138987, 2680, 253, 4, 16, "Subsection",ExpressionUUID->"d438ec39-0e88-415c-9af1-550f42c9553e"],
Cell[139243, 2686, 4652, 100, 9, "Input",ExpressionUUID->"9f197d38-b966-4cd8-9833-f8046edd83c2"],
Cell[143898, 2788, 3518, 69, 9, "Input",ExpressionUUID->"b16826d6-b21d-4622-9b41-47aae6a6b6fa"]
}, Closed]],
Cell[CellGroupData[{
Cell[147453, 2862, 398, 8, 16, "Subsection",ExpressionUUID->"ac9ecbf5-8db4-4ec6-a67f-08256e707124"],
Cell[147854, 2872, 12033, 226, 9, "Input",ExpressionUUID->"09689079-c025-481f-9b5d-3c78297d7c6d"]
}, Closed]],
Cell[CellGroupData[{
Cell[159924, 3103, 426, 8, 16, "Subsection",ExpressionUUID->"856a67cb-2647-4efb-ace1-d402123e1bf5"],
Cell[160353, 3113, 3380, 67, 9, "Input",ExpressionUUID->"e29bd05a-cd43-4ec0-81b0-b62159bd7246"],
Cell[163736, 3182, 5197, 124, 9, "Input",ExpressionUUID->"1d7fe270-8221-42d8-ba56-911ce856434d"]
}, Closed]],
Cell[CellGroupData[{
Cell[168970, 3311, 292, 4, 16, "Subsection",ExpressionUUID->"2eb3e65b-79f7-4754-8461-6b0684db1de4"],
Cell[169265, 3317, 2440, 54, 9, "Input",ExpressionUUID->"dabfc3dc-56aa-48ec-a19c-2d1bcd33858c"],
Cell[171708, 3373, 1310, 37, 9, "Input",ExpressionUUID->"4ec01059-f622-4410-a1c3-86d7d04babf0"],
Cell[173021, 3412, 8891, 203, 9, "Input",ExpressionUUID->"83ff820d-da7a-4ede-b383-ae81e8360b6b"]
}, Closed]],
Cell[CellGroupData[{
Cell[181949, 3620, 259, 4, 16, "Subsection",ExpressionUUID->"52775ca3-8f49-442c-9ef4-d048aed8b88f"],
Cell[182211, 3626, 4233, 95, 9, "Input",ExpressionUUID->"f1fe01d3-64e6-40c9-a66c-9c09a63c1755"]
}, Closed]],
Cell[CellGroupData[{
Cell[186481, 3726, 161, 3, 16, "Subsection",ExpressionUUID->"77eaa6d1-8676-4e6c-8f16-b6130e6b6c2a"],
Cell[186645, 3731, 506, 10, 9, "Input",ExpressionUUID->"87ccae87-4b32-41d5-9d61-1b1a96ff9fff"],
Cell[187154, 3743, 3866, 96, 9, "Input",ExpressionUUID->"d74b26eb-9735-4f3a-844e-3329afb47bde"]
}, Closed]],
Cell[CellGroupData[{
Cell[191057, 3844, 159, 3, 16, "Subsection",ExpressionUUID->"acfc757a-3196-4781-a4f5-8a05ee2de22b"],
Cell[191219, 3849, 513, 9, 9, "Input",ExpressionUUID->"ef65d7c3-baaa-457e-acd8-7577e28da918"],
Cell[191735, 3860, 13272, 294, 9, "Input",ExpressionUUID->"3d1603e5-b5ac-4c2b-b516-b83738bc58de"],
Cell[205010, 4156, 440, 10, 9, "Input",ExpressionUUID->"a62c2d03-cd86-42f2-b31f-9fd5cbbfddb7"]
}, Closed]],
Cell[CellGroupData[{
Cell[205487, 4171, 165, 3, 16, "Subsection",ExpressionUUID->"9288ed2f-2279-4df1-a7c2-f62bc1de11d1"],
Cell[205655, 4176, 643, 12, 36, "Text",ExpressionUUID->"d60ef27e-50f7-41bf-a056-538381aadeac"],
Cell[206301, 4190, 2511, 52, 77, "Input",ExpressionUUID->"4a467329-bd15-47e8-b342-634ca3848213"],
Cell[208815, 4244, 12763, 274, 320, "Input",ExpressionUUID->"89bd7b7d-9cb3-449c-b8c7-79667447072e"],
Cell[221581, 4520, 13632, 289, 320, "Input",ExpressionUUID->"54be78c8-fcb0-4e1e-808b-677b03ec837f"],
Cell[235216, 4811, 14960, 312, 338, "Input",ExpressionUUID->"82a4c8d7-5087-45ae-a49f-cf93b702ac9f"]
}, Closed]],
Cell[CellGroupData[{
Cell[250213, 5128, 162, 3, 16, "Subsection",ExpressionUUID->"83372367-5348-4386-be4e-e7ce8056936c"],
Cell[250378, 5133, 6870, 163, 9, "Input",ExpressionUUID->"d6b2ca9a-fb9d-4d23-b267-0dd2f36fcbc1"],
Cell[257251, 5298, 1889, 48, 9, "Input",ExpressionUUID->"bf272181-6928-4628-86b6-599f9e1bbf21"],
Cell[259143, 5348, 1960, 46, 9, "Input",ExpressionUUID->"3acb93d4-d3a1-412e-bae1-601b700b40e6"],
Cell[261106, 5396, 1802, 45, 9, "Input",ExpressionUUID->"685ff480-475d-47f7-aa93-f6f18e4903ed"]
}, Closed]],
Cell[CellGroupData[{
Cell[262945, 5446, 424, 8, 16, "Subsection",ExpressionUUID->"5cfa164d-1ff7-4e72-8c5b-bbc8b0796cd3"],
Cell[263372, 5456, 5522, 131, 9, "Input",ExpressionUUID->"2c98d8ee-0599-45cb-b95e-f13e754763e8"]
}, Closed]],
Cell[CellGroupData[{
Cell[268931, 5592, 312, 7, 16, "Subsection",ExpressionUUID->"09581180-0d2c-42fa-aedc-7d1b8f7a0787"],
Cell[269246, 5601, 2528, 51, 9, "Input",ExpressionUUID->"92567c1a-feb8-43d5-b290-81249e4d2e96"]
}, Closed]],
Cell[CellGroupData[{
Cell[271811, 5657, 438, 8, 16, "Subsection",ExpressionUUID->"6e43622c-7b66-4ba4-98c8-2b4d629d1c03"],
Cell[272252, 5667, 4402, 90, 9, "Input",ExpressionUUID->"1ea48a73-204e-47f8-94ac-a862a1e58d5d"]
}, Closed]],
Cell[CellGroupData[{
Cell[276691, 5762, 306, 5, 16, "Subsection",ExpressionUUID->"67559df4-9479-4774-9481-451a827af675"],
Cell[277000, 5769, 14355, 314, 9, "Input",ExpressionUUID->"32cec282-b416-4885-81cc-d9efc58b851a"],
Cell[291358, 6085, 8573, 201, 9, "Input",ExpressionUUID->"ab81c138-211c-46b9-99e4-e1c5a838764c"],
Cell[299934, 6288, 3615, 85, 9, "Input",ExpressionUUID->"7617eea5-7332-4c61-99ae-0b4065bcad2b"]
}, Closed]],
Cell[CellGroupData[{
Cell[303586, 6378, 253, 4, 16, "Subsection",ExpressionUUID->"61fe7ff1-20ee-482d-802e-f160a81cfe1d"],
Cell[303842, 6384, 1608, 36, 9, "Input",ExpressionUUID->"719118c6-2230-4562-822c-44478d5a68be"],
Cell[305453, 6422, 1937, 43, 9, "Input",ExpressionUUID->"a37c1806-5ace-41f5-8418-f44926b396bf"],
Cell[307393, 6467, 6763, 154, 9, "Input",ExpressionUUID->"0a2d8c66-a6f7-4f20-8d3a-724d0f41542b"]
}, Closed]],
Cell[CellGroupData[{
Cell[314193, 6626, 158, 3, 16, "Subsection",ExpressionUUID->"f79524e6-639c-4244-b72d-ed5779731f40"],
Cell[314354, 6631, 621, 11, 9, "Input",ExpressionUUID->"494bc971-4e2d-4b6b-aa60-73772d5e4e44"],
Cell[314978, 6644, 8959, 199, 9, "Input",ExpressionUUID->"88aef07b-19d9-42ee-ac8c-eb8e3743e876"]
}, Closed]],
Cell[CellGroupData[{
Cell[323974, 6848, 171, 3, 16, "Subsection",ExpressionUUID->"ada456d6-1d9c-4b38-816e-3ccf12fe85dc"],
Cell[324148, 6853, 7650, 175, 9, "Input",ExpressionUUID->"71dbcf64-a30e-4685-935a-ab6705494cff"]
}, Closed]],
Cell[CellGroupData[{
Cell[331835, 7033, 242, 6, 16, "Subsection",ExpressionUUID->"b81bb2a7-c2c9-4d8a-8b17-8f13c1c3ed06"],
Cell[332080, 7041, 1610, 39, 9, "Input",ExpressionUUID->"e98d3c78-47c0-4443-b473-a4823c7e3dc9"],
Cell[333693, 7082, 1735, 41, 9, "Input",ExpressionUUID->"0ca9d9c3-e6a4-4b37-a7d4-d509a413b2e4"]
}, Closed]],
Cell[CellGroupData[{
Cell[335465, 7128, 241, 4, 16, "Subsection",ExpressionUUID->"61f6a415-821b-4948-9dad-7963d18bd10c"],
Cell[335709, 7134, 1372, 36, 9, "Input",ExpressionUUID->"82bd3861-bdaf-4fba-94c3-d10ca8f6a214"]
}, Closed]],
Cell[CellGroupData[{
Cell[337118, 7175, 231, 5, 16, "Subsection",ExpressionUUID->"4e3722c9-cac0-45ce-9344-8f07a405af1f"],
Cell[337352, 7182, 4572, 100, 9, "Input",ExpressionUUID->"29049d6e-41f8-49c7-a7d3-bcfa5c95f1e4"],
Cell[341927, 7284, 4385, 95, 9, "Input",ExpressionUUID->"b9193d75-bcde-44d5-8abc-b609284c6a5b"]
}, Closed]],
Cell[CellGroupData[{
Cell[346349, 7384, 204, 3, 16, "Subsection",ExpressionUUID->"390ccb0c-3538-42c3-952e-16e7b25e37ea"],
Cell[346556, 7389, 5307, 139, 9, "Input",ExpressionUUID->"f23e08f0-16d4-4d00-89ea-13391b259136"]
}, Closed]],
Cell[CellGroupData[{
Cell[351900, 7533, 342, 7, 16, "Subsection",ExpressionUUID->"688a2350-76d5-4f97-9f57-fe0416bc729d"],
Cell[352245, 7542, 25179, 597, 9, "Input",ExpressionUUID->"3b8039fd-3356-45f0-93d1-c0a01421ab38"]
}, Closed]],
Cell[CellGroupData[{
Cell[377461, 8144, 213, 3, 16, "Subsection",ExpressionUUID->"98210668-a556-466f-9d3b-c3a718135c27"],
Cell[377677, 8149, 6285, 142, 9, "Input",ExpressionUUID->"f080d4e2-9682-4fd5-a5f8-6c42ed499483"],
Cell[383965, 8293, 147, 2, 9, "Input",ExpressionUUID->"a1fe6c81-d9c7-4688-8ae6-3c1133c54371"]
}, Closed]],
Cell[CellGroupData[{
Cell[384149, 8300, 282, 6, 16, "Subsection",ExpressionUUID->"82b73e89-3e04-4197-b14c-d1cb718fe1bc"],
Cell[384434, 8308, 5813, 146, 9, "Input",ExpressionUUID->"44ef4ac3-e13c-4656-8cbe-1c69c15e13eb"],
Cell[390250, 8456, 2987, 70, 9, "Input",ExpressionUUID->"68d1159a-88e4-46ba-9347-ccb34350f301"]
}, Closed]],
Cell[CellGroupData[{
Cell[393274, 8531, 222, 4, 16, "Subsection",ExpressionUUID->"3251f51f-4997-47db-950b-c7108a395b32"],
Cell[CellGroupData[{
Cell[393521, 8539, 436, 10, 9, "Input",ExpressionUUID->"7cdbab8f-98d6-4d81-b005-66f32ca9a881"],
Cell[393960, 8551, 2227, 44, 70, "Output",ExpressionUUID->"828d2d82-f87e-4666-946c-a5e2a916149c"]
}, Open  ]],
Cell[396202, 8598, 1254, 29, 9, "Input",ExpressionUUID->"546fea86-4971-45f1-872b-d275d1861de4"],
Cell[397459, 8629, 258, 5, 9, "Input",ExpressionUUID->"a6f7404f-f4b3-4994-8d27-218f87d32ef1"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[397766, 8640, 157, 3, 41, "Section",ExpressionUUID->"3a221e5b-3b24-4968-bc89-9cd3c6343234"],
Cell[CellGroupData[{
Cell[397948, 8647, 400, 6, 41, "Subsection",ExpressionUUID->"ba88c470-c371-4902-8e1b-8069f85d0586"],
Cell[CellGroupData[{
Cell[398373, 8657, 705, 13, 24, "Input",ExpressionUUID->"b3c6f0f4-9a0a-48b8-a087-285b6a7482a8"],
Cell[399081, 8672, 2548, 40, 38, "Output",ExpressionUUID->"a453ef81-15c6-4e2a-960d-6fbdb163fd2b"]
}, Open  ]],
Cell[401644, 8715, 667, 17, 25, "Input",ExpressionUUID->"84568daa-98a4-4e27-8788-55b3fbda201d"],
Cell[402314, 8734, 1046, 26, 73, "Input",ExpressionUUID->"da217a5f-cbcd-49a2-aa60-37ad8ef316e3"],
Cell[403363, 8762, 1122, 27, 41, "Input",ExpressionUUID->"5ce07a94-a438-44af-bee4-ea6834bb68c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[404522, 8794, 360, 6, 41, "Subsection",ExpressionUUID->"c51f2ed7-62e2-4a00-b383-f12ba16af33f"],
Cell[404885, 8802, 329, 7, 24, "Input",ExpressionUUID->"871b832f-b66c-4d98-a62f-6c5f18668b2f"],
Cell[405217, 8811, 1862, 58, 78, "Input",ExpressionUUID->"ddcb7aa2-8919-4c4c-9e1a-ef31d345e63b"],
Cell[407082, 8871, 360, 8, 46, "Text",ExpressionUUID->"99bed588-3034-447b-922c-addbb7ee5f66"],
Cell[407445, 8881, 397, 8, 25, "Input",ExpressionUUID->"53ef1dc3-23bd-4227-8f8c-4e0c3cb17578"]
}, Open  ]],
Cell[CellGroupData[{
Cell[407879, 8894, 464, 8, 41, "Subsection",ExpressionUUID->"3d2ba228-e178-47c6-999f-7433ea4b06b0"],
Cell[408346, 8904, 222, 7, 46, "Text",ExpressionUUID->"520f76f0-2f84-4b28-9cdc-630e08b2ce7c"],
Cell[408571, 8913, 440, 11, 25, "Input",ExpressionUUID->"799d74b0-9bb7-4611-82a6-460622d6a194"],
Cell[CellGroupData[{
Cell[409036, 8928, 284, 8, 24, "Input",ExpressionUUID->"787b1de9-8a64-4202-a7f1-8ae164e32500"],
Cell[409323, 8938, 1596, 28, 27, "Output",ExpressionUUID->"83c01723-fffd-4953-a9e5-bb971fd68587"]
}, Open  ]],
Cell[CellGroupData[{
Cell[410956, 8971, 681, 17, 57, "Input",ExpressionUUID->"c92094e2-c529-413f-863a-3c3f6b0962d4"],
Cell[411640, 8990, 1399, 21, 27, "Output",ExpressionUUID->"a5994bcd-0c02-4b9e-a183-a5054d4eea77"],
Cell[413042, 9013, 1398, 21, 27, "Output",ExpressionUUID->"3e3829d6-ee5d-4f5d-8269-09bd91b91487"],
Cell[414443, 9036, 1397, 21, 27, "Output",ExpressionUUID->"435f149f-74e2-4f79-9fad-cb84fccb9334"]
}, Open  ]],
Cell[CellGroupData[{
Cell[415877, 9062, 611, 13, 24, "Input",ExpressionUUID->"d29fbd7f-1d53-4b40-bb1b-52d7b629cafa"],
Cell[416491, 9077, 1521, 24, 27, "Output",ExpressionUUID->"d4a5965e-935f-4e27-8951-694e8968882b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[418049, 9106, 581, 12, 24, "Input",ExpressionUUID->"7e3575c9-2df9-4141-9811-a6fcb66b9260"],
Cell[418633, 9120, 1952, 46, 191, "Output",ExpressionUUID->"098f9967-d643-48d2-ac67-ae3f71c12389"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[420634, 9172, 469, 8, 41, "Subsection",ExpressionUUID->"adeccb3a-6a9f-4d00-a651-2ad94ebf2949"],
Cell[421106, 9182, 152, 3, 24, "Input",ExpressionUUID->"7f9bc9d9-ca1d-441c-9f29-f452e532a224"],
Cell[CellGroupData[{
Cell[421283, 9189, 266, 6, 24, "Input",ExpressionUUID->"0d7b7665-b15b-4161-a0f4-c01a3856c400"],
Cell[421552, 9197, 278, 4, 28, "Output",ExpressionUUID->"79b1404e-f059-4866-90a2-ffa8fc4c018b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[421867, 9206, 670, 17, 41, "Input",ExpressionUUID->"f61fa399-7c87-400d-917c-b3e43f45de11"],
Cell[422540, 9225, 2599, 40, 300, "Output",ExpressionUUID->"4d7acab2-4dc2-4d3c-8c3a-ac7a9042d145"],
Cell[425142, 9267, 2472, 38, 284, "Output",ExpressionUUID->"562291ff-e804-485b-8737-6c0c5da3d06f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[427651, 9310, 1614, 39, 89, "Input",ExpressionUUID->"55988fc3-aee7-4655-b948-fe849759c3e0"],
Cell[429268, 9351, 788, 13, 27, "Output",ExpressionUUID->"581a18e0-3a05-42ee-9e9e-8e6d9eb6788f"],
Cell[430059, 9366, 2247, 47, 44, "Output",ExpressionUUID->"bb53ced5-119c-446b-aac6-42d83ce069be"],
Cell[432309, 9415, 2269, 47, 44, "Output",ExpressionUUID->"0a208d9e-5c5b-4ba7-81f1-8d76f7c336c6"],
Cell[434581, 9464, 2261, 47, 44, "Output",ExpressionUUID->"1e841f13-3217-4e74-9aae-837fc658d814"]
}, Open  ]],
Cell[CellGroupData[{
Cell[436879, 9516, 367, 10, 24, "Input",ExpressionUUID->"7ec674c1-e86f-4f33-a636-4cd438e75ca7"],
Cell[437249, 9528, 1909, 42, 44, "Output",ExpressionUUID->"c03813ca-c028-4a13-afe5-2fdddf4bb918"]
}, Open  ]],
Cell[CellGroupData[{
Cell[439195, 9575, 1010, 28, 24, "Input",ExpressionUUID->"bdb77d2d-fc2b-4eb6-b1b8-ad89dc2062d0"],
Cell[440208, 9605, 3934, 116, 60, "Output",ExpressionUUID->"d4f534bb-b63b-4a7e-ad01-9f200b22da88"]
}, Open  ]],
Cell[CellGroupData[{
Cell[444179, 9726, 1964, 51, 73, "Input",ExpressionUUID->"20ede4ef-3bc1-4ebc-b063-af594f1d6aa8"],
Cell[446146, 9779, 14280, 320, 167, "Output",ExpressionUUID->"99f2f0e7-0043-4bdc-9751-442573f7e6a7"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

