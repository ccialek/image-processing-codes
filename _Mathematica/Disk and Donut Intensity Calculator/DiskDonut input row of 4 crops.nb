(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     50897,       1069]
NotebookOptionsPosition[     49213,       1035]
NotebookOutlinePosition[     49549,       1050]
CellTagsIndexPosition[     49506,       1047]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["MyDiskDonutMask (VERSION 1, more flexibility)", "Subsubsection",
 CellChangeTimes->{{3.7464496243784494`*^9, 3.7464496290851107`*^9}, {
   3.746451235258383*^9, 3.74645123548956*^9}, {3.750949132243795*^9, 
   3.7509491388134403`*^9}, {3.750950017616474*^9, 3.750950018408107*^9}, {
   3.750950049325511*^9, 3.750950052579129*^9}, {3.750951082292624*^9, 
   3.750951098440075*^9}, 3.7509513082353897`*^9, {3.7963918374504423`*^9, 
   3.796391848694112*^9}, 
   3.796400853745133*^9},ExpressionUUID->"06ef67d0-8399-4056-8186-\
b94c6196eb57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyDiskDonutMask", "::", "usage"}], "=", "\[IndentingNewLine]", 
    "\"\<Makes a disk and donut mask based on size constraints that the user \
provides. Output:  {\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
\"], {{0, 12}, {11, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
11, 12},PlotRange->{{0, 11}, {0, \
12}}]\),\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
\"], {{0, 12}, {11, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
11, 12},PlotRange->{{0, 11}, {0, 12}}]\)}\n\nInputs\n1. myPadSize: how big \
you want the crop to be. Should match the size of your crops.\n2. \
donutRadius: Diff Lim Spot, use 2 or 3\n3. diskRadius: use the donutRadius, \
unless you want a pixel gap between your disk and donut\n4. diskWidth: Diff \
Lim Spot, use myPadSize unless you want a bigger/smaller disk\n\>\""}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyDiskDonutMask", "[", 
   RowBox[{
   "myPadSize_", ",", "donutRadius_", ",", "diskRadius_", ",", "diskWidth_"}],
    "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mycent", ",", "mydonut"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mycent", "=", 
      RowBox[{"Image", "[", 
       RowBox[{"DiskMatrix", "[", 
        RowBox[{"donutRadius", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"2", "*", "myPadSize"}], "+", "1"}], ",", 
           RowBox[{
            RowBox[{"2", "*", "myPadSize"}], "+", "1"}]}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mydonut", "=", 
      RowBox[{"Image", "[", 
       RowBox[{
        RowBox[{"DiskMatrix", "[", 
         RowBox[{"diskRadius", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", "myPadSize"}], "+", "1"}], ",", 
            RowBox[{
             RowBox[{"2", "*", "myPadSize"}], "+", "1"}]}], "}"}]}], "]"}], 
        "-", 
        RowBox[{"DiskMatrix", "[", 
         RowBox[{"diskWidth", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"2", "*", "myPadSize"}], "+", "1"}], ",", 
            RowBox[{
             RowBox[{"2", "*", "myPadSize"}], "+", "1"}]}], "}"}]}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"mycent", ",", "mydonut"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.5750965858018923`*^9, 3.5750966952420454`*^9}, {
  3.5751516881187415`*^9, 3.5751517415788164`*^9}, {3.5787952659665294`*^9, 
  3.578795266902531*^9}, {3.746450618041257*^9, 3.7464506325390673`*^9}, {
  3.746451229341381*^9, 3.746451233024241*^9}, {3.7464512851329184`*^9, 
  3.746451476184409*^9}, {3.7494086106269345`*^9, 3.749408612465603*^9}, {
  3.7494786662825217`*^9, 3.7494786831055794`*^9}, {3.750949144621682*^9, 
  3.750949171539495*^9}, {3.750949202634305*^9, 3.7509492065697823`*^9}, {
  3.750949249498136*^9, 3.75094935832798*^9}, {3.7509495261099157`*^9, 
  3.7509497203736343`*^9}, {3.750949984139188*^9, 3.75095000820501*^9}, {
  3.75095052843073*^9, 3.7509509891151323`*^9}, {3.796400844299876*^9, 
  3.7964008470021133`*^9}},ExpressionUUID->"71807987-e891-4d2a-a837-\
91498f2756df"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyDiskDonutCentered", "Subsubsection",
 CellChangeTimes->{{3.7464496243784494`*^9, 3.7464496290851107`*^9}, {
   3.746451235258383*^9, 3.74645123548956*^9}, {3.750949132243795*^9, 
   3.7509491388134403`*^9}, {3.750950512193235*^9, 3.750950512888213*^9}, {
   3.750951457307918*^9, 3.75095145745465*^9}, 
   3.796400855977681*^9},ExpressionUUID->"0a78fb85-1fbf-4654-9fe1-\
104f22d6e001"],

Cell["Module Unit Test input : ", "Text",
 CellChangeTimes->{{3.750954857477921*^9, 
  3.750954876337336*^9}},ExpressionUUID->"3375c5a6-0e99-4278-b426-\
91975e2fd805"],

Cell[BoxData[
 RowBox[{"(*", "  ", 
  RowBox[{"MyDiskDonutCentered", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "5"}], ",", "3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
         "], {{0, 12}, {11, 0}}, {0., 1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{11, 12},
       PlotRange->{{0, 11}, {0, 12}}], ",", 
      GraphicsBox[
       TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
         "], {{0, 12}, {11, 0}}, {0.,
          1.},
         ColorFunction->GrayLevel],
        BoxForm`ImageTag[
        "Real", ColorSpace -> Automatic, Interleaving -> None],
        Selectable->False],
       DefaultBaseStyle->"ImageGraphics",
       ImageSizeRaw->{11, 12},
       PlotRange->{{0, 11}, {0, 12}}]}], "}"}]}], "]"}], "  ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.750955060199387*^9, 3.7509551190982122`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"fb23f662-0308-49d8-b520-4bd294e71915"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MyDiskDonutCentered", "::", "usage"}], "=", 
    "\[IndentingNewLine]", 
    "\"\<Uses masks for the disk and donut, \
{\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
\"], {{0, 12}, {11, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
11, 12},PlotRange->{{0, 11}, {0, \
12}}]\),\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
\"], {{0, 12}, {11, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
11, 12},PlotRange->{{0, 11}, {0, 12}}]\)}, then pads them to center them \
around the centroid, such as this: \
{\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSFIMiAUZRsEoGAWj
YBSMglEweMAHe+z0QNtPb/eMuoM094yC4Q4A5vchAQ==
\"], {{0, 22}, {17, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
17, 22},PlotRange->{{0, 17}, {0, \
22}}]\),\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSFIMiAUZRsEoGAWj
YBSMgoEAH+yJo+llP6XqaGU/rd1DqTmj7qCtOwY6fZBq7kDlX3qXH/QHAA+k
LgY=
\"], {{0, 22}, {17, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
17, 22},PlotRange->{{0, 17}, {0, 22}}]\)}. \n\nInputs\n1. centroid {x,y}, \
ex.:  {-1,1} \n2. masks {disk,donut}, ex.:  \
{\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZRsHgAB/s
sdPUNo9S84eauYTMHwWEAAAJmCDx
\"], {{0, 12}, {11, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
11, 12},PlotRange->{{0, 11}, {0, \
12}}]\),\!\(\*GraphicsBox[TagBox[RasterBox[CompressedData[\"
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBbCBOamKOmUkqSJIHiLkZhhv4YE8c
Ta559FJHqj5SzSNW/1A1d7jEM6Xpl3IAAIu1LfY=
\"], {{0, 12}, {11, 0}}, {0., 1.},ColorFunction->GrayLevel],BoxForm`ImageTag[\
\"Real\", ColorSpace -> Automatic, Interleaving -> \
None],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSizeRaw->{\
11, 12},PlotRange->{{0, 11}, {0, 12}}]\)}\n\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyDiskDonutCentered", "[", 
   RowBox[{"centroid_", ",", "myDiskDonut_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"g", ",", "h"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"g", ",", "h"}], "}"}], " ", "=", " ", "centroid"}], "  ", ";",
      "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"g", "\[LessEqual]", " ", "0"}], " ", "&&", " ", 
        RowBox[{"h", "\[GreaterEqual]", " ", "0"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ImagePad", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"2", "g"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "h"}], "}"}]}], "}"}]}], "]"}], "&"}], "/@", 
        "myDiskDonut"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "\[LessEqual]", "0"}], " ", "&&", " ", 
        RowBox[{"h", "\[LessEqual]", "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ImagePad", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"-", "g"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "h"}], ",", "0"}], "}"}]}], "}"}]}], "]"}], "&"}],
         "/@", "myDiskDonut"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
        RowBox[{"h", "\[GreaterEqual]", "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ImagePad", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"g", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "h"}], "}"}]}], "}"}]}], "]"}], "&"}], "/@", 
        "myDiskDonut"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "\[GreaterEqual]", "0"}], " ", "&&", " ", 
        RowBox[{"h", "\[LessEqual]", "0"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ImagePad", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"g", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "h"}], ",", "0"}], "}"}]}], "}"}]}], "]"}], "&"}],
         "/@", "myDiskDonut"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.5750965858018923`*^9, 3.5750966952420454`*^9}, {
   3.5751516881187415`*^9, 3.5751517415788164`*^9}, {3.5787952659665294`*^9, 
   3.578795266902531*^9}, {3.746450618041257*^9, 3.7464506325390673`*^9}, {
   3.746451229341381*^9, 3.746451233024241*^9}, {3.7464512851329184`*^9, 
   3.746451476184409*^9}, {3.7494086106269345`*^9, 3.749408612465603*^9}, {
   3.7494786662825217`*^9, 3.7494786831055794`*^9}, {3.750949144621682*^9, 
   3.750949171539495*^9}, {3.750949202634305*^9, 3.7509492065697823`*^9}, {
   3.750949249498136*^9, 3.75094935832798*^9}, {3.7509495261099157`*^9, 
   3.7509497203736343`*^9}, {3.750950083209612*^9, 3.750950101374525*^9}, {
   3.751244825867087*^9, 3.7512448342795677`*^9}, 3.7963918987548523`*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"9c38180d-6b03-444d-817b-11b14a91a9be"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "MyDiskandDonutIntensity\n",
 StyleBox["take a line of dataframePF, make masks, center masks via padding, \
then calculate mask area, multiply mask x crop, then calculate mean \
intensity, then export stats: {background subtracted center intensity, \
background intensity, sizeDisk, sizeDonut, stdevDisk, stdevDonut}",
  FontSize->14]
}], "Subsubsection",
 CellChangeTimes->{{3.7464496243784494`*^9, 3.7464496290851107`*^9}, {
   3.746451235258383*^9, 3.74645123548956*^9}, {3.750949132243795*^9, 
   3.7509491388134403`*^9}, {3.750950017616474*^9, 3.750950018408107*^9}, {
   3.750950049325511*^9, 3.750950052579129*^9}, 3.750951542405332*^9, {
   3.750951607120916*^9, 3.750951698469619*^9}, {3.750951739435706*^9, 
   3.750951769329777*^9}, {3.750951806956396*^9, 3.7509518489449253`*^9}, {
   3.7512872720804157`*^9, 3.751287276147211*^9}, {3.7536248229011383`*^9, 
   3.7536248422374372`*^9}, {3.753631344140572*^9, 
   3.7536314326529408`*^9}},ExpressionUUID->"d9002f4d-dbe1-49f1-8a32-\
102b729fe2c1"],

Cell["Module Unit Test input : ", "Text",
 CellChangeTimes->{{3.750954857477921*^9, 
  3.750954876337336*^9}},ExpressionUUID->"56cc26d8-7d85-43ce-b96e-\
591cd9cb9069"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MyDiskDonutIntensity", "[", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     GraphicsBox[
      TagBox[
       RasterBox[
        RawArray["UnsignedInteger16",{{2159, 2370, 2360, 2554, 2322, 2588, 
         2175, 2173, 2244, 1924, 2161}, {2133, 2104, 2389, 2432, 2620, 2265, 
         2325, 2237, 2220, 2340, 2019}, {2189, 2732, 2853, 3227, 3043, 3083, 
         3191, 2484, 2509, 2265, 2215}, {2767, 2635, 3297, 4150, 4992, 4733, 
         4374, 3914, 3072, 2633, 2411}, {2418, 3091, 3896, 4986, 5833, 6092, 
         6172, 5127, 3960, 3068, 2489}, {2508, 2769, 3977, 4627, 5414, 6439, 
         6173, 5800, 4921, 3523, 3003}, {2721, 3000, 3491, 3808, 4900, 5466, 
         5228, 5126, 4046, 3757, 2718}, {2666, 2848, 3242, 3325, 3516, 3543, 
         3759, 3340, 2894, 2746, 2564}, {2534, 2857, 2815, 2941, 3046, 2893, 
         2732, 2664, 2233, 2295, 2169}, {2089, 2506, 2414, 2362, 2363, 2438, 
         2356, 2266, 2246, 2218, 2171}, {2163, 2053, 2306, 2353, 2151, 2160, 
         2280, 2352, 2179, 2201, 2041}}], {{0, 11}, {11, 0}}, {0, 65535},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag[
       "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
        MetaInformation -> 
        Association[
         "Exif" -> Association[
           "NewSubfileType" -> "Primary image", "ImageWidth" -> 624, 
            "ImageLength" -> 944, "BitsPerSample" -> 16, 
            "PhotometricInterpretation" -> "Black Is Zero", 
            "ImageDescription" -> 
            "ImageJ=1.52p\nimages=4\nchannels=4\nmode=composite\nloop=false\n\
min=5746.0\nmax=20647.0", "StripOffsets" -> 325, "SamplesPerPixel" -> 1, 
            "RowsPerStrip" -> 944, "StripByteCounts" -> 1178112]]],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSize->{22., Automatic},
      ImageSizeRaw->{11, 11},
      PlotRange->{{0, 11}, {0, 11}}], ",", 
     GraphicsBox[
      TagBox[
       RasterBox[
        RawArray["UnsignedInteger16",{{1764, 1980, 1945, 2383, 2529, 2210, 
         1911, 2069, 1894, 2049, 1895}, {1868, 2179, 2317, 2636, 2401, 2305, 
         2070, 2050, 1818, 1884, 1929}, {2057, 2512, 2482, 3053, 3192, 2988, 
         2456, 2431, 2026, 1795, 1880}, {2154, 2786, 3396, 4819, 4182, 4321, 
         3294, 2956, 2240, 1856, 1785}, {2160, 2741, 3793, 4944, 5001, 5227, 
         4364, 3283, 2723, 2093, 1952}, {2032, 2279, 3636, 3925, 4931, 4633, 
         4748, 3843, 3275, 2439, 2074}, {1836, 2363, 3108, 3777, 3907, 4373, 
         4585, 3626, 4010, 2955, 2208}, {1807, 2010, 2305, 2789, 3377, 3702, 
         3354, 3339, 3422, 2559, 2185}, {1885, 2003, 2423, 2549, 2672, 2584, 
         2761, 2743, 2578, 1925, 1809}, {1940, 1803, 1965, 2196, 1959, 2191, 
         2264, 2238, 2168, 2026, 1928}, {1889, 1833, 1830, 1835, 2019, 1982, 
         2217, 2137, 1957, 1823, 1891}}], {{0, 11}, {11, 0}}, {0, 65535},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag[
       "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
        MetaInformation -> 
        Association[
         "Exif" -> Association[
           "NewSubfileType" -> "Primary image", "ImageWidth" -> 624, 
            "ImageLength" -> 944, "BitsPerSample" -> 16, 
            "PhotometricInterpretation" -> "Black Is Zero", 
            "ImageDescription" -> 
            "ImageJ=1.52p\nimages=4\nchannels=4\nmode=composite\nloop=false\n\
min=5746.0\nmax=20647.0", "StripOffsets" -> 325, "SamplesPerPixel" -> 1, 
            "RowsPerStrip" -> 944, "StripByteCounts" -> 1178112]]],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSizeRaw->{11, 11},
      PlotRange->{{0, 11}, {0, 11}}], ",", 
     GraphicsBox[
      TagBox[
       RasterBox[
        RawArray["UnsignedInteger16",{{2943, 4235, 5243, 6780, 8268, 8982, 
         8260, 6558, 4762, 3420, 2449}, {3041, 5263, 8420, 14354, 17454, 
         17868, 15862, 11482, 8472, 5637, 3429}, {3969, 7430, 16818, 30307, 
         38771, 38420, 32602, 26430, 17859, 9851, 5310}, {5401, 12507, 29976, 
         52003, 62748, 63335, 55556, 44013, 31186, 17640, 8483}, {5886, 17940,
          40824, 64622, 65535, 65535, 65535, 60552, 44452, 27383, 13718}, {
         6461, 17744, 40308, 64433, 65535, 65535, 65535, 65448, 52562, 35027, 
         19021}, {5829, 14376, 32406, 54117, 64686, 65535, 65535, 63635, 
         51551, 35612, 16696}, {4288, 9896, 21208, 38710, 49381, 56973, 58486,
          52055, 41587, 25957, 12490}, {3574, 6272, 11039, 18593, 26831, 
         32534, 35069, 31299, 23984, 14517, 6253}, {3252, 4507, 6304, 9277, 
         12033, 14311, 15045, 14373, 11463, 6200, 3724}, {2782, 3259, 4085, 
         5124, 5645, 6518, 6293, 5872, 4602, 3579, 2954}}], {{0, 11}, {11, 
        0}}, {0, 65535},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag[
       "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
        MetaInformation -> 
        Association[
         "Exif" -> Association[
           "NewSubfileType" -> "Primary image", "ImageWidth" -> 624, 
            "ImageLength" -> 944, "BitsPerSample" -> 16, 
            "PhotometricInterpretation" -> "Black Is Zero", 
            "ImageDescription" -> 
            "ImageJ=1.52p\nimages=4\nchannels=4\nmode=composite\nloop=false\n\
min=5746.0\nmax=20647.0", "StripOffsets" -> 325, "SamplesPerPixel" -> 1, 
            "RowsPerStrip" -> 944, "StripByteCounts" -> 1178112]]],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSizeRaw->{11, 11},
      PlotRange->{{0, 11}, {0, 11}}], ",", 
     GraphicsBox[
      TagBox[
       RasterBox[
        RawArray["UnsignedInteger16",{{5150, 5963, 6765, 8000, 9771, 8973, 
         8009, 6610, 5384, 4815, 4620}, {5433, 7482, 10027, 12677, 14604, 
         14519, 12740, 10394, 8353, 5890, 4690}, {7183, 11620, 17186, 22448, 
         25222, 25119, 22214, 17810, 13778, 9029, 6275}, {9605, 15315, 23637, 
         31886, 34643, 34561, 33062, 28926, 22283, 14582, 9189}, {11854, 
         20191, 31058, 35733, 37462, 38955, 38580, 35879, 28740, 21067, 
         11137}, {13251, 23909, 35455, 37990, 37087, 36975, 38062, 37380, 
         34193, 25772, 15250}, {12424, 25174, 36418, 39841, 37424, 36596, 
         36751, 36397, 34275, 26175, 16384}, {10920, 22580, 31590, 35924, 
         37431, 35774, 35954, 34170, 29990, 22187, 12592}, {7817, 15325, 
         23815, 30535, 34107, 34021, 32267, 30586, 25831, 17886, 10188}, {
         6073, 9629, 14688, 21373, 24350, 24326, 25306, 23376, 18981, 12865, 
         7903}, {4636, 7195, 8638, 10681, 13150, 14213, 15151, 16013, 11865, 
         8505, 6173}}], {{0, 11}, {11, 0}}, {0, 65535},
        ColorFunction->GrayLevel],
       BoxForm`ImageTag[
       "Bit16", ColorSpace -> "Grayscale", Interleaving -> None, 
        MetaInformation -> 
        Association[
         "Exif" -> Association[
           "NewSubfileType" -> "Primary image", "ImageWidth" -> 624, 
            "ImageLength" -> 944, "BitsPerSample" -> 16, 
            "PhotometricInterpretation" -> "Black Is Zero", 
            "ImageDescription" -> 
            "ImageJ=1.52p\nimages=4\nchannels=4\nmode=composite\nloop=false\n\
min=5746.0\nmax=20647.0", "StripOffsets" -> 325, "SamplesPerPixel" -> 1, 
            "RowsPerStrip" -> 944, "StripByteCounts" -> 1178112]]],
       Selectable->False],
      DefaultBaseStyle->"ImageGraphics",
      ImageSizeRaw->{11, 11},
      PlotRange->{{0, 11}, {0, 11}}]}], "}"}], ",", " ", "1.5", ",", " ", "7",
    ",", " ", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.796390207820122*^9, 3.796390242120866*^9}, {
   3.796390343639681*^9, 3.796390369224848*^9}, {3.796391476542094*^9, 
   3.796391486924451*^9}, 3.796392113519389*^9, {3.796392450752205*^9, 
   3.796392451176455*^9}, {3.796392830096846*^9, 3.796392840022279*^9}, {
   3.796400767060446*^9, 3.796400804847747*^9}},
 CellLabel->
  "In[283]:=",ExpressionUUID->"719fbeac-471a-4852-9f97-7a5a9e2a95bf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.04905658081555978`", ",", 
     RowBox[{"{", 
      RowBox[{"0.08265694717948253`", ",", "0.03360036636392275`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.07222095131874084`", ",", "0.08900587260723114`", ",", 
         "0.09295795857906342`", ",", "0.0941786840558052`", ",", 
         "0.07060349732637405`", ",", "0.08261234313249588`", ",", 
         "0.09825284034013748`", ",", "0.0941939428448677`", ",", 
         "0.08850232511758804`", ",", "0.07476920634508133`", ",", 
         "0.08340581506490707`", ",", "0.0797741636633873`", ",", 
         "0.05406271293759346`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0.03294422850012779`", ",", "0.03616388142108917`", ",", 
         "0.03601129353046417`", ",", "0.034241244196891785`", ",", 
         "0.029358359053730965`", ",", "0.03297474607825279`", ",", 
         "0.032547492533922195`", ",", "0.0321049839258194`", ",", 
         "0.035706110298633575`", ",", "0.030807964503765106`", ",", 
         "0.03340199962258339`", ",", "0.03379873186349869`", ",", 
         "0.03866636008024216`", ",", "0.03309682011604309`", ",", 
         "0.0318760983645916`", ",", "0.03823911026120186`", ",", 
         "0.033844511955976486`", ",", "0.03312733769416809`", ",", 
         "0.03300526365637779`", ",", "0.0313267707824707`", ",", 
         "0.03518730401992798`", ",", "0.03324940800666809`", ",", 
         "0.03358510881662369`", ",", "0.031143663451075554`"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.038355213154155104`", ",", 
     RowBox[{"{", 
      RowBox[{"0.0675622528562179`", ",", "0.029207039702062804`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.06593423336744308`", ",", "0.07631036639213562`", ",", 
         "0.0797589048743248`", ",", "0.06659036874771118`", ",", 
         "0.05989165976643562`", ",", "0.07524223625659943`", ",", 
         "0.07069505006074905`", ",", "0.07244983315467834`", ",", 
         "0.05864042043685913`", ",", "0.059616997838020325`", ",", 
         "0.06672770529985428`", ",", "0.06996261328458786`", ",", 
         "0.056488897651433945`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0.02691691555082798`", ",", "0.03021286427974701`", ",", 
         "0.029678797349333763`", ",", "0.028900587931275368`", ",", 
         "0.0312657356262207`", ",", "0.028915846720337868`", ",", 
         "0.02850385382771492`", ",", "0.03324940800666809`", ",", 
         "0.02874799817800522`", ",", "0.029434652999043465`", ",", 
         "0.031387809664011`", ",", "0.02868696115911007`", ",", 
         "0.02876325696706772`", ",", "0.027603570371866226`", ",", 
         "0.029602503404021263`", ",", "0.027512015774846077`", ",", 
         "0.030914777889847755`", ",", "0.029419394209980965`", ",", 
         "0.02882429212331772`", ",", "0.027969786897301674`", ",", 
         "0.027924010530114174`", ",", "0.02986190654337406`", ",", 
         "0.027817197144031525`", ",", "0.02885480970144272`"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9223679701248424`", ",", 
     RowBox[{"{", 
      RowBox[{"0.9849757368748006`", ",", "0.06260776674995819`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.966430127620697`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
         "0.9831845760345459`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
         "0.9986724853515625`", ",", "0.9870451092720032`", ",", "1.`", ",", 
         "1.`", ",", "0.8693522810935974`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0.04490730166435242`", ",", "0.0646219551563263`", ",", 
         "0.0800030529499054`", ",", "0.07266346365213394`", ",", 
         "0.05218585580587387`", ",", "0.037369344383478165`", ",", 
         "0.04640268534421921`", ",", "0.0803082287311554`", ",", 
         "0.08601510524749756`", ",", "0.05232318490743637`", ",", 
         "0.06056305766105652`", ",", "0.08102540671825409`", ",", 
         "0.05453574284911156`", ",", "0.0954146608710289`", ",", 
         "0.04962233826518059`", ",", "0.06877241283655167`", ",", 
         "0.0946059376001358`", ",", "0.05682459846138954`", ",", 
         "0.04245059937238693`", ",", "0.049729153513908386`", ",", 
         "0.06233310326933861`", ",", "0.07022202014923096`", ",", 
         "0.054612040519714355`", ",", "0.045075152069330215`"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4588244592484374`", ",", 
     RowBox[{"{", 
      RowBox[{"0.5676320928793688`", ",", "0.10880763363093138`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0.5273670554161072`", ",", "0.5716334581375122`", ",", 
         "0.5944151878356934`", ",", "0.5886930823326111`", ",", 
         "0.5796902179718018`", ",", "0.5659113526344299`", ",", 
         "0.5642023086547852`", ",", "0.5807889103889465`", ",", 
         "0.5703822374343872`", ",", "0.5710536241531372`", ",", 
         "0.5584191679954529`", ",", "0.5607843399047852`", ",", 
         "0.5458762645721436`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "0.0785839632153511`", ",", "0.09098954498767853`", ",", 
         "0.10322728008031845`", ",", "0.08215457201004028`", ",", 
         "0.07347218692302704`", ",", "0.07049667835235596`", ",", 
         "0.08290226757526398`", ",", "0.11416800320148468`", ",", 
         "0.08987563848495483`", ",", "0.07156481593847275`", ",", 
         "0.10960555076599121`", ",", "0.0957503616809845`", ",", 
         "0.11927977204322815`", ",", "0.15545891225337982`", ",", 
         "0.09266804158687592`", ",", "0.14692911505699158`", ",", 
         "0.19630731642246246`", ",", "0.12059205025434494`", ",", 
         "0.07074082642793655`", ",", "0.10978866368532181`", ",", 
         "0.13180743157863617`", ",", "0.18104828894138336`", ",", 
         "0.12977798283100128`", ",", "0.0941939428448677`"}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.796404459193749*^9, 3.796404461613571*^9}},
 CellLabel->
  "Out[283]=",ExpressionUUID->"247f171c-0197-4b79-8f7a-fb215c3d4b40"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.796404413706273*^9, 
  3.796404414715735*^9}},ExpressionUUID->"45f0c545-9be3-4b4e-b87d-\
ed7cc78438a6"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.796404319195938*^9, 
  3.796404320252549*^9}},ExpressionUUID->"5c3cdf35-52b2-4886-83c9-\
25d1d5c303ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MyDiskDonutIntensity", "::", "usage"}], "=", 
   "\[IndentingNewLine]", 
   "\"\<Gives the Disk&Donut calculated intensity of a set of crops (in \
different channels, presumably). Output:  {{RED Disk Ints, RED Donut Ints}, \
RED Di-Do Ints}, ...} for each channel. \n\nInputs\n1. mycrops: list of crops \
for 1 spot, eg  \
{\!\(\*GraphicsBox[TagBox[RasterBox[RawArray[\"UnsignedInteger16\",{{2159, \
2370, 2360, 2554, 2322, 2588, 2175, 2173, 2244, 1924, 2161}, {2133, 2104, \
2389, 2432, 2620, 2265, 2325, 2237, 2220, 2340, 2019}, {2189, 2732, 2853, \
3227, 3043, 3083, 3191, 2484, 2509, 2265, 2215}, {2767, 2635, 3297, 4150, \
4992, 4733, 4374, 3914, 3072, 2633, 2411}, {2418, 3091, 3896, 4986, 5833, \
6092, 6172, 5127, 3960, 3068, 2489}, {2508, 2769, 3977, 4627, 5414, 6439, \
6173, 5800, 4921, 3523, 3003}, {2721, 3000, 3491, 3808, 4900, 5466, 5228, \
5126, 4046, 3757, 2718}, {2666, 2848, 3242, 3325, 3516, 3543, 3759, 3340, \
2894, 2746, 2564}, {2534, 2857, 2815, 2941, 3046, 2893, 2732, 2664, 2233, \
2295, 2169}, {2089, 2506, 2414, 2362, 2363, 2438, 2356, 2266, 2246, 2218, \
2171}, {2163, 2053, 2306, 2353, 2151, 2160, 2280, 2352, 2179, 2201, 2041}}], \
{{0, 11}, {11, 0}}, {0, \
65535},ColorFunction->GrayLevel],BoxForm`ImageTag[\"Bit16\", ColorSpace -> \
\"Grayscale\", Interleaving -> None, MetaInformation -> Association[\"Exif\" \
-> Association[\"NewSubfileType\" -> \"Primary image\", \"ImageWidth\" -> \
624, \"ImageLength\" -> 944, \"BitsPerSample\" -> 16, \
\"PhotometricInterpretation\" -> \"Black Is Zero\", \"ImageDescription\" -> \
\"ImageJ=1.52pimages=4channels=4mode=compositeloop=falsemin=5746.0max=20647.0\
\", \"StripOffsets\" -> 325, \"SamplesPerPixel\" -> 1, \"RowsPerStrip\" -> \
944, \"StripByteCounts\" -> \
1178112]]],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",ImageSize->{\
22., Automatic},ImageSizeRaw->{11, 11},PlotRange->{{0, 11}, {0, \
11}}]\),\!\(\*GraphicsBox[TagBox[RasterBox[RawArray[\"UnsignedInteger16\",{{\
1764, 1980, 1945, 2383, 2529, 2210, 1911, 2069, 1894, 2049, 1895}, {1868, \
2179, 2317, 2636, 2401, 2305, 2070, 2050, 1818, 1884, 1929}, {2057, 2512, \
2482, 3053, 3192, 2988, 2456, 2431, 2026, 1795, 1880}, {2154, 2786, 3396, \
4819, 4182, 4321, 3294, 2956, 2240, 1856, 1785}, {2160, 2741, 3793, 4944, \
5001, 5227, 4364, 3283, 2723, 2093, 1952}, {2032, 2279, 3636, 3925, 4931, \
4633, 4748, 3843, 3275, 2439, 2074}, {1836, 2363, 3108, 3777, 3907, 4373, \
4585, 3626, 4010, 2955, 2208}, {1807, 2010, 2305, 2789, 3377, 3702, 3354, \
3339, 3422, 2559, 2185}, {1885, 2003, 2423, 2549, 2672, 2584, 2761, 2743, \
2578, 1925, 1809}, {1940, 1803, 1965, 2196, 1959, 2191, 2264, 2238, 2168, \
2026, 1928}, {1889, 1833, 1830, 1835, 2019, 1982, 2217, 2137, 1957, 1823, \
1891}}], {{0, 11}, {11, 0}}, {0, \
65535},ColorFunction->GrayLevel],BoxForm`ImageTag[\"Bit16\", ColorSpace -> \
\"Grayscale\", Interleaving -> None, MetaInformation -> Association[\"Exif\" \
-> Association[\"NewSubfileType\" -> \"Primary image\", \"ImageWidth\" -> \
624, \"ImageLength\" -> 944, \"BitsPerSample\" -> 16, \
\"PhotometricInterpretation\" -> \"Black Is Zero\", \"ImageDescription\" -> \
\"ImageJ=1.52pimages=4channels=4mode=compositeloop=falsemin=5746.0max=20647.0\
\", \"StripOffsets\" -> 325, \"SamplesPerPixel\" -> 1, \"RowsPerStrip\" -> \
944, \"StripByteCounts\" -> \
1178112]]],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",\
ImageSizeRaw->{11, 11},PlotRange->{{0, 11}, {0, \
11}}]\),\!\(\*GraphicsBox[TagBox[RasterBox[RawArray[\"UnsignedInteger16\",{{\
2943, 4235, 5243, 6780, 8268, 8982, 8260, 6558, 4762, 3420, 2449}, {3041, \
5263, 8420, 14354, 17454, 17868, 15862, 11482, 8472, 5637, 3429}, {3969, \
7430, 16818, 30307, 38771, 38420, 32602, 26430, 17859, 9851, 5310}, {5401, \
12507, 29976, 52003, 62748, 63335, 55556, 44013, 31186, 17640, 8483}, {5886, \
17940, 40824, 64622, 65535, 65535, 65535, 60552, 44452, 27383, 13718}, {6461, \
17744, 40308, 64433, 65535, 65535, 65535, 65448, 52562, 35027, 19021}, {5829, \
14376, 32406, 54117, 64686, 65535, 65535, 63635, 51551, 35612, 16696}, {4288, \
9896, 21208, 38710, 49381, 56973, 58486, 52055, 41587, 25957, 12490}, {3574, \
6272, 11039, 18593, 26831, 32534, 35069, 31299, 23984, 14517, 6253}, {3252, \
4507, 6304, 9277, 12033, 14311, 15045, 14373, 11463, 6200, 3724}, {2782, \
3259, 4085, 5124, 5645, 6518, 6293, 5872, 4602, 3579, 2954}}], {{0, 11}, {11, \
0}}, {0, 65535},ColorFunction->GrayLevel],BoxForm`ImageTag[\"Bit16\", \
ColorSpace -> \"Grayscale\", Interleaving -> None, MetaInformation -> \
Association[\"Exif\" -> Association[\"NewSubfileType\" -> \"Primary image\", \
\"ImageWidth\" -> 624, \"ImageLength\" -> 944, \"BitsPerSample\" -> 16, \
\"PhotometricInterpretation\" -> \"Black Is Zero\", \"ImageDescription\" -> \
\"ImageJ=1.52pimages=4channels=4mode=compositeloop=falsemin=5746.0max=20647.0\
\", \"StripOffsets\" -> 325, \"SamplesPerPixel\" -> 1, \"RowsPerStrip\" -> \
944, \"StripByteCounts\" -> \
1178112]]],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",\
ImageSizeRaw->{11, 11},PlotRange->{{0, 11}, {0, \
11}}]\),\!\(\*GraphicsBox[TagBox[RasterBox[RawArray[\"UnsignedInteger16\",{{\
5150, 5963, 6765, 8000, 9771, 8973, 8009, 6610, 5384, 4815, 4620}, {5433, \
7482, 10027, 12677, 14604, 14519, 12740, 10394, 8353, 5890, 4690}, {7183, \
11620, 17186, 22448, 25222, 25119, 22214, 17810, 13778, 9029, 6275}, {9605, \
15315, 23637, 31886, 34643, 34561, 33062, 28926, 22283, 14582, 9189}, {11854, \
20191, 31058, 35733, 37462, 38955, 38580, 35879, 28740, 21067, 11137}, \
{13251, 23909, 35455, 37990, 37087, 36975, 38062, 37380, 34193, 25772, \
15250}, {12424, 25174, 36418, 39841, 37424, 36596, 36751, 36397, 34275, \
26175, 16384}, {10920, 22580, 31590, 35924, 37431, 35774, 35954, 34170, \
29990, 22187, 12592}, {7817, 15325, 23815, 30535, 34107, 34021, 32267, 30586, \
25831, 17886, 10188}, {6073, 9629, 14688, 21373, 24350, 24326, 25306, 23376, \
18981, 12865, 7903}, {4636, 7195, 8638, 10681, 13150, 14213, 15151, 16013, \
11865, 8505, 6173}}], {{0, 11}, {11, 0}}, {0, \
65535},ColorFunction->GrayLevel],BoxForm`ImageTag[\"Bit16\", ColorSpace -> \
\"Grayscale\", Interleaving -> None, MetaInformation -> Association[\"Exif\" \
-> Association[\"NewSubfileType\" -> \"Primary image\", \"ImageWidth\" -> \
624, \"ImageLength\" -> 944, \"BitsPerSample\" -> 16, \
\"PhotometricInterpretation\" -> \"Black Is Zero\", \"ImageDescription\" -> \
\"ImageJ=1.52pimages=4channels=4mode=compositeloop=falsemin=5746.0max=20647.0\
\", \"StripOffsets\" -> 325, \"SamplesPerPixel\" -> 1, \"RowsPerStrip\" -> \
944, \"StripByteCounts\" -> \
1178112]]],Selectable->False],DefaultBaseStyle->\"ImageGraphics\",\
ImageSizeRaw->{11, 11},PlotRange->{{0, 11}, {0, 11}}]\)}\n2. myDonutRadius: \
Diff Lim Spot, use 2 or 3\n3. myDiskRadius: use the donutRadius, unless you \
want a pixel gap between your disk and donut\n4. myDiskWidth: Diff Lim Spot, \
use myPadSize unless you want a bigger/smaller disk\n\>\""}], ";"}]], "Input",\

 CellChangeTimes->{{3.796400639660453*^9, 3.796400747018486*^9}, 
   3.7964008289183826`*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"9d3e777a-6599-417e-941b-8de7c21c2f3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyDiskDonutIntensity", "[", 
   RowBox[{
   "mycrops_", ",", "  ", "myDonutRadius_", ",", "  ", "myDiskRadius_", ",", 
    "  ", "myDiskWidth_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myPadSize", ",", " ", "len", ",", " ", "centroidRaw", ",", 
      "centroidUltimate", ",", "centroid", " ", ",", " ", "masks", ",", "  ", 
      "blank", ",", "centeredmasks", ",", " ", "centeredMasks", ",", 
      "masksizes", ",", "mymaskedcrops", ",", "allIntensityPixs", ",", " ", 
      "meanIntensities", ",", "meanBGintensity"}], "   ", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myPadSize", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"ImageDimensions", "[", " ", 
           RowBox[{"mycrops", "[", 
            RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], "  ", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "-", " ", "1"}], " ", ")"}], 
       "/", "2"}]}], " ", ";", "\[IndentingNewLine]", 
     RowBox[{"len", " ", "=", " ", 
      RowBox[{"Length", "@", "mycrops"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"centroidRaw", " ", "=", " ", 
      RowBox[{"ImageMeasurements", "[", 
       RowBox[{
        RowBox[{"ImageAdjust", "[", " ", 
         RowBox[{"mycrops", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
        "\"\<IntensityCentroid\>\""}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "This", " ", "little", " ", "trick", " ", "rounds", " ", "the", " ", 
       "number", " ", "without", " ", "using", " ", "the", " ", "shitty", " ",
        "mma", " ", "round", " ", "fxn"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"centroidUltimate", "  ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Ceiling", "[", " ", 
         RowBox[{"(", 
          RowBox[{"#", "-", "0.5"}], ")"}], " ", "]"}], "&"}], "/@", 
       "centroidRaw"}]}], "  ", ";", "\[IndentingNewLine]", 
     RowBox[{"centroid", " ", "=", " ", 
      RowBox[{"centroidUltimate", " ", "-", " ", 
       RowBox[{"{", 
        RowBox[{"myPadSize", " ", ",", " ", "myPadSize"}], "}"}]}]}], "   ", 
     ";", " ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Use", " ", "THIS", " ", "is", " ", "as", " ", "the", " ", "centroid", 
        " ", "because", " ", "you", " ", "recenter", " ", "to", " ", "0.", 
        " ", "Not", " ", "subtracting", " ", "the", " ", "pad", " ", "size", 
        " ", "will", " ", "leave", " ", "the", " ", "centroid", " ", "half", 
        " ", "a", " ", "Pad", " ", "away", " ", "from", " ", "center"}], 
       "..."}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "That", " ", "is", " ", "the", " ", "intesntiy", " ", "centroid", " ", 
        "in", " ", "X"}], ",", "Y"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "I", " ", "will", " ", "always", " ", "find", " ", "the", " ", 
        "cetroid", " ", "in", " ", "teh", " ", "RED", " ", "channel"}], ",", 
       " ", 
       RowBox[{
        RowBox[{"since", " ", 
         RowBox[{"I", "'"}], "m", " ", "always", " ", "looking", " ", "at", 
         " ", "red", " ", 
         RowBox[{"spots", "."}]}], " ", "\[IndentingNewLine]", "\[Rule]", " ", 
        RowBox[{"I", " ", "will", " ", "assume", " ", 
         RowBox[{"I", "'"}], "m", " ", "lookig", " ", "at", " ", "a", " ", 
         "row", " ", "of", " ", "crops"}]}], ",", " ", 
       RowBox[{
        RowBox[{
        "with", " ", "the", " ", "first", " ", "one", " ", "being", " ", 
         RowBox[{"red", "."}]}], " ", "\[IndentingNewLine]", "\[Rule]", " ", 
        RowBox[{
        "This", " ", "can", " ", "be", " ", "changed", " ", "in", " ", "the", 
         " ", "future", " ", "if", " ", "the", " ", "input", " ", "will", " ",
          "be", " ", "just", " ", "ONE", " ", "crop", " ", "or", " ", "if", 
         " ", "I", " ", "want", " ", "to", " ", "have", " ", "the", " ", 
         "intensity", " ", "centroid", " ", "change", " ", "PER", " ", "crop",
          " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"i", ".", "e", ".", " ", "a"}], " ", "new", " ", 
            "intensity", " ", "centroid", " ", "centered", " ", "around", " ",
             "blue", " ", "or", " ", "purple", " ", "or", " ", "whatever"}], 
           ")"}], "."}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"masks", " ", "=", " ", 
      RowBox[{"MyDiskDonutMask", "[", 
       RowBox[{
        RowBox[{"myPadSize", "+", "2"}], ",", "myDonutRadius", ",", 
        "myDiskRadius", " ", ",", " ", "myDiskWidth"}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centeredmasks", " ", "=", " ", 
      RowBox[{"MyDiskDonutCentered", "[", 
       RowBox[{"centroid", ",", " ", "masks"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"blank", "=", " ", 
      RowBox[{"Image", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"myPadSize", "*", "2"}], "+", "1"}], ")"}]}], "]"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"myPadSize", "*", "2"}], "+", "1"}], ")"}]}], "]"}], 
       "]"}]}], "   ", ";", " ", "\[IndentingNewLine]", 
     RowBox[{"centeredMasks", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{"blank", ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"MyDiskDonutCentered", "[", 
        RowBox[{"centroid", ",", "masks"}], "]"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"masksizes", " ", "=", "  ", 
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"ImageData", "[", "#", "]"}]}], ",", "1."}], "]"}], "&"}], 
       "/@", "centeredMasks"}]}], "  ", ";", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "counts", " ", "nonzero", " ", "pixels", " ", "in", " ", "masks"}], 
       ",", " ", 
       RowBox[{
       "which", " ", "correspond", " ", "to", " ", "pixel", " ", "size", " ", 
        "of", " ", "masks"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mymaskedcrops", " ", "=", " ", 
      RowBox[{"Table", " ", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ImageMultiply", "[", 
           RowBox[{
            RowBox[{"mycrops", "[", 
             RowBox[{"[", "color", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
          "centeredMasks"}], " ", ",", " ", 
        RowBox[{"{", 
         RowBox[{"color", ",", "1", ",", "len"}], "}"}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"allIntensityPixs", "=", "   ", 
      RowBox[{"Table", "[", "    ", 
       RowBox[{
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Select", "[", " ", 
           RowBox[{
            RowBox[{"Flatten", "@", 
             RowBox[{"ImageData", "[", 
              RowBox[{"mymaskedcrops", "[", 
               RowBox[{"[", 
                RowBox[{"color", ",", " ", "i"}], "]"}], "]"}], "]"}]}], " ", 
            ",", " ", 
            RowBox[{
             RowBox[{"#", ">", "0"}], "&"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"mymaskedcrops", "[", 
              RowBox[{"[", "color", "]"}], "]"}]}], ",", "1"}], "}"}]}], 
         "]"}], ",", "\[IndentingNewLine]", " ", 
        RowBox[{"{", 
         RowBox[{"color", ",", "1", ",", "len"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"meanIntensities", "=", "   ", 
      RowBox[{"Table", "[", "    ", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", 
            RowBox[{"Flatten", "@", 
             RowBox[{"ImageData", "[", 
              RowBox[{"mymaskedcrops", "[", 
               RowBox[{"[", 
                RowBox[{"color", ",", " ", "i"}], "]"}], "]"}], "]"}]}], 
            "]"}], "/", 
           RowBox[{"masksizes", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{"mymaskedcrops", "[", 
              RowBox[{"[", "color", "]"}], "]"}]}], ",", "1"}], "}"}]}], 
         "]"}], ",", "\[IndentingNewLine]", " ", 
        RowBox[{"{", 
         RowBox[{"color", ",", "1", ",", "len"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"meanBGintensity", " ", "=", "   ", 
      RowBox[{"Table", "[", "  ", 
       RowBox[{
        RowBox[{
         RowBox[{"meanIntensities", "\[LeftDoubleBracket]", 
          RowBox[{"color", ",", " ", "1"}], "\[RightDoubleBracket]"}], "-", 
         " ", 
         RowBox[{"meanIntensities", "\[LeftDoubleBracket]", 
          RowBox[{"color", ",", " ", "2"}], "\[RightDoubleBracket]"}]}], " ", 
        ",", " ", "\[IndentingNewLine]", " ", 
        RowBox[{"{", 
         RowBox[{"color", ",", "1", ",", "len"}], "}"}]}], "]"}]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
         "meanBGintensity", " ", "\[LeftDoubleBracket]", "color", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
         "meanIntensities", " ", "\[LeftDoubleBracket]", "color", 
          "\[RightDoubleBracket]"}], " ", ",", " ", 
         RowBox[{
         "allIntensityPixs", "\[LeftDoubleBracket]", "color", 
          "\[RightDoubleBracket]"}]}], "}"}], ",", " ", "\[IndentingNewLine]",
        " ", 
       RowBox[{"{", 
        RowBox[{"color", ",", "1", ",", "len"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"RESULTS", ":", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"mean", " ", "disk"}], "-", 
         RowBox[{"donut", " ", "intensity", " ", 
          RowBox[{"(", 
           RowBox[{"Di", "-", "Do"}], ")"}]}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mean", " ", "intensity", " ", "disk", " ", 
           RowBox[{"(", "Disk", ")"}]}], ",", " ", 
          RowBox[{"mean", " ", "intenstiy", " ", "donut", " ", 
           RowBox[{"(", "donut", ")"}]}]}], "}"}], " ", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"All", " ", "Disk", " ", "pixel", " ", "intensities"}], 
            "..."}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"All", " ", "Donut", " ", "pixel", " ", "intensities"}], 
            "..."}], "}"}]}], "}"}]}], "}"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"RED", " ", "Di"}], "-", "Do"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RED", " ", "Disk"}], ",", " ", 
            RowBox[{"RED", " ", "Donut"}]}], "}"}], ",", "  ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Red", " ", "Disk", " ", "Pix"}], "..."}], "}"}], ",", 
            " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Red", " ", "Donut", " ", "Pix"}], "..."}], "}"}]}], 
           "}"}]}], "  ", "}"}], " ", ",", " ", 
        RowBox[{"GRN", " ", "..."}], " ", ",", " ", 
        RowBox[{"BLU", " ", "..."}], " ", ",", "  ", 
        RowBox[{"PURP", "..."}]}], "  "}]}]}], "*)"}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796398294061943*^9, 3.796398462270859*^9}, {
   3.7963985186506233`*^9, 3.796398526997797*^9}, {3.796398558484681*^9, 
   3.796398666266556*^9}, {3.796398697125163*^9, 3.7963986976179943`*^9}, {
   3.7963987776441*^9, 3.79639885291603*^9}, {3.796398901251598*^9, 
   3.796398929775834*^9}, {3.7963989996812077`*^9, 3.796399033645464*^9}, {
   3.796399152593471*^9, 3.7963991532281637`*^9}, 3.7963991936419077`*^9, {
   3.796400292331275*^9, 3.796400356857592*^9}, {3.796400389832747*^9, 
   3.796400523629655*^9}, {3.796400567233632*^9, 3.796400621112296*^9}, 
   3.796400832466913*^9, {3.7964042936307*^9, 3.796404307952849*^9}, {
   3.796404338979618*^9, 3.796404407758704*^9}, {3.79640500864636*^9, 
   3.796405051205853*^9}, {3.796405083664548*^9, 3.7964052145520563`*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"ba116d1d-fa9b-47f0-8ccc-002529becb88"]
}, Open  ]]
},
WindowSize->{1243, 811},
WindowMargins->{{4, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 546, 8, 45, "Subsubsection",ExpressionUUID->"06ef67d0-8399-4056-8186-b94c6196eb57"],
Cell[1129, 32, 3794, 81, 334, "Input",ExpressionUUID->"71807987-e891-4d2a-a837-91498f2756df"]
}, Closed]],
Cell[CellGroupData[{
Cell[4960, 118, 393, 6, 37, "Subsubsection",ExpressionUUID->"0a78fb85-1fbf-4654-9fe1-104f22d6e001"],
Cell[5356, 126, 167, 3, 35, "Text",ExpressionUUID->"3375c5a6-0e99-4278-b426-91975e2fd805"],
Cell[5526, 131, 1342, 36, 39, "Input",ExpressionUUID->"fb23f662-0308-49d8-b520-4bd294e71915"],
Cell[6871, 169, 6473, 139, 448, "Input",ExpressionUUID->"9c38180d-6b03-444d-817b-11b14a91a9be"]
}, Closed]],
Cell[CellGroupData[{
Cell[13381, 313, 1024, 17, 75, "Subsubsection",ExpressionUUID->"d9002f4d-dbe1-49f1-8a32-102b729fe2c1"],
Cell[14408, 332, 167, 3, 35, "Text",ExpressionUUID->"56cc26d8-7d85-43ce-b96e-591cd9cb9069"],
Cell[CellGroupData[{
Cell[14600, 339, 7922, 145, 39, "Input",ExpressionUUID->"719fbeac-471a-4852-9f97-7a5a9e2a95bf"],
Cell[22525, 486, 6341, 126, 308, "Output",ExpressionUUID->"247f171c-0197-4b79-8f7a-fb215c3d4b40"]
}, Open  ]],
Cell[28881, 615, 152, 3, 30, "Input",ExpressionUUID->"45f0c545-9be3-4b4e-b87d-ed7cc78438a6"],
Cell[29036, 620, 152, 3, 30, "Input",ExpressionUUID->"5c3cdf35-52b2-4886-83c9-25d1d5c303ef"],
Cell[29191, 625, 7167, 104, 227, "Input",ExpressionUUID->"9d3e777a-6599-417e-941b-8de7c21c2f3a"],
Cell[36361, 731, 12836, 301, 892, "Input",ExpressionUUID->"ba116d1d-fa9b-47f0-8ccc-002529becb88"]
}, Open  ]]
}
]
*)

