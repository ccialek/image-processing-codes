(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    712100,      15581]
NotebookOptionsPosition[    685148,      15156]
NotebookOutlinePosition[    685533,      15173]
CellTagsIndexPosition[    685490,      15170]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["README", "Section",
 CellChangeTimes->{{3.652215360972802*^9, 3.652215361253603*^9}, {
  3.78008042119586*^9, 
  3.780080424355165*^9}},ExpressionUUID->"3f07c72f-85b6-4681-a408-\
a4718c8f0c18"],

Cell[TextData[StyleBox["PURPOSE: To make \[OpenCurlyQuote]gif\
\[CloseCurlyQuote] 20f short video showing different colored tracked spots \n\
Red, Purple, Yel and White only ",
 FontSize->36,
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.6522153655592103`*^9, 3.6522154663197875`*^9}, {
   3.678312147583539*^9, 3.678312185902731*^9}, {3.6783219579446597`*^9, 
   3.6783219785338373`*^9}, {3.6786316276437817`*^9, 3.678632063908735*^9}, 
   3.6955758494167385`*^9, {3.7180218002157917`*^9, 3.7180218084866943`*^9}, {
   3.725211718679832*^9, 3.725211816174674*^9}, {3.7800794324507504`*^9, 
   3.7800794634858723`*^9}, {3.780080416750127*^9, 
   3.780080417752246*^9}},ExpressionUUID->"7b09ba0a-f281-4131-9a7c-\
b1666f34a03b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.575085645362406*^9, 3.5750856463124075`*^9}, {
  3.5774930265230093`*^9, 3.5774930278830867`*^9}, {3.712936679691573*^9, 
  3.712936679835582*^9}},ExpressionUUID->"758ecad8-d80b-46fb-82bb-\
ad2e406fd28c"],

Cell[CellGroupData[{

Cell["FitMySpotIntensity[img_,sigma_,dims_]", "Subsection",
 CellChangeTimes->{{3.7186598833497066`*^9, 3.7186598911906433`*^9}, 
   3.726008474223016*^9},ExpressionUUID->"8cb08f85-32ab-4789-b881-\
6daec01df10a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FitMySpotIntensity", "[", 
   RowBox[{"img_", ",", "sigma_", ",", "dims_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myzs", ",", "my3Ddata", ",", "nlm", ",", "A", ",", "CC", ",", "x", ",", 
      "x0", ",", "y", ",", "y0"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myzs", "=", 
      RowBox[{"ImageData", "@", "img"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"my3Ddata", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j", ",", 
           RowBox[{"myzs", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "dims", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "dims", ",", "1"}], "}"}]}], "]"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nlm", "=", 
      RowBox[{"NonlinearModelFit", "[", 
       RowBox[{"my3Ddata", ",", 
        RowBox[{"CC", "+", 
         RowBox[{"A", " ", 
          RowBox[{"E", "^", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", 
                RowBox[{"sigma", "^", "2"}]}], ")"}]}], "-", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", 
                RowBox[{"sigma", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"CC", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x0", ",", 
            RowBox[{"dims", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y0", ",", 
            RowBox[{"dims", "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"A", ",", "0.5"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "/.", 
        RowBox[{"nlm", "[", "\"\<BestFitParameters\>\"", "]"}]}], ",", 
       RowBox[{
        RowBox[{"nlm", "[", "\"\<ParameterConfidenceIntervals\>\"", "]"}], 
        "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.718659550490794*^9, 3.7186597685396814`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"656dff07-5f80-4e42-88e5-ac9f6caab26e"]
}, Closed]],

Cell[CellGroupData[{

Cell["ImgCoord2DataCoord (integer)", "Subsection",
 CellChangeTimes->{{3.715707646859561*^9, 3.7157076885559464`*^9}, {
  3.7157157411215267`*^9, 
  3.715715743770678*^9}},ExpressionUUID->"e3cd521a-93de-4017-a61c-\
bfc187e2d2e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Img2DataCoord", "[", 
   RowBox[{"imageSize_", ",", "coordinate_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
        "}"}], "&"}], "@", 
     RowBox[{"Abs", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{
           RowBox[{
           "imageSize", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "+", "1"}]}], "}"}], "-", 
        RowBox[{"Ceiling", "@", "coordinate"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.71570769159112*^9, 3.715707770748647*^9}, {
  3.7157078970378704`*^9, 3.7157079243804345`*^9}, {3.7157079962525454`*^9, 
  3.7157079981646547`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"096d0ea6-8ac6-4f77-ad10-03ee9de40601"]
}, Closed]],

Cell[CellGroupData[{

Cell["BandPass", "Subsection",
 CellChangeTimes->{{3.5781169365680165`*^9, 
  3.57811693907802*^9}},ExpressionUUID->"f98a213a-716d-497c-9a1d-\
3bfe197e8d3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BandPass", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgb", ",", "imgc"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgb", "=", 
      RowBox[{"ImageConvolve", "[", 
       RowBox[{"img", ",", 
        RowBox[{"GaussianMatrix", "[", 
         RowBox[{"{", 
          RowBox[{"hi", ",", "lo"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"imgc", "=", 
        RowBox[{"ImageConvolve", "[", 
         RowBox[{"img", ",", 
          FractionBox[
           RowBox[{"BoxMatrix", "[", "hi", "]"}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "hi"}], "+", "1"}], ")"}], "2"]]}], "]"}]}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"imgc", "=", 
      RowBox[{"ImageConvolve", "[", 
       RowBox[{"img", ",", 
        FractionBox[
         RowBox[{"DiskMatrix", "[", "hi", "]"}], 
         RowBox[{"Plus", "@@", 
          RowBox[{"Plus", "@@", 
           RowBox[{"DiskMatrix", "[", "hi", "]"}]}]}]]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSubtract", "[", 
      RowBox[{"imgb", ",", "imgc"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5750965858018923`*^9, 3.5750966952420454`*^9}, {
  3.5751516881187415`*^9, 3.5751517415788164`*^9}, {3.5787952659665294`*^9, 
  3.578795266902531*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"6ad9a377-aa8c-46a3-843e-148a3b2332fd"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"BandPass", "[", 
    RowBox[{
     GraphicsBox[
      TagBox[RasterBox[CompressedData["
1:eJxc3XezbVWZx/uuui+io0gDksydg6STz9777JM5gKG77aBtEyQniYIoAqIe
lCgoSUREBbSRjKKAWTF29T/9Su73jk/NUdRdVXvV2mvNOeYIz3jC7wnjz99/
1p73/z9/8Ad/cH9/z/f3/33+wAc+8O53v/vAgQObN2/etm3bCSecsL6+vmfP
nu3bt//DP/zDysrKe9/73r7ZuHHj2trarl27Nm3atGHDhr//+7/fO179dNxx
x/Xe59NOO211dfVtb3tbt//zP//zSSed9B//8R99v2XLFld2++mnn/5v//Zv
Pah23ve+95188smnnHJKT+/9gx/8YP92TQ/dunVr19SHPmt8586d28ernvzd
3/1dV9bCvn376nAPqg9d2UDqZN3up63j1ZVvfetb+6kO++aYY47p167/x3/8
x/6t5R07duj8/v37Deev/uqvukafu/c973lPD2pQJqfHdW/TVeN90+P0ttt7
r/8nnnhiw+knw6xBs6fPW8br/e9/f3cdffTRTVdNnXrqqU3C2Wef3QVNeM9q
Jmu55/7rv/5rHWiuuqAu/dM//dN//ud/1o1/+Zd/Oeywwz70oQ8df/zxPVTH
+lyzZkmXGku/9mH37t21UyNd0BNruX52V73693//927pifvGq870uRb6vp40
lt67uBt7RO/NVZd1Qe30TW32iDrWhDS0Bl6bzWpzHqmYYTPTq7vqRp3pygbY
hx7XKOpnH2q81qLJPnTBnvHq3jkDzUYP6kN9+/CHP2xpoo0eUT+7qwmsV/W/
lntc9/bEuvHOd76zpfyLv/iLFqIvW8Fa7uJm4B/Hq3+7vuWIQrqgVajlvjGf
f/u3f9vtXdazaqH3Btt7z6qRHlcHehB66Ke+7Jt+tTTmthb6ppmswf3j1WVN
Zt/0XrPd0qh7epNmyK5H0qeMV9c05/W227vsr//6r7vF1oskkGh9bvjdWJt9
rmPd2LzVYFNR+01417dM9arJbFztnT53V//63F0tSq3VeB1u6v7mb/4GgXXj
scce23vt13LvNdvy1du62rQ00q7sp4bf7b3vHC+01xBqtrt63DnnnBNDqD/1
Sgt1ssnvS2TTNd1Yby1cPWn4LVMT0vfdMje7nrSzoo3a6VdbpoE0XX2uKWNE
aX3oEQje3PZlLAuN1W176l3veldjqTULXcv1oSv7tTXqvX+tXRdH861+1NLn
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
        "], {{0, 165}, {192, 0}}, {0, 255},
        ColorFunction->RGBColor],
       BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
       Selectable->False],
      BaseStyle->"ImageGraphics",
      ImageSize->{78., Automatic},
      ImageSizeRaw->{192, 165},
      PlotRange->{{0, 192}, {0, 165}}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "12"}], "}"}]}], "]"}], "//", "ImageAdjust"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.575096671242012*^9, 3.575096685632032*^9}, {
   3.575151552048551*^9, 3.575151584238596*^9}, {3.5751527213321905`*^9, 
   3.575152738242214*^9}, {3.5787952704749374`*^9, 3.5787952717229395`*^9}, {
   3.648226188532628*^9, 3.6482261920908318`*^9}, {3.648226491268944*^9, 
   3.648226494211112*^9}, {3.6482313009610424`*^9, 3.6482313029911585`*^9}, {
   3.6482314723518453`*^9, 3.648231474766983*^9}, {3.6483038949211793`*^9, 
   3.6483038979373517`*^9}, 3.7197529874318905`*^9, 3.719756532127636*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"0d97f3f9-dc4e-4b68-8e09-e30b7d44cd12"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyThresholdingCrop (NEW - no rescale shit) ", "Subsection",
 CellChangeTimes->{{3.767212295845253*^9, 3.767212300601066*^9}, {
  3.7672913146944036`*^9, 
  3.767291319595132*^9}},ExpressionUUID->"cf842ced-36be-4bdc-b758-\
24be0ce41324"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyThresholdingCrop", "[", 
   RowBox[{
   "img_", ",", "analysisFolder_", ",", " ", "mytemplocs_", ",", " ", 
    "myPad_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"myImg", " ", "=", " ", "img"}], ",", " ", "myCrop"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"DynamicModule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flagRed", ",", "flagGreen", ",", "flagBlue"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "control", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SetOptions", "[", 
        RowBox[{"Manipulator", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "]"}], ";", 
       "\[IndentingNewLine]", "myImg", " ", ";", "\[IndentingNewLine]", 
       RowBox[{"myCenterofCrop", " ", "=", " ", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"mytemplocs", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Median"}], " ", 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mytemplocs", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Median"}]}], 
         "  ", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"myCenterofVideoCropped", " ", "=", " ", 
        RowBox[{"Table", "[", "  ", 
         RowBox[{
          RowBox[{
           RowBox[{"mytemplocs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "-", " ", "myCenterofCrop", 
           " ", "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"myPad", " ", "+", " ", "0.1"}], ",", 
             RowBox[{"myPad", " ", "+", " ", "0.1"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "@", "mytemplocs"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"mymessage", " ", "=", " ", 
        RowBox[{"(*", 
         RowBox[{
         "Test", " ", "to", " ", "see", " ", "if", " ", "any", " ", "of", " ",
           "the", " ", "numbers", " ", "GO", " ", "OUTSIDE", " ", "the", " ", 
          RowBox[{"pad", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", " ", 
        RowBox[{"If", " ", "[", "  ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", "  ", 
            RowBox[{
             RowBox[{"Flatten", "@", "myCenterofVideoCropped"}], ",", "  ", 
             RowBox[{"x_", "/;", 
              RowBox[{
               RowBox[{"x", " ", "\[GreaterEqual]", " ", 
                RowBox[{"2", "*", "myPad"}]}], "  ", "||", " ", 
               RowBox[{"x", "<", "0"}]}]}]}], " ", "]"}], "   ", "==", " ", 
           RowBox[{"{", "}"}]}], " ", ",", " ", "\[IndentingNewLine]", 
          "\"\<GOOD: all points are within pad size \>\"", ",", " ", 
          "\[IndentingNewLine]", 
          "\"\<Warning: the centroid goes out of the frame! \>\""}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"myCrop", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", " ", "[", " ", 
           RowBox[{
            RowBox[{"ImageTrim", "[", 
             RowBox[{
              RowBox[{"myImg", "[", 
               RowBox[{"[", 
                RowBox[{"channel", ",", " ", "time"}], "]"}], "]"}], ",", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#", "-", "myPad"}], ",", " ", 
                  RowBox[{"#", "+", "myPad", "-", "0.1"}]}], "}"}], "&"}], 
               "@", " ", "myCenterofCrop"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"time", ",", " ", "1", ",", " ", 
              RowBox[{"Length", "@", 
               RowBox[{"myImg", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "1"}], "}"}]}], "]"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"channel", ",", " ", "1", ",", " ", "3"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Column", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"mymessage", ",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"myCrop", "\[LeftDoubleBracket]", 
                RowBox[{"color", ",", "frame"}], "\[RightDoubleBracket]"}], "//", 
               RowBox[{
                RowBox[{"ImageAdjust", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], "]"}], 
                "&"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}], "}"}]}], 
         ",", " ", "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"color", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
             RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
             RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "myCrop", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"threshold1", ",", "0.01"}], "}"}], ",", "0", ",", "0.4", 
           ",", "0.001"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"threshold2", ",", "0.1"}], "}"}], ",", "0", ",", "0.4", 
           ",", "0.001"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Save Threshold\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"thredcrop", "=", 
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"flagRed", "=", 
                RowBox[{
                 RowBox[{"ToString", "@", "thredcrop"}], "<>", 
                 "\"\<Saved\>\""}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"thredcrop", ">>", 
                RowBox[{
                "analysisFolder", "<>", "\"\<_thredcrop.dat\>\""}]}]}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "2"}], ",", 
              RowBox[{
               RowBox[{"thgreencrop", "=", 
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
               RowBox[{"flagGreen", "=", 
                RowBox[{
                 RowBox[{"ToString", "@", "thgreencrop"}], "<>", 
                 "\"\<Saved\>\""}]}], ";", 
               RowBox[{"thgreencrop", ">>", 
                RowBox[{
                "analysisFolder", "<>", "\"\<_thgreencrop.dat\>\""}]}]}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "3"}], ",", 
              RowBox[{
               RowBox[{"thbluecrop", "=", 
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
               RowBox[{"flagBlue", "=", 
                RowBox[{
                 RowBox[{"ToString", "@", "thbluecrop"}], "<>", 
                 "\"\<Saved\>\""}]}], ";", 
               RowBox[{"thbluecrop", ">>", 
                RowBox[{
                "analysisFolder", "<>", "\"\<_thbluecrop.dat\>\""}]}]}]}], 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Spacer", "@", "5"}], ",", "\[IndentingNewLine]", " ", 
         "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Load Pre-Saved Parameters\>\"", ",", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"color", "\[Equal]", "1"}], "&&", 
               RowBox[{"ValueQ", "@", "thredcrop"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
               "thredcrop"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"color", "\[Equal]", "2"}], "&&", 
               RowBox[{"ValueQ", "@", "thgreencrop"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
               "thgreencrop"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"color", "\[Equal]", "3"}], "&&", 
               RowBox[{"ValueQ", "@", "thbluecrop"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
               "thbluecrop"}]}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.76720976745989*^9, {3.767209844947056*^9, 3.767209885573757*^9}, {
   3.767209954547155*^9, 3.767209996595964*^9}, {3.767210209573606*^9, 
   3.767210372156601*^9}, {3.7672104179687033`*^9, 3.7672104238052473`*^9}, {
   3.7672104603528557`*^9, 3.767210530441082*^9}, {3.767210617320299*^9, 
   3.767210669673134*^9}, {3.767210745070674*^9, 3.7672108505285397`*^9}, {
   3.76721090233589*^9, 3.767210904126678*^9}, {3.767210992685691*^9, 
   3.76721099310496*^9}, {3.7672110838177*^9, 3.7672111006213818`*^9}, 
   3.767211171226522*^9, {3.767211337633225*^9, 3.767211409240115*^9}, {
   3.767211441844675*^9, 3.7672114739116173`*^9}, {3.767211528610634*^9, 
   3.767211555235812*^9}, {3.767211598322698*^9, 3.767211623991646*^9}, {
   3.767211818955925*^9, 3.767211821577488*^9}, {3.767211855362607*^9, 
   3.7672118812827873`*^9}, {3.767212072578465*^9, 3.767212157623848*^9}, {
   3.767212187780294*^9, 3.7672121953296957`*^9}, {3.76721224947709*^9, 
   3.767212277650869*^9}, {3.767287254121592*^9, 3.7672872587830763`*^9}, {
   3.7672912605820017`*^9, 3.7672912866167707`*^9}, {3.767291327033588*^9, 
   3.767291358891459*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"ebb8d511-56d1-43e6-a736-4a22dcafd132"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyThresholdingCropOLD", "Subsection",
 CellChangeTimes->{{3.767212295845253*^9, 3.767212300601066*^9}, {
  3.767291309072548*^9, 
  3.767291309355528*^9}},ExpressionUUID->"23e54ef2-b5fd-46ec-82a1-\
323bcc760f5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyThresholdingCropOLD", "[", 
   RowBox[{
   "img_", ",", "analysisFolder_", ",", " ", "mytemplocs_", ",", " ", 
    "myPad_", ",", " ", "myrescalefactor_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"myImg", " ", "=", " ", "img"}], ",", " ", "myCrop"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"DynamicModule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flagRed", ",", "flagGreen", ",", "flagBlue"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "control", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"SetOptions", "[", 
        RowBox[{"Manipulator", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "]"}], ";", 
       "\[IndentingNewLine]", "myImg", " ", ";", "\[IndentingNewLine]", 
       RowBox[{"myCenterofCrop", " ", "=", " ", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"mytemplocs", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Median"}], " ", 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mytemplocs", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Median"}]}], 
         "  ", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"myCenterofVideoCropped", " ", "=", " ", 
        RowBox[{"Table", "[", "  ", 
         RowBox[{
          RowBox[{
           RowBox[{"mytemplocs", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "-", " ", "myCenterofCrop", 
           " ", "+", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"myPad", " ", "+", " ", "0.1"}], ",", 
             RowBox[{"myPad", " ", "+", " ", "0.1"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "@", "mytemplocs"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"mymessage", " ", "=", " ", 
        RowBox[{"(*", 
         RowBox[{
         "Test", " ", "to", " ", "see", " ", "if", " ", "any", " ", "of", " ",
           "the", " ", "numbers", " ", "GO", " ", "OUTSIDE", " ", "the", " ", 
          RowBox[{"pad", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", " ", 
        RowBox[{"If", " ", "[", "  ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", "  ", 
            RowBox[{
             RowBox[{"Flatten", "@", "myCenterofVideoCropped"}], ",", "  ", 
             RowBox[{"x_", "/;", 
              RowBox[{
               RowBox[{"x", " ", "\[GreaterEqual]", " ", 
                RowBox[{"2", "*", "myPad"}]}], "  ", "||", " ", 
               RowBox[{"x", "<", "0"}]}]}]}], " ", "]"}], "   ", "==", " ", 
           RowBox[{"{", "}"}]}], " ", ",", " ", "\[IndentingNewLine]", 
          "\"\<GOOD: all points are within pad size \>\"", ",", " ", 
          "\[IndentingNewLine]", 
          "\"\<Warning: the centroid goes out of the frame! \>\""}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"myCrop", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"ImageResize", "[", 
             RowBox[{
              RowBox[{"ImageTrim", "[", 
               RowBox[{
                RowBox[{"myImg", "[", 
                 RowBox[{"[", 
                  RowBox[{"channel", ",", " ", "time"}], "]"}], "]"}], ",", 
                " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"#", "-", "myPad"}], ",", " ", 
                    RowBox[{"#", "+", "myPad", "-", "0.1"}]}], "}"}], "&"}], 
                 "@", " ", "myCenterofCrop"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", "*", "myPad"}], "+", "1"}], ")"}], "*", 
               "myRescaleFactor"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"time", ",", " ", "1", ",", " ", 
              RowBox[{"Length", "@", 
               RowBox[{"myImg", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", "1"}], "}"}]}], "]"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"channel", ",", " ", "1", ",", " ", "3"}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Column", "@", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"mymessage", ",", "\[IndentingNewLine]", 
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"myCrop", "\[LeftDoubleBracket]", 
                RowBox[{"color", ",", "frame"}], "\[RightDoubleBracket]"}], "//", 
               RowBox[{
                RowBox[{"ImageAdjust", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], "]"}], 
                "&"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}], "}"}]}], 
         ",", " ", "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"color", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
             RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
             RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "myCrop", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"threshold1", ",", "0.01"}], "}"}], ",", "0", ",", "0.4", 
           ",", "0.001"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"threshold2", ",", "0.1"}], "}"}], ",", "0", ",", "0.4", 
           ",", "0.001"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Save Threshold\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"thredcrop", "=", 
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"flagRed", "=", 
                RowBox[{
                 RowBox[{"ToString", "@", "thredcrop"}], "<>", 
                 "\"\<Saved\>\""}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"thredcrop", ">>", 
                RowBox[{
                "analysisFolder", "<>", "\"\<_thredcrop.dat\>\""}]}]}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "2"}], ",", 
              RowBox[{
               RowBox[{"thgreencrop", "=", 
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
               RowBox[{"flagGreen", "=", 
                RowBox[{
                 RowBox[{"ToString", "@", "thgreencrop"}], "<>", 
                 "\"\<Saved\>\""}]}], ";", 
               RowBox[{"thgreencrop", ">>", 
                RowBox[{
                "analysisFolder", "<>", "\"\<_thgreencrop.dat\>\""}]}]}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "3"}], ",", 
              RowBox[{
               RowBox[{"thbluecrop", "=", 
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
               RowBox[{"flagBlue", "=", 
                RowBox[{
                 RowBox[{"ToString", "@", "thbluecrop"}], "<>", 
                 "\"\<Saved\>\""}]}], ";", 
               RowBox[{"thbluecrop", ">>", 
                RowBox[{
                "analysisFolder", "<>", "\"\<_thbluecrop.dat\>\""}]}]}]}], 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Spacer", "@", "5"}], ",", "\[IndentingNewLine]", " ", 
         "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Load Pre-Saved Parameters\>\"", ",", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"color", "\[Equal]", "1"}], "&&", 
               RowBox[{"ValueQ", "@", "thredcrop"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
               "thredcrop"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"color", "\[Equal]", "2"}], "&&", 
               RowBox[{"ValueQ", "@", "thgreencrop"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
               "thgreencrop"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"color", "\[Equal]", "3"}], "&&", 
               RowBox[{"ValueQ", "@", "thbluecrop"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
               "thbluecrop"}]}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.76720976745989*^9, {3.767209844947056*^9, 3.767209885573757*^9}, {
   3.767209954547155*^9, 3.767209996595964*^9}, {3.767210209573606*^9, 
   3.767210372156601*^9}, {3.7672104179687033`*^9, 3.7672104238052473`*^9}, {
   3.7672104603528557`*^9, 3.767210530441082*^9}, {3.767210617320299*^9, 
   3.767210669673134*^9}, {3.767210745070674*^9, 3.7672108505285397`*^9}, {
   3.76721090233589*^9, 3.767210904126678*^9}, {3.767210992685691*^9, 
   3.76721099310496*^9}, {3.7672110838177*^9, 3.7672111006213818`*^9}, 
   3.767211171226522*^9, {3.767211337633225*^9, 3.767211409240115*^9}, {
   3.767211441844675*^9, 3.7672114739116173`*^9}, {3.767211528610634*^9, 
   3.767211555235812*^9}, {3.767211598322698*^9, 3.767211623991646*^9}, {
   3.767211818955925*^9, 3.767211821577488*^9}, {3.767211855362607*^9, 
   3.7672118812827873`*^9}, {3.767212072578465*^9, 3.767212157623848*^9}, {
   3.767212187780294*^9, 3.7672121953296957`*^9}, {3.76721224947709*^9, 
   3.767212277650869*^9}, {3.767287254121592*^9, 3.7672872587830763`*^9}, {
   3.7672912605820017`*^9, 3.7672912866167707`*^9}, {3.7672913729248238`*^9, 
   3.7672913731405287`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"4905c452-175f-49d4-962b-384d9e54ac83"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyThresholding", "Subsection",
 CellChangeTimes->{{3.713117663995283*^9, 
  3.7131176666674356`*^9}},ExpressionUUID->"35bbb725-2dcf-4317-94bc-\
bb754bd912ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyThresholding", "[", 
   RowBox[{"img_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"myImg", "=", "img"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"DynamicModule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flagRed", ",", "flagGreen", ",", "flagBlue"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"checking", " ", "for", " ", "saved", " ", "parameters"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"flagRed", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FileExistsQ", "@", 
           RowBox[{"(", 
            RowBox[{"analysisFolder", "<>", "\"\<_thred.dat\>\""}], ")"}]}], 
          ",", 
          RowBox[{
           RowBox[{"thred", "=", 
            RowBox[{"<<", 
             RowBox[{"(", 
              RowBox[{"analysisFolder", "<>", "\"\<_thred.dat\>\""}], 
              ")"}]}]}], ";", 
           RowBox[{
            RowBox[{"ToString", "@", "thred"}], "<>", 
            "\"\<  Already Saved\>\""}]}], ",", 
          "\"\<Not Yet Determined\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"flagGreen", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FileExistsQ", "@", 
           RowBox[{"(", 
            RowBox[{"analysisFolder", "<>", "\"\<_thgreen.dat\>\""}], ")"}]}],
           ",", 
          RowBox[{
           RowBox[{"thgreen", "=", 
            RowBox[{"<<", 
             RowBox[{"(", 
              RowBox[{"analysisFolder", "<>", "\"\<_thgreen.dat\>\""}], 
              ")"}]}]}], ";", 
           RowBox[{
            RowBox[{"ToString", "@", "thgreen"}], "<>", 
            "\"\<  Already Saved\>\""}]}], ",", 
          "\"\<Not Yet Determined\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"flagBlue", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FileExistsQ", "@", 
           RowBox[{"(", 
            RowBox[{"analysisFolder", "<>", "\"\<_thblue.dat\>\""}], ")"}]}], 
          ",", 
          RowBox[{
           RowBox[{"thblue", "=", 
            RowBox[{"<<", 
             RowBox[{"(", 
              RowBox[{"analysisFolder", "<>", "\"\<_thblue.dat\>\""}], 
              ")"}]}]}], ";", 
           RowBox[{
            RowBox[{"ToString", "@", "thblue"}], "<>", 
            "\"\<  Already Saved\>\""}]}], ",", 
          "\"\<Not Yet Determined\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "control", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"SetOptions", "[", 
        RowBox[{"Manipulator", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Manipulate", "[", 
        RowBox[{
         RowBox[{"Column", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"myImg", "\[LeftDoubleBracket]", 
                RowBox[{"color", ",", "frame"}], "\[RightDoubleBracket]"}], "//", 
               RowBox[{
                RowBox[{"ImageAdjust", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], "]"}], 
                "&"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Red Threshold  : \>\"", "<>", "flagRed"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Green Threshold: \>\"", "<>", "flagGreen"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"\"\<Blue Threshold : \>\"", "<>", "flagBlue"}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"color", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
             RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
             RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
            "myImg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"threshold1", ",", "0.01"}], "}"}], ",", "0", ",", "0.4", 
           ",", "0.001"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"threshold2", ",", "0.1"}], "}"}], ",", "0", ",", "0.4", 
           ",", "0.001"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Save Threshold\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "1"}], ",", 
              RowBox[{
               RowBox[{"thred", "=", 
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"flagRed", "=", 
                RowBox[{
                 RowBox[{"ToString", "@", "thred"}], "<>", 
                 "\"\<Saved\>\""}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"thred", ">>", 
                RowBox[{"analysisFolder", "<>", "\"\<_thred.dat\>\""}]}]}]}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "2"}], ",", 
              RowBox[{
               RowBox[{"thgreen", "=", 
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
               RowBox[{"flagGreen", "=", 
                RowBox[{
                 RowBox[{"ToString", "@", "thgreen"}], "<>", 
                 "\"\<Saved\>\""}]}], ";", 
               RowBox[{"thgreen", ">>", 
                RowBox[{
                "analysisFolder", "<>", "\"\<_thgreen.dat\>\""}]}]}]}], "]"}],
             ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "3"}], ",", 
              RowBox[{
               RowBox[{"thblue", "=", 
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
               RowBox[{"flagBlue", "=", 
                RowBox[{
                 RowBox[{"ToString", "@", "thblue"}], "<>", 
                 "\"\<Saved\>\""}]}], ";", 
               RowBox[{"thblue", ">>", 
                RowBox[{"analysisFolder", "<>", "\"\<_thblue.dat\>\""}]}]}]}],
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Spacer", "@", "5"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Load Pre-Saved Parameters\>\"", ",", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"color", "\[Equal]", "1"}], "&&", 
               RowBox[{"ValueQ", "@", "thred"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
               "thred"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"color", "\[Equal]", "2"}], "&&", 
               RowBox[{"ValueQ", "@", "thgreen"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
               "thgreen"}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"color", "\[Equal]", "3"}], "&&", 
               RowBox[{"ValueQ", "@", "thblue"}]}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
               "thblue"}]}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.71311477549407*^9, 3.713115047105606*^9}, {
   3.7131151313864264`*^9, 3.7131151317224455`*^9}, {3.713115176105984*^9, 
   3.71311524684203*^9}, {3.7131152824100647`*^9, 3.71311533880329*^9}, {
   3.7131153694430428`*^9, 3.7131153772424884`*^9}, {3.713115557426794*^9, 
   3.7131155639231663`*^9}, {3.7131156055385466`*^9, 
   3.7131156140430326`*^9}, {3.713115714765794*^9, 3.713115717363942*^9}, {
   3.7131157802195377`*^9, 3.7131158982832904`*^9}, {3.7131159299871035`*^9, 
   3.713115946627055*^9}, {3.7131160469557943`*^9, 3.7131160525641146`*^9}, {
   3.7131170980459127`*^9, 3.7131171494368525`*^9}, {3.7131172670045767`*^9, 
   3.7131172728449106`*^9}, {3.7131173345974426`*^9, 3.7131174051574783`*^9}, 
   3.7131174585005293`*^9, {3.7131184818940644`*^9, 3.7131185203572645`*^9}, {
   3.7131191217586627`*^9, 3.71311913098219*^9}, {3.7131191695663967`*^9, 
   3.7131191793019543`*^9}, {3.7131192385663433`*^9, 3.713119240806472*^9}, {
   3.713120509503037*^9, 3.7131205660152693`*^9}, {3.7131232576092196`*^9, 
   3.7131232793214617`*^9}, {3.7131235614495983`*^9, 3.713123571710185*^9}, {
   3.7131826018405156`*^9, 3.713182620017555*^9}, {3.7166680370076284`*^9, 
   3.716668098192128*^9}, {3.716668276360319*^9, 3.7166683499365273`*^9}, {
   3.7166684302801228`*^9, 3.716668482617116*^9}, {3.716668517240096*^9, 
   3.7166685530891466`*^9}, 3.7166702604908047`*^9, 3.7169062389820023`*^9, {
   3.7174333794424405`*^9, 3.7174333865958495`*^9}, {3.7179422555525503`*^9, 
   3.7179424707438583`*^9}, 3.7179430071455383`*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"c4d25eed-5d8e-45f9-b813-ad989dda868b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyThresholding3D", "[", 
   RowBox[{"img_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"myImg", "=", "img"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"DynamicModule", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"flagRed", ",", "flagGreen", ",", "flagBlue3D"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"checking", " ", "for", " ", "saved", " ", "parameters"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"flagRed", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "@", 
            RowBox[{"(", 
             RowBox[{"analysisFolder", "<>", "\"\<_thred.dat\>\""}], ")"}]}], 
           ",", 
           RowBox[{
            RowBox[{"thred", "=", 
             RowBox[{"<<", 
              RowBox[{"(", 
               RowBox[{"analysisFolder", "<>", "\"\<_thred.dat\>\""}], 
               ")"}]}]}], ";", 
            RowBox[{
             RowBox[{"ToString", "@", "thred"}], "<>", 
             "\"\<  Already Saved\>\""}]}], ",", 
           "\"\<Not Yet Determined\>\""}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"flagGreen", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "@", 
            RowBox[{"(", 
             RowBox[{"analysisFolder", "<>", "\"\<_thgreen.dat\>\""}], 
             ")"}]}], ",", 
           RowBox[{
            RowBox[{"thgreen", "=", 
             RowBox[{"<<", 
              RowBox[{"(", 
               RowBox[{"analysisFolder", "<>", "\"\<_thgreen.dat\>\""}], 
               ")"}]}]}], ";", 
            RowBox[{
             RowBox[{"ToString", "@", "thgreen"}], "<>", 
             "\"\<  Already Saved\>\""}]}], ",", 
           "\"\<Not Yet Determined\>\""}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"flagBlue3D", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FileExistsQ", "@", 
           RowBox[{"(", 
            RowBox[{"analysisFolder", "<>", "\"\<_thblue3D.dat\>\""}], 
            ")"}]}], ",", 
          RowBox[{
           RowBox[{"thblue3D", "=", 
            RowBox[{"<<", 
             RowBox[{"(", 
              RowBox[{"analysisFolder", "<>", "\"\<_thblue3D.dat\>\""}], 
              ")"}]}]}], ";", 
           RowBox[{
            RowBox[{"ToString", "@", "thblue3D"}], "<>", 
            "\"\<  Already Saved\>\""}]}], ",", 
          "\"\<Not Yet Determined\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", "control", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"SetOptions", "[", 
        RowBox[{"Manipulator", ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Manipulate", "[", 
        RowBox[{
         RowBox[{"Column", "@", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Show", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"myImg", "\[LeftDoubleBracket]", 
                RowBox[{"frame", ",", "z"}], "\[RightDoubleBracket]"}], "//", 
               RowBox[{
                RowBox[{"ImageAdjust", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], "]"}], 
                "&"}]}], ",", 
              RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"\"\<Red Threshold  : \>\"", "<>", "flagRed"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<Green Threshold: \>\"", "<>", "flagGreen"}], ","}],
              "*)"}], "\[IndentingNewLine]", 
            RowBox[{"\"\<Blue Threshold 3D : \>\"", "<>", "flagBlue3D"}]}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", "myImg"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"z", ",", 
             RowBox[{"Round", "@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{
                 "myImg", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "/", "2"}], ")"}]}]}], "}"}], 
           ",", "1", ",", 
           RowBox[{"Length", "@", 
            RowBox[{
            "myImg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"threshold1", ",", "0.01"}], "}"}], ",", "0", ",", "0.4", 
           ",", "0.001"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"threshold2", ",", "0.1"}], "}"}], ",", "0", ",", "0.4", 
           ",", "0.001"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Save Threshold\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"thred", "=", 
                 RowBox[{"{", 
                  RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"flagRed", "=", 
                 RowBox[{
                  RowBox[{"ToString", "@", "thred"}], "<>", 
                  "\"\<Saved\>\""}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"thred", ">>", 
                 RowBox[{"analysisFolder", "<>", "\"\<_thred.dat\>\""}]}]}]}],
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "2"}], ",", 
               RowBox[{
                RowBox[{"thgreen", "=", 
                 RowBox[{"{", 
                  RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
                RowBox[{"flagGreen", "=", 
                 RowBox[{
                  RowBox[{"ToString", "@", "thgreen"}], "<>", 
                  "\"\<Saved\>\""}]}], ";", 
                RowBox[{"thgreen", ">>", 
                 RowBox[{
                 "analysisFolder", "<>", "\"\<_thgreen.dat\>\""}]}]}]}], 
              "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "3"}], ","}]}], "*)"}], 
           RowBox[{
            RowBox[{"thblue3D", "=", 
             RowBox[{"{", 
              RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], ";", 
            RowBox[{"flagBlue3D", "=", 
             RowBox[{
              RowBox[{"ToString", "@", "thblue3D"}], "<>", 
              "\"\<  Saved\>\""}]}], ";", 
            RowBox[{"thblue3D", ">>", 
             RowBox[{"analysisFolder", "<>", "\"\<_thblue3D.dat\>\""}]}], 
            RowBox[{"(*", "]", "*)"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Spacer", "@", "5"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Button", "[", 
          RowBox[{"\"\<Load Pre-Saved Parameters\>\"", ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"color", "\[Equal]", "1"}], "&&", 
                RowBox[{"ValueQ", "@", "thred"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
                "thred"}]}], "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"color", "\[Equal]", "2"}], "&&", 
                RowBox[{"ValueQ", "@", "thgreen"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
                "thgreen"}]}], "]"}], ";"}], "*)"}], 
           RowBox[{"If", "[", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"color", "\[Equal]", "3"}], "&&"}], "*)"}], 
            RowBox[{
             RowBox[{"ValueQ", "@", "thblue3D"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"threshold1", ",", "threshold2"}], "}"}], "=", 
              "thblue3D"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7185591101571407`*^9, 3.7185593449895725`*^9}, {
  3.7186414361979213`*^9, 3.7186414613663607`*^9}, {3.7186417151428757`*^9, 
  3.7186417163909473`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"07f33d1a-dbe2-4edb-8ea1-06013e33850e"]
}, Closed]],

Cell[CellGroupData[{

Cell["MyBinarization", "Subsection",
 CellChangeTimes->{{3.71311410796889*^9, 
  3.7131141110090637`*^9}},ExpressionUUID->"22722800-c48e-4d31-8b6b-\
ed42c16b1010"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyBinarization", "[", 
   RowBox[{"img_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"myImg", "=", "img"}], ",", "mask", ",", "threshold1"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mask", "=", 
      RowBox[{"Import", "@", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"threshold1", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<_thred.dat\>\"", ",", "\"\<_thgreen.dat\>\"", ",", 
           "\"\<_thblue.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "flagRed", ",", "flagGreen", ",", "flagBlue", ",", "max", ",", "imga",
          ",", "imgb", ",", "color", ",", "frame", ",", "threshold", ",", 
         "lowpass", ",", "hipass", ",", "lo", ",", "hi", ",", "myOutline", 
         ",", "myFill"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"checking", " ", "for", " ", "saved", " ", "parameters"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"flagRed", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "@", 
            RowBox[{"(", 
             RowBox[{"analysisFolder", "<>", "\"\<_thred2.dat\>\""}], ")"}]}],
            ",", 
           RowBox[{
            RowBox[{"thredAll", "=", 
             RowBox[{"<<", 
              RowBox[{"(", 
               RowBox[{"analysisFolder", "<>", "\"\<_thred2.dat\>\""}], 
               ")"}]}]}], ";", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"ToString", "/@", "thredAll"}], ",", 
              "\"\<Already Saved\>\""}], "]"}]}], ",", 
           RowBox[{"{", "\"\<Not Yet Determined\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"flagGreen", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "@", 
            RowBox[{"(", 
             RowBox[{"analysisFolder", "<>", "\"\<_thgreen2.dat\>\""}], 
             ")"}]}], ",", 
           RowBox[{
            RowBox[{"thgreenAll", "=", 
             RowBox[{"<<", 
              RowBox[{"(", 
               RowBox[{"analysisFolder", "<>", "\"\<_thgreen2.dat\>\""}], 
               ")"}]}]}], ";", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"ToString", "/@", "thgreenAll"}], ",", 
              "\"\<Already Saved\>\""}], "]"}]}], ",", 
           RowBox[{"{", "\"\<Not Yet Determined\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"flagBlue", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "@", 
            RowBox[{"(", 
             RowBox[{"analysisFolder", "<>", "\"\<_thblue2.dat\>\""}], 
             ")"}]}], ",", 
           RowBox[{
            RowBox[{"thblueAll", "=", 
             RowBox[{"<<", 
              RowBox[{"(", 
               RowBox[{"analysisFolder", "<>", "\"\<_thblue2.dat\>\""}], 
               ")"}]}]}], ";", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"ToString", "/@", "thblueAll"}], ",", 
              "\"\<Already Saved\>\""}], "]"}]}], ",", 
           RowBox[{"{", "\"\<Not Yet Determined\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "control", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"SetOptions", "[", 
         RowBox[{"Manipulator", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"imga", "=", 
            RowBox[{"ImageAdjust", "[", 
             RowBox[{
              RowBox[{"myImg", "\[LeftDoubleBracket]", 
               RowBox[{"color", ",", "frame"}], "\[RightDoubleBracket]"}], 
              ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
              RowBox[{
              "threshold1", "\[LeftDoubleBracket]", "color", 
               "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"max", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"BandPass", "[", 
               RowBox[{
                RowBox[{"ImageMultiply", "[", 
                 RowBox[{
                  RowBox[{"ImageAdjust", "[", 
                   RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{"color", ",", "1"}], "\[RightDoubleBracket]"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
                    RowBox[{
                    "threshold1", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "mask"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"lowpass", ",", "hipass"}], "}"}]}], "]"}], "//", 
              "ImageData"}], "//", "Max"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"imgb", "=", 
            RowBox[{"SelectComponents", "[", 
             RowBox[{
              RowBox[{"ImageMultiply", "[", 
               RowBox[{
                RowBox[{"Binarize", "[", 
                 RowBox[{
                  RowBox[{"BandPass", "[", 
                   RowBox[{"imga", ",", 
                    RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}]}], "]"}], ",", 
                  RowBox[{"max", " ", "threshold"}]}], "]"}], ",", "mask"}], 
               "]"}], ",", "\"\<Count\>\"", ",", 
              RowBox[{
               RowBox[{"lo", "<", "#", "<", "hi"}], "&"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Column", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"GraphicsRow", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Show", "[", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myOutline", "\[Equal]", "True"}], "&&", 
                    RowBox[{"myFill", "\[Equal]", "False"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"imga", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ComponentMeasurements", "[", 
                    RowBox[{"imgb", ",", "\"\<Contours\>\""}], "]"}], ")"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
                    "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"myFill", "\[Equal]", "True"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"imga", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Green", ",", 
                    RowBox[{"Polygon", "@", "#"}]}], "}"}], "]"}], "&"}], "/@", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ComponentMeasurements", "[", 
                    RowBox[{"imgb", ",", "\"\<Contours\>\""}], "]"}], ")"}], 
                    "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}]}], "}"}], ",", "imga"}], 
                    "]"}]}], "]"}], "]"}], ",", "imgb"}], "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"TableForm", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<\>\"", ",", "\"\<max\>\"", ",", "\"\<threshold\>\"", 
                   ",", "\"\<bandpass\>\"", ",", "\"\<particle size\>\""}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Prepend", "[", 
                  RowBox[{"flagRed", ",", "\"\<Red Threshold 2   :\>\""}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Prepend", "[", 
                  RowBox[{"flagGreen", ",", "\"\<Green Threshold 2 :\>\""}], 
                  "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Prepend", "[", 
                  RowBox[{"flagBlue", ",", "\"\<Blue Threshold 2  :\>\""}], 
                  "]"}]}], "}"}]}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"color", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
              RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
              RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"frame", ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myImg", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"threshold", ",", "0.1"}], "}"}], ",", "0", ",", "1", 
            ",", "0.01"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lowpass", ",", "1"}], "}"}], ",", "0", ",", "10", ",", 
            "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hipass", ",", "7"}], "}"}], ",", "0", ",", "10", ",", 
            "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lo", ",", "5"}], "}"}], ",", "0", ",", "20", ",", "1"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hi", ",", "100"}], "}"}], ",", "10", ",", "1000", ",", 
            "1"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Row", "@", 
           RowBox[{"{", 
            RowBox[{"\"\<Display options: \>\"", ",", 
             RowBox[{"Spacer", "@", "5"}], ",", "\"\<outline \>\"", ",", 
             RowBox[{"Checkbox", "[", 
              RowBox[{"Dynamic", "@", "myOutline"}], "]"}], ",", 
             RowBox[{"Spacer", "@", "10"}], ",", "\"\<filled \>\"", ",", 
             RowBox[{"Checkbox", "[", 
              RowBox[{"Dynamic", "@", "myFill"}], "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Save Threshold 2\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "1"}], ",", 
               RowBox[{
                RowBox[{"thredAll", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"mymaxred", "=", "max"}], ",", 
                   RowBox[{"thred2", "=", "threshold"}], ",", 
                   RowBox[{"bandpassred", "=", 
                    RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}]}], ",", 
                   RowBox[{"dotsizered", "=", 
                    RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"flagRed", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{
                   RowBox[{"ToString", "/@", "thredAll"}], ",", 
                   "\"\<Saved\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"thredAll", ">>", 
                 RowBox[{
                 "analysisFolder", "<>", "\"\<_thred2.dat\>\""}]}]}]}], "]"}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "2"}], ",", 
               RowBox[{
                RowBox[{"thgreenAll", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"mymaxgreen", "=", "max"}], ",", 
                   RowBox[{"thgreen2", "=", "threshold"}], ",", 
                   RowBox[{"bandpassgreen", "=", 
                    RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}]}], ",", 
                   RowBox[{"dotsizegreen", "=", 
                    RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}]}], "}"}]}], ";", 
                RowBox[{"flagGreen", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{
                   RowBox[{"ToString", "/@", "thgreenAll"}], ",", 
                   "\"\<Saved\>\""}], "]"}]}], ";", 
                RowBox[{"thgreenAll", ">>", 
                 RowBox[{
                 "analysisFolder", "<>", "\"\<_thgreen2.dat\>\""}]}]}]}], 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "3"}], ",", 
               RowBox[{
                RowBox[{"thblueAll", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"mymaxblue", "=", "max"}], ",", 
                   RowBox[{"thblue2", "=", "threshold"}], ",", 
                   RowBox[{"bandpassblue", "=", 
                    RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}]}], ",", 
                   RowBox[{"dotsizeblue", "=", 
                    RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}]}], "}"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"flagBlue", "=", 
                 RowBox[{"Append", "[", 
                  RowBox[{
                   RowBox[{"ToString", "/@", "thblueAll"}], ",", 
                   "\"\<Saved\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"thblueAll", ">>", 
                 RowBox[{
                 "analysisFolder", "<>", "\"\<_thblue2.dat\>\""}]}]}]}], 
              "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Load Pre-Saved Parameters\>\"", ",", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"color", "\[Equal]", "1"}], "&&", 
                RowBox[{"ValueQ", "@", "thredAll"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"max", ",", "threshold", ",", 
                  RowBox[{"{", 
                   RowBox[{"lowpass", ",", "hipass"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lo", ",", "hi"}], "}"}]}], "}"}], "=", 
                "thredAll"}]}], "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"color", "\[Equal]", "2"}], "&&", 
                RowBox[{"ValueQ", "@", "thgreenAll"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"max", ",", "threshold", ",", 
                  RowBox[{"{", 
                   RowBox[{"lowpass", ",", "hipass"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lo", ",", "hi"}], "}"}]}], "}"}], "=", 
                "thgreenAll"}]}], "]"}], ";", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"color", "\[Equal]", "3"}], "&&", 
                RowBox[{"ValueQ", "@", "thblueAll"}]}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"max", ",", "threshold", ",", 
                  RowBox[{"{", 
                   RowBox[{"lowpass", ",", "hipass"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"lo", ",", "hi"}], "}"}]}], "}"}], "=", 
                "thblueAll"}]}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7131841049224873`*^9, 3.7131841932585397`*^9}, {
   3.7131843328755255`*^9, 3.713184435515396*^9}, {3.713184478715867*^9, 
   3.7131845394673414`*^9}, {3.713184625946288*^9, 3.7131846392040462`*^9}, {
   3.7131847116601906`*^9, 3.7131847117871976`*^9}, {3.713186711469573*^9, 
   3.7131867951253576`*^9}, {3.713186834756624*^9, 3.7131869018374615`*^9}, {
   3.713187223207843*^9, 3.713187224589922*^9}, {3.7131872578378234`*^9, 
   3.7131873188943157`*^9}, {3.7131873600926723`*^9, 
   3.7131873820939302`*^9}, {3.713187748766903*^9, 3.7131877488939104`*^9}, 
   3.713187904446807*^9, {3.713188219446824*^9, 3.713188279646268*^9}, 
   3.7131883351344414`*^9, {3.7131888887031035`*^9, 3.713188927351314*^9}, {
   3.7131889758730893`*^9, 3.713188982431464*^9}, {3.7166686764812045`*^9, 
   3.7166688942106576`*^9}, 3.7166702543794546`*^9, {3.716735928614806*^9, 
   3.716735988719244*^9}, {3.716736085134759*^9, 3.7167360934152327`*^9}, {
   3.7167361571758795`*^9, 3.7167362008393764`*^9}, {3.716906052159316*^9, 
   3.7169060532543793`*^9}, {3.7174333178519173`*^9, 3.71743334342038*^9}, 
   3.717433388805976*^9, {3.7179430208503227`*^9, 3.717943109562396*^9}, 
   3.717943226355077*^9, {3.717975480387902*^9, 3.7179754811719465`*^9}, {
   3.71864149614635*^9, 3.7186415213427916`*^9}, {3.7186415716556687`*^9, 
   3.71864161258701*^9}, {3.718643873009299*^9, 3.718643887489127*^9}, 
   3.719275482931738*^9, 3.7197594166796227`*^9, {3.7197704322556777`*^9, 
   3.719770487855858*^9}, {3.719770576023901*^9, 3.7197705867205124`*^9}, {
   3.71977073616006*^9, 3.7197707689039326`*^9}, {3.7197708854726*^9, 
   3.7197709295771227`*^9}, {3.7197710785686445`*^9, 
   3.7197712434890776`*^9}, {3.719771354449424*^9, 3.719771419025118*^9}, {
   3.719771461363539*^9, 3.7197714856339273`*^9}, {3.7197715282983675`*^9, 
   3.719771643057932*^9}, {3.7197716903786383`*^9, 3.7197717895703115`*^9}, 
   3.719772309700061*^9, {3.7197727494912157`*^9, 3.719772755139539*^9}, 
   3.719772788883469*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"b399d9ed-54ae-4411-9311-94d8b485cd63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MyBinarization3D", "[", 
   RowBox[{"img_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"myImg", "=", "img"}], ",", "mask", ",", "threshold1"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mask", "=", 
      RowBox[{"Import", "@", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"threshold1", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"(*", 
           RowBox[{"\"\<_thred.dat\>\"", ",", "\"\<_thgreen.dat\>\"", ","}], 
           "*)"}], "\"\<_thblue.dat\>\"", "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "flagRed", ",", "flagGreen", ",", "flagBlue3D", ",", "max", ",", 
         "imgb", ",", "color", ",", "frame", ",", "threshold", ",", "lowpass",
          ",", "hipass", ",", "lo", ",", "hi"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"checking", " ", "for", " ", "saved", " ", "parameters"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"flagRed", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FileExistsQ", "@", 
             RowBox[{"(", 
              RowBox[{"analysisFolder", "<>", "\"\<_thred2.dat\>\""}], 
              ")"}]}], ",", 
            RowBox[{
             RowBox[{"thredAll", "=", 
              RowBox[{"<<", 
               RowBox[{"(", 
                RowBox[{"analysisFolder", "<>", "\"\<_thred2.dat\>\""}], 
                ")"}]}]}], ";", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"ToString", "/@", "thredAll"}], ",", 
               "\"\<Already Saved\>\""}], "]"}]}], ",", 
            RowBox[{"{", "\"\<Not Yet Determined\>\"", "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"flagGreen", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FileExistsQ", "@", 
             RowBox[{"(", 
              RowBox[{"analysisFolder", "<>", "\"\<_thgreen2.dat\>\""}], 
              ")"}]}], ",", 
            RowBox[{
             RowBox[{"thgreenAll", "=", 
              RowBox[{"<<", 
               RowBox[{"(", 
                RowBox[{"analysisFolder", "<>", "\"\<_thgreen2.dat\>\""}], 
                ")"}]}]}], ";", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"ToString", "/@", "thgreenAll"}], ",", 
               "\"\<Already Saved\>\""}], "]"}]}], ",", 
            RowBox[{"{", "\"\<Not Yet Determined\>\"", "}"}]}], "]"}]}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"flagBlue3D", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"FileExistsQ", "@", 
            RowBox[{"(", 
             RowBox[{"analysisFolder", "<>", "\"\<_thblue3D2.dat\>\""}], 
             ")"}]}], ",", 
           RowBox[{
            RowBox[{"thblue3DAll", "=", 
             RowBox[{"<<", 
              RowBox[{"(", 
               RowBox[{"analysisFolder", "<>", "\"\<_thblue3D2.dat\>\""}], 
               ")"}]}]}], ";", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"ToString", "/@", "thblue3DAll"}], ",", 
              "\"\<  Already Saved\>\""}], "]"}]}], ",", 
           RowBox[{"{", "\"\<Not Yet Determined\>\"", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"color", "=", "1"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", "control", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"SetOptions", "[", 
         RowBox[{"Manipulator", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Manipulate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"max", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"BandPass", "[", 
               RowBox[{
                RowBox[{"ImageMultiply", "[", 
                 RowBox[{
                  RowBox[{"ImageAdjust", "[", 
                   RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", 
                    RowBox[{"Round", "@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{
                    "myImg", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "/", "2"}], ")"}]}]}], 
                    "\[RightDoubleBracket]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
                    RowBox[{
                    "threshold1", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", "mask"}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"lowpass", ",", "hipass"}], "}"}]}], "]"}], "//", 
              "ImageData"}], "//", "Max"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"imgb", "=", 
            RowBox[{"BandPass", "[", 
             RowBox[{
              RowBox[{"ImageAdjust", "[", 
               RowBox[{
                RowBox[{"myImg", "\[LeftDoubleBracket]", 
                 RowBox[{"frame", ",", "z"}], "\[RightDoubleBracket]"}], " ", 
                ",", " ", 
                RowBox[{"{", 
                 RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
                RowBox[{
                "threshold1", "\[LeftDoubleBracket]", "color", 
                 "\[RightDoubleBracket]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"lowpass", ",", "hipass"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Column", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"GraphicsRow", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"ImageAdjust", "[", 
                   RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{"frame", ",", "z"}], "\[RightDoubleBracket]"}], 
                    ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", " ", "0", ",", " ", "1"}], "}"}], ",", 
                    RowBox[{
                    "threshold1", "\[LeftDoubleBracket]", "color", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"SelectComponents", "[", 
                   RowBox[{
                    RowBox[{"ImageMultiply", "[", 
                    RowBox[{
                    RowBox[{"Binarize", "[", 
                    RowBox[{"imgb", ",", 
                    RowBox[{"max", " ", "threshold"}]}], "]"}], ",", "mask"}],
                     "]"}], ",", "\"\<Count\>\"", ",", 
                    RowBox[{
                    RowBox[{"lo", "<", "#", "<", "hi"}], "&"}]}], "]"}]}], 
                 "}"}], ",", 
                RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"TableForm", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                  "\"\<\>\"", ",", "\"\<max\>\"", ",", "\"\<threshold\>\"", 
                   ",", "\"\<bandpass\>\"", ",", "\"\<particle size\>\""}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Prepend", "[", 
                    RowBox[{"flagRed", ",", "\"\<Red Threshold 2   :\>\""}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                   RowBox[{"Prepend", "[", 
                    RowBox[{"flagGreen", ",", "\"\<Green Threshold 2 :\>\""}],
                     "]"}], ","}], "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"Prepend", "[", 
                  RowBox[{
                  "flagBlue3D", ",", "\"\<Blue Threshold 3D 2  :\>\""}], 
                  "]"}]}], "}"}]}]}], "}"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"frame", ",", "1", ",", 
            RowBox[{"Length", "@", "myImg"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"z", ",", 
              RowBox[{"Round", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{
                  "myImg", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "/", "2"}], ")"}]}]}], "}"}], 
            ",", "1", ",", 
            RowBox[{"Length", "@", 
             RowBox[{
             "myImg", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"threshold", ",", "0.1"}], "}"}], ",", "0", ",", "1", 
            ",", "0.01"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lowpass", ",", "1"}], "}"}], ",", "0", ",", "10", ",", 
            "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hipass", ",", "7"}], "}"}], ",", "0", ",", "10", ",", 
            "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"lo", ",", "5"}], "}"}], ",", "0", ",", "20", ",", "1"}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"hi", ",", "100"}], "}"}], ",", "10", ",", "1000", ",", 
            "1"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Save Threshold 3D 2\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"color", "\[Equal]", "1"}], ",", 
                RowBox[{
                 RowBox[{"thredAll", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"mymaxred", "=", "max"}], ",", 
                    RowBox[{"thred2", "=", "threshold"}], ",", 
                    RowBox[{"bandpassred", "=", 
                    RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}]}], ",", 
                    RowBox[{"dotsizered", "=", 
                    RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}]}], "}"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"flagRed", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"ToString", "/@", "thredAll"}], ",", 
                    "\"\<Saved\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"thredAll", ">>", 
                  RowBox[{
                  "analysisFolder", "<>", "\"\<_thred2.dat\>\""}]}]}]}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"color", "\[Equal]", "2"}], ",", 
                RowBox[{
                 RowBox[{"thgreenAll", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"mymaxgreen", "=", "max"}], ",", 
                    RowBox[{"thgreen2", "=", "threshold"}], ",", 
                    RowBox[{"bandpassgreen", "=", 
                    RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}]}], ",", 
                    RowBox[{"dotsizegreen", "=", 
                    RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}]}], "}"}]}], ";", 
                 RowBox[{"flagGreen", "=", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"ToString", "/@", "thgreenAll"}], ",", 
                    "\"\<Saved\>\""}], "]"}]}], ";", 
                 RowBox[{"thgreenAll", ">>", 
                  RowBox[{
                  "analysisFolder", "<>", "\"\<_thgreen2.dat\>\""}]}]}]}], 
               "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "3"}], ","}]}], "*)"}], 
            RowBox[{
             RowBox[{"thblue3DAll", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"mymaxblue3D", "=", "max"}], ",", 
                RowBox[{"thblue3D2", "=", "threshold"}], ",", 
                RowBox[{"bandpassblue3D", "=", 
                 RowBox[{"{", 
                  RowBox[{"lowpass", ",", "hipass"}], "}"}]}], ",", 
                RowBox[{"dotsizeblue3D", "=", 
                 RowBox[{"{", 
                  RowBox[{"lo", ",", "hi"}], "}"}]}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"flagBlue3D", "=", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"ToString", "/@", "thblue3DAll"}], ",", 
                "\"\<  Saved\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"thblue3DAll", ">>", 
              RowBox[{
              "analysisFolder", "<>", "\"\<_thblue3D2.dat\>\""}]}]}]}], 
           RowBox[{"(*", 
            RowBox[{"]", ";"}], "*)"}], "\[IndentingNewLine]", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Button", "[", 
           RowBox[{"\"\<Load Pre-Saved Parameters\>\"", ",", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"color", "\[Equal]", "1"}], "&&", 
                 RowBox[{"ValueQ", "@", "thredAll"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"max", ",", "threshold", ",", 
                   RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}], "}"}], "=", 
                 "thredAll"}]}], "]"}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"color", "\[Equal]", "2"}], "&&", 
                 RowBox[{"ValueQ", "@", "thgreenAll"}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"max", ",", "threshold", ",", 
                   RowBox[{"{", 
                    RowBox[{"lowpass", ",", "hipass"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"lo", ",", "hi"}], "}"}]}], "}"}], "=", 
                 "thgreenAll"}]}], "]"}], ";"}], "*)"}], 
            RowBox[{"If", "[", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"color", "\[Equal]", "3"}], "&&"}], "*)"}], 
             RowBox[{
              RowBox[{"ValueQ", "@", "thblue3DAll"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"max", ",", "threshold", ",", 
                 RowBox[{"{", 
                  RowBox[{"lowpass", ",", "hipass"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"lo", ",", "hi"}], "}"}]}], "}"}], "=", 
               "thblue3DAll"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7186417253914623`*^9, 3.7186419242398357`*^9}, {
  3.71864355709723*^9, 3.7186437180654364`*^9}, {3.7186437815850697`*^9, 
  3.7186437992340794`*^9}, {3.7186438951775665`*^9, 3.7186438992097974`*^9}, {
  3.7186439718829536`*^9, 3.7186439745701075`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"639f7fb2-3c66-48c4-a6e2-855d15efe6d5"]
}, Closed]],

Cell[CellGroupData[{

Cell["FindParticles", "Subsection",
 CellChangeTimes->{{3.578116942838025*^9, 
  3.5781169456080294`*^9}},ExpressionUUID->"064717fb-9a60-4b41-b181-\
4fe59e29cbfc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindParticlesWeighted", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}], ",", "max_", ",", "th_", ",", 
    "imgmask_", ",", 
    RowBox[{"{", 
     RowBox[{"small_", ",", "large_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgb", ",", "imgc", ",", "pos"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgb", "=", 
      RowBox[{"BandPass", "[", 
       RowBox[{"img", ",", 
        RowBox[{"{", 
         RowBox[{"lo", ",", "hi"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"imgc", "=", 
      RowBox[{"SelectComponents", "[", 
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{
          RowBox[{"imgb", "//", 
           RowBox[{
            RowBox[{"Binarize", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"max", " ", "th"}]}], "]"}], "&"}]}], ",", "imgmask"}], 
         "]"}], ",", "\"\<Count\>\"", ",", 
        RowBox[{
         RowBox[{"small", "<", "#", "<", "large"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ComponentMeasurements", "[", 
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{"img", ",", "imgc"}], "]"}], ",", 
        RowBox[{"{", "\"\<IntensityCentroid\>\"", "}"}]}], "]"}], 
      "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{"img", ",", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", 
          RowBox[{"Color", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Circle", "[", 
              RowBox[{"#", ",", 
               RowBox[{"hi", " ", "1.5"}]}], "]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{"pos", "=", 
              RowBox[{
               RowBox[{"ComponentMeasurements", "[", 
                RowBox[{"imgc", ",", 
                 RowBox[{"{", "\"\<Centroid\>\"", "}"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"All", ",", "2", ",", "1"}], "]"}], "]"}]}], 
             ")"}]}]}], "}"}], "]"}]}], "]"}], ",", "pos"}], "}"}], "*)"}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.5751527958022947`*^9, 3.5751528802924128`*^9}, {
   3.575152925492476*^9, 3.575153061152666*^9}, {3.5751531432227807`*^9, 
   3.5751531438627815`*^9}, {3.575153188922845*^9, 3.575153245352924*^9}, {
   3.5751533274730387`*^9, 3.5751533584830823`*^9}, {3.575153416033163*^9, 
   3.575153416743164*^9}, {3.575153718293586*^9, 3.5751537187735863`*^9}, {
   3.575157436595137*^9, 3.575157459425169*^9}, {3.5751582558262844`*^9, 
   3.5751582568962855`*^9}, {3.575166234180505*^9, 3.5751662566605363`*^9}, {
   3.5752405029781218`*^9, 3.5752405155081396`*^9}, 3.5752409476101503`*^9, {
   3.575241075013016*^9, 3.575241093953043*^9}, {3.575241128623091*^9, 
   3.5752411288630915`*^9}, {3.575241197793188*^9, 3.5752411981431885`*^9}, {
   3.5752413495734005`*^9, 3.5752413764734383`*^9}, {3.608917991298159*^9, 
   3.608917992241254*^9}, {3.6464847677413335`*^9, 3.646484783389229*^9}, {
   3.6485836816759624`*^9, 3.648583758596362*^9}, {3.6485838271562834`*^9, 
   3.6485838425561647`*^9}, {3.648584935277664*^9, 3.648584935773693*^9}, {
   3.653239142652603*^9, 3.653239166804985*^9}, {3.653239283964686*^9, 
   3.6532393084690876`*^9}, {3.6550415999770727`*^9, 
   3.6550416069970846`*^9}, {3.655041804633832*^9, 3.655041805772634*^9}, {
   3.6550418792175627`*^9, 3.6550418826339693`*^9}, {3.655059163882098*^9, 
   3.655059163986104*^9}, {3.655059211210805*^9, 3.655059211353813*^9}, {
   3.6552216016280055`*^9, 3.655221607020314*^9}, {3.6552232897335596`*^9, 
   3.6552232946458406`*^9}, {3.6552233416135273`*^9, 3.655223392261424*^9}, {
   3.6552241750611973`*^9, 3.65522418961403*^9}, {3.6553853018305316`*^9, 
   3.6553853463590784`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"bb1218e8-0849-4630-bfe3-ebdc6bec9a65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindParticles", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}], ",", "max_", ",", "th_", ",", 
    "imgmask_", ",", 
    RowBox[{"{", 
     RowBox[{"small_", ",", "large_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgb", ",", "imgc", ",", "compResults"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgb", "=", 
      RowBox[{"BandPass", "[", 
       RowBox[{"img", ",", 
        RowBox[{"{", 
         RowBox[{"lo", ",", "hi"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"imgc", "=", 
      RowBox[{"SelectComponents", "[", 
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{
          RowBox[{"FillingTransform", "@", 
           RowBox[{"Binarize", "[", 
            RowBox[{"imgb", ",", " ", 
             RowBox[{"max", " ", "th"}]}], "]"}]}], ",", "imgmask"}], "]"}], 
        ",", "\"\<Count\>\"", ",", 
        RowBox[{
         RowBox[{"small", "<", "#", "<", "large"}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"compResults", "=", 
      RowBox[{"ComponentMeasurements", "[", 
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{"img", ",", "imgc"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<IntensityCentroid\>\"", ",", "\"\<Centroid\>\"", ",", 
          "\"\<Area\>\"", ",", "\"\<TotalIntensity\>\"", ",", 
          "\"\<MeanIntensity\>\"", ",", "\"\<MedianIntensity\>\"", ",", 
          "\"\<Elongation\>\"", ",", "\"\<MaxCentroidDistance\>\"", ",", 
          "\"\<BoundingBox\>\"", ",", "\"\<ConvexVertices\>\""}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"compResults", "\[LeftDoubleBracket]", 
      RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7147583971303506`*^9, 3.714758408167982*^9}, 
   3.7147584663613105`*^9, {3.714759074449091*^9, 3.7147591860164723`*^9}, {
   3.715380673551758*^9, 3.71538067971211*^9}, {3.715434171802683*^9, 
   3.7154341776260157`*^9}, {3.7157340160817947`*^9, 3.7157340224781604`*^9}, 
   3.716227279614752*^9, {3.716227323727275*^9, 3.7162273973594866`*^9}, {
   3.7162274765670166`*^9, 3.7162275061277075`*^9}, {3.717507076675681*^9, 
   3.7175070820519886`*^9}, {3.717507117202999*^9, 3.717507123539361*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"bc5e76ee-de19-4bbc-afab-7733a2385851"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"After", " ", "finding", " ", "particles"}], ",", " ", 
    RowBox[{"add", " ", "track", " ", "number", " ", "as", " ", "0"}], ",", 
    " ", 
    RowBox[{"and", " ", "add", " ", "frame", " ", "number"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MyParticleFinder", "[", 
    RowBox[{"myColMovie_", ",", "channel_", ",", "analysisFolder_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "threshold1", ",", "threshold2", ",", "imgmask", ",", "bandpass", ",", 
       "dotsize", ",", "max", ",", "th2", ",", "result"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"threshold1", "=", 
       RowBox[{"Get", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<_thred.dat\>\"", ",", "\"\<_thgreen.dat\>\"", ",", 
            "\"\<_thblue.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"threshold2", "=", 
       RowBox[{"Get", "/@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
          RowBox[{"{", 
           RowBox[{
           "\"\<_thred2.dat\>\"", ",", "\"\<_thgreen2.dat\>\"", ",", 
            "\"\<_thblue2.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imgmask", "=", 
       RowBox[{"Import", "@", 
        RowBox[{"(", 
         RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bandpass", ",", "dotsize"}], "}"}], "=", 
       RowBox[{"threshold2", "\[LeftDoubleBracket]", 
        RowBox[{"channel", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "4"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"max", ",", "th2"}], "}"}], "=", 
       RowBox[{"threshold2", "\[LeftDoubleBracket]", 
        RowBox[{"channel", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"FindParticles", "[", 
          RowBox[{
           RowBox[{"ImageAdjust", "[", 
            RowBox[{"#", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
             RowBox[{
             "threshold1", "\[LeftDoubleBracket]", "channel", 
              "\[RightDoubleBracket]"}]}], "]"}], ",", "bandpass", ",", "max",
            ",", "th2", ",", "imgmask", ",", "dotsize"}], "]"}], "&"}], "/@", 
        RowBox[{
        "myColMovie", "\[LeftDoubleBracket]", "channel", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Thread", "@", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
            "result", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "result"}], ",", "1"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{"#", ",", "0"}], "]"}], "&"}], "/@", "#"}], "&"}], "/@", 
        "result"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7147583971303506`*^9, 3.714758408167982*^9}, 
   3.7147584663613105`*^9, {3.714759074449091*^9, 3.7147591860164723`*^9}, {
   3.715380673551758*^9, 3.71538067971211*^9}, {3.715434171802683*^9, 
   3.7154341776260157`*^9}, {3.7157340160817947`*^9, 3.7157340224781604`*^9}, 
   3.716227279614752*^9, {3.716227323727275*^9, 3.7162273973594866`*^9}, {
   3.7162274765670166`*^9, 3.7162275061277075`*^9}, {3.717507076675681*^9, 
   3.7175070820519886`*^9}, {3.717507117202999*^9, 3.717507123539361*^9}, {
   3.717509271589223*^9, 3.717509293909499*^9}, {3.717509331916673*^9, 
   3.7175094269971113`*^9}, {3.717509507004688*^9, 3.7175095835090637`*^9}, {
   3.717509644237537*^9, 3.7175097021328487`*^9}, {3.717510019574005*^9, 
   3.7175100234212255`*^9}, {3.7175101642622805`*^9, 
   3.7175101680614977`*^9}, {3.71751024729403*^9, 3.71751027491761*^9}, {
   3.717521561879187*^9, 3.7175215686705756`*^9}, 3.717521646888049*^9, {
   3.717521682112064*^9, 3.71752175459921*^9}, {3.717522233039575*^9, 
   3.71752228906378*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"fe21cfa8-6986-4eaa-af88-bed3bfaea37e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindGranuleMasks", "[", 
   RowBox[{"img_", ",", 
    RowBox[{"{", 
     RowBox[{"lo_", ",", "hi_"}], "}"}], ",", "max_", ",", "th_", ",", 
    "imgmask_", ",", 
    RowBox[{"{", 
     RowBox[{"small_", ",", "large_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"imgb", ",", "imgc", ",", "pos"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"imgb", "=", 
      RowBox[{"BandPass", "[", 
       RowBox[{"img", ",", 
        RowBox[{"{", 
         RowBox[{"lo", ",", "hi"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"imgc", "=", 
      RowBox[{"SelectComponents", "[", 
       RowBox[{
        RowBox[{"ImageMultiply", "[", 
         RowBox[{
          RowBox[{"FillingTransform", "@", 
           RowBox[{"Binarize", "[", 
            RowBox[{"imgb", ",", " ", 
             RowBox[{"max", " ", "th"}]}], "]"}]}], ",", "imgmask"}], "]"}], 
        ",", "\"\<Count\>\"", ",", 
        RowBox[{
         RowBox[{"small", "<", "#", "<", "large"}], "&"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.715433047700388*^9, 3.7154330762730217`*^9}, {
  3.715434158130901*^9, 3.715434164106242*^9}, {3.717523811400852*^9, 
  3.7175238219614563`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"ef7a5c03-8cbf-4f18-ac26-cbe5709c0583"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myGranuleMaskFinder", "[", 
   RowBox[{"myColMovie_", ",", "channel_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "threshold1", ",", "threshold2", ",", "imgmask", ",", "bandpass", ",", 
      "dotsize", ",", "max", ",", "th2", ",", "result"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"threshold1", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<_thred.dat\>\"", ",", "\"\<_thgreen.dat\>\"", ",", 
           "\"\<_thblue.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"threshold2", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<_thred2.dat\>\"", ",", "\"\<_thgreen2.dat\>\"", ",", 
           "\"\<_thblue2.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"imgmask", "=", 
      RowBox[{"Import", "@", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bandpass", ",", "dotsize"}], "}"}], "=", 
      RowBox[{"threshold2", "\[LeftDoubleBracket]", 
       RowBox[{"channel", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"max", ",", "th2"}], "}"}], "=", 
      RowBox[{"threshold2", "\[LeftDoubleBracket]", 
       RowBox[{"channel", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"FindGranuleMasks", "[", 
        RowBox[{
         RowBox[{"ImageAdjust", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
           RowBox[{
           "threshold1", "\[LeftDoubleBracket]", "channel", 
            "\[RightDoubleBracket]"}]}], "]"}], ",", "bandpass", ",", "max", 
         ",", "th2", ",", "imgmask", ",", "dotsize"}], "]"}], "&"}], "/@", 
      RowBox[{
      "myColMovie", "\[LeftDoubleBracket]", "channel", 
       "\[RightDoubleBracket]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.717523855883397*^9, 3.7175239911131315`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"509b1cbd-4f09-4e33-afc4-1224f02defc5"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
PairConnect2 (still one small error, but doesn\[CloseCurlyQuote]t seem to \
mess up stuff)\
\>", "Subsection",
 CellChangeTimes->{{3.578373737283985*^9, 3.578373754802816*^9}, {
  3.6425405298598948`*^9, 3.6425405335598993`*^9}, {3.642540631241037*^9, 
  3.6425406446910553`*^9}, {3.6483824557337046`*^9, 
  3.648382456997307*^9}},ExpressionUUID->"5877958b-0478-4e3a-bf3b-\
d0460736ce6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PairConnect2", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ticker_", ",", "anolist1t_"}], "}"}], ",", "list2t_", ",", 
    "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newticker", ",", "finalticker", ",", "list1", ",", "list2", ",", "flag",
       ",", "out", ",", "newTracks", ",", "mypos", ",", "myind", ",", "myl", 
      ",", "out2", ",", "out3"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newticker", "=", "ticker"}], ";", "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"anolist1t", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
          RowBox[{"#2", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"Sort", "@", "list2t"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"flag", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"myind", "=", "1"}], ";", "\[IndentingNewLine]", 
         RowBox[{"mypos", "=", 
          RowBox[{"list2", "\[LeftDoubleBracket]", 
           RowBox[{"myind", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Reap", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"While", "[", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
               RowBox[{"list1", "\[LeftDoubleBracket]", 
                RowBox[{"m", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
               "-", "dist"}], "\[LessEqual]"}], " ", "*)"}], 
            RowBox[{
             RowBox[{
              RowBox[{"mypos", "\[LessEqual]", 
               RowBox[{
                RowBox[{"list1", "\[LeftDoubleBracket]", 
                 RowBox[{"m", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}],
                 "+", "dist"}]}], " ", "&&", 
              RowBox[{"myind", "\[LessEqual]", " ", 
               RowBox[{"Length", "@", "list2"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"EuclideanDistance", "[", 
                  RowBox[{
                   RowBox[{
                   "list2", "\[LeftDoubleBracket]", "myind", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"list1", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                  "]"}], "\[LessEqual]", "dist"}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Sow", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"list1", "\[LeftDoubleBracket]", 
                    RowBox[{"m", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "list2", "\[LeftDoubleBracket]", "myind", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"list2", "=", 
                  RowBox[{"Delete", "[", 
                   RowBox[{"list2", ",", "myind"}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"myind", "=", 
                  RowBox[{"myind", "-", "1"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"flag", "=", 
                  RowBox[{"flag", "+", "1"}]}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myind", "=", 
               RowBox[{"myind", "+", "1"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "@", "list2"}], ">", "0"}], "&&", 
                 RowBox[{"myind", "\[LessEqual]", 
                  RowBox[{"Length", "@", "list2"}]}]}], ",", 
                RowBox[{"mypos", "=", 
                 RowBox[{"list2", "\[LeftDoubleBracket]", 
                  RowBox[{"myind", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                ",", 
                RowBox[{"m", "=", 
                 RowBox[{"Length", "@", "list1"}]}]}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"m", ",", "1", ",", 
          RowBox[{"Length", "@", "list1"}], ",", "1"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"out2", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"out", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "2"}], "]"}], "&"}]}], ",", "Null"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "list2"}], ">", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"finalticker", "=", 
         RowBox[{"newticker", "+", 
          RowBox[{"Length", "[", "list2", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newTracks", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{"newticker", "+", "1"}], ",", "finalticker"}], "]"}], 
            ",", "list2"}], "}"}], "//", "Transpose"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"out3", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"out2", ",", "newTracks"}], "]"}]}], ";"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"finalticker", "=", "newticker"}], ";", "\[IndentingNewLine]", 
        RowBox[{"out3", "=", "out2"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"finalticker", ",", "out3"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.578278483426984*^9, 3.578278527017045*^9}, {
   3.578278617567171*^9, 3.578278812177444*^9}, {3.578278860177511*^9, 
   3.578278958617649*^9}, {3.5782790527777805`*^9, 3.5782791306678896`*^9}, {
   3.578279228338026*^9, 3.5782792824481025`*^9}, {3.578279331708171*^9, 
   3.57827937375923*^9}, {3.5782797231797194`*^9, 3.5782797524497604`*^9}, {
   3.5782798062098355`*^9, 3.578279820769856*^9}, {3.578279860929912*^9, 
   3.578279877759936*^9}, {3.5782800389101615`*^9, 3.5782800426101665`*^9}, {
   3.5782801504503174`*^9, 3.5782802956605206`*^9}, {3.5782803604306116`*^9, 
   3.5782803672306213`*^9}, {3.5782804440807285`*^9, 3.578280470540766*^9}, {
   3.5782805111508226`*^9, 3.5782805168008304`*^9}, {3.5782805968509426`*^9, 
   3.5782805970109425`*^9}, {3.5782806657110386`*^9, 
   3.5782806854210663`*^9}, {3.5782807162611094`*^9, 
   3.5782807175111113`*^9}, {3.5782807897512126`*^9, 3.578280792511216*^9}, {
   3.5782808529913015`*^9, 3.5782808624313145`*^9}, 3.578280908081378*^9, {
   3.5782809467514324`*^9, 3.5782810046925135`*^9}, {3.5782810446625695`*^9, 
   3.5782810505625772`*^9}, {3.5782811481127143`*^9, 
   3.5782811696327443`*^9}, {3.578281283622904*^9, 3.5782812974929237`*^9}, {
   3.578281465663159*^9, 3.578281465853159*^9}, {3.578281551223279*^9, 
   3.578281564433297*^9}, {3.5782816376533995`*^9, 3.578281646533412*^9}, {
   3.578282025693943*^9, 3.5782820302239494`*^9}, {3.5782822587442694`*^9, 
   3.578282264654278*^9}, {3.5782823233143597`*^9, 3.57828232345436*^9}, {
   3.5782825197346344`*^9, 3.578282525154642*^9}, {3.578282604784754*^9, 
   3.5782826048347535`*^9}, {3.5782826819758615`*^9, 
   3.5782826900358734`*^9}, {3.5782827276359253`*^9, 3.578282894096159*^9}, {
   3.578282962536255*^9, 3.5782829667562604`*^9}, {3.5782831375564995`*^9, 
   3.5782831679665422`*^9}, {3.578283206996597*^9, 3.5782832870267086`*^9}, {
   3.578283348096794*^9, 3.578283367776822*^9}, {3.578283470656966*^9, 
   3.578283492016996*^9}, {3.5782839458876314`*^9, 3.5782839944376993`*^9}, {
   3.5782841031378517`*^9, 3.578284113677866*^9}, {3.5782842223180184`*^9, 
   3.5782842223880186`*^9}, {3.5782843294291687`*^9, 
   3.5782843302791696`*^9}, {3.5782844209192963`*^9, 3.578284457309347*^9}, {
   3.578284550769478*^9, 3.5782845508994784`*^9}, {3.578284822663619*^9, 
   3.57828484069565*^9}, {3.5782853893969555`*^9, 3.578285423857003*^9}, {
   3.578285545237173*^9, 3.578285545617174*^9}, {3.5782858759376364`*^9, 
   3.578285897557667*^9}, {3.578286003598815*^9, 3.5782860371688623`*^9}, {
   3.5782861572790303`*^9, 3.57828615737903*^9}, {3.5782862077491007`*^9, 
   3.5782862166091137`*^9}, {3.5782862581791716`*^9, 3.5782862847992086`*^9}, 
   3.578286325379266*^9, {3.578286401229372*^9, 3.5782864672294645`*^9}, {
   3.578286510369525*^9, 3.578286511389526*^9}, {3.5782870152702312`*^9, 
   3.578287016370233*^9}, {3.5782872721305914`*^9, 3.5782873117806463`*^9}, {
   3.5782874462608347`*^9, 3.5782874467208357`*^9}, {3.5782874911708975`*^9, 
   3.5782874941909018`*^9}, {3.5782876928021803`*^9, 3.578287701252192*^9}, {
   3.5782877771222982`*^9, 3.578287777862299*^9}, {3.578288352623104*^9, 
   3.578288353153105*^9}, {3.578288429383211*^9, 3.578288430623213*^9}, {
   3.5782885667834034`*^9, 3.5782885799034224`*^9}, {3.578288708243602*^9, 
   3.5782887524836636`*^9}, {3.578288898613868*^9, 3.578288905053877*^9}, {
   3.5782893486954985`*^9, 3.5782893521655035`*^9}, {3.578291437249422*^9, 
   3.5782914925594997`*^9}, 3.578291604639657*^9, {3.6425306412239523`*^9, 
   3.642530683860013*^9}, {3.642530742362096*^9, 3.6425308047651834`*^9}, {
   3.642531019962491*^9, 3.642531020132491*^9}, {3.6425311360136547`*^9, 
   3.642531166125697*^9}, {3.64253121132876*^9, 3.6425312242587786`*^9}, {
   3.642531293833877*^9, 3.642531297573882*^9}, {3.6425314082820387`*^9, 
   3.64253150795218*^9}, {3.6425315514062414`*^9, 3.6425315622862563`*^9}, {
   3.6425315928842998`*^9, 3.6425316444823723`*^9}, {3.642531691449439*^9, 
   3.6425317249694867`*^9}, {3.6425319206627626`*^9, 
   3.6425319318037777`*^9}, {3.642532056447954*^9, 3.6425320886969995`*^9}, {
   3.642532138244069*^9, 3.6425321476280828`*^9}, 3.642532244681219*^9, {
   3.6425323095393105`*^9, 3.6425323484653654`*^9}, {3.6425323843774157`*^9, 
   3.642532444282503*^9}, {3.642532501847584*^9, 3.6425325024575853`*^9}, {
   3.6425325615806684`*^9, 3.642532601869725*^9}, {3.642532707053873*^9, 
   3.6425327454539275`*^9}, {3.6425327819739795`*^9, 
   3.6425327821139793`*^9}, {3.642532815416026*^9, 3.6425328677931004`*^9}, {
   3.6425329233521786`*^9, 3.642532926542183*^9}, {3.642533062098374*^9, 
   3.642533259736653*^9}, {3.642533571219092*^9, 3.642533595639126*^9}, {
   3.642533784734393*^9, 3.64253385364149*^9}, {3.6425339204625874`*^9, 
   3.642533928552599*^9}, {3.642533971415659*^9, 3.642533983913677*^9}, {
   3.642534058391782*^9, 3.642534134649889*^9}, 3.6425342296930227`*^9, {
   3.642534352895197*^9, 3.6425345223634353`*^9}, {3.642534700581686*^9, 
   3.6425347028516893`*^9}, {3.642534759857769*^9, 3.6425347601777697`*^9}, {
   3.6425348824019413`*^9, 3.6425348994869657`*^9}, {3.642535074718212*^9, 
   3.6425352725904903`*^9}, {3.6425353223105607`*^9, 
   3.6425353314005733`*^9}, {3.6425353699746275`*^9, 
   3.6425353984366674`*^9}, {3.64253546901377*^9, 3.642535556605893*^9}, {
   3.642535660427039*^9, 3.6425356605370398`*^9}, {3.642535706873105*^9, 
   3.6425357137931147`*^9}, {3.6425384922410283`*^9, 3.642538496281034*^9}, 
   3.6785566714495325`*^9, {3.6785587960190516`*^9, 3.6785588947867002`*^9}, {
   3.6785593039071007`*^9, 3.678559305379185*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"ac00e7fd-158a-4f47-a4cd-a2c4e7124f4e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
PairConnect3 (Connect a dot in frame(n) to the nearest dot in frame(n-1) \
which is less than the determined jumping distance > there is no conversion, \
but diversion) \
\>", "Subsection",
 CellChangeTimes->{{3.678559583698104*^9, 3.678559593562668*^9}, {
  3.6785687791460533`*^9, 3.6785688974738216`*^9}, {3.6785689412813272`*^9, 
  3.678568949921821*^9}},ExpressionUUID->"4114f7dc-f275-426d-878f-\
d33fec46039f"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "is", " ", "used", " ", "with", " ", 
     "LinkTracks", " ", "or", " ", "LinkTracks2", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", "A", " ", "cordinate", " ", "of", " ", 
     "each", " ", "dots", " ", "at", " ", "frame", "#", " ", "N"}], "+", 
    RowBox[{
    "1", " ", "is", " ", "compared", " ", "with", " ", "dots", " ", "at", " ",
      "frame", "#", " ", "N", " ", "by", " ", "Table", " ", "function", 
     "\[IndentingNewLine]", "\t", "Those", " ", "dots", " ", "located"}], " ",
     "+", 
    RowBox[{
     RowBox[{"/", 
      RowBox[{"-", " ", "\"\<dist_\>\""}]}], " ", "are", " ", "listed", " ", 
     "as", " ", "\"\<potentialDots\>\"", "\[IndentingNewLine]", "\t", "If", 
     " ", "the", " ", "nearest", " ", "dots", " ", "in", " ", 
     "\"\<potentialDots\>\"", " ", "is", " ", "actually", " ", "less", " ", 
     "than", " ", "\"\<dist_\>\"", "\[IndentingNewLine]", "\t", "the", " ", 
     "track", " ", "number", " ", "of", " ", "the", " ", "dot", " ", "is", 
     " ", "given", " ", "to", " ", "the", " ", "current", " ", "dot", " ", 
     "at", " ", "frame", "#", " ", "N"}], "+", 
    RowBox[{
    "1", "\[IndentingNewLine]", "\t", "This", " ", "will", " ", "ensure", " ",
      "there", " ", "is", " ", "no", " ", "conversion", " ", "in", " ", 
     "tracks", "\[IndentingNewLine]", "\t", "If", " ", "there", " ", "is", 
     " ", "no", " ", "dots", " ", "closeby", " ", "in", " ", "frame", " ", 
     "#N"}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "the", " ", "current", " ", "dot", " ", "gets", " ", "the", " ", "new", 
     " ", "track", " ", "number", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{
     "list1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ":", 
    " ", 
    RowBox[{"the", " ", "latest", " ", 
     RowBox[{"(", "biggest", ")"}], " ", "track", " ", "number", " ", "being",
      " ", "used", " ", 
     RowBox[{"(", "newticker", ")"}], "\[IndentingNewLine]", "\t\t", 
     RowBox[{
     "list1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ":", 
    " ", 
    RowBox[{
    "the", " ", "list", " ", "of", " ", "cordinate", " ", "of", " ", "points",
      " ", "with", " ", "a", " ", "track", " ", "number", " ", "at", " ", 
     "frame", "#", " ", "N", " ", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"list2", ":", "    ", 
      RowBox[{
       RowBox[{
       "the", " ", "list", " ", "of", " ", "cordinate", " ", "of", " ", 
        "points", " ", "at", " ", "frame", "#", " ", "N"}], "+", 
       RowBox[{
       "1", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t ", "out"}]}], 
      ":", "      ", 
      RowBox[{
       RowBox[{
       "the", " ", "list", " ", "of", " ", "cordinate", " ", "of", " ", 
        "points", " ", "with", " ", "a", " ", "track", " ", "number", " ", 
        "at", " ", "frame", "#", " ", "N"}], "+", "1"}]}]}]}]}], 
  "\[IndentingNewLine]", " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6786311463602543`*^9, 3.6786316118118763`*^9}, {
  3.6786336143174133`*^9, 3.6786336993652773`*^9}, {3.6786337329091964`*^9, 
  3.6786338276456146`*^9}, {3.6786442408382154`*^9, 3.67864462992647*^9}, {
  3.678644735598514*^9, 3.678644831406994*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"7723b677-00ac-4bad-a2fc-617d06cf3d1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PairConnect3", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ticker_", ",", "anolist1t_"}], "}"}], ",", "list2t_", ",", 
    "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newticker", ",", "list1", ",", "list2", ",", "out", ",", "mypos"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newticker", "=", "ticker"}], ";", "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"anolist1t", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
          RowBox[{"#2", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"Sort", "@", "list2t"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mypos", "=", 
          RowBox[{
          "list2", "\[LeftDoubleBracket]", "myi", "\[RightDoubleBracket]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"potentialDots", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"list1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "-", "dist"}], "<", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "+", "dist"}]}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "-", "dist"}], "<", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<", 
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "+", "dist"}]}]}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"potentialDots", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newticker", "+=", "1"}], ";", 
            RowBox[{"out", "=", 
             RowBox[{"{", 
              RowBox[{"newticker", ",", "mypos"}], "}"}]}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"potentialDot", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"potentialDots", ",", 
                 RowBox[{"x_", "/;", 
                  RowBox[{
                   RowBox[{
                   "x", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"potentialDots", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",",
                     "mypos"}], "]"}]}]}]}]}], "]"}], ",", "1"}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"EuclideanDistance", "[", 
                RowBox[{"mypos", ",", 
                 RowBox[{
                 "potentialDot", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ">", "dist"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{"newticker", "+=", "1"}], ";", 
               RowBox[{"out", "=", 
                RowBox[{"{", 
                 RowBox[{"newticker", ",", "mypos"}], "}"}]}], ";"}], ",", 
              RowBox[{
               RowBox[{"out", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "potentialDot", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "mypos"}], "}"}]}], 
               ";"}]}], "]"}]}]}], "]"}], ";", "out"}], ",", 
        RowBox[{"{", 
         RowBox[{"myi", ",", "1", ",", 
          RowBox[{"Length", "@", "list2"}], ",", "1"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newticker", ",", "out"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.678559612091728*^9, 3.678559616794997*^9}, {
   3.6785597764591293`*^9, 3.678559889284582*^9}, {3.6785600026430664`*^9, 
   3.6785600028040757`*^9}, {3.6785645606417685`*^9, 3.6785646495908566`*^9}, 
   3.6785661846406565`*^9, 3.6785662164474754`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"a1db5db6-6304-4051-817a-9848a8dead52"]
}, Closed]],

Cell[CellGroupData[{

Cell["PairConnect4 (PairConnect3 + removing diversion)", "Subsection",
 CellChangeTimes->{{3.678559583698104*^9, 3.678559593562668*^9}, {
  3.67856877593787*^9, 3.678568776041876*^9}, {3.678568958833331*^9, 
  3.6785689735461726`*^9}},ExpressionUUID->"82501da8-27d3-41c4-919a-\
6a91c3668e37"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "is", " ", "used", " ", "with", " ", 
     "LinkTracks", " ", "or", " ", "LinkTracks2", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\t", "After", " ", "connecting", " ", "all", " ",
      "dots", " ", "at", " ", "frame", "#", " ", "N"}], "+", 
    RowBox[{
    "1", " ", "to", " ", "dots", " ", "at", " ", "frame", "#", " ", "N", 
     "\[IndentingNewLine]", "\t", "finding", " ", "redundant", " ", "track", 
     " ", "numbers", " ", "by", " ", "using", " ", "RedundantTrack", " ", 
     "function", "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", 
     RowBox[{"RedundantTrack", "[", 
      RowBox[{"{", 
       RowBox[{
       "1", ",", "2", ",", "5", ",", "1", ",", "6", ",", "7", ",", "2", ",", 
        "2", ",", "5"}], "}"}], "]"}], "\[IndentingNewLine]", "\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "5", ",", "6", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "4", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "2", "}"}], ",", 
           RowBox[{"{", "7", "}"}], ",", 
           RowBox[{"{", "8", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "3", "}"}], ",", 
           RowBox[{"{", "9", "}"}]}], "}"}]}], "}"}]}], "}"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\t", "redundant", " ", 
     "track", " ", "numbers", " ", "means", " ", "track", " ", "gets", " ", 
     "split", " ", "at", " ", "frame", "#", " ", "N"}], "+", 
    RowBox[{
    "1", "\[IndentingNewLine]", "\t", "in", " ", "order", " ", "to", " ", 
     "avoid", " ", "this"}]}], ",", " ", 
   RowBox[{
   "choosing", " ", "the", " ", "nearest", " ", "point", " ", "and", " ", 
    "assign", " ", "a", " ", "new", " ", "track", " ", "number", " ", "to", 
    " ", "the", " ", "other", " ", "points"}]}], "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.678644657461045*^9, 3.6786447316622887`*^9}, {
  3.678644841734585*^9, 3.678644919664042*^9}, {3.678644955945117*^9, 
  3.678645062191194*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"ce2cb924-fceb-4603-9a5d-7c19ed17c90e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RedundantTrack", "[", 
   RowBox[{"list_", ",", 
    RowBox[{"test_:", " ", "Identity"}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Composition", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"list", ",", "#"}], "]"}], "&"}], "/@", 
         RowBox[{
         "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
       "}"}], "&"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", "_", "}"}]}], "]"}], "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], "&"}],
      ",", 
     RowBox[{
      RowBox[{"GatherBy", "[", 
       RowBox[{"#", ",", "test"}], "]"}], "&"}]}], "]"}], "[", "list", 
   "]"}]}]], "Input",
 CellLabel->"In[20]:=",ExpressionUUID->"24c6d2ca-d437-436d-a2ca-e8901fc98d27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PairConnect4", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ticker_", ",", "anolist1t_"}], "}"}], ",", "list2t_", ",", 
    "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newticker", ",", "list1", ",", "list2", ",", "out", ",", "mypos", ",", 
      "myRedundant", ",", "null", ",", "tempOriginalPoint", ",", 
      "tempNewPoints", ",", "tempTruePoint", ",", "tempOutlierPointPosi"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newticker", "=", "ticker"}], ";", "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"anolist1t", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"#1", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
          RowBox[{"#2", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "&"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"Sort", "@", "list2t"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"out", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mypos", "=", 
          RowBox[{
          "list2", "\[LeftDoubleBracket]", "myi", "\[RightDoubleBracket]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"potentialDots", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"list1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "-", "dist"}], "<", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "<", 
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "+", "dist"}]}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "-", "dist"}], "<", 
               RowBox[{"x", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<", 
               RowBox[{
                RowBox[{
                "mypos", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "+", "dist"}]}]}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"potentialDots", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newticker", "+=", "1"}], ";", 
            RowBox[{"out", "=", 
             RowBox[{"{", 
              RowBox[{"newticker", ",", "mypos"}], "}"}]}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"potentialDot", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"potentialDots", ",", 
                 RowBox[{"x_", "/;", 
                  RowBox[{
                   RowBox[{
                   "x", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Nearest", "[", 
                    RowBox[{
                    RowBox[{"potentialDots", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",",
                     "mypos"}], "]"}]}]}]}]}], "]"}], ",", "1"}], "]"}]}], 
            ";", "\[IndentingNewLine]", "\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"EuclideanDistance", "[", 
                RowBox[{"mypos", ",", 
                 RowBox[{
                 "potentialDot", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ">", "dist"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{"newticker", "+=", "1"}], ";", 
               RowBox[{"out", "=", 
                RowBox[{"{", 
                 RowBox[{"newticker", ",", "mypos"}], "}"}]}], ";"}], ",", 
              RowBox[{
               RowBox[{"out", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                  "potentialDot", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "mypos"}], "}"}]}], 
               ";"}]}], "]"}]}]}], "]"}], ";", "out"}], ",", 
        RowBox[{"{", 
         RowBox[{"myi", ",", "1", ",", 
          RowBox[{"Length", "@", "list2"}], ",", "1"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"myRedundant", "=", 
      RowBox[{"RedundantTrack", "[", 
       RowBox[{"out", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"null", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempOriginalPoint", "=", 
          RowBox[{"Extract", "[", 
           RowBox[{"list1", ",", 
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{"list1", "\[LeftDoubleBracket]", 
               RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{"myRedundant", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "myj"}], "\[RightDoubleBracket]"}]}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tempNewPoints", "=", 
          RowBox[{"out", "\[LeftDoubleBracket]", 
           RowBox[{"Flatten", "@", 
            RowBox[{"myRedundant", "\[LeftDoubleBracket]", 
             RowBox[{"3", ",", "myj"}], "\[RightDoubleBracket]"}]}], 
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tempTruePoint", "=", 
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"tempNewPoints", ",", 
             RowBox[{"Flatten", "@", 
              RowBox[{"Nearest", "[", 
               RowBox[{
                RowBox[{"tempNewPoints", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                RowBox[{"tempOriginalPoint", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], 
               "]"}]}]}], "]"}], "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tempOutlierPointPosi", "=", 
          RowBox[{
           RowBox[{"Delete", "[", 
            RowBox[{
             RowBox[{"myRedundant", "\[LeftDoubleBracket]", 
              RowBox[{"3", ",", "myj"}], "\[RightDoubleBracket]"}], ",", 
             "tempTruePoint"}], "]"}], "//", "Flatten"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Range", "[", 
          RowBox[{
           RowBox[{"newticker", "+", "1"}], ",", 
           RowBox[{"newticker", "+", 
            RowBox[{"Length", "@", "tempOutlierPointPosi"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"out", "\[LeftDoubleBracket]", 
           RowBox[{"tempOutlierPointPosi", ",", "1"}], 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"newticker", "+", "1"}], ",", 
            RowBox[{"newticker", "+", 
             RowBox[{"Length", "@", "tempOutlierPointPosi"}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"newticker", "=", 
          RowBox[{"newticker", "+", 
           RowBox[{"Length", "@", "tempOutlierPointPosi"}]}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"myj", ",", "1", ",", 
          RowBox[{"Length", "@", 
           RowBox[{
           "myRedundant", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newticker", ",", "out"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.678559612091728*^9, 3.678559616794997*^9}, {
   3.6785597764591293`*^9, 3.678559889284582*^9}, {3.6785600026430664`*^9, 
   3.6785600028040757`*^9}, {3.6785645606417685`*^9, 3.6785646495908566`*^9}, 
   3.6785661846406565`*^9, 3.6785662164474754`*^9, {3.6785691452029905`*^9, 
   3.6785691752347083`*^9}, {3.6786294864193106`*^9, 
   3.6786294970029163`*^9}, {3.6786295295627785`*^9, 
   3.6786295693700557`*^9}, {3.6786296000998135`*^9, 3.678629674828087*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"8e2a5c19-7e6c-4da2-82bc-c53f9938adbc"]
}, Closed]],

Cell[CellGroupData[{

Cell["LinkTracks", "Subsection",
 CellChangeTimes->{{3.6425406972561293`*^9, 3.642540699196132*^9}, {
  3.6425407307771764`*^9, 3.642540734629182*^9}, {3.6483824467792892`*^9, 
  3.648382447886891*^9}},ExpressionUUID->"42b0c1a2-f5ce-42fd-bae4-\
0a31b08df29a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkTracks", "[", 
   RowBox[{"testgreenP_", ",", "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list1", ",", "list2", ",", "listResult", ",", "listResultFrame", ",", 
      "listResultTrack"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list1", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", 
           RowBox[{
           "testgreenP", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{"Sort", "@", 
          RowBox[{
          "testgreenP", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Length", "@", "list1"}], ",", "list1"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"testgreenP", "\[LeftDoubleBracket]", 
       RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"listResult", "=", 
      RowBox[{"FoldList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PairConnect4", "[", 
          RowBox[{"#1", ",", "#2", ",", "dist"}], "]"}], "&"}], ",", "list1", 
        ",", "list2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listResultFrame", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{
          "listResult", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "i", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "j", ",", "2", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"listResult", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
              "1"}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "listResult"}], ",", "1"}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"listResultTrack", "=", 
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"listResultFrame", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "Sort"}], ",", 
        "First"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"listResultFrame", ",", "listResultTrack"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.642537218408235*^9, 3.642537264040299*^9}, {
   3.642537296025344*^9, 3.6425373967124853`*^9}, {3.6425375490676994`*^9, 
   3.6425375491776996`*^9}, {3.6428863768161287`*^9, 
   3.6428863815353985`*^9}, {3.642886462952055*^9, 3.642886463968113*^9}, {
   3.642939120294883*^9, 3.642939135121731*^9}, {3.64293926676126*^9, 
   3.6429392677223153`*^9}, {3.6429393414655333`*^9, 
   3.6429393421455717`*^9}, {3.6430564615444183`*^9, 
   3.6430564648156056`*^9}, {3.678556682570169*^9, 3.678556741576544*^9}, {
   3.6785567816588364`*^9, 3.6785567968567057`*^9}, {3.6785568671847286`*^9, 
   3.6785568723050213`*^9}, 3.678556966680419*^9, {3.6785646596314306`*^9, 
   3.6785646597424374`*^9}, {3.678564878566953*^9, 3.6785648786709595`*^9}, {
   3.6785659857122784`*^9, 3.678565985832285*^9}, {3.6785672838895297`*^9, 
   3.678567283976535*^9}, {3.678567339273698*^9, 3.678567339384704*^9}, {
   3.6786298277868357`*^9, 3.6786298278828416`*^9}, {3.6786455094707775`*^9, 
   3.6786455421916485`*^9}, {3.6786456047912292`*^9, 3.678645677591393*^9}, {
   3.6786458595918026`*^9, 3.6786458778638477`*^9}, {3.6786459520160894`*^9, 
   3.67864598315987*^9}, {3.6786460706318736`*^9, 3.6786460973284006`*^9}, {
   3.67864615028743*^9, 3.6786461816002207`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"d899a0da-0a23-46c3-9f8f-39815f16a4e3"]
}, Closed]],

Cell[CellGroupData[{

Cell["LinkTracks2", "Subsection",
 CellChangeTimes->{{3.6786311154964886`*^9, 
  3.678631122754904*^9}},ExpressionUUID->"9ee3618b-b7ab-4cda-b98d-\
b18d656f8d1d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "get", " ", "rid", " ", "of", " ", "tracks", " ", "which", " ", "last", 
    " ", "only", " ", "1", " ", "or", " ", "2", " ", "frame", 
    RowBox[{"(", "s", ")"}], " ", "and", " ", "re"}], "-", 
   RowBox[{"assign", " ", "consecutive", " ", "track", " ", "numbers"}]}], 
  " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6786451804919605`*^9, 3.6786452852309513`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"6f5db85a-570c-4bbd-b299-fa7459cda639"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkTracks2", "[", 
   RowBox[{"testgreenP_", ",", "dist_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "list1", ",", "list2", ",", "listResult", ",", "listResultFrame", ",", 
      "listResultTrack", ",", "listResultTrackL"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list1", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", 
           RowBox[{
           "testgreenP", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{"Sort", "@", 
          RowBox[{
          "testgreenP", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list1", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Length", "@", "list1"}], ",", "list1"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"list2", "=", 
      RowBox[{"testgreenP", "\[LeftDoubleBracket]", 
       RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"listResult", "=", 
      RowBox[{"FoldList", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"PairConnect4", "[", 
          RowBox[{"#1", ",", "#2", ",", "dist"}], "]"}], "&"}], ",", "list1", 
        ",", "list2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listResultFrame", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Insert", "[", 
         RowBox[{
          RowBox[{
          "listResult", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}], ",", "i", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "j", ",", "2", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "@", 
               RowBox[{"listResult", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
              "1"}], "}"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "listResult"}], ",", "1"}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"listResultTrack", "=", 
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"listResultFrame", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "Sort"}], ",", 
        "First"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listResultTrackL", "=", 
      RowBox[{"Extract", "[", 
       RowBox[{"listResultTrack", ",", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Length", "/@", "listResultTrack"}], ",", 
          RowBox[{"x_", "/;", 
           RowBox[{"x", ">", "2"}]}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listResultTrackL", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "listResultTrackL"}]}]}], ";", 
     "\[IndentingNewLine]", "listResultTrackL"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.678645143510845*^9, {3.6786462319861026`*^9, 3.6786462430877376`*^9}, {
   3.678646706939268*^9, 3.678646782449587*^9}, {3.67864688984873*^9, 
   3.678646931857133*^9}, 3.6786469851691823`*^9, {3.6786471294484344`*^9, 
   3.6786471353687735`*^9}, {3.678648850050847*^9, 3.6786488527139997`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"0f2410ff-b202-4ef3-abac-1d744fff5830"]
}, Closed]],

Cell[CellGroupData[{

Cell["Relinking", "Subsection",
 CellChangeTimes->{{3.6429485555685496`*^9, 
  3.642948561607895*^9}},ExpressionUUID->"f7fe15cd-a3df-406c-8d08-\
e574d4759856"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Only", " ", "the", " ", "longest", " ", "path", " ", "will", " ", "be", 
   " ", "taken", " ", "for", " ", "the", " ", "last", " ", "frame", " ", "if",
    " ", "the", " ", "track", " ", "split", " ", "in", " ", "the", " ", 
   "middle"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6430559206934834`*^9, 3.6430559317251143`*^9}, {
  3.6431167430053205`*^9, 3.6431168098051414`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"d5b4867a-3176-4d7a-93ad-6894f58bd0b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Relinking", "[", 
   RowBox[{
   "sortedbyframe_", ",", "sortedbytrack_", ",", "gap_", ",", "distance_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "ftrackList", ",", "ltrackList", ",", "linkinglist", ",", "mytrack", ",",
       "mytrackN", ",", "myt", ",", "mypos", ",", "newrange", ",", "flag", 
      ",", "targetFrame", ",", "targetTracks", ",", "candidateTracks", ",", 
      "closestTrack", ",", "out", ",", "newlinkinglist", ",", 
      "newsortedbytrack", ",", "oldtrackN", ",", "newtrackN", ",", 
      "newsortedbyframe", ",", "oldtrackPos"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "extracting", " ", "the", " ", "begining", " ", "and", " ", "the", " ", 
      "ending", " ", "of", " ", "all", " ", "tracks"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ftrackList", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"First", "/@", 
          RowBox[{
          "sortedbytrack", "\[LeftDoubleBracket]", "All", 
           "\[RightDoubleBracket]"}]}], ")"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "}"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ftrackList", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"ftrackList", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"x", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "\[LessEqual]",
           "2"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ltrackList", "=", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{"Last", "/@", 
         RowBox[{
         "sortedbytrack", "\[LeftDoubleBracket]", "All", 
          "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "}"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "relinking", " ", "tracks", " ", "and", " ", "making", " ", "a", " ", 
       "list"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"linkinglist", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"mytrack", "=", 
         RowBox[{
         "ftrackList", "\[LeftDoubleBracket]", "i", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mytrackN", "=", 
         RowBox[{
         "mytrack", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"myt", "=", 
         RowBox[{"mytrack", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mypos", "=", 
         RowBox[{"mytrack", "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", 
           RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newrange", "=", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{
            RowBox[{"myt", "-", "gap", "-", "1"}], ",", 
            RowBox[{"myt", "-", "2"}], ",", "1"}], "]"}], "//", "Reverse"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"flag", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"targetFrame", "=", 
            RowBox[{
            "newrange", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"flag", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"targetTracks", "=", 
               RowBox[{"Extract", "[", 
                RowBox[{"ltrackList", ",", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"ltrackList", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "targetFrame"}], "]"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"candidateTracks", "=", 
               RowBox[{"Select", "[", 
                RowBox[{"targetTracks", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"EuclideanDistance", "[", 
                    RowBox[{
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}], 
                    ",", "mypos"}], "]"}], "<", "distance"}], "&"}]}], 
                "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "candidateTracks", "]"}], ">", "0"}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", "candidateTracks", "]"}], 
                   "\[Equal]", "1"}], ",", 
                  RowBox[{
                   RowBox[{"out", "=", 
                    RowBox[{"{", 
                    RowBox[{"mytrackN", ",", 
                    RowBox[{"candidateTracks", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], ";", 
                   RowBox[{
                    RowBox[{"ltrackList", "\[LeftDoubleBracket]", 
                    RowBox[{"mytrackN", ",", "1"}], "\[RightDoubleBracket]"}],
                     "=", 
                    RowBox[{"candidateTracks", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                   RowBox[{"flag", "=", "1"}], ";"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"closestTrack", "=", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"candidateTracks", ",", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"x", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"#", ",", "mypos"}], "]"}], "&"}], "/@", 
                    RowBox[{"candidateTracks", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", 
                    RowBox[{"2", ";;", "3"}]}], "\[RightDoubleBracket]"}]}]}],
                     ",", 
                    RowBox[{"Min", "[", "x", "]"}]}], "]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"out", "=", 
                    RowBox[{"{", 
                    RowBox[{"mytrackN", ",", 
                    RowBox[{"closestTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}], ";", 
                   RowBox[{
                    RowBox[{"ltrackList", "\[LeftDoubleBracket]", 
                    RowBox[{"mytrackN", ",", "1"}], "\[RightDoubleBracket]"}],
                     "=", 
                    RowBox[{"closestTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                   RowBox[{"flag", "=", "1"}], ";"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"out", "=", 
                  RowBox[{"{", "}"}]}], ";", 
                 RowBox[{"flag", "=", "0"}]}]}], "]"}]}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", 
            RowBox[{"Length", "[", "newrange", "]"}], ",", "1"}], "}"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"linkinglist", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"linkinglist", ",", "out"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "ftrackList", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "convert", " ", "old", " ", "track", " ", "numbers", " ", "to", " ", 
       "new", " ", "track", " ", "numbers", " ", "in", " ", 
       "\"\<sortedbytrack\>\"", " ", "and", " ", "\"\<sortedbyframe\>\""}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"newlinkinglist", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"linkinglist", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newsortedbytrack", "=", "sortedbytrack"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newsortedbyframe", "=", "sortedbyframe"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"oldtrackN", "=", 
         RowBox[{"newlinkinglist", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newtrackN", "=", 
         RowBox[{"newlinkinglist", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newsortedbytrack", "\[LeftDoubleBracket]", 
          RowBox[{"oldtrackN", ",", "All", ",", "1"}], 
          "\[RightDoubleBracket]"}], "=", "newtrackN"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"oldtrackPos", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{"newsortedbyframe", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2", ",", "All", ",", "1"}], 
                "\[RightDoubleBracket]"}], ",", "oldtrackN"}], "]"}], "//", 
             "Flatten"}], "//", 
            RowBox[{
             RowBox[{"Riffle", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", 
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{"#", ",", "4"}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newsortedbyframe", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"newsortedbyframe", ",", 
           RowBox[{"oldtrackPos", " ", "\[Rule]", " ", "newtrackN"}]}], 
          "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "newlinkinglist", "]"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newsortedbytrack", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"newsortedbytrack", "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "Sort"}], "//", 
       RowBox[{
        RowBox[{"SplitBy", "[", 
         RowBox[{"#", ",", "First"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "newsortedbyframe", ",", "newsortedbytrack", ",", "newlinkinglist"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.643045022540145*^9, 3.643045216993267*^9}, {
   3.6430452488580894`*^9, 3.643045276385664*^9}, {3.6430453376271667`*^9, 
   3.6430453986246557`*^9}, {3.6430569720696187`*^9, 
   3.6430570220844793`*^9}, {3.64305706195576*^9, 3.6430571061472874`*^9}, {
   3.6430573628279686`*^9, 3.6430573771327868`*^9}, {3.643057427907691*^9, 
   3.6430574393803473`*^9}, {3.6431331820155783`*^9, 
   3.6431332581189313`*^9}, {3.643136544192884*^9, 3.643136634932074*^9}, 
   3.6431370498418055`*^9, {3.643137451493778*^9, 3.6431374541959333`*^9}, {
   3.643137698250892*^9, 3.6431377016580873`*^9}, {3.643138000046154*^9, 
   3.6431380084446344`*^9}, {3.643138079340689*^9, 3.6431380961476507`*^9}, {
   3.6431381850367346`*^9, 3.643138198147485*^9}, {3.643139144227597*^9, 
   3.6431393006865463`*^9}, {3.6431398221283712`*^9, 
   3.6431398241664877`*^9}, {3.6431407049758673`*^9, 
   3.6431407055348988`*^9}, {3.643471534892849*^9, 3.643471536684952*^9}, {
   3.643471617238559*^9, 3.6434716488853693`*^9}, {3.6434717183183403`*^9, 
   3.6434717592526817`*^9}, 3.649472570771883*^9},
 CellLabel->"In[26]:=",ExpressionUUID->"6ff309f0-4fbf-4d46-bce7-0a511ac96dd8"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sortedbyframe", ",", "sortedbytrack"}], "}"}], "=", 
    RowBox[{"LinkTracks", "[", 
     RowBox[{"testgreenP", ",", "1"}], "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.643140617018836*^9, 3.6431406198890004`*^9}, {
  3.648304096465707*^9, 3.6483040988408427`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"97c8f76c-8fa2-4c2e-9770-016c61a3c9d9"]
}, Closed]],

Cell[CellGroupData[{

Cell["ParticleFitting", "Subsection",
 CellChangeTimes->{{3.6515211610224323`*^9, 
  3.651521163990602*^9}},ExpressionUUID->"db94ffc5-f824-4e2c-8fab-\
1f05523d3d48"],

Cell["\<\
When raw images are used for fitting, avgFrameN_ is used to shift frames such \
that the middle frame of running average is used for fitting.
For example when avgFrameN is 3, the centroid at the first time point in \
mylongtrack is determined from the average image of frame 1, 2 and 3. So \
frame 2 should be fitted with this initial guess.
When running averaged images are used for fitting, enter \
\[OpenCurlyDoubleQuote]1\[CloseCurlyDoubleQuote] at the last input instead of \
avgFrameN.\
\>", "Text",
 CellChangeTimes->{{3.6557286003930864`*^9, 
  3.655728889600628*^9}},ExpressionUUID->"59f65602-4c60-4e55-a84b-\
747f815ce24a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParticleFittingSee", "[", 
   RowBox[{
   "myColMovie_", ",", "channel_", ",", "mylongtrack_", ",", "pad_", ",", 
    "myTrimSize_", ",", "avgFrameN_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"tempTime", ",", "tempCenter", ",", "frameShift"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tempTime", "=", 
        RowBox[{"mylongtrack", "\[LeftDoubleBracket]", 
         RowBox[{"t", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"tempCenter", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"mylongtrack", "\[LeftDoubleBracket]", 
          RowBox[{"t", ",", "2", ",", 
           RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"frameShift", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ImageTrim", "[", 
        RowBox[{
         RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
          RowBox[{"channel", ",", 
           RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"tempCenter", "-", "pad"}], ",", 
           RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}], "]"}]}],
       "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1", ",", 
        RowBox[{"Length", "[", "mylongtrack", "]"}], ",", "1"}], "}"}]}], 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
  3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
  3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
  3.655581282500985*^9, 3.6555813891080823`*^9}, {3.6555814330835977`*^9, 
  3.65558148994785*^9}, {3.655581570579462*^9, 3.655581605779475*^9}, {
  3.655581714731707*^9, 3.6555817416352463`*^9}, {3.6556456138785295`*^9, 
  3.6556456600301685`*^9}, {3.655645691237954*^9, 3.6556457099260225`*^9}, {
  3.655646442718936*^9, 3.6556464690944448`*^9}, {3.6556603618410645`*^9, 
  3.655660361961071*^9}, {3.6557217222026763`*^9, 3.6557218284757547`*^9}, {
  3.6557218930834503`*^9, 3.6557219581311707`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"55ae7aa6-f29e-4601-ac2c-cd9d1e2f17d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParticleFitting", "[", 
   RowBox[{
   "myColMovie_", ",", "channel_", ",", "mylongtracks_", ",", "pad_", ",", 
    "myTrimSize_", ",", "avgFrameN_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myAllParametersEach", ",", "myTrimImgs", ",", "myOrigins", ",", 
      "tempTime", ",", "tempCenter", ",", "frameShift", ",", "myImgs", ",", 
      "myData", ",", "myFits", ",", "tempData3D", ",", "myFit", ",", "myPos", 
      ",", "myPosImgCoordn", ",", "myAbsPos", ",", "myIntBGSigma", ",", 
      "myPos90Conf", ",", "myPos90ConfImgCoordn", ",", "myAbsPos90Conf", ",", 
      "myIntBGSigma90Conf", ",", "myFitData", ",", "CC", ",", "A", ",", "x0", 
      ",", "a", ",", "y0", ",", "b", ",", "x", ",", "y"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myAllParametersEach", ",", "myPos", ",", "myFitData"}], "}"}],
       "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "t", ",", "2", ",", "1"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "t", ",", "2", ",", 
                   RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"frameShift", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mylongtracks", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", 
                "x", ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"b", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"b", ",", "1"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "6"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBGSigma", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2", ",", "5", ",", "7"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "5"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBGSigma90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1", ",", "4", ",", "6"}], "}"}]}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myAllParametersEach", "=", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "2", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "myAbsPos", ",", 
                 "myIntBGSigma", ",", "myAbsPos90Conf", ",", 
                 "myIntBGSigma90Conf", ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "3"}], 
                  "\[RightDoubleBracket]"}]}], "}"}]}]}]}], ",", "myPos", ",",
             "myData"}], "}"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "mylongtracks", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myAllParametersEach", "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "myPos", ",", 
       "myFitData"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.655834242142449*^9, 
   3.655834341613138*^9}, {3.6561793737004633`*^9, 3.656179378164719*^9}, 
   3.6838989198137875`*^9},
 CellLabel->"In[29]:=",ExpressionUUID->"b03344ff-129d-41e3-bc45-bc5eaa32f134"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "input", " ", "does", " ", "not", " ", "have", " ", "color", " ", "code", 
    " ", "such", " ", "as", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}], " ", "for", " ", "red"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ParticleFitting2", "[", 
    RowBox[{
    "myColMovie_", ",", "channel_", ",", "mylongtracks_", ",", "pad_", ",", 
     "avgFrameN_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myTrimSize", ",", "myAllParametersEach", ",", "myTrimImgs", ",", 
       "myOrigins", ",", "tempTime", ",", "tempCenter", ",", "frameShift", 
       ",", "myImgs", ",", "myData", ",", "myFits", ",", "tempData3D", ",", 
       "myFit", ",", "myPos", ",", "myPosImgCoordn", ",", "myAbsPos", ",", 
       "myIntBGSigma", ",", "myPos90Conf", ",", "myPos90ConfImgCoordn", ",", 
       "myAbsPos90Conf", ",", "myIntBGSigma90Conf", ",", "myFitData", ",", 
       "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", "x", 
       ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myTrimSize", "=", 
       RowBox[{
        RowBox[{"2", "*", "pad"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "t", ",", "2", ",", "1"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "t", ",", "2", ",", 
                   RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"frameShift", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mylongtracks", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", 
                "x", ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"b", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"b", ",", "1"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "6"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBGSigma", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2", ",", "5", ",", "7"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "5"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBGSigma90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1", ",", "4", ",", "6"}], "}"}]}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myAllParametersEach", "=", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "2", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "myAbsPos", ",", 
                 "myIntBGSigma", ",", "myAbsPos90Conf", ",", 
                 "myIntBGSigma90Conf"}], "}"}]}]}]}], ",", "myPos", ",", 
            "myData"}], "}"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "mylongtracks", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"myAllParametersEach", "//", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "myPos", ",", 
        "myFitData"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.655834242142449*^9, 
   3.655834341613138*^9}, {3.6561793737004633`*^9, 3.656179378164719*^9}, 
   3.6838989198137875`*^9, {3.7136623625257072`*^9, 3.713662365581882*^9}, {
   3.7137020685437613`*^9, 3.7137020960063324`*^9}, {3.7137258651152134`*^9, 
   3.713725887763509*^9}, 3.7137281635906787`*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"c0d772fb-e2fd-4401-89de-fdda03298174"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"input", " ", "not", " ", "tracked"}], ",", " ", 
    RowBox[{
     RowBox[{
     "contains", " ", "multiple", " ", "information", " ", "from", " ", 
      "component", " ", 
      RowBox[{"measurments", ".", " ", "intensity"}], " ", "centroid", " ", 
      "is", " ", "the", " ", "first", " ", "component", "\[IndentingNewLine]",
       "   ", "fitted", " ", "result", " ", "is", " ", "appended", " ", 
      "after", " ", "the", " ", "component", " ", "measurments", " ", 
      "\[IndentingNewLine]", "    ", "output", " ", "list", " ", "has", " ", 
      "3", " ", "components", "\[IndentingNewLine]", "    ", "1.", " ", 
      "component", " ", "measurements"}], " ", "+", " ", 
     RowBox[{
     "fit", " ", "results", "\[IndentingNewLine]", "    ", "2.", " ", "fit", 
      " ", "centroid", " ", "in", " ", "the", " ", "cropped", " ", "data", 
      "\[IndentingNewLine]", "    ", "3.", " ", "cropped", " ", "data"}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MyParticleFitter", "[", 
    RowBox[{
    "myColMovie_", ",", "channel_", ",", "mySpots_", ",", "pad_", ",", 
     "avgFrameN_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myTrimSize", ",", "myAllParametersEach", ",", "myTrimImgs", ",", 
       "myOrigins", ",", "tempTime", ",", "tempCenter", ",", "frameShift", 
       ",", "myImgs", ",", "myData", ",", "myFits", ",", "tempData3D", ",", 
       "myFit", ",", "myPos", ",", "myPosImgCoordn", ",", "myAbsPos", ",", 
       "myIntBG", ",", "mySigma", ",", "myPos90Conf", ",", 
       "myPos90ConfImgCoordn", ",", "myAbsPos90Conf", ",", "myIntBG90Conf", 
       ",", "mySigma90Conf", ",", "myParametersAll", ",", "my90ConfAll", ",", 
       "myFitData", ",", "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", 
       "b", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myTrimSize", "=", 
       RowBox[{
        RowBox[{"2", "*", "pad"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"frameShift", "=", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mySpots", "\[LeftDoubleBracket]", 
                 RowBox[{"frame", ",", "spot", ",", "2"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mySpots", "\[LeftDoubleBracket]", 
                  RowBox[{"frame", ",", "spot", ",", "3", ",", "1"}], 
                  "\[RightDoubleBracket]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"spot", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mySpots", "\[LeftDoubleBracket]", "frame", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", 
                "x", ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"b", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"b", ",", "1"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "@", "myData"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "6"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mySigma", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "7"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "5"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"mySigma90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "6"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myParametersAll", "=", 
           RowBox[{"Thread", "@", 
            RowBox[{"{", 
             RowBox[{"myAbsPos", ",", "myIntBG", ",", "mySigma"}], "}"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"my90ConfAll", "=", 
           RowBox[{"Thread", "@", 
            RowBox[{"{", 
             RowBox[{
             "myAbsPos90Conf", ",", "myIntBG90Conf", ",", "mySigma90Conf"}], 
             "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myAllParametersEach", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "mySpots", "\[LeftDoubleBracket]", "frame", 
                 "\[RightDoubleBracket]"}], ",", "myParametersAll", ",", 
                "my90ConfAll"}], "}"}]}], ",", "myPos", ",", "myData"}], 
            "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myAllParametersEach", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
              "]"}], "&"}], "/@", 
            RowBox[{
            "myAllParametersEach", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
          "myAllParametersEach"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", "mySpots"}], ",", "1"}], "}"}]}], "]"}], "//",
        "Transpose"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.655834242142449*^9, 
   3.655834341613138*^9}, {3.6561793737004633`*^9, 3.656179378164719*^9}, 
   3.6838989198137875`*^9, {3.7136623625257072`*^9, 3.713662365581882*^9}, {
   3.7137020685437613`*^9, 3.7137020960063324`*^9}, {3.7137258651152134`*^9, 
   3.713725887763509*^9}, 3.7137281635906787`*^9, {3.716218610152887*^9, 
   3.7162186290729694`*^9}, {3.7162188409140854`*^9, 
   3.7162188503136234`*^9}, {3.716226078608058*^9, 3.7162261469599676`*^9}, {
   3.7162262473677106`*^9, 3.7162263090952415`*^9}, {3.716226339167961*^9, 
   3.716226369095673*^9}, {3.716230669451639*^9, 3.716230700595421*^9}, {
   3.7162308037553215`*^9, 3.7162308187311773`*^9}, {3.7162308814597654`*^9, 
   3.7162309845396614`*^9}, {3.7162310295472355`*^9, 3.71623108085117*^9}, {
   3.7162311195873857`*^9, 3.7162311493070855`*^9}, {3.716231257540276*^9, 
   3.716231299355668*^9}, {3.7162313301954317`*^9, 3.716231346324354*^9}, {
   3.716231384443535*^9, 3.7162314202995853`*^9}, {3.71623151356392*^9, 
   3.7162315421245537`*^9}, {3.7162392090030737`*^9, 
   3.7162392113062057`*^9}, {3.7162393595866866`*^9, 3.716239360106716*^9}, 
   3.7162394725941505`*^9, {3.7162408270356197`*^9, 3.716240911547454*^9}, {
   3.717510224470724*^9, 3.7175102282229395`*^9}, {3.7175103518710117`*^9, 
   3.717510486663721*^9}, {3.7175212119451723`*^9, 3.71752121784851*^9}, {
   3.718634324209139*^9, 3.718634335056759*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"c6724af9-01d1-41f0-8e98-973f754b04ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"input", " ", "not", " ", "tracked"}], ",", " ", 
    RowBox[{
     RowBox[{
     "contains", " ", "multiple", " ", "information", " ", "from", " ", 
      "component", " ", 
      RowBox[{"measurments", ".", " ", "intensity"}], " ", "centroid", " ", 
      "is", " ", "the", " ", "first", " ", "component", "\[IndentingNewLine]",
       "   ", "fitted", " ", "result", " ", "is", " ", "appended", " ", 
      "after", " ", "the", " ", "component", " ", "measurments", " ", 
      "\[IndentingNewLine]", "    ", "output", " ", "list", " ", "has", " ", 
      "3", " ", "components", "\[IndentingNewLine]", "    ", "1.", " ", 
      "component", " ", "measurements"}], " ", "+", " ", 
     RowBox[{
     "fit", " ", "results", "\[IndentingNewLine]", "    ", "2.", " ", "fit", 
      " ", "centroid", " ", "in", " ", "the", " ", "cropped", " ", "data", 
      "\[IndentingNewLine]", "    ", "3.", " ", "cropped", " ", "data"}]}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ParticleFitting3", "[", 
    RowBox[{
    "myColMovie_", ",", "channel_", ",", "mySpots_", ",", "pad_", ",", 
     "avgFrameN_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myTrimSize", ",", "myAllParametersEach", ",", "myTrimImgs", ",", 
       "myOrigins", ",", "tempCenter", ",", "frameShift", ",", "myImgs", ",", 
       "myData", ",", "myFits", ",", "tempData3D", ",", "myFit", ",", "myPos",
        ",", "myPosImgCoordn", ",", "myAbsPos", ",", "myIntBG", ",", 
       "mySigma", ",", "myPos90Conf", ",", "myPos90ConfImgCoordn", ",", 
       "myAbsPos90Conf", ",", "myIntBG90Conf", ",", "mySigma90Conf", ",", 
       "myParametersAll", ",", "my90ConfAll", ",", "myFitData", ",", "CC", 
       ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", "x", ",", 
       "y"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myTrimSize", "=", 
       RowBox[{
        RowBox[{"2", "*", "pad"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mySpots", "\[LeftDoubleBracket]", 
                  RowBox[{"frame", ",", "spot", ",", "2"}], 
                  "\[RightDoubleBracket]"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"frameShift", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"frame", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"spot", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mySpots", "\[LeftDoubleBracket]", "frame", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", 
                "x", ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"b", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "1"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"b", ",", "1"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "@", "myData"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "6"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"mySigma", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "7"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "5"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"mySigma90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "6"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myParametersAll", "=", 
           RowBox[{"Thread", "@", 
            RowBox[{"{", 
             RowBox[{"myAbsPos", ",", "myIntBG", ",", "mySigma"}], "}"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"my90ConfAll", "=", 
           RowBox[{"Thread", "@", 
            RowBox[{"{", 
             RowBox[{
             "myAbsPos90Conf", ",", "myIntBG90Conf", ",", "mySigma90Conf"}], 
             "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myAllParametersEach", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Thread", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "mySpots", "\[LeftDoubleBracket]", "frame", 
                 "\[RightDoubleBracket]"}], ",", "myParametersAll", ",", 
                "my90ConfAll"}], "}"}]}], ",", "myPos", ",", "myData"}], 
            "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"frame", ",", "1", ",", 
           RowBox[{"Length", "@", "mySpots"}], ",", "1"}], "}"}]}], "]"}], "//",
        "Transpose"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.655834242142449*^9, 
   3.655834341613138*^9}, {3.6561793737004633`*^9, 3.656179378164719*^9}, 
   3.6838989198137875`*^9, {3.7136623625257072`*^9, 3.713662365581882*^9}, {
   3.7137020685437613`*^9, 3.7137020960063324`*^9}, {3.7137258651152134`*^9, 
   3.713725887763509*^9}, 3.7137281635906787`*^9, {3.716218610152887*^9, 
   3.7162186290729694`*^9}, {3.7162188409140854`*^9, 
   3.7162188503136234`*^9}, {3.716226078608058*^9, 3.7162261469599676`*^9}, {
   3.7162262473677106`*^9, 3.7162263090952415`*^9}, {3.716226339167961*^9, 
   3.716226369095673*^9}, {3.716230669451639*^9, 3.716230700595421*^9}, {
   3.7162308037553215`*^9, 3.7162308187311773`*^9}, {3.7162308814597654`*^9, 
   3.7162309845396614`*^9}, {3.7162310295472355`*^9, 3.71623108085117*^9}, {
   3.7162311195873857`*^9, 3.7162311493070855`*^9}, {3.716231257540276*^9, 
   3.716231299355668*^9}, {3.7162313301954317`*^9, 3.716231346324354*^9}, {
   3.716231384443535*^9, 3.7162314202995853`*^9}, {3.71623151356392*^9, 
   3.7162315421245537`*^9}, {3.7162392090030737`*^9, 
   3.7162392113062057`*^9}, {3.7162393595866866`*^9, 3.716239360106716*^9}, 
   3.7162394725941505`*^9, {3.7162408270356197`*^9, 3.716240911547454*^9}, {
   3.717520921320549*^9, 3.7175209600797663`*^9}, {3.717521047439763*^9, 
   3.717521100032771*^9}, {3.7175212011425543`*^9, 3.7175212022166157`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"cb6ef53a-fb22-45a2-8783-c5a6f004feae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParticleFittingFixedSigma", "[", 
   RowBox[{
   "myColMovie_", ",", "channel_", ",", "mylongtracks_", ",", "pad_", ",", 
    "myTrimSize_", ",", "sigma_", ",", "avgFrameN_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myAllParametersEach", ",", "myTrimImgs", ",", "myOrigins", ",", 
      "tempTime", ",", "tempCenter", ",", "frameShift", ",", "myImgs", ",", 
      "myData", ",", "myFits", ",", "tempData3D", ",", "myFit", ",", "myPos", 
      ",", "myPosImgCoordn", ",", "myAbsPos", ",", "myIntBG", ",", 
      "myPos90Conf", ",", "myPos90ConfImgCoordn", ",", "myAbsPos90Conf", ",", 
      "myIntBG90Conf", ",", "myFitData", ",", "CC", ",", "A", ",", "x0", ",", 
      "y0", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myAllParametersEach", ",", "myPos", ",", "myFitData"}], "}"}],
       "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "t", ",", "2", ",", "1"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "t", ",", "2", ",", 
                   RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"frameShift", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mylongtracks", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "A", ",", "x0", ",", "y0", ",", "x", ",", "y"}], 
               "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "5"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myAllParametersEach", "=", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "2", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "myAbsPos", ",", "myIntBG", 
                 ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"sigma", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "myFits", "]"}], ",", "2"}], 
                    "}"}]}], "]"}], ",", "myAbsPos90Conf", ",", 
                 "myIntBG90Conf", ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "myFits", "]"}], ",", "4"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "3"}], 
                  "\[RightDoubleBracket]"}]}], "}"}]}]}]}], ",", "myPos", ",",
             "myData"}], "}"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "mylongtracks", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myAllParametersEach", "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "myPos", ",", 
       "myFitData"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.6558217347800684`*^9, 
   3.655821738523283*^9}, {3.655821772268213*^9, 3.6558218199079375`*^9}, {
   3.6558220477879715`*^9, 3.655822098179854*^9}, {3.655822176491333*^9, 
   3.6558222037238903`*^9}, {3.6558251922148223`*^9, 
   3.6558251961030445`*^9}, {3.6558252647589717`*^9, 
   3.6558252785097585`*^9}, {3.655825327463558*^9, 3.65582555844777*^9}, {
   3.6558273393006287`*^9, 3.6558273978079753`*^9}, {3.655834316381695*^9, 
   3.655834318069792*^9}, {3.6558443721728535`*^9, 3.6558444445739946`*^9}, {
   3.655844977494476*^9, 3.6558449788855553`*^9}, {3.6558453738731475`*^9, 
   3.655845391423151*^9}, {3.663965324194535*^9, 3.663965335002153*^9}, 
   3.663965615067172*^9, {3.6838988788284435`*^9, 3.68389888575784*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"4b84309d-cddb-42f3-a43e-70e470815b9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParticleFittingFixedSigmaInclinedBG", "[", 
   RowBox[{
   "myColMovie_", ",", "channel_", ",", "mylongtracks_", ",", "pad_", ",", 
    "myTrimSize_", ",", "sigma_", ",", "avgFrameN_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myAllParametersEach", ",", "myTrimImgs", ",", "myOrigins", ",", 
      "tempTime", ",", "tempCenter", ",", "frameShift", ",", "myImgs", ",", 
      "myData", ",", "myFits", ",", "tempData3D", ",", "myFit", ",", "myPos", 
      ",", "myPosImgCoordn", ",", "myAbsPos", ",", "myIntBG", ",", 
      "myInclinedBG", ",", "myPos90Conf", ",", "myPos90ConfImgCoordn", ",", 
      "myAbsPos90Conf", ",", "myIntBG90Conf", ",", "myInclinedBG90conf", ",", 
      "myFitData", ",", "CC", ",", "BGa", ",", "BGb", ",", "A", ",", "x0", 
      ",", "y0", ",", "x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myAllParametersEach", ",", "myPos", ",", "myFitData"}], "}"}],
       "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
           RowBox[{
            RowBox[{"Table", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"tempTime", "=", 
                RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                 RowBox[{"j", ",", "t", ",", "2", ",", "1"}], 
                 "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"tempCenter", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "t", ",", "2", ",", 
                   RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"frameShift", "=", 
                RowBox[{"Ceiling", "[", 
                 RowBox[{"avgFrameN", "/", "2"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"myImgs", "=", 
                  RowBox[{"ImageTrim", "[", 
                   RowBox[{
                    RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
                    RowBox[{"channel", ",", 
                    RowBox[{"tempTime", "+", "frameShift", "-", "1"}]}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"tempCenter", "-", "pad"}], ",", 
                    RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}],
                    "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"myOrigins", "=", 
                  RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"t", ",", "1", ",", 
                RowBox[{"Length", "[", 
                 RowBox[{
                 "mylongtracks", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "]"}], ",", "1"}], "}"}]}], 
             "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myData", "=", 
           RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myFits", "=", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"tempData3D", "=", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"MapIndexed", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#1"}], "}"}], "&"}], ",", 
                   RowBox[{
                   "myData", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"Clear", "[", 
               RowBox[{
               "CC", ",", "BGa", ",", "BGb", ",", "A", ",", "x0", ",", "y0", 
                ",", "x", ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"myFit", "=", 
               RowBox[{"NonlinearModelFit", "[", 
                RowBox[{"tempData3D", ",", 
                 RowBox[{"CC", " ", "+", " ", 
                  RowBox[{"BGa", " ", "x"}], " ", "+", " ", 
                  RowBox[{"BGb", " ", "y"}], "+", 
                  RowBox[{"A", " ", 
                   RowBox[{"E", "^", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                    RowBox[{"(", 
                    RowBox[{"2", " ", 
                    RowBox[{"sigma", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"CC", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"A", ",", 
                    RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                    ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"x0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"y0", ",", 
                    RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"BGa", ",", "0.01"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"BGb", ",", "0.01"}], "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"myFit", "[", 
               RowBox[{"{", 
                RowBox[{
                "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
                 "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Rearrange", " ", "the", " ", "parameters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"myPos", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "5"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPosImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myAbsPos", "=", 
           RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "2"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myInclinedBG", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
             RowBox[{"{", 
              RowBox[{"6", ",", "7"}], "}"}], ",", "2"}], 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "4"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myPos90ConfImgCoordn", "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", 
               "0.5"}], ",", 
              RowBox[{"myTrimSize", "-", 
               RowBox[{"myPos90Conf", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
               "0.5"}]}], "}"}], "//", "Thread"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], 
           "=", 
           RowBox[{"myPos90ConfImgCoordn", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "2", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myAbsPos90Conf", "=", 
           RowBox[{"myPos90ConfImgCoordn", "+", "myOrigins"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"myIntBG90Conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"myInclinedBG90conf", "=", 
           RowBox[{"myFits", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "3", ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "6"}], "}"}]}], "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Output", " ", "the", " ", "paramters"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myAllParametersEach", "=", 
             RowBox[{"Flatten", "/@", 
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "2", ",", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "myAbsPos", ",", "myIntBG", 
                 ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"sigma", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "myFits", "]"}], ",", "2"}], 
                    "}"}]}], "]"}], ",", "myAbsPos90Conf", ",", 
                 "myIntBG90Conf", ",", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Length", "[", "myFits", "]"}], ",", "4"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"mylongtracks", "\[LeftDoubleBracket]", 
                  RowBox[{"j", ",", "All", ",", "3"}], 
                  "\[RightDoubleBracket]"}], ",", "myInclinedBG", ",", 
                 "myInclinedBG90conf"}], "}"}]}]}]}], ",", "myPos", ",", 
            "myData"}], "}"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "mylongtracks", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myAllParametersEach", "//", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}]}], ",", "myPos", ",", 
       "myFitData"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6515211934142847`*^9, 3.651521280519267*^9}, {
   3.6515213469590673`*^9, 3.6515214200482473`*^9}, {3.651521518984906*^9, 
   3.6515218293366575`*^9}, {3.6515218704650097`*^9, 3.651521919528816*^9}, {
   3.655581282500985*^9, 3.6555813891080823`*^9}, {3.65565276167636*^9, 
   3.655652802204678*^9}, {3.655660380715144*^9, 3.6556603808751535`*^9}, {
   3.655721972211976*^9, 3.655721995987336*^9}, {3.6558217347800684`*^9, 
   3.655821738523283*^9}, {3.655821772268213*^9, 3.6558218199079375`*^9}, {
   3.6558220477879715`*^9, 3.655822098179854*^9}, {3.655822176491333*^9, 
   3.6558222037238903`*^9}, {3.6558251922148223`*^9, 
   3.6558251961030445`*^9}, {3.6558252647589717`*^9, 
   3.6558252785097585`*^9}, {3.655825327463558*^9, 3.65582555844777*^9}, {
   3.6558273393006287`*^9, 3.6558273978079753`*^9}, {3.655834316381695*^9, 
   3.655834318069792*^9}, {3.6558443721728535`*^9, 3.6558444445739946`*^9}, {
   3.655844977494476*^9, 3.6558449788855553`*^9}, {3.6558453738731475`*^9, 
   3.655845391423151*^9}, {3.663965485538763*^9, 3.6639655359626474`*^9}, 
   3.6639656173703036`*^9, {3.6639657258505087`*^9, 3.663965767234875*^9}, {
   3.6639658125564675`*^9, 3.6639658154426327`*^9}, {3.6639660619637327`*^9, 
   3.6639661631625214`*^9}, {3.663966219218727*^9, 3.6639662361706967`*^9}, {
   3.6639663351493583`*^9, 3.663966338347541*^9}, 3.68389895482279*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"884cec7f-f0bf-4904-a9eb-666b96f797b7"]
}, Closed]],

Cell[CellGroupData[{

Cell["BeadsFitting", "Subsection",
 CellChangeTimes->{{3.651523106216691*^9, 
  3.6515231119520187`*^9}},ExpressionUUID->"33a59f29-f52d-4f7c-a621-\
07ba86419f00"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeadsFitting", "[", 
   RowBox[{"myRefBeadsImg_", ",", "myPosGuess_", ",", "pad_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myTrimSize", ",", "myTrimImgs", ",", "myOrigins", ",", "tempCenter", 
      ",", "myImgs", ",", "myData", ",", "myFits", ",", "tempData3D", ",", 
      "myFit", ",", "CC", ",", "A", ",", "x", ",", "x0", ",", "a", ",", "y", 
      ",", "y0", ",", "b", ",", "myPos", ",", "myPosImgCoordn", ",", 
      "myAbsPos"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myTrimSize", "=", 
      RowBox[{
       RowBox[{"2", "*", "pad"}], "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myTrimImgs", ",", "myOrigins"}], "}"}], "=", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"tempCenter", "=", 
           RowBox[{"Ceiling", "[", 
            RowBox[{
            "myPosGuess", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"myImgs", "=", 
             RowBox[{"ImageTrim", "[", 
              RowBox[{"myRefBeadsImg", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"tempCenter", "-", "pad"}], ",", 
                 RowBox[{"tempCenter", "+", "pad", "-", "0.1"}]}], "}"}]}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"myOrigins", "=", 
             RowBox[{"tempCenter", "-", "pad", "-", "1"}]}]}], "}"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "myPosGuess", "]"}], ",", "1"}], "}"}]}], 
        "]"}], "//", "Transpose"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myData", "=", 
      RowBox[{"ImageData", "/@", "myTrimImgs"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myFits", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempData3D", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"MapIndexed", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  ",", 
                 RowBox[{
                 "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
                  ",", "#1"}], "}"}], "&"}], ",", 
              RowBox[{
              "myData", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"{", "2", "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Clear", "[", 
          RowBox[{
          "CC", ",", "A", ",", "x0", ",", "a", ",", "y0", ",", "b", ",", "x", 
           ",", "y"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"myFit", "=", 
          RowBox[{"NonlinearModelFit", "[", 
           RowBox[{"tempData3D", ",", 
            RowBox[{"CC", "+", 
             RowBox[{"A", " ", 
              RowBox[{"E", "^", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "x0"}], ")"}], "^", "2"}]}], "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", 
                    RowBox[{"a", "^", "2"}]}], ")"}]}], "-", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"y", "-", "y0"}], ")"}], "^", "2"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"2", " ", 
                    RowBox[{"b", "^", "2"}]}], ")"}]}]}], ")"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"CC", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"A", ",", 
                RowBox[{"tempData3D", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"2", "*", "pad", "*", 
                    RowBox[{"(", 
                    RowBox[{"pad", "+", "1"}], ")"}]}], "+", "1"}], ")"}], 
                  ",", "3"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"x0", ",", 
                RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y0", ",", 
                RowBox[{"pad", "+", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "1"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"myFit", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<ParameterTable\>\"", ",", "\"\<ANOVATable\>\"", ",", 
            "\"\<ParameterConfidenceIntervals\>\""}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "myData", "]"}], ",", "1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myPos", "=", 
      RowBox[{"myFits", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "1", ",", "1", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "6"}], "}"}], ",", "2"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myPosImgCoordn", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"myPos", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "-", "0.5"}],
          ",", 
         RowBox[{"myTrimSize", "-", 
          RowBox[{"myPos", "\[LeftDoubleBracket]", 
           RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "+", 
          "0.5"}]}], "}"}], "//", "Thread"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myAbsPos", "=", 
      RowBox[{"myPosImgCoordn", "+", "myOrigins"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6483906843449163`*^9, 3.6483906948281345`*^9}, {
  3.6483907313009987`*^9, 3.64839074897783*^9}, {3.648390922446535*^9, 
  3.648391064072584*^9}, {3.6483911220930867`*^9, 3.648391274564155*^9}, {
  3.6483913389338684`*^9, 3.648391349604287*^9}, {3.648391401635379*^9, 
  3.6483914032577815`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"07720052-1098-404b-9512-f354c4295570"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeadsSorting", "[", 
   RowBox[{"myRedAbsPos_", ",", "myGreenAbsPos_", ",", "dist_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myRedAbsPosSort", ",", "distanceOriginal", ",", "idx", ",", 
      "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myRedAbsPosSort", "=", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{"myRedAbsPos", ",", "myGreenAbsPos"}], "]"}], "//", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"distanceOriginal", "=", 
      RowBox[{"EuclideanDistance", "@@@", 
       RowBox[{"Thread", "@", 
        RowBox[{"{", 
         RowBox[{"myGreenAbsPos", ",", "myRedAbsPosSort"}], "}"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"idx", "=", 
      RowBox[{"Position", "[", 
       RowBox[{"distanceOriginal", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"x", ">", "dist"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw"}], 
       "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Delete", "[", 
         RowBox[{"#", ",", "idx"}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "myRedAbsPosSort", ",", "myGreenAbsPos", ",", "distanceOriginal"}], 
        "}"}]}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6483909446005745`*^9, 3.648390951901387*^9}, {
  3.6483915027763567`*^9, 3.648391714274162*^9}, {3.6515238560495787`*^9, 
  3.6515239184811497`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"935ebc3d-ee9e-4673-928b-6a14f723c56e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeadsTransform", "[", 
   RowBox[{"myRedAbsPos_", ",", "myGreenAbsPos_", ",", "dist_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw", ",", 
      "myTfFuncError", ",", "myTfFunc", ",", "myRedCorrPos", ",", 
      "distanceCorrected"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw"}], 
       "}"}], "=", 
      RowBox[{"BeadsSorting", "[", 
       RowBox[{"myRedAbsPos", ",", "myGreenAbsPos", ",", "dist"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"myTfFuncError", ",", "myTfFunc"}], "}"}], "=", 
      RowBox[{"FindGeometricTransform", "[", 
       RowBox[{"myGreenAbsPos4Calc", ",", "myRedAbsPos4Calc"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myRedCorrPos", "=", 
      RowBox[{"myTfFunc", "[", "myRedAbsPos4Calc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"distanceCorrected", "=", 
      RowBox[{"EuclideanDistance", "@@@", 
       RowBox[{"Thread", "@", 
        RowBox[{"{", 
         RowBox[{"myGreenAbsPos4Calc", ",", "myRedCorrPos"}], "}"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "myTfFuncError", ",", "myTfFunc", ",", "distanceRaw", ",", 
       "distanceCorrected"}], "}"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.648392120969268*^9, 3.648392151951922*^9}, {
  3.6483921960239997`*^9, 3.6483921962424*^9}, {3.6484004568741035`*^9, 
  3.648400590161727*^9}, {3.648400991802699*^9, 3.6484010666779823`*^9}, {
  3.651523934337057*^9, 3.6515240057701426`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"d9ebd50d-697c-4f41-bc11-60ec0fe9b1ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BeadsCheck", "[", 
   RowBox[{"myRedAbsPos_", ",", "myGreenAbsPos_", ",", "dist_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw", ",", 
      "myRedCorrPos", ",", "distanceCorrected"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "myRedAbsPos4Calc", ",", "myGreenAbsPos4Calc", ",", "distanceRaw"}], 
       "}"}], "=", 
      RowBox[{"BeadsSorting", "[", 
       RowBox[{"myRedAbsPos", ",", "myGreenAbsPos", ",", "dist"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myRedCorrPos", "=", 
      RowBox[{"myTfFunc", "[", "myRedAbsPos4Calc", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"distanceCorrected", "=", 
      RowBox[{"EuclideanDistance", "@@@", 
       RowBox[{"Thread", "@", 
        RowBox[{"{", 
         RowBox[{"myGreenAbsPos4Calc", ",", "myRedCorrPos"}], "}"}]}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Insert", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"distanceRaw", ",", "distanceCorrected"}], "}"}], "//", 
         "Transpose"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Distance Before Correction\>\"", ",", 
          "\"\<Distance After Correction\>\""}], "}"}], ",", "1"}], "]"}], "//",
       "TableForm"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6484012753809195`*^9, 3.648401405682372*^9}, 
   3.6515236689298763`*^9, 3.6515237173296447`*^9, {3.651524011241455*^9, 
   3.6515240637694597`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"040952a7-0b02-4c3e-99dd-ac7019c63c2c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
FindOverlapDistance[track1,track2,\[Tau]] (measures average distance between \
two tracks when they overlap in time for at least time \[Tau], otherwise \
outputs -1)\
\>", "Subsection",
 CellChangeTimes->{{3.6792547892990313`*^9, 3.6792548292263145`*^9}, {
  3.6792560996119766`*^9, 3.6792561534200544`*^9}, {3.679256196156499*^9, 
  3.679256207268134*^9}},ExpressionUUID->"1f951c62-3bf4-4a2a-8a9b-\
9d0952291a60"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindOverlapDist", "[", 
   RowBox[{"track1_", ",", "track2_", ",", "\[Tau]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t1", ",", "t2", ",", "ol", ",", "avgpos1", ",", "avgpos2"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"makes", " ", "tracks", " ", "have", " ", 
       RowBox[{"form", ":", " ", "t1"}]}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"track", "#"}], ",", "time1", ",", "x1", ",", "y1"}], "}"}],
         ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"track", "#"}], ",", "time2", ",", "x2", ",", "y2"}], 
          "}"}], " ", "..."}]}], "}"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"t1", "=", 
      RowBox[{
       RowBox[{"track1", "//", "Flatten"}], "//", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{
            "track1", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}]}], "]"}], "&"}]}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"t2", "=", 
      RowBox[{
       RowBox[{"track2", "//", "Flatten"}], "//", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{
            "track2", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}]}]}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "The", " ", "following", " ", "just", " ", "sorts", " ", "by", " ", 
        "time", " ", "rather", " ", "than", " ", "track", " ", "#", " ", 
        "and", " ", 
        RowBox[{"splits", ".", " ", "If"}], " ", "the", " ", "two", " ", 
        "tracks", " ", "have", " ", "overlapping", " ", "time"}], ",", " ", 
       RowBox[{
       "then", " ", "the", " ", "split", " ", "will", " ", "contain", " ", 
        "2", " ", 
        RowBox[{"elements", ".", " ", "Thus"}]}], ",", " ", 
       RowBox[{
       "DeleteCases", " ", "eliminates", " ", "all", " ", "parts", " ", "of", 
        " ", "the", " ", "track", " ", "that", " ", "do", " ", "not", " ", 
        RowBox[{"overlap", ".", " ", "Finally"}]}], ",", " ", 
       RowBox[{
       "the", " ", "Transpose", " ", "command", " ", "gives", " ", "back", 
        " ", "a", " ", "list", " ", "of", " ", "overlapping", " ", "segments",
         " ", "of", " ", 
        RowBox[{"tracks", ":", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"segment", " ", "from", " ", "t1"}], ",", " ", 
            RowBox[{"segment", " ", "from", " ", "t2"}]}], "}"}], " ", "so", 
          " ", "the", " ", "mean", " ", "can", " ", "be", " ", "computed", 
          " ", "for", " ", 
          RowBox[{"each", "."}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t1", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"t1", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t2", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"t2", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ol", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t1", ",", "t2"}], "}"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "//", "Sort"}], "//", 
        RowBox[{
         RowBox[{"SplitBy", "[", 
          RowBox[{"#", ",", "First"}], "]"}], "&"}]}], "//", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{"#", ",", 
          RowBox[{"x_", "/;", 
           RowBox[{
            RowBox[{"Length", "[", "x", "]"}], "<", "2"}]}]}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "ol", "]"}], ">", "\[Tau]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"avgpos1", ",", "avgpos2"}], "}"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Mean", "/@", 
            RowBox[{"(", 
             RowBox[{"Transpose", "[", "ol", "]"}], ")"}]}], ")"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", 
           RowBox[{"3", ";;", "4"}]}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"EuclideanDistance", "[", 
         RowBox[{"avgpos1", ",", "avgpos2"}], "]"}]}], ",", 
       RowBox[{"-", "1"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6786456735071197`*^9, 3.67864569624042*^9}, {
   3.678649737790583*^9, 3.678649747421134*^9}, {3.678649849596978*^9, 
   3.6786498560923495`*^9}, 3.678649893780505*^9, {3.678651646039729*^9, 
   3.678651754831951*^9}, {3.6786518947939568`*^9, 3.678651906719639*^9}, {
   3.678654891133279*^9, 3.678655133120904*^9}, {3.678655265255536*^9, 
   3.678655271542347*^9}, {3.678655312398819*^9, 3.678655481487516*^9}, {
   3.6786590429146595`*^9, 3.678659058140286*^9}, 3.678659148324044*^9, {
   3.678659360531217*^9, 3.678659413025309*^9}, {3.6786594573761873`*^9, 
   3.6786595006038632`*^9}, {3.678661648900236*^9, 3.6786616602726564`*^9}, {
   3.6786617455580063`*^9, 3.678661846568184*^9}, {3.678908725814332*^9, 
   3.678908744530402*^9}, {3.6792561705500345`*^9, 3.679256182637726*^9}, {
   3.6950519040325556`*^9, 3.6950519333132305`*^9}, {3.695053212489395*^9, 
   3.6950532203608456`*^9}, {3.6950535043610897`*^9, 
   3.6950535108654613`*^9}, {3.695053543785344*^9, 3.695053560233285*^9}, {
   3.6950536245939665`*^9, 3.69505365595376*^9}, {3.695053690908759*^9, 
   3.6950536944499617`*^9}, {3.6950542281774893`*^9, 3.695054243346357*^9}, {
   3.6950542754901953`*^9, 3.695054390329764*^9}, {3.6950544941787033`*^9, 
   3.6950545192341366`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"54b810ff-269f-4f68-bd6e-658077341d25"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
ColorLinker[gbtrackpairs, greentracklist, blueflag] \[Rule] bluetracklist \
connected to greentracklist\
\>", "Subsection",
 CellChangeTimes->{{3.6806246269012165`*^9, 3.680624764997115*^9}, {
  3.6806247965259185`*^9, 
  3.680624857013378*^9}},ExpressionUUID->"d64a05af-02b7-4ca0-be3b-\
64d174d6ccac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"This", " ", "returns", " ", "all", " ", "green", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"or", " ", "blue"}], ",", " ", 
      RowBox[{
       RowBox[{"specified", " ", "by", " ", "colorN"}], " ", "=", " ", 
       RowBox[{
       "1", " ", "for", " ", "green", " ", "and", " ", "2", " ", "for", " ", 
        "blue"}]}]}], ")"}], " ", "elements", " ", "of", " ", "gbpairs", " ", 
    "whose", " ", "blue", " ", 
    RowBox[{"(", 
     RowBox[{"or", " ", "green"}], ")"}], " ", "element", " ", "is", " ", "a",
     " ", "member", " ", "of", " ", "colorList"}], "  ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ColorLinker", "[", 
    RowBox[{"pairs_", ",", "colorList_", ",", "colorN_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"pairs", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"colorList", ",", 
            RowBox[{"x", "\[LeftDoubleBracket]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"colorN", "\[Equal]", "1"}], ",", "2", ",", "1"}], 
              "]"}], "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}], 
       "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "colorN"}], "\[RightDoubleBracket]"}], "//", 
      "Union"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6805740062990694`*^9, 3.6805740406204433`*^9}, {
   3.6805741188562174`*^9, 3.6805741787253094`*^9}, {3.6805742783761835`*^9, 
   3.6805744551618032`*^9}, {3.680574568875996*^9, 3.6805745770167227`*^9}, {
   3.6805746087046037`*^9, 3.680574638548729*^9}, {3.6805746814887447`*^9, 
   3.680574736205081*^9}, {3.6805747827626133`*^9, 3.6805747852001743`*^9}, {
   3.6805752554891725`*^9, 3.6805752772550993`*^9}, {3.680575586323535*^9, 
   3.680575588370466*^9}, {3.6805756485840797`*^9, 3.6805756489434566`*^9}, {
   3.6805757700250216`*^9, 3.6805757790564346`*^9}, {3.680577674705389*^9, 
   3.6805778461890535`*^9}, {3.6805780041356936`*^9, 3.680578086949133*^9}, 
   3.680580011546554*^9, {3.680582146697378*^9, 3.680582190295504*^9}, {
   3.680582634441224*^9, 3.680582676237847*^9}, {3.680611589887657*^9, 
   3.680611591153296*^9}, {3.6806117919141035`*^9, 3.680611804492385*^9}, {
   3.6806144134000797`*^9, 3.6806144195720625`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"bc52e14a-58a0-4456-b4b1-ff6212fb5d0c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
CrossPairFinder[gbtrackpairs] \[Rule] list of green tracks gi connected to \
list of blue tracks bi : {{g1,b1}, {g2, b2}, ...}\
\>", "Subsection",
 CellChangeTimes->{{3.6805823863330293`*^9, 3.6805823912862163`*^9}, 
   3.680624601365756*^9, {3.68062478274113*^9, 3.6806247899335413`*^9}, {
   3.6806248648218246`*^9, 3.6806249434613223`*^9}, 3.6806252236703496`*^9, {
   3.715628406372265*^9, 
   3.715628413204655*^9}},ExpressionUUID->"873d5f51-8113-4d1e-b278-\
68dd833b7d8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CrossPairFinder", "[", "myGBpairs_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"b1", ",", "g1", ",", "seed", ",", 
      RowBox[{"myFlag", "=", "0"}], ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"seed", "=", 
         RowBox[{"{", 
          RowBox[{"myGBpairs", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "}"}]}], ";", 
        " ", 
        RowBox[{"(*", 
         RowBox[{
         "seed", " ", "with", " ", "ith", " ", "green", " ", "element", " ", 
          "from", " ", "pair", " ", "list"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"myFlag", "\[Equal]", "0"}], " ", ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"b1", "=", 
            RowBox[{
             RowBox[{"ColorLinker", "[", 
              RowBox[{"myGBpairs", ",", "seed", ",", "2"}], "]"}], "//", 
             "Union"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{
            "bluelist", " ", "b1", " ", "connected", " ", "to", " ", 
             "greenlist", " ", "seed"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"g1", "=", 
            RowBox[{
             RowBox[{"ColorLinker", "[", 
              RowBox[{"myGBpairs", ",", "b1", ",", "1"}], "]"}], "//", 
             "Union"}]}], ";", " ", 
           RowBox[{"(*", 
            RowBox[{
            "greenlist", " ", "g1", " ", "connected", " ", "to", " ", 
             "bluelist", " ", "b1"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"g1", "\[Equal]", "seed"}], ",", 
             RowBox[{"myFlag", "=", "1"}], ",", " ", 
             RowBox[{"seed", "=", "g1"}]}], "]"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{
            "exit", " ", "if", " ", "greenlist", " ", "g1", " ", "is", " ", 
             "the", " ", "same", " ", "as", " ", "seed"}], ";", " ", 
            RowBox[{"if", " ", "not"}]}], ",", " ", 
           RowBox[{"g1", " ", "becomes", " ", "new", " ", "seed"}]}], "*)"}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"myFlag", "=", "0"}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "repeat", " ", "loop", " ", "for", " ", "all", " ", "possible", " ", 
          "green", " ", "seeds"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"g1", ",", "b1"}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "myGBpairs", "]"}], ",", "1"}], "}"}]}], 
      "]"}], "//", "Union"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6805804083588796`*^9, 3.680580496547429*^9}, {
   3.6805806479556093`*^9, 3.6805806957530966`*^9}, {3.6805808476007257`*^9, 
   3.680580847819522*^9}, {3.680580927929554*^9, 3.6805809299138975`*^9}, {
   3.6805822183190556`*^9, 3.6805823167853155`*^9}, {3.680582445147624*^9, 
   3.680582489650468*^9}, 3.6805825196701097`*^9, {3.6805826935160985`*^9, 
   3.6805827655538387`*^9}, {3.68061140063095*^9, 3.680611502910879*^9}, {
   3.6806115504808807`*^9, 3.680611563652952*^9}, {3.680611606508988*^9, 
   3.68061164941532*^9}, {3.680611719298317*^9, 3.680611763017613*^9}, {
   3.6806118326217384`*^9, 3.680611837434298*^9}, {3.6806118732598915`*^9, 
   3.6806119010954266`*^9}, {3.680612028677389*^9, 3.6806120313336725`*^9}, {
   3.680612125630992*^9, 3.6806121606332965`*^9}, {3.680612400194989*^9, 
   3.680612531452464*^9}, {3.680612562975997*^9, 3.680612651693954*^9}, {
   3.680612698670108*^9, 3.680612704732683*^9}, {3.680612737749642*^9, 
   3.6806127839376864`*^9}, {3.6806128376774015`*^9, 3.68061283875551*^9}, {
   3.6806129034791393`*^9, 3.680612931182576*^9}, {3.680612991955402*^9, 
   3.6806130150338707`*^9}, {3.680613258192689*^9, 3.680613259848961*^9}, {
   3.680613998596075*^9, 3.680614023940117*^9}, {3.680614216257804*^9, 
   3.6806142169140077`*^9}, {3.6806144254002414`*^9, 
   3.6806144270565624`*^9}, {3.680623480818158*^9, 3.6806235013184032`*^9}, 
   3.680624604283923*^9},
 CellLabel->"In[41]:=",ExpressionUUID->"691d7d1d-e859-4ddb-8b7f-8a35a07af45b"]
}, Closed]],

Cell[CellGroupData[{

Cell["ConnectByColor", "Subsection",
 CellChangeTimes->{{3.68184476959031*^9, 3.681844775966675*^9}, {
  3.681844807942504*^9, 3.681844812318754*^9}, {3.6818451029743786`*^9, 
  3.68184510719862*^9}, {3.681848738193301*^9, 
  3.681848741585495*^9}},ExpressionUUID->"603c25a0-0ed6-4734-a846-\
12ab606ec971"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Connect2Colors", "[", 
   RowBox[{
   "track1_", ",", "track2_", ",", "minOverlapTime_", ",", 
    "maxOverlapDistance_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "idxTrack1", ",", "idxTrack2", ",", "myAllLink", ",", "tempTrack1", ",", 
      "tempTrack2", ",", "myLinkList", ",", "newTrack1", ",", "newTrack2", 
      ",", "myMergedTrack", ",", "bigTrack1", ",", "bigTrack2"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", 
     RowBox[{
     "Getting", " ", "color", " ", "index", " ", "assuming", " ", "the", " ", 
      "tracks", " ", "have", " ", "never", " ", "been", " ", "connected", " ",
       "with", " ", "any", " ", "other", " ", "colors"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"idxTrack1", "=", 
      RowBox[{"track1", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"idxTrack2", "=", 
      RowBox[{"track2", "\[LeftDoubleBracket]", 
       RowBox[{"1", ",", "1", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"Creating", " ", "linking", " ", "pair", " ", "list"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"myAllLink", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempTrack1", "=", 
          RowBox[{
          "track1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"tempTrack2", "=", 
          RowBox[{
          "track2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"FindOverlapDist", "[", 
          RowBox[{"tempTrack1", ",", "tempTrack2", ",", "minOverlapTime"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "track1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "@", "track2"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myLinkList", "=", 
      RowBox[{"CrossPairFinder", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"myAllLink", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"0", "\[LessEqual]", "x", "<", "maxOverlapDistance"}]}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"Preparing", " ", "output", " ", "track"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"newTrack1", "=", "track1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTrack2", "=", "track2"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"Connecting", " ", "tracks"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"myMergedTrack", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"track1", "\[LeftDoubleBracket]", 
               RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"track2", "\[LeftDoubleBracket]", 
               RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}]}], "}"}], "//", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&"}]}], 
             "]"}], "&"}]}], "//", 
          RowBox[{
           RowBox[{"SplitBy", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"#", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&"}]}], 
            "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"bigTrack1", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "2"}], ",", " ", 
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"x_", "/;", 
                 RowBox[{
                  RowBox[{
                  "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                   "\[Equal]", "idxTrack1"}]}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
                " ", "#", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "]"}], "&"}], "/@", 
           "myMergedTrack"}], ")"}]}], ";", "  ", 
        RowBox[{"(*", 
         RowBox[{
         "Note", " ", "that", " ", "this", " ", "automatically", " ", 
          "deletes", " ", "times", " ", "where", " ", "three", " ", "or", " ",
           "more", " ", "points", " ", "appears", " ", "at", " ", "once"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"bigTrack1", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"bigTrack1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{"Length", "@", "x"}], ">", "1"}]}]}], "]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "Note", " ", "that", " ", "this", " ", "automatically", " ", 
          "deletes", " ", "times", " ", "where", " ", "there", " ", "is", " ",
           "overlap", " ", "in", " ", "multiple", " ", "tracks", " ", "in", 
          " ", "track1"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
         " ", 
        RowBox[{"(*", 
         RowBox[{
         "Choose", " ", "to", " ", "label", " ", "big", " ", "track", " ", 
          "as", " ", "lowest", " ", 
          RowBox[{"#", "'"}], "d", " ", "track1"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"idxTrack1", "+", "idxTrack2"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{
         "Change", " ", "color", " ", "index", " ", "to", " ", "two", " ", 
          "colors", " ", "from", " ", "one", " ", "color"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}], "=", "bigTrack1"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ">", "1"}],
           ",", 
          RowBox[{
           RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "lowest", " ", "#", " ", "track1", " ", "that", " ", "should", " ", 
           "be", " ", "linked", " ", "is", " ", "replaced", " ", "with", " ", 
           "bigTrack1"}], ";", " ", 
          RowBox[{"others", " ", "become", " ", 
           RowBox[{"{", "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"bigTrack2", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "2"}], ",", " ", 
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"x_", "/;", 
                 RowBox[{
                  RowBox[{
                  "x", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
                   "\[Equal]", "idxTrack2"}]}]}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
                " ", "#", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "]"}], "&"}], "/@", 
           "myMergedTrack"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bigTrack2", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"bigTrack2", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{"Length", "@", "x"}], ">", "1"}]}]}], "]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack2", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack2", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"idxTrack1", "+", "idxTrack2"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newTrack2", "\[LeftDoubleBracket]", 
          RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}], "=", "bigTrack2"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ">", "1"}],
           ",", 
          RowBox[{
           RowBox[{"newTrack2", "\[LeftDoubleBracket]", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2", ",", 
              RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{"{", "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "myLinkList"}], ",", "1"}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"newTrack1", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newTrack1", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", 
      RowBox[{"Now", " ", "get", " ", "rid", " ", "of", " ", "the", " ", 
       RowBox[{"{", "}"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTrack1"}]}]}], ";", 
     RowBox[{"(*", "renumber", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"newTrack2", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newTrack2", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTrack2", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTrack2"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newTrack1", ",", "newTrack2"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6818477833286858`*^9, 3.6818479300650787`*^9}, 
   3.681847962152914*^9, {3.6818480224173613`*^9, 3.681848083193837*^9}, {
   3.681848114416623*^9, 3.6818481247852163`*^9}, {3.6818487447936783`*^9, 
   3.6818487458577394`*^9}, {3.6818533936295767`*^9, 3.681853409781501*^9}, {
   3.682708447520831*^9, 3.6827084621686687`*^9}, {3.6827085690727835`*^9, 
   3.6827086288092003`*^9}, {3.6827087069206676`*^9, 3.68270872880892*^9}, {
   3.682766907607557*^9, 3.6827669156630173`*^9}, {3.68276707498313*^9, 
   3.6827671445201073`*^9}, {3.682768646177997*^9, 3.6827686940657363`*^9}, {
   3.6827687722172065`*^9, 3.682768776041425*^9}, {3.6827688265133123`*^9, 
   3.6827688825615177`*^9}, {3.6827689192496157`*^9, 3.682768923001831*^9}, {
   3.682769039177476*^9, 3.6827691459455824`*^9}, {3.682770721506699*^9, 
   3.682770737554617*^9}, {3.682860302066414*^9, 3.6828603066736774`*^9}, {
   3.6828603498911495`*^9, 3.682860543546226*^9}, {3.6828605761940937`*^9, 
   3.6828605966112614`*^9}, {3.682861188652124*^9, 3.6828612173707666`*^9}, {
   3.6828614396034775`*^9, 3.6828617892354755`*^9}, {3.682861825644558*^9, 
   3.6828618869800663`*^9}, 3.682862876700675*^9, {3.682863100068451*^9, 
   3.6828631120611367`*^9}, 3.6828635003333445`*^9, {3.6828721540043063`*^9, 
   3.6828721618757563`*^9}, {3.682885069295019*^9, 3.68288507107012*^9}, {
   3.6832990650866437`*^9, 3.6832990971674786`*^9}, {3.6832991433351192`*^9, 
   3.6832991439671555`*^9}, {3.6832995779349775`*^9, 
   3.6832996392954865`*^9}, {3.6832996727033978`*^9, 3.683299686272174*^9}, {
   3.683299717889982*^9, 3.6832997212561746`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"e179f637-930a-4dfc-a933-3926d8531b1c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Connect2ColorsFor3", "[", 
   RowBox[{
   "track1_", ",", "track2_", ",", "minOverlapTime_", ",", 
    "maxOverlapDistance_", ",", "track1Color_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "idxTrack1", ",", "idxTrack2", ",", "myAllLink", ",", "tempTrack1", ",", 
      "tempTrack2", ",", "myLinkList", ",", "newTrack1", ",", "newTrack2", 
      ",", "myMergedTrack", ",", "bigTrack1", ",", "bigTrack2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myAllLink", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"tempTrack1", "=", 
          RowBox[{
          "track1", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"tempTrack2", "=", 
          RowBox[{
          "track2", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"FindOverlapDist", "[", 
          RowBox[{"tempTrack1", ",", "tempTrack2", ",", "minOverlapTime"}], 
          "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "track1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "@", "track2"}], ",", "1"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"myLinkList", "=", 
      RowBox[{"CrossPairFinder", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"myAllLink", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"0", "\[LessEqual]", "x", "<", "maxOverlapDistance"}]}]}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTrack1", "=", "track1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"myMergedTrack", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"track1", "\[LeftDoubleBracket]", 
               RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"track2", "\[LeftDoubleBracket]", 
               RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], 
               "\[RightDoubleBracket]"}]}], "}"}], "//", 
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"#", ",", "2"}], "]"}], "&"}]}], "//", 
           RowBox[{
            RowBox[{"SortBy", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"#", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&"}]}], 
             "]"}], "&"}]}], "//", 
          RowBox[{
           RowBox[{"SplitBy", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"#", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "&"}]}], 
            "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bigTrack1", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "2"}], ",", " ", 
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{"x_", "/;", 
                 RowBox[{
                  RowBox[{"x", "\[LeftDoubleBracket]", 
                   RowBox[{"3", ",", "track1Color"}], 
                   "\[RightDoubleBracket]"}], "\[Equal]", "1"}]}]}], "]"}], 
              ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], ",", 
                " ", "#", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], "]"}], "&"}], "/@", 
           "myMergedTrack"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bigTrack1", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"bigTrack1", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{
              RowBox[{"Length", "@", "x"}], ">", "1"}]}]}], "]"}], "//", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";",
         " ", "\[IndentingNewLine]", 
        RowBox[{"idxTrack1", "=", 
         RowBox[{"Total", "@", 
          RowBox[{"track1", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", "1", 
            ",", "3"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"idxTrack2", "=", 
         RowBox[{"Total", "@", 
          RowBox[{"track2", "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", "1", 
            ",", "3"}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"bigTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "3"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"idxTrack1", "+", "idxTrack2"}], ")"}], "/.", 
          RowBox[{
           RowBox[{"x_", "/;", 
            RowBox[{"x", ">", "0"}]}], "\[Rule]", "1"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
          RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}], "=", "bigTrack1"}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ">", "1"}],
           ",", 
          RowBox[{
           RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}], 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{"{", "}"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "myLinkList"}], ",", "1"}], "}"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"newTrack1", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"newTrack1", ",", 
        RowBox[{"{", "}"}]}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTrack1", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTrack1"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTrack2", "=", 
      RowBox[{"Delete", "[", 
       RowBox[{"track2", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", "#", "}"}], "&"}], "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"myLinkList", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "//", 
            "Flatten"}], "//", "Sort"}], ")"}]}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTrack2", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTrack2"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newTrack1", ",", "newTrack2"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6833889497817545`*^9, 3.683389048590406*^9}, {
  3.6833892503099437`*^9, 3.6833892517180243`*^9}, {3.695053735866331*^9, 
  3.695053742513711*^9}, {3.69505533034753*^9, 3.695055330827557*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"5c288b64-6f54-479c-b0d0-e6d29650f930"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Connect3Colors", "[", 
   RowBox[{
   "trackr_", ",", "trackg_", ",", "trackb_", ",", "minOverlapTime_", ",", 
    "maxOverlapDistance_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "trackgb", ",", "trackbAlone", ",", "trackrgb", ",", "newTrackr", ",", 
      "trackbr", ",", "trackrAlone1", ",", "trackgbr", ",", "newTrackg", ",", 
      "trackgr", ",", "trackrAlone2", ",", "trackbgr", ",", "newTrackb", ",", 
      "dum"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackgb", ",", "trackbAlone"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackg", ",", "trackb", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackrgb", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackr", ",", "trackgb", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newTrackr", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackrgb", ",", "trackbAlone", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackbr", ",", "trackrAlone1"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackb", ",", "trackr", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackgbr", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackg", ",", "trackbr", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newTrackg", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackgbr", ",", "trackrAlone1", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackgr", ",", "trackrAlone2"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackg", ",", "trackr", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"trackbgr", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackb", ",", "trackgr", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newTrackb", ",", "dum"}], "}"}], "=", 
      RowBox[{"Connect2ColorsFor3", "[", 
       RowBox[{
       "trackbgr", ",", "trackrAlone2", ",", "minOverlapTime", ",", 
        "maxOverlapDistance", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"newTrackr", ",", "newTrackg", ",", "newTrackb"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6833890896927567`*^9, 3.6833892422454824`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"1ef56b29-7824-4b9e-a249-fe0dda430dc0"]
}, Closed]],

Cell[CellGroupData[{

Cell["ConnectTracks[tracks_,listConnectTracks, (renumberQ)]", "Subsection",
 CellChangeTimes->{{3.67925864456554*^9, 3.6792586589813643`*^9}, {
  3.679260491399173*^9, 
  3.6792605037188773`*^9}},ExpressionUUID->"0561d3d1-9341-4bd1-9ba8-\
231ce873d04b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConnectTracks", "[", 
   RowBox[{"tracksList_", ",", "listConnectTracks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "newTracksList", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newTracksList", "=", "tracksList"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", "All", ",", 
        "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"tracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{
        "listConnectTracks", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", "1", ",", "1"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTracksList", "=", 
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{"Sort", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"newTracksList", ",", "1"}], "]"}]}], ",", "First"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTracksList"}]}]}], ";", 
     "\[IndentingNewLine]", "newTracksList"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.679260438412142*^9, 3.679260486195875*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"21335729-9ca3-4c02-af3e-2789bc6211af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConnectTracks", "[", 
   RowBox[{"tracksList_", ",", "listConnectTracks_", ",", "renumberQ_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "newTracksList", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newTracksList", "=", "tracksList"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", "All", ",", 
        "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"tracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{
        "listConnectTracks", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", "1", ",", "1"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"renumberQ", ",", 
       RowBox[{
        RowBox[{"newTracksList", "=", 
         RowBox[{"SplitBy", "[", 
          RowBox[{
           RowBox[{"Sort", "@", 
            RowBox[{"Flatten", "[", 
             RowBox[{"newTracksList", ",", "1"}], "]"}]}], ",", "First"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"Range", "@", 
          RowBox[{"Length", "@", "newTracksList"}]}]}]}], ",", 
       "newTracksList"}], "]"}], ";", "\[IndentingNewLine]", 
     "newTracksList"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.679260438412142*^9, 3.679260467243791*^9}, {
  3.6792605093571997`*^9, 3.67926051250838*^9}, {3.679260779604657*^9, 
  3.6792608012368946`*^9}, {3.679260951305478*^9, 3.6792609531485834`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"d0db0273-57ac-44fb-bf1c-a5e037e7c25b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConnectTracksFilled", "[", 
   RowBox[{"tracksList_", ",", "listConnectTracks_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newTracksList", ",", "spotEnd", ",", "spotStart", ",", "missingNum", 
      ",", "fillingNum", ",", "fillingPos", ",", "fillingSpots"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newTracksList", "=", "tracksList"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"spotEnd", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Last", "@", 
            RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
             RowBox[{
             "listConnectTracks", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], ")"}], 
          "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"spotStart", "=", 
         RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
            RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}], ",", "1", ",",
            "2"}], "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"missingNum", "=", 
         RowBox[{
          RowBox[{
          "spotStart", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "-", 
          RowBox[{
          "spotEnd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "-", "1"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"missingNum", ">", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fillingNum", "=", 
            RowBox[{"Range", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "spotEnd", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "+", "1"}], ",", 
              RowBox[{
               RowBox[{
               "spotStart", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "-", "1"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"fillingPos", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Plus", "[", 
               RowBox[{"#", ",", 
                RowBox[{"spotEnd", "\[LeftDoubleBracket]", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}]}],
                "]"}], "&"}], "/@", 
             RowBox[{"Outer", "[", 
              RowBox[{"Times", ",", 
               RowBox[{
                RowBox[{"Range", "@", "missingNum"}], "/", 
                RowBox[{"(", 
                 RowBox[{"missingNum", "+", "1"}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"spotStart", "\[LeftDoubleBracket]", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}], 
                "-", 
                RowBox[{"spotEnd", "\[LeftDoubleBracket]", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}], 
                 "\[RightDoubleBracket]"}]}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"fillingSpots", "=", 
            RowBox[{"ConstantArray", "[", 
             RowBox[{
              RowBox[{"Last", "@", 
               RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
                RowBox[{
                "listConnectTracks", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], ",", 
              "missingNum"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"fillingSpots", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Thread", "@", 
               RowBox[{"{", 
                RowBox[{"fillingNum", ",", "fillingPos"}], "}"}]}], "//", 
              "Flatten"}], "//", 
             RowBox[{
              RowBox[{"Partition", "[", 
               RowBox[{"#", ",", "3"}], "]"}], "&"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
             RowBox[{
             "listConnectTracks", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{"PadRight", "[", 
             RowBox[{
              RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
               RowBox[{
               "listConnectTracks", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
                 RowBox[{
                 "listConnectTracks", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], "+",
                "missingNum"}], ",", "fillingSpots"}], "]"}]}]}]}], "]"}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{
          RowBox[{"Length", "@", "listConnectTracks"}], "-", "1"}], ",", 
         "1"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{"listConnectTracks", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", "All", ",", 
        "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"tracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{
        "listConnectTracks", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], ",", "1", ",", "1"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"newTracksList", "=", 
      RowBox[{"SplitBy", "[", 
       RowBox[{
        RowBox[{"Sort", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{"newTracksList", ",", "1"}], "]"}]}], ",", "First"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newTracksList", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"Range", "@", 
       RowBox[{"Length", "@", "newTracksList"}]}]}], ";", 
     "\[IndentingNewLine]", "newTracksList"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6818437818788157`*^9, 3.681843790654318*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"7b34700f-17c0-4dc6-b161-bb484a8f69d5"]
}, Closed]],

Cell[CellGroupData[{

Cell["TrackFiller", "Subsection",
 CellChangeTimes->{{3.681819224690225*^9, 
  3.68181922983352*^9}},ExpressionUUID->"eced1eb2-4a00-411a-8d3f-\
ef52922f98d0"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "This", " ", "module", " ", "fills", " ", "any", " ", "gaps", " ", "in", 
   " ", "tracks", " ", "by", " ", "interpolating", " ", "the", " ", 
   "position", " ", "from", " ", "the", " ", "last", " ", "postion", " ", 
   "before", " ", "the", " ", "gap", " ", "and", " ", "the", " ", "first", 
   " ", "position", " ", "after", " ", "the", " ", "gap"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.681839614018428*^9, 3.681839638313818*^9}, {
  3.681839694090008*^9, 3.681839739850625*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"5eb3a08a-fc5f-4bac-8dc1-1192c8ee332e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TrackFiller", "[", "tracksList_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "filledTracksList", ",", "myIdx", ",", "missingStart", ",", "missingNum",
       ",", "missingStartShifted", ",", "spotEnd", ",", "spotStart", ",", 
      "fillingNum", ",", "fillingPos", ",", "fillingSpots", ","}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"filledTracksList", "=", "tracksList"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"myIdx", "=", 
         RowBox[{
          RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", 
            RowBox[{"2", ";;"}], ",", "2", ",", "1"}], 
           "\[RightDoubleBracket]"}], "-", 
          RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", 
            RowBox[{";;", 
             RowBox[{
              RowBox[{"Length", "@", 
               RowBox[{
               "filledTracksList", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "-", "1"}]}], ",", "2", ",", 
            "1"}], "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"missingStart", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"myIdx", ",", 
             RowBox[{"x_", "/;", 
              RowBox[{"x", ">", "1"}]}]}], "]"}], "+", "1"}], "//", 
          "Flatten"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"missingNum", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"myIdx", ",", 
            RowBox[{"x_", "/;", 
             RowBox[{"x", ">", "1"}]}]}], "]"}], "-", "1"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"missingStart", "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"missingStartShifted", "=", "missingStart"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"missingStartShifted", "\[LeftDoubleBracket]", 
             RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{
             RowBox[{"missingStart", "\[LeftDoubleBracket]", 
              RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"FoldList", "[", 
                RowBox[{"Plus", ",", "missingNum"}], "]"}], ")"}], 
              "\[LeftDoubleBracket]", 
              RowBox[{";;", 
               RowBox[{
                RowBox[{"Length", "@", "missingNum"}], "-", "1"}]}], 
              "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"spotEnd", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{
                    "missingStartShifted", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], 
                  "\[RightDoubleBracket]"}], ")"}], "\[LeftDoubleBracket]", 
                "2", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"spotStart", "=", 
               RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", 
                 RowBox[{
                 "missingStartShifted", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], ",", "2"}], 
                "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"fillingNum", "=", 
               RowBox[{"Range", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "spotEnd", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "+", "1"}], ",", 
                 RowBox[{
                  RowBox[{
                  "spotStart", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "-", "1"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fillingPos", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Plus", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"spotEnd", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], 
                    "\[RightDoubleBracket]"}]}], "]"}], "&"}], "/@", 
                RowBox[{"Outer", "[", 
                 RowBox[{"Times", ",", 
                  RowBox[{
                   RowBox[{"Range", "@", 
                    RowBox[{
                    "missingNum", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "/", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "missingNum", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "+", "1"}], ")"}]}], ",", 
                  RowBox[{
                   RowBox[{"spotStart", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], "\[RightDoubleBracket]"}],
                    "-", 
                   RowBox[{"spotEnd", "\[LeftDoubleBracket]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "3"}], "}"}], 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"fillingSpots", "=", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"filledTracksList", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", 
                   RowBox[{
                    RowBox[{
                    "missingStartShifted", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "-", "1"}]}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "missingNum", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"fillingSpots", "\[LeftDoubleBracket]", 
                RowBox[{"All", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"Thread", "@", 
                  RowBox[{"{", 
                   RowBox[{"fillingNum", ",", "fillingPos"}], "}"}]}], "//", 
                 "Flatten"}], "//", 
                RowBox[{
                 RowBox[{"Partition", "[", 
                  RowBox[{"#", ",", "3"}], "]"}], "&"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "filledTracksList", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "=", 
                 RowBox[{"Insert", "[", 
                  RowBox[{
                   RowBox[{
                   "filledTracksList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "fillingSpots", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                    RowBox[{
                    "missingStartShifted", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "+", "k", "-", "1"}]}], 
                  "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", "1", ",", 
                  RowBox[{
                  "missingNum", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], ",", "1"}], "}"}]}], "]"}], 
              ";"}], "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "@", "missingStart"}], ",", "1"}], "}"}]}], 
            "]"}], ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "filledTracksList"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "filledTracksList"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.681819232566676*^9, 3.681819281457472*^9}, {
  3.681836758312091*^9, 3.681836906328557*^9}, {3.681836938336388*^9, 
  3.681836980535802*^9}, {3.681837014016717*^9, 3.681837143512123*^9}, {
  3.6818371739048615`*^9, 3.6818373862010045`*^9}, {3.6818390382424955`*^9, 
  3.68183903989859*^9}, {3.681839128498658*^9, 3.6818391529510565`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"234ec91a-b7f8-43cb-8dbf-054f9e5c8e7a"]
}, Closed]],

Cell[CellGroupData[{

Cell["FindConnectableTracks", "Subsection",
 CellChangeTimes->{{3.679313898838685*^9, 
  3.6793139041269875`*^9}},ExpressionUUID->"1edbe8ff-b774-4be2-be35-\
d8bdd5e58989"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindConnectableTracks2", "[", 
   RowBox[{
   "tracksList_", ",", "myMaxN_", ",", "dist_", ",", "time_", ",", 
    "trackNumber_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "allTracksStart", ",", "timeEnd", ",", "posiEnd", ",", "afterTracks", 
      ",", "listConnectTracks", ",", "tempConnectTracks", ",", 
      "tempConnectTracks2", ",", "tempConnectTracks3", ",", 
      "posiConnectTracks", ",", "tempTrack", ",", "tempFrame"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"allTracksStart", "=", 
      RowBox[{"tracksList", "\[LeftDoubleBracket]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"trackNumber", "+", "1"}], ")"}], ";;"}], ",", "1"}], 
       "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"timeEnd", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Last", "@", 
         RowBox[{
         "tracksList", "\[LeftDoubleBracket]", "trackNumber", 
          "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"posiEnd", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Last", "@", 
         RowBox[{
         "tracksList", "\[LeftDoubleBracket]", "trackNumber", 
          "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
       RowBox[{"2", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"afterTracks", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"allTracksStart", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{
          RowBox[{"timeEnd", "<", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], 
           "\[LessEqual]", 
           RowBox[{"timeEnd", "+", "time"}]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
            "posiEnd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "-", "dist"}], "<", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], "<", 
           RowBox[{
            RowBox[{
            "posiEnd", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "+", "dist"}]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
            "posiEnd", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
             "-", "dist"}], "<", 
           RowBox[{"x", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "3"}], "\[RightDoubleBracket]"}], "<", 
           RowBox[{
            RowBox[{
            "posiEnd", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
             "+", "dist"}]}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listConnectTracks", "=", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", 
        RowBox[{"trackNumber", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"afterTracks", "\[NotEqual]", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"afterTracks", "\[LeftDoubleBracket]", 
            RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"{", "}"}]}], "]"}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tempConnectTracks", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
        "tracksList", "\[LeftDoubleBracket]", "listConnectTracks", 
         "\[RightDoubleBracket]"}], "//", "Flatten"}], "//", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Length", "@", 
           RowBox[{"Flatten", "@", 
            RowBox[{"tracksList", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}]}], "]"}], 
        "&"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tempConnectTracks", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}]}], "\[RightDoubleBracket]"}], "=", 
      RowBox[{"tempConnectTracks", "\[LeftDoubleBracket]", 
       RowBox[{"All", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}]}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tempConnectTracks2", "=", 
      RowBox[{
       RowBox[{"tempConnectTracks", "//", "Sort"}], "//", 
       RowBox[{
        RowBox[{"SplitBy", "[", 
         RowBox[{"#", ",", "First"}], "]"}], "&"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tempConnectTracks3", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"tempConnectTracks2", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"tempConnectTracks2", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", 
           RowBox[{"2", ";;"}]}], "\[RightDoubleBracket]"}]}], "}"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"posiConnectTracks", "=", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "@", "myMaxN"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
           "myMaxN"}], "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"tempFrame", "=", 
         RowBox[{"tempConnectTracks3", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{
         RowBox[{"posiConnectTracks", "\[LeftDoubleBracket]", 
          RowBox[{"tempFrame", ",", "2"}], "\[RightDoubleBracket]"}], "=", 
         RowBox[{"tempConnectTracks3", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ";"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "tempConnectTracks3"}], ",", "1"}], "}"}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"listConnectTracks", ",", "posiConnectTracks"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6787314149002867`*^9, 3.678731473628646*^9}, {
   3.678731527835746*^9, 3.678731651943845*^9}, {3.67873192075622*^9, 
   3.678731925884513*^9}, {3.6787323688368483`*^9, 3.678732492620929*^9}, {
   3.6787335929338627`*^9, 3.678733599774254*^9}, {3.6787336336611924`*^9, 
   3.6787336361663356`*^9}, 3.6790900466130695`*^9, {3.679090105420433*^9, 
   3.6790901372212524`*^9}, {3.67909033683667*^9, 3.6790904911094933`*^9}, {
   3.6791367729136615`*^9, 3.67913678355427*^9}, {3.6791370766180325`*^9, 
   3.6791371439218817`*^9}, {3.6791371846022086`*^9, 
   3.6791372102186737`*^9}, {3.6791372727062483`*^9, 3.679137333898748*^9}, {
   3.679137417098507*^9, 3.6791374283151484`*^9}, {3.6791501942853203`*^9, 
   3.6791502799182177`*^9}, {3.679152732282485*^9, 3.6791527339295793`*^9}, {
   3.6792419937019463`*^9, 3.679242050430191*^9}, {3.679250900469384*^9, 
   3.679250901061418*^9}, {3.679258064987171*^9, 3.6792580677713304`*^9}, {
   3.6792585280766582`*^9, 3.6792585508039584`*^9}, {3.6792616162782936`*^9, 
   3.6792616315821686`*^9}, {3.6792620662780323`*^9, 3.679262089254346*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"8d74d7e6-aceb-42e6-b4bf-7fa09cb513dd"]
}, Closed]],

Cell[CellGroupData[{

Cell["NearestNeighborLinking", "Subsection",
 CellChangeTimes->{{3.713636244958868*^9, 
  3.713636252095276*^9}},ExpressionUUID->"8a082051-d2c7-4845-90e8-\
2b24805ccc51"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Using", " ", "a", " ", "globally", " ", "determined", " ", 
    RowBox[{"(", "automatic", ")"}], " ", "threshod", " ", "for", " ", 
    "binarization"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NearestNeighborLinking1", "[", 
    RowBox[{
    "img_", ",", "channel_", ",", "startFrame_", ",", "startPosition_", ",", 
     "pad_", ",", "bandpass_", ",", "dotsize_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newPos", ",", "myTrack", ",", "myTrimImg", ",", "tempOrigin", ",", 
       "myNewTempCenterList", ",", "tempCenter", ",", "flagFin", ",", 
       "euList"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newPos", "=", "startPosition"}], ";", "\[IndentingNewLine]", 
      RowBox[{"myTrack", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"myTrimImg", "=", 
           RowBox[{"ImageTrim", "[", 
            RowBox[{
             RowBox[{"img", "\[LeftDoubleBracket]", 
              RowBox[{"channel", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Ceiling", "@", "newPos"}], "-", "pad"}], ",", 
               RowBox[{
                RowBox[{"Ceiling", "@", "newPos"}], "+", "pad", "-", 
                "0.1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tempOrigin", "=", 
           RowBox[{
            RowBox[{"Ceiling", "@", "newPos"}], "-", "pad", "-", "1"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"myNewTempCenterList", "=", 
           RowBox[{"ComponentMeasurements", "[", 
            RowBox[{
             RowBox[{"ImageMultiply", "[", 
              RowBox[{"myTrimImg", ",", 
               RowBox[{"SelectComponents", "[", 
                RowBox[{
                 RowBox[{"Binarize", "[", 
                  RowBox[{"BandPass", "[", 
                   RowBox[{
                    RowBox[{"ImageAdjust", "@", "myTrimImg"}], ",", 
                    "bandpass"}], "]"}], "]"}], ",", "\"\<Count\>\"", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "dotsize", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "<", "#", "<", 
                   RowBox[{
                   "dotsize", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "&"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<IntensityCentroid\>\"", ",", "\"\<Centroid\>\"", ",", 
               "\"\<Area\>\"", ",", "\"\<TotalIntensity\>\"", ",", 
               "\"\<MeanIntensity\>\"", ",", "\"\<MedianIntensity\>\"", ",", 
               "\"\<Elongation\>\"", ",", "\"\<MaxCentroidDistance\>\"", ",", 
               "\"\<BoundingBox\>\"", ",", "\"\<ConvexVertices\>\""}], 
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "myNewTempCenterList"}], "\[Equal]", 
             "1"}], ",", 
            RowBox[{
             RowBox[{"myNewTempCenterList", "=", 
              RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
             RowBox[{"tempCenter", "=", 
              RowBox[{
              "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "myNewTempCenterList"}], "\[Equal]", 
               "0"}], ",", 
              RowBox[{"myNewTempCenterList", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "tempOrigin"}], "*", "1.0"}], ",", "0", ",", 
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                 "0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"myNewTempCenterList", "=", 
                RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"euList", "=", 
                    RowBox[{
                    RowBox[{"N", "@", "Total"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pad", ",", "pad"}], "}"}], "+", "0.5", "-", 
                    "#"}], ")"}], "^", "2"}], "&"}], "/@", 
                    RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], ",", 
                    RowBox[{"Min", "@", "euList"}]}], "]"}]}], ")"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
               RowBox[{"tempCenter", "=", 
                RowBox[{
                "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newPos", "=", 
           RowBox[{"tempOrigin", "+", "tempCenter"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "+=", "tempOrigin"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "9", 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", "tempOrigin"}], "&"}], "/@", 
            RowBox[{
            "myNewTempCenterList", "\[LeftDoubleBracket]", "9", 
             "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "10", 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", "tempOrigin"}], "&"}], "/@", 
            RowBox[{
            "myNewTempCenterList", "\[LeftDoubleBracket]", "10", 
             "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
          "myNewTempCenterList"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "startFrame", ",", 
           RowBox[{"Length", "@", 
            RowBox[{
            "img", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", "1"}], "}"}]}], "]"}]}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7136232245561433`*^9, 3.7136232269002776`*^9}, {
   3.7136232829164815`*^9, 3.7136233141482677`*^9}, {3.71362348569308*^9, 
   3.7136235304126377`*^9}, {3.7136235713409786`*^9, 
   3.7136236995503116`*^9}, {3.713623731533141*^9, 3.71362378763735*^9}, {
   3.7136238545101748`*^9, 3.713623869126011*^9}, {3.713626004392141*^9, 
   3.713626012959631*^9}, {3.7136331241973705`*^9, 3.7136331300937076`*^9}, 
   3.7168389349994345`*^9, {3.7168389704584627`*^9, 3.7168389918586864`*^9}, {
   3.7168391921041403`*^9, 3.7168392837123795`*^9}, {3.7168969767182307`*^9, 
   3.716896976846238*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"e6f1600d-e7f3-412c-9509-14f7c34d2aaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Using", " ", "user", " ", "defined", " ", "threshod", " ", "for", " ", 
    "binarization"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NearestNeighborLinking2", "[", 
    RowBox[{
    "img_", ",", "channel_", ",", "startFrame_", ",", "startPosition_", ",", 
     "pad_", ",", "threshold1_", ",", "bandpass_", ",", "max_", ",", 
     "threshold2_", ",", "dotsize_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newPos", ",", "myTrack", ",", "myTrimImg", ",", "tempOrigin", ",", 
       "myNewTempCenterList", ",", "tempCenter", ",", "flagFin", ",", 
       "euList"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"newPos", "=", "startPosition"}], ";", "\[IndentingNewLine]", 
      RowBox[{"myTrack", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"myTrimImg", "=", 
           RowBox[{"ImageTrim", "[", 
            RowBox[{
             RowBox[{"img", "\[LeftDoubleBracket]", 
              RowBox[{"channel", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Ceiling", "@", "newPos"}], "-", "pad"}], ",", 
               RowBox[{
                RowBox[{"Ceiling", "@", "newPos"}], "+", "pad", "-", 
                "0.1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tempOrigin", "=", 
           RowBox[{
            RowBox[{"Ceiling", "@", "newPos"}], "-", "pad", "-", "1"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"myNewTempCenterList", "=", 
           RowBox[{"ComponentMeasurements", "[", 
            RowBox[{
             RowBox[{"ImageMultiply", "[", 
              RowBox[{"myTrimImg", ",", 
               RowBox[{"SelectComponents", "[", 
                RowBox[{
                 RowBox[{"Binarize", "[", 
                  RowBox[{
                   RowBox[{"BandPass", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{"myTrimImg", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    "threshold1"}], "]"}], ",", "bandpass"}], "]"}], ",", 
                   RowBox[{"max", "*", "threshold2"}]}], "]"}], ",", 
                 "\"\<Count\>\"", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "dotsize", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "<", "#", "<", 
                   RowBox[{
                   "dotsize", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "&"}]}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "\"\<IntensityCentroid\>\"", ",", "\"\<Centroid\>\"", ",", 
               "\"\<Area\>\"", ",", "\"\<TotalIntensity\>\"", ",", 
               "\"\<MeanIntensity\>\"", ",", "\"\<MedianIntensity\>\"", ",", 
               "\"\<Elongation\>\"", ",", "\"\<MaxCentroidDistance\>\"", ",", 
               "\"\<BoundingBox\>\"", ",", "\"\<ConvexVertices\>\""}], 
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "myNewTempCenterList"}], "\[Equal]", 
             "1"}], ",", 
            RowBox[{
             RowBox[{"myNewTempCenterList", "=", 
              RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
             RowBox[{"tempCenter", "=", 
              RowBox[{
              "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "myNewTempCenterList"}], "\[Equal]", 
               "0"}], ",", 
              RowBox[{"myNewTempCenterList", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "tempOrigin"}], "*", "1.0"}], ",", "0", ",", 
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                 "0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"myNewTempCenterList", "=", 
                RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"euList", "=", 
                    RowBox[{
                    RowBox[{"N", "@", "Total"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pad", ",", "pad"}], "}"}], "+", "0.5", "-", 
                    "#"}], ")"}], "^", "2"}], "&"}], "/@", 
                    RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], ",", 
                    RowBox[{"Min", "@", "euList"}]}], "]"}]}], ")"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
               RowBox[{"tempCenter", "=", 
                RowBox[{
                "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newPos", "=", 
           RowBox[{"tempOrigin", "+", "tempCenter"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "+=", "tempOrigin"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "9", 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", "tempOrigin"}], "&"}], "/@", 
            RowBox[{
            "myNewTempCenterList", "\[LeftDoubleBracket]", "9", 
             "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "10", 
            "\[RightDoubleBracket]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "+", "tempOrigin"}], "&"}], "/@", 
            RowBox[{
            "myNewTempCenterList", "\[LeftDoubleBracket]", "10", 
             "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
          "myNewTempCenterList"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "startFrame", ",", 
           RowBox[{"Length", "@", 
            RowBox[{
            "img", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
           ",", "1"}], "}"}]}], "]"}]}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7136232245561433`*^9, 3.7136232269002776`*^9}, {
   3.7136232829164815`*^9, 3.7136233141482677`*^9}, {3.71362348569308*^9, 
   3.7136235304126377`*^9}, {3.7136235713409786`*^9, 
   3.7136236995503116`*^9}, {3.713623731533141*^9, 3.71362378763735*^9}, {
   3.7136238545101748`*^9, 3.713623869126011*^9}, {3.713626004392141*^9, 
   3.713626012959631*^9}, {3.7136331241973705`*^9, 3.7136331300937076`*^9}, 
   3.7152803087122173`*^9, {3.7152803820724134`*^9, 3.715280394208107*^9}, {
   3.715280439327688*^9, 3.715280447024128*^9}, {3.715283100618905*^9, 
   3.7152831529468985`*^9}, 3.7153683920062933`*^9, {3.715368447870489*^9, 
   3.715368465935522*^9}, 3.715368830591379*^9, {3.715368926510865*^9, 
   3.715368926989893*^9}, {3.7153689807669687`*^9, 3.7153689824550653`*^9}, {
   3.715369125431243*^9, 3.7153691860067077`*^9}, {3.715369559759085*^9, 
   3.715369565031387*^9}, {3.7153745206118298`*^9, 3.715374526583171*^9}, {
   3.715734175657922*^9, 3.715734182007285*^9}, {3.7157351145786247`*^9, 
   3.7157351553949594`*^9}, {3.7157353126509542`*^9, 
   3.7157353399945183`*^9}, {3.7157353767066174`*^9, 
   3.7157353768666267`*^9}, {3.7157360009653234`*^9, 3.71573600615562*^9}, {
   3.715950921504075*^9, 3.7159509387910633`*^9}, {3.7159515373592997`*^9, 
   3.7159515669839945`*^9}, {3.7168049211329527`*^9, 3.716804930300477*^9}, {
   3.716808616344307*^9, 3.7168087186411576`*^9}, {3.7168087925193834`*^9, 
   3.716808881312462*^9}, {3.7168089824322453`*^9, 3.7168090069846497`*^9}, {
   3.716809281840371*^9, 3.7168092844645205`*^9}, {3.716809665465313*^9, 
   3.7168097154961743`*^9}, {3.716809806893402*^9, 3.7168098210342107`*^9}, {
   3.7168098925092993`*^9, 3.7168099200168724`*^9}, {3.7168294690890155`*^9, 
   3.716829476072415*^9}, {3.7168318680432277`*^9, 3.716831870338359*^9}, {
   3.7168366670147133`*^9, 3.716836667678751*^9}, {3.716839289000682*^9, 
   3.7168393122970147`*^9}, {3.716896979182372*^9, 3.7168969793343806`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"2a597b2c-4228-4cb6-8c5d-7e32887d28c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NearestNeighborLinking3D2", "[", 
   RowBox[{
   "img_", ",", "channel_", ",", "startFrame_", ",", "startPosition_", ",", 
    "pad_", ",", "threshold1_", ",", "bandpass_", ",", "max_", ",", 
    "threshold2_", ",", "dotsize_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "newPos", ",", "myTrack", ",", "myTrimImg", ",", "tempOrigin", ",", 
      "myNewTempCenterList", ",", "tempCenter", ",", "flagFin", ",", 
      "euList"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"newPos", "=", "startPosition"}], ";", "\[IndentingNewLine]", 
     RowBox[{"myTrack", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"myTrimImg", "=", 
          RowBox[{"ImageTrim", "[", 
           RowBox[{
            RowBox[{"img", "\[LeftDoubleBracket]", 
             RowBox[{"channel", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Ceiling", "@", "newPos"}], "-", "pad"}], ",", 
              RowBox[{
               RowBox[{"Ceiling", "@", "newPos"}], "+", "pad", "-", "0.1"}]}],
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tempOrigin", "=", 
          RowBox[{
           RowBox[{"Ceiling", "@", "newPos"}], "-", "pad", "-", "1"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"myNewTempCenterList", "=", 
          RowBox[{"ComponentMeasurements", "[", 
           RowBox[{
            RowBox[{"ImageMultiply", "[", 
             RowBox[{"myTrimImg", ",", 
              RowBox[{"SelectComponents", "[", 
               RowBox[{
                RowBox[{"Binarize", "[", 
                 RowBox[{
                  RowBox[{"BandPass", "[", 
                   RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{"myTrimImg", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    "threshold1"}], "]"}], ",", "bandpass"}], "]"}], ",", 
                  RowBox[{"max", "*", "threshold2"}]}], "]"}], ",", 
                "\"\<Count\>\"", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "dotsize", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "<", "#", "<", 
                  RowBox[{
                  "dotsize", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "&"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<IntensityCentroid\>\"", ",", "\"\<Centroid\>\"", ",", 
              "\"\<Area\>\"", ",", "\"\<TotalIntensity\>\"", ",", 
              "\"\<MeanIntensity\>\"", ",", "\"\<MedianIntensity\>\"", ",", 
              "\"\<Elongation\>\"", ",", "\"\<MaxCentroidDistance\>\"", ",", 
              "\"\<BoundingBox\>\"", ",", "\"\<ConvexVertices\>\""}], "}"}]}],
            "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "myNewTempCenterList"}], "\[Equal]", "1"}],
            ",", 
           RowBox[{
            RowBox[{"myNewTempCenterList", "=", 
             RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
            RowBox[{"tempCenter", "=", 
             RowBox[{
             "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "myNewTempCenterList"}], "\[Equal]", 
              "0"}], ",", 
             RowBox[{"myNewTempCenterList", "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "tempOrigin"}], "*", "1.0"}], ",", "0", ",", 
                "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
                "0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"myNewTempCenterList", "=", 
               RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Flatten", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"euList", "=", 
                    RowBox[{
                    RowBox[{"N", "@", "Total"}], "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"pad", ",", "pad"}], "}"}], "+", "0.5", "-", 
                    "#"}], ")"}], "^", "2"}], "&"}], "/@", 
                    RowBox[{"myNewTempCenterList", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], ")"}]}]}], ",", 
                    RowBox[{"Min", "@", "euList"}]}], "]"}]}], ")"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
                  "2"}], "\[RightDoubleBracket]"}]}], ";", 
              RowBox[{"tempCenter", "=", 
               RowBox[{
               "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newPos", "=", 
          RowBox[{"tempOrigin", "+", "tempCenter"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "myNewTempCenterList", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}], "+=", "tempOrigin"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "myNewTempCenterList", "\[LeftDoubleBracket]", "9", 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "+", "tempOrigin"}], "&"}], "/@", 
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "9", 
            "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "myNewTempCenterList", "\[LeftDoubleBracket]", "10", 
           "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "+", "tempOrigin"}], "&"}], "/@", 
           RowBox[{
           "myNewTempCenterList", "\[LeftDoubleBracket]", "10", 
            "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
         "myNewTempCenterList"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "startFrame", ",", 
          RowBox[{"Length", "@", 
           RowBox[{
           "img", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ",", "1"}], "}"}]}], "]"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7186461866496315`*^9, 3.718646187089657*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"d7b5f399-acd9-4a07-985e-35d99e7e234c"]
}, Closed]],

Cell[CellGroupData[{

Cell["ClickAndTrack", "Subsection",
 CellChangeTimes->{{3.713636223270627*^9, 
  3.7136362302310257`*^9}},ExpressionUUID->"1883b62e-bec1-43fc-9774-\
28798021b6d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClickAndTrack", "[", 
   RowBox[{"imgRaw_", ",", "img_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"myImgRaw", "=", "imgRaw"}], ",", 
      RowBox[{"myImg", "=", "img"}], ",", "mask", ",", "avgFrameN", ",", 
      "threshold1", ",", "threshold2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mask", "=", 
      RowBox[{"Import", "@", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"avgFrameN", "=", 
      RowBox[{"<<", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_avgFrameN.dat\>\""}], ")"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"threshold1", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<_thred.dat\>\"", ",", "\"\<_thgreen.dat\>\"", ",", 
           "\"\<_thblue.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"threshold2", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{
          "\"\<_thred2.dat\>\"", ",", "\"\<_thgreen2.dat\>\"", ",", 
           "\"\<_thblue2.dat\>\""}], "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Nimg", "=", 
          RowBox[{"Length", "@", 
           RowBox[{
           "myImg", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{"spotType", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"binarizeMethod", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"trackChannel", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"dispChannel", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"trimPad", "=", "15"}], ",", "zoom", ",", 
         RowBox[{"myt", "=", "1"}], ",", "mycurpoints", ",", "newPos", ",", 
         "bandpass", ",", "dotsize", ",", "max", ",", "th2", ",", "myTrimImg",
          ",", "tempOrigin", ",", "myNewTempCenterList", ",", "tempCenter", 
         ",", "flagFin", ",", "euList", ",", "myTrack", ",", "myIdx", ",", 
         "myFitAllParameters", ",", "myFitPos", ",", "myFitData", ",", 
         "myFit", ",", "myColor", ",", "flagFileName", ",", "myFilename", ",",
          "myTrackNum"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "flagFileName", "=", "\"\<No track is saved in this session\>\""}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"myFit", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
           "0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Panel", "@", 
         RowBox[{"Column", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Column", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Tracking Spot:        \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"spotType", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"spotType", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"spotType", "=", "#"}]}], "]"}], ")"}], "&"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "1", "\[Rule]", "\"\<Difraction Limitted Spot\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Blob\>\""}]}], "}"}]}], 
                    "]"}]}], "}"}]}], ",", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Binarization:           \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"binarizeMethod", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"binarizeMethod", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"binarizeMethod", "=", "#"}]}], "]"}], ")"}], 
                    "&"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Automatic\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<User-defined\>\""}]}], 
                    "}"}]}], "]"}]}], "}"}]}], ",", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Tracking Channel: \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"trackChannel", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"trackChannel", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"trackChannel", "=", "#"}]}], "]"}], ")"}], 
                    "&"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
                    RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], 
                    "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Display Channel:    \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"dispChannel", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"dispChannel", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"dispChannel", "=", "#"}]}], "]"}], ")"}], 
                    "&"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
                    RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], 
                    "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Trim Size: \>\"", ",", 
                    RowBox[{"Spacer", "[", "45", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "trimPad", "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "3"}]}], "]"}]}], 
                   "}"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Column", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Row", "@", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    "\"\<Track Particle\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myTrack", "=", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Range", "@", "Nimg"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0."}], "}"}], "}"}], ",", "Nimg"}], 
                    "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"binarizeMethod", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"bandpass", ",", "dotsize"}], "}"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"spotType", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "7"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "100"}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "10"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1000"}], "}"}]}], "}"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking1", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", "bandpass", ",", "dotsize"}], 
                    "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"bandpass", ",", "dotsize"}], "}"}], "=", 
                    RowBox[{"threshold2", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"max", ",", "th2"}], "}"}], "=", 
                    RowBox[{"threshold2", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking2", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",",
                     "bandpass", ",", "max", ",", "th2", ",", "dotsize"}], 
                    "]"}]}], ";"}]}], "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Re-Track\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"binarizeMethod", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking1", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", "bandpass", ",", "dotsize"}], 
                    "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking2", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",",
                     "bandpass", ",", "max", ",", "th2", ",", "dotsize"}], 
                    "]"}]}], ";"}]}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Refill Gaps\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myIdx", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Split", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0."}], "}"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#2", "-", "#1"}], "\[Equal]", "1"}], "&"}]}], 
                    "]"}], ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], "||", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"x", ",", "Nimg"}], "]"}]}]}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    "1"}], ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
                    "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "@", 
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "+", "1"}], ",", "2", ",", 
                    "1"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    "1"}], ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "+", "1"}], ")"}]}], "*", 
                    "#"}]}], "&"}], "/@", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", 
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "@", "myIdx"}], ",", "1"}], "}"}]}], 
                    "]"}], ";"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PopupWindow", "[", 
                    RowBox[{
                    RowBox[{"Button", "[", "\"\<Plot Track\>\"", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"ListPointPlot3D", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "/@", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
                    RowBox[{"Graphics3D", "[", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"Flatten", "/@", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}], "]"}]}], "}"}], 
                    "]"}], ",", 
                    RowBox[{"BoxRatios", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1", ",", "1"}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}], ",", 
                    "\"\<No Track\>\""}], "]"}]}], ",", 
                    RowBox[{"WindowFloating", "  ", "\[Rule]", " ", "True"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowMargins", "   ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowSize", "      ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{"650", ",", " ", "400"}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "WindowTitle", "     ", "\[Rule]", " ", 
                    "\"\<3D track\>\""}]}], "]"}]}], "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"PopupWindow", "[", 
                    RowBox[{
                    RowBox[{"Button", "[", "\"\<Plot Track Gauss\>\"", "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"ListPointPlot3D", "[", 
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"myFit", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "All", ",", 
                    RowBox[{"2", ";;", "4"}]}], "\[RightDoubleBracket]"}]}], 
                    ",", "3"}], "]"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
                    RowBox[{"Graphics3D", "[", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Line", "@", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"myFit", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "All", ",", 
                    RowBox[{"2", ";;", "4"}]}], "\[RightDoubleBracket]"}]}], 
                    ",", "3"}], "]"}]}]}], "}"}], "]"}], ",", 
                    RowBox[{"BoxRatios", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1", ",", "1"}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}], ",", 
                    RowBox[{"WindowFloating", "  ", "\[Rule]", " ", "True"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowMargins", "   ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowSize", "      ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{"650", ",", " ", "400"}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "WindowTitle", "     ", "\[Rule]", " ", 
                    "\"\<3D track\>\""}]}], "]"}]}]}], "*)"}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Delete Current Position\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2"}], "\[RightDoubleBracket]"}], "-=", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    ";"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Delete All Subsequent Positions\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "-=", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}]}], ";"}]}], "]"}]}], "}"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    "\"\<Gaussian Fit\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"myFit", "=", 
                    RowBox[{"ParticleFitting2", "[", 
                    RowBox[{"myImgRaw", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", "myTrack"}], ",", "3"}], "]"}]}], 
                    "}"}]}], "}"}], ",", "trimPad", ",", "avgFrameN"}], 
                    "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ","}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Save Track\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myColor", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"trackChannel", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", "\"\<red\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"trackChannel", "\[Equal]", 
                    RowBox[{"{", "2", "}"}]}], ",", "\"\<green\>\"", ",", 
                    "\"\<blue\>\""}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"myTrackNum", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "+", 
                    RowBox[{"Length", "@", 
                    RowBox[{"FileNames", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringDelete", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"DirectoryName", "@", "#"}]}], "]"}], "<>", 
                    "\"\<_myTrack_\>\"", "<>", "myColor", "<>", "\"\<*\>\""}],
                     ",", 
                    RowBox[{"DirectoryName", "@", "#"}]}], "]"}]}]}], "&"}], 
                    "@", "analysisFolder"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"myFilename", "=", 
                    RowBox[{
                    "\"\<_myTrack_\>\"", "<>", "myColor", "<>", "\"\<_\>\"", "<>", 
                    RowBox[{"ToString", "@", "myTrackNum"}], "<>", 
                    "\"\<.dat\>\""}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"#", ",", "myTrackNum"}], "]"}], "&"}], "/@", 
                    "myTrack"}], ")"}], ">>", 
                    RowBox[{"analysisFolder", "<>", "myFilename"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"flagFileName", "=", 
                    RowBox[{
                    "\"\<Saved File Name : \>\"", "<>", "myFilename"}]}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "@", "flagFileName"}]}], "}"}]}]}], 
                "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<time points   \>\"", ",", 
                 RowBox[{"Slider", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", "myt", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "Nimg", ",", "1"}], "}"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"600", ",", "20"}], "}"}]}]}], "]"}], " ", ",", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<-\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"myt", ">", "1"}], ",", 
                    RowBox[{"myt", "=", 
                    RowBox[{"myt", "-", "1"}]}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<+\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"myt", "<", "Nimg"}], ",", 
                    RowBox[{"myt", "=", 
                    RowBox[{"myt", "+", "1"}]}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"Spacer", "[", "10", "]"}], ",", 
                 RowBox[{"Dynamic", "[", "myt", "]"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "@", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"LocatorPane", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", "mycurpoints", "]"}], ",", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], "]"}],
                   "]"}], ",", 
                 RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"ImageTrim", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Ceiling", "@", "mycurpoints"}], "-", "20"}], ",", 
                    RowBox[{
                    RowBox[{"Ceiling", "@", "mycurpoints"}], "+", "20", "-", 
                    "0.1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "150"}]}], "]"}], "]"}]}],
                 "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Spacer", "@", "3"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Yellow", ",", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "mycurpoints"}], "]"}], 
                    ",", "4"}], "]"}]}], "}"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"ImageTrim", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "mycurpoints"}], "]"}]}], 
                    "-", "20"}], ",", 
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "mycurpoints"}], "]"}]}], 
                    "+", "20", "-", "0.1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "150"}]}], "]"}], "]"}]}],
                 "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
             "}"}]}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7168388001647224`*^9, 3.71683883334162*^9}, {
   3.716839082028844*^9, 3.7168391614443865`*^9}, {3.7168393298620195`*^9, 
   3.716839335454339*^9}, {3.716839373916539*^9, 3.7168393764626846`*^9}, 
   3.71683966555122*^9, {3.7168400979099493`*^9, 3.716840153254115*^9}, {
   3.716840224542192*^9, 3.716840239119026*^9}, {3.7168935523053656`*^9, 
   3.716893562503949*^9}, {3.7168940576642704`*^9, 3.7168940650236917`*^9}, {
   3.7168941014087725`*^9, 3.71689411080031*^9}, {3.7168942481301646`*^9, 
   3.7168942542975173`*^9}, {3.71689439229041*^9, 3.716894417553855*^9}, 
   3.7168945363936524`*^9, {3.716894611569952*^9, 3.716894625553752*^9}, {
   3.716894744377548*^9, 3.716894764441696*^9}, 3.716894795376465*^9, {
   3.716894840953072*^9, 3.7168948413850965`*^9}, {3.716894906081797*^9, 
   3.7168950553133326`*^9}, {3.716895087010146*^9, 3.7168950889132547`*^9}, {
   3.716895138994119*^9, 3.7168951419212866`*^9}, {3.716895527874362*^9, 
   3.716895567746642*^9}, {3.7168957632518244`*^9, 3.716895771691307*^9}, {
   3.716895837002043*^9, 3.7168958392191696`*^9}, {3.716895894179313*^9, 
   3.716895933690573*^9}, {3.7168959856735463`*^9, 3.716896009002881*^9}, {
   3.716896048459138*^9, 3.7168961133958516`*^9}, {3.716896435499275*^9, 
   3.716896552626974*^9}, {3.7168965961954665`*^9, 3.7168966636353235`*^9}, 
   3.7168968967406564`*^9, {3.7168969951732864`*^9, 3.716897003571767*^9}, 
   3.7173599520836353`*^9, {3.717437650744745*^9, 3.7174376677057147`*^9}, {
   3.7174377325444236`*^9, 3.7174377344255314`*^9}, {3.717442673174011*^9, 
   3.717442685477715*^9}, {3.717442719365653*^9, 3.7174427617820797`*^9}, {
   3.717515242111717*^9, 3.717515259174693*^9}, 3.717515878791133*^9, {
   3.717515928638984*^9, 3.7175159500952115`*^9}, {3.717516026280569*^9, 
   3.717516073215254*^9}, {3.7175190913628817`*^9, 3.717519102474517*^9}, {
   3.7175191332742786`*^9, 3.71751914623402*^9}, {3.7175192069064903`*^9, 
   3.7175192202502537`*^9}, {3.7175192675549593`*^9, 3.717519273914323*^9}, 
   3.717519694043353*^9, {3.7175284753156133`*^9, 3.71752849099551*^9}, {
   3.719772959239213*^9, 3.719772959333218*^9}, {3.7197731604307203`*^9, 
   3.719773183782056*^9}, {3.766943445558028*^9, 3.766943449803052*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"5b48b1a6-45c5-4743-ab9f-fdfab1fd1a3a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClickAndTrack3D", "[", 
   RowBox[{"(*", 
    RowBox[{"imgRaw_", ","}], "*)"}], 
   RowBox[{"img_", ",", "analysisFolder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"myImgRaw", "=", "imgRaw"}], ",", 
      RowBox[{"myImg", "=", "img"}], ",", "mask", ",", "avgFrameN", ",", 
      "threshold1", ",", "threshold2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mask", "=", 
      RowBox[{"Import", "@", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"avgFrameN", "=", 
      RowBox[{"<<", 
       RowBox[{"(", 
        RowBox[{"analysisFolder", "<>", "\"\<_avgFrameN.dat\>\""}], ")"}]}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"threshold1", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"(*", 
           RowBox[{"\"\<_thred.dat\>\"", ",", "\"\<_thgreen.dat\>\"", ","}], 
           "*)"}], "\"\<_thblue.dat\>\"", "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"threshold2", "=", 
      RowBox[{"Get", "/@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"analysisFolder", "<>", "#"}], "&"}], "/@", 
         RowBox[{"{", 
          RowBox[{"(*", 
           RowBox[{"\"\<_thred2.dat\>\"", ",", "\"\<_thgreen2.dat\>\"", ","}],
            "*)"}], "\"\<_thblue2.dat\>\"", "}"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Nimg", "=", 
          RowBox[{"Length", "@", 
           RowBox[{
           "myImg", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", 
         RowBox[{"spotType", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"binarizeMethod", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"trackChannel", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"dispChannel", "=", 
          RowBox[{"{", "1", "}"}]}], ",", 
         RowBox[{"trimPad", "=", "15"}], ",", "zoom", ",", 
         RowBox[{"myt", "=", "1"}], ",", "mycurpoints", ",", "newPos", ",", 
         "bandpass", ",", "dotsize", ",", "max", ",", "th2", ",", "myTrimImg",
          ",", "tempOrigin", ",", "myNewTempCenterList", ",", "tempCenter", 
         ",", "flagFin", ",", "euList", ",", "myTrack", ",", "myIdx", ",", 
         "myFitAllParameters", ",", "myFitPos", ",", "myFitData", ",", 
         "myFit", ",", "myColor", ",", "flagFileName", ",", "myFilename", ",",
          "myTruckNum"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "flagFileName", "=", "\"\<No track is saved in this session\>\""}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"myFit", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}], ",", 
           "0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Panel", "@", 
         RowBox[{"Column", "[", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Column", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Tracking Spot:        \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"spotType", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"spotType", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"spotType", "=", "#"}]}], "]"}], ")"}], "&"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "1", "\[Rule]", "\"\<Difraction Limitted Spot\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Blob\>\""}]}], "}"}]}], 
                    "]"}]}], "}"}]}], ",", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Binarization:           \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"binarizeMethod", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"binarizeMethod", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"binarizeMethod", "=", "#"}]}], "]"}], ")"}], 
                    "&"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Automatic\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<User-defined\>\""}]}], 
                    "}"}]}], "]"}]}], "}"}]}], ",", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Tracking Channel: \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"trackChannel", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"trackChannel", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"trackChannel", "=", "#"}]}], "]"}], ")"}], 
                    "&"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
                    RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], 
                    "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Display Channel:    \>\"", ",", 
                    RowBox[{"CheckboxBar", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"dispChannel", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "#", "]"}], ">", "1"}], ",", 
                    RowBox[{"dispChannel", "=", 
                    RowBox[{"#", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"-", "1"}], ";;"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"dispChannel", "=", "#"}]}], "]"}], ")"}], 
                    "&"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
                    RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
                    RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], 
                    "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", 
                   RowBox[{"\"\<Trim Size: \>\"", ",", 
                    RowBox[{"Spacer", "[", "45", "]"}], ",", 
                    RowBox[{"InputField", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "trimPad", "]"}], ",", 
                    RowBox[{"FieldSize", "\[Rule]", "3"}]}], "]"}]}], 
                   "}"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Spacer", "[", "20", "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"Column", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Row", "@", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    "\"\<Track Particle\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myTrack", "=", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Range", "@", "Nimg"}], ",", 
                    RowBox[{"ConstantArray", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0."}], "}"}], "}"}], ",", "Nimg"}], 
                    "]"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"binarizeMethod", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"bandpass", ",", "dotsize"}], "}"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"spotType", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "7"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "100"}], "}"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "10"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1000"}], "}"}]}], "}"}]}], "]"}]}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking1", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", "bandpass", ",", "dotsize"}], 
                    "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"bandpass", ",", "dotsize"}], "}"}], "=", 
                    RowBox[{"threshold2", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"max", ",", "th2"}], "}"}], "=", 
                    RowBox[{"threshold2", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking2", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",",
                     "bandpass", ",", "max", ",", "th2", ",", "dotsize"}], 
                    "]"}]}], ";"}]}], "]"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Re-Track\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"binarizeMethod", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking1", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", "bandpass", ",", "dotsize"}], 
                    "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"NearestNeighborLinking2", "[", 
                    RowBox[{"myImg", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt", ",", "mycurpoints",
                     ",", "trimPad", ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], ",",
                     "bandpass", ",", "max", ",", "th2", ",", "dotsize"}], 
                    "]"}]}], ";"}]}], "]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Refill Gaps\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myIdx", "=", 
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Split", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", "0."}], "}"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#2", "-", "#1"}], "\[Equal]", "1"}], "&"}]}], 
                    "]"}], ",", 
                    RowBox[{"x_", "/;", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"x", ",", "1"}], "]"}], "||", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"x", ",", "Nimg"}], "]"}]}]}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    "1"}], ",", "2", ",", "1"}], "\[RightDoubleBracket]"}], 
                    "+", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Last", "@", 
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "+", "1"}], ",", "2", ",", 
                    "1"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myIdx", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    "1"}], ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                    ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "@", 
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "+", "1"}], ")"}]}], "*", 
                    "#"}]}], "&"}], "/@", 
                    RowBox[{"Range", "@", 
                    RowBox[{"Length", "@", 
                    RowBox[{
                    "myIdx", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "@", "myIdx"}], ",", "1"}], "}"}]}], 
                    "]"}], ";"}]}], "]"}]}], 
                   RowBox[{"(*", 
                    RowBox[{",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PopupWindow", "[", 
                    RowBox[{
                    RowBox[{"Button", "[", "\"\<Plot Track\>\"", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"ListPointPlot3D", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "/@", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
                    RowBox[{"Graphics3D", "[", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Line", "[", 
                    RowBox[{"Flatten", "/@", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}], "]"}]}], "}"}], 
                    "]"}], ",", 
                    RowBox[{"BoxRatios", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1", ",", "1"}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}], ",", 
                    "\"\<No Track\>\""}], "]"}]}], ",", 
                    RowBox[{"WindowFloating", "  ", "\[Rule]", " ", "True"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowMargins", "   ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowSize", "      ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{"650", ",", " ", "400"}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "WindowTitle", "     ", "\[Rule]", " ", 
                    "\"\<3D track\>\""}]}], "]"}]}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "@", 
                    RowBox[{"PopupWindow", "[", 
                    RowBox[{
                    RowBox[{"Button", "[", "\"\<Plot Track Gauss\>\"", "]"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"ListPointPlot3D", "[", 
                    RowBox[{
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"myFit", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "All", ",", 
                    RowBox[{"2", ";;", "4"}]}], "\[RightDoubleBracket]"}]}], 
                    ",", "3"}], "]"}], ",", 
                    RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
                    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
                    RowBox[{"Graphics3D", "[", 
                    RowBox[{"{", 
                    RowBox[{"Red", ",", 
                    RowBox[{"Line", "@", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"myFit", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "All", ",", 
                    RowBox[{"2", ";;", "4"}]}], "\[RightDoubleBracket]"}]}], 
                    ",", "3"}], "]"}]}]}], "}"}], "]"}], ",", 
                    RowBox[{"BoxRatios", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"5", ",", "1", ",", "1"}], "}"}]}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "600"}]}], "]"}], ",", 
                    RowBox[{"WindowFloating", "  ", "\[Rule]", " ", "True"}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowMargins", "   ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"50", ",", "50"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"WindowSize", "      ", "\[Rule]", " ", 
                    RowBox[{"{", 
                    RowBox[{"650", ",", " ", "400"}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "WindowTitle", "     ", "\[Rule]", " ", 
                    "\"\<3D track\>\""}]}], "]"}]}]}], "*)"}], "}"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Delete Current Position\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2"}], "\[RightDoubleBracket]"}], "-=", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    ";"}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Delete All Subsequent Positions\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}], "-=", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"myt", ";;"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}]}], ";"}]}], "]"}]}], "}"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Row", "@", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{
                    "\"\<Gaussian Fit\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{"myFit", "=", 
                    RowBox[{"ParticleFitting2", "[", 
                    RowBox[{"myImgRaw", ",", 
                    RowBox[{
                    "trackChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Thread", "@", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"Partition", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", "myTrack"}], ",", "3"}], "]"}]}], 
                    "}"}]}], "}"}], ",", "trimPad", ",", "avgFrameN"}], 
                    "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "[", "5", "]"}], ","}], "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Button", "[", 
                    RowBox[{"\"\<Save Track\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"myColor", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"trackChannel", "\[Equal]", 
                    RowBox[{"{", "1", "}"}]}], ",", "\"\<red\>\"", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"trackChannel", "\[Equal]", 
                    RowBox[{"{", "2", "}"}]}], ",", "\"\<green\>\"", ",", 
                    "\"\<blue\>\""}], "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"myTrackNum", "=", 
                    RowBox[{"1", "+", 
                    RowBox[{"Length", "@", 
                    RowBox[{"FileNames", "[", 
                    RowBox[{
                    RowBox[{
                    "\"\<*_myTrack_\>\"", "<>", "myColor", "<>", 
                    "\"\<*\>\""}], ",", 
                    RowBox[{"DirectoryName", "@", "analysisFolder"}]}], 
                    "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"myFilename", "=", 
                    RowBox[{
                    "\"\<_myTrack_\>\"", "<>", "myColor", "<>", "\"\<_\>\"", "<>", 
                    RowBox[{"ToString", "@", "myTrackNum"}], "<>", 
                    "\"\<.dat\>\""}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Prepend", "[", 
                    RowBox[{"#", ",", "myTrackNum"}], "]"}], "&"}], "/@", 
                    "myTrack"}], ")"}], ">>", 
                    RowBox[{"analysisFolder", "<>", "myFilename"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"flagFileName", "=", 
                    RowBox[{
                    "\"\<Saved File Name : \>\"", "<>", "myFilename"}]}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Dynamic", "@", "flagFileName"}]}], "}"}]}]}], 
                "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"\"\<time points   \>\"", ",", 
                 RowBox[{"Slider", "[", 
                  RowBox[{
                   RowBox[{"Dynamic", "[", "myt", "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "Nimg", ",", "1"}], "}"}], ",", 
                   RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"600", ",", "20"}], "}"}]}]}], "]"}], " ", ",", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<-\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"myt", ">", "1"}], ",", 
                    RowBox[{"myt", "=", 
                    RowBox[{"myt", "-", "1"}]}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"Button", "[", 
                  RowBox[{"\"\<+\>\"", ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"myt", "<", "Nimg"}], ",", 
                    RowBox[{"myt", "=", 
                    RowBox[{"myt", "+", "1"}]}]}], "]"}]}], "]"}], ",", 
                 RowBox[{"Spacer", "[", "10", "]"}], ",", 
                 RowBox[{"Dynamic", "[", "myt", "]"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Row", "@", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"LocatorPane", "[", 
                   RowBox[{
                    RowBox[{"Dynamic", "[", "mycurpoints", "]"}], ",", 
                    RowBox[{"Show", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}]}], "]"}],
                   "]"}], ",", 
                 RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"ImageTrim", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Ceiling", "@", "mycurpoints"}], "-", "20"}], ",", 
                    RowBox[{
                    RowBox[{"Ceiling", "@", "mycurpoints"}], "+", "20", "-", 
                    "0.1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}]}],
                 "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Spacer", "@", "3"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"{", 
                    RowBox[{"Yellow", ",", 
                    RowBox[{"Circle", "[", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "mycurpoints"}], "]"}], 
                    ",", "4"}], "]"}]}], "}"}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], "]"}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{"Spacer", "@", "10"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"Show", "[", 
                   RowBox[{
                    RowBox[{"ImageTrim", "[", 
                    RowBox[{
                    RowBox[{"ImageAdjust", "[", 
                    RowBox[{
                    RowBox[{"myImg", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "myt"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
                    RowBox[{"threshold1", "\[LeftDoubleBracket]", 
                    RowBox[{
                    "dispChannel", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "mycurpoints"}], "]"}]}], 
                    "-", "20"}], ",", 
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ValueQ", "@", "myTrack"}], ",", 
                    RowBox[{"myTrack", "\[LeftDoubleBracket]", 
                    RowBox[{"myt", ",", "2", ",", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "mycurpoints"}], "]"}]}], 
                    "+", "20", "-", "0.1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], "]"}]}],
                 "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
             "}"}]}], "}"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7168388001647224`*^9, 3.71683883334162*^9}, {
   3.716839082028844*^9, 3.7168391614443865`*^9}, {3.7168393298620195`*^9, 
   3.716839335454339*^9}, {3.716839373916539*^9, 3.7168393764626846`*^9}, 
   3.71683966555122*^9, {3.7168400979099493`*^9, 3.716840153254115*^9}, {
   3.716840224542192*^9, 3.716840239119026*^9}, {3.7168935523053656`*^9, 
   3.716893562503949*^9}, {3.7168940576642704`*^9, 3.7168940650236917`*^9}, {
   3.7168941014087725`*^9, 3.71689411080031*^9}, {3.7168942481301646`*^9, 
   3.7168942542975173`*^9}, {3.71689439229041*^9, 3.716894417553855*^9}, 
   3.7168945363936524`*^9, {3.716894611569952*^9, 3.716894625553752*^9}, {
   3.716894744377548*^9, 3.716894764441696*^9}, 3.716894795376465*^9, {
   3.716894840953072*^9, 3.7168948413850965`*^9}, {3.716894906081797*^9, 
   3.7168950553133326`*^9}, {3.716895087010146*^9, 3.7168950889132547`*^9}, {
   3.716895138994119*^9, 3.7168951419212866`*^9}, {3.716895527874362*^9, 
   3.716895567746642*^9}, {3.7168957632518244`*^9, 3.716895771691307*^9}, {
   3.716895837002043*^9, 3.7168958392191696`*^9}, {3.716895894179313*^9, 
   3.716895933690573*^9}, {3.7168959856735463`*^9, 3.716896009002881*^9}, {
   3.716896048459138*^9, 3.7168961133958516`*^9}, {3.716896435499275*^9, 
   3.716896552626974*^9}, {3.7168965961954665`*^9, 3.7168966636353235`*^9}, 
   3.7168968967406564`*^9, {3.7168969951732864`*^9, 3.716897003571767*^9}, 
   3.7173599520836353`*^9, {3.717437650744745*^9, 3.7174376677057147`*^9}, {
   3.7174377325444236`*^9, 3.7174377344255314`*^9}, {3.717442673174011*^9, 
   3.717442685477715*^9}, {3.717442719365653*^9, 3.7174427617820797`*^9}, {
   3.717515242111717*^9, 3.717515259174693*^9}, 3.717515878791133*^9, {
   3.717515928638984*^9, 3.7175159500952115`*^9}, {3.717516026280569*^9, 
   3.717516073215254*^9}, {3.7175190913628817`*^9, 3.717519102474517*^9}, {
   3.7175191332742786`*^9, 3.71751914623402*^9}, {3.7175192069064903`*^9, 
   3.7175192202502537`*^9}, {3.7175192675549593`*^9, 3.717519273914323*^9}, 
   3.717519694043353*^9, {3.7175284753156133`*^9, 3.71752849099551*^9}, {
   3.7186459457108507`*^9, 3.718645992157507*^9}, {3.718646096302464*^9, 
   3.7186461076941156`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"4a55e1cd-c647-4b18-b8c9-2a10b6ad78f5"]
}, Closed]],

Cell[CellGroupData[{

Cell["FilterFitOutlier", "Subsection",
 CellChangeTimes->{{3.71629985262469*^9, 3.7162998590880604`*^9}, {
  3.7177712559439316`*^9, 
  3.7177712581020555`*^9}},ExpressionUUID->"3d1858ec-3141-4fc1-98d7-\
0f43f356dbdf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "function", " ", "removes", " ", "outliers", " ", "based", 
     " ", "on", " ", "intensity"}], ",", " ", 
    RowBox[{
    "90", "%", " ", "confidence", " ", "interval", " ", "of", " ", "xy", " ", 
     "positions", " ", "and", " ", "the", " ", "size", " ", "of", " ", 
     "sigma"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FilterFitOutlier", "[", 
    RowBox[{"mySpotsFit_", ",", "maxDxy_", ",", "maxSig_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "idxInt", ",", "idxX90Conf", ",", "idxY90Conf", ",", "idxSigX", ",", 
       "idxSigY", ",", "idxOutliers"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"idxInt", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"mySpotsFit", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "4", ",", "2", ",", "1"}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"x_", "/;", 
          RowBox[{
           RowBox[{"x", "<", "0"}], "||", 
           RowBox[{"x", ">", "2"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"idxX90Conf", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Differences", "/@", "#"}], "&"}], "/@", 
            RowBox[{"mySpotsFit", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "All", ",", "5", ",", "1", ",", "1"}], 
             "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"x", ">", "maxDxy"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxY90Conf", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Differences", "/@", "#"}], "&"}], "/@", 
            RowBox[{"mySpotsFit", "\[LeftDoubleBracket]", 
             RowBox[{"All", ",", "All", ",", "5", ",", "1", ",", "2"}], 
             "\[RightDoubleBracket]"}]}], ")"}], "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}], 
         ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"x", ">", "maxDxy"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxSigX", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"mySpotsFit", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "4", ",", "3", ",", "1"}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"x_", "/;", 
          RowBox[{
           RowBox[{"Abs", "@", "x"}], ">", "maxSig"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxSigY", "=", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"mySpotsFit", "\[LeftDoubleBracket]", 
          RowBox[{"All", ",", "All", ",", "4", ",", "3", ",", "2"}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"x_", "/;", 
          RowBox[{
           RowBox[{"Abs", "@", "x"}], ">", "maxSig"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"idxOutliers", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
        "idxInt", ",", "idxX90Conf", ",", "idxY90Conf", ",", "idxSigX", ",", 
         "idxSigY"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Delete", "[", 
       RowBox[{"mySpotsFit", ",", "idxOutliers"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7163079773033953`*^9, 3.7163080736239047`*^9}, {
  3.716308283583914*^9, 3.7163083117995276`*^9}, {3.7163083677277265`*^9, 
  3.7163083737850733`*^9}, {3.7175241617528915`*^9, 3.7175241618648977`*^9}, {
  3.7175242033692713`*^9, 3.717524205240379*^9}, {3.7175242379372487`*^9, 
  3.717524239273325*^9}, {3.7175250840096416`*^9, 3.7175250850256996`*^9}, {
  3.717771260303181*^9, 3.7177712633193536`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"1ab9bc7e-65db-419e-b9b9-e9430a853082"]
}, Closed]],

Cell[CellGroupData[{

Cell["SpotLocationOnCell", "Subsection",
 CellChangeTimes->{{3.716315153980878*^9, 
  3.716315185436677*^9}},ExpressionUUID->"acb548d0-1794-4ea7-b4ed-\
bb7d76d9a0d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "function", " ", "to", " ", "show", " ", "cell", " ", "movie", " ", "with",
     " ", "tracked", " ", "spot", " ", "positions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SpotLocationOnCell", "[", 
    RowBox[{
    "myColMovie_", ",", "thred_", ",", "redSpots_", ",", "thgreen_", ",", 
     "greenSpots_", ",", "thblue_", ",", "blueSpots_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"th", ",", "colCircle", ",", "spots"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"color", "\[Equal]", "1"}], ",", 
          RowBox[{
           RowBox[{"th", "=", "thred"}], ";", 
           RowBox[{"colCircle", "=", "Red"}], ";", 
           RowBox[{"spots", "=", "redSpots"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"color", "\[Equal]", "2"}], ",", 
            RowBox[{
             RowBox[{"th", "=", "thgreen"}], ";", 
             RowBox[{"colCircle", "=", "Green"}], ";", 
             RowBox[{"spots", "=", "greenSpots"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"th", "=", "thblue"}], ";", 
             RowBox[{"colCircle", "=", "Blue"}], ";", 
             RowBox[{"spots", "=", "blueSpots"}]}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"ImageAdjust", "[", 
           RowBox[{
            RowBox[{"myColMovie", "\[LeftDoubleBracket]", 
             RowBox[{"color", ",", "frame"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "th"}], "]"}], 
          ",", 
          RowBox[{"Graphics", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"colCircle", ",", 
               RowBox[{"Circle", "[", 
                RowBox[{"#", ",", "7"}], "]"}]}], "}"}], "&"}], "/@", 
            RowBox[{
            "spots", "\[LeftDoubleBracket]", "frame", 
             "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"color", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "\[Rule]", "\"\<Red\>\""}], ",", 
           RowBox[{"2", "\[Rule]", "\"\<Green\>\""}], ",", 
           RowBox[{"3", "\[Rule]", "\"\<Blue\>\""}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"frame", ",", "1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{
          "myColMovie", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", "1"}], "}"}], ",", 
       RowBox[{"ControlType", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"RadioButtonBar", ",", "Automatic"}], "}"}]}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.716315179996366*^9, 3.7163153405015464`*^9}, {
  3.716560508065325*^9, 3.7165605535859284`*^9}, {3.717941332702766*^9, 
  3.7179413338548317`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"2d1c4e11-ce9a-4d7f-b7ca-599602f209eb"]
}, Closed]],

Cell[CellGroupData[{

Cell["ShiftingDataPoints", "Subsection",
 CellChangeTimes->{{3.716560254248807*^9, 
  3.7165602596331153`*^9}},ExpressionUUID->"73f259af-eeef-427c-9ee5-\
d1d410d3e7ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "function", " ", "to", " ", "shift", " ", "dataset", " ", "using", " ", 
     RowBox[{"offset", ".", " ", "The"}], " ", "data", " ", "first", " ", 
     "get", " ", "interpolated", " ", "linearly"}], ",", " ", "shifted", ",", 
    " ", 
    RowBox[{"and", " ", "then", " ", "resampled"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ShiftingDataPointsMin", "[", 
    RowBox[{
    "myData_", ",", "myOffset_", ",", "myResolution_", ",", "flagFill_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myDataInterpolFunc", ",", "myDataInterpol", ",", "myDataResample", ",",
        "myStart", ",", "myFillSize"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myDataInterpolFunc", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"#", ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "&"}], "/@",
         "myData"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"myDataInterpol", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{"#", ",", 
           RowBox[{"1", "+", 
            RowBox[{"myResolution", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{
                "myData", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "-", "1"}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "@", 
              RowBox[{
              "myData", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
        "myDataInterpolFunc"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"myStart", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", 
            RowBox[{"Min", "@", "#"}]}], ")"}], "+", "1"}], "&"}], "@", 
        RowBox[{"Round", "@", 
         RowBox[{"(", 
          RowBox[{"10", "*", "myOffset"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"myDataResample", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"myDataInterpol", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{
            "myStart", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
             ";;"}]}], "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "myDataInterpol"}], ",", "1"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"myDataResample", "=", 
       RowBox[{"myDataResample", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{";;", "All", ";;", "myResolution"}]}], 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"flagFill", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"myFillSize", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Max", "@", "#"}], "-", "#"}], "&"}], "@", 
           RowBox[{"(", 
            RowBox[{"Length", "/@", "myDataResample"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"myDataResample", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{
                "myDataResample", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{
                  "myFillSize", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], ",", "1"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "myDataResample"}], ",", "1"}], "}"}]}], 
           "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "myDataResample"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7165605573051414`*^9, 3.716560608545072*^9}, {
  3.716561843233692*^9, 3.716561867770096*^9}, {3.7165619129386787`*^9, 
  3.7165619648906507`*^9}, {3.716562014898511*^9, 3.7165620674995193`*^9}, {
  3.7165622401223927`*^9, 3.71656230388504*^9}, {3.719179697118103*^9, 
  3.719179697448122*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"2f1cad17-a302-410c-a38e-b29e1d8a6ab5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "function", " ", "to", " ", "shift", " ", "dataset", " ", "using", " ", 
     RowBox[{"offset", ".", " ", "The"}], " ", "data", " ", "first", " ", 
     "get", " ", "interpolated", " ", "linearly"}], ",", " ", "shifted", ",", 
    " ", 
    RowBox[{"and", " ", "then", " ", "resampled"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ShiftingDataPointsMean", "[", 
    RowBox[{
    "myData_", ",", "myOffset_", ",", "myResolution_", ",", "flagFill_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "myDataInterpolFunc", ",", "myDataInterpol", ",", "myDataResample", ",",
        "myStart", ",", "myFillSize"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myDataInterpolFunc", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Interpolation", "[", 
          RowBox[{"#", ",", 
           RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "&"}], "/@",
         "myData"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"myDataInterpol", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Array", "[", 
            RowBox[{"#", ",", 
             RowBox[{"1", "+", 
              RowBox[{"myResolution", "*", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Length", "@", 
                  RowBox[{
                  "myData", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "-", "1"}], ")"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"Length", "@", 
                RowBox[{
                "myData", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
          "myDataInterpolFunc"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"myDataInterpol", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Array", "[", 
          RowBox[{
           RowBox[{
           "myDataInterpolFunc", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"1", "+", 
            RowBox[{"myResolution", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "@", 
                RowBox[{
                "myData", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}], "-", "1"}], ")"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "@", 
              RowBox[{
              "myData", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "myData"}], ",", "1"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"myStart", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "-", 
            RowBox[{"Round", "@", 
             RowBox[{"Mean", "@", "#"}]}]}], ")"}], "+", "1"}], "&"}], "@", 
        RowBox[{"Round", "@", 
         RowBox[{"(", 
          RowBox[{"10", "*", "myOffset"}], ")"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"myDataResample", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "myStart", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
             "<", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{
               "myDataInterpol", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"ConstantArray", "[", 
                RowBox[{
                 RowBox[{"{", "}"}], ",", 
                 RowBox[{
                  RowBox[{"Abs", "@", 
                   RowBox[{
                   "myStart", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "+", "1"}]}], "]"}]}], "]"}],
              ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"myDataInterpol", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", 
             RowBox[{
              RowBox[{
              "myStart", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], ";;"}]}], 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "myDataInterpol"}], ",", "1"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"myDataResample", "=", 
       RowBox[{"myDataResample", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{";;", "All", ";;", "myResolution"}]}], 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"flagFill", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"myFillSize", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Max", "@", "#"}], "-", "#"}], "&"}], "@", 
           RowBox[{"(", 
            RowBox[{"Length", "/@", "myDataResample"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"myDataResample", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "myDataResample", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "}"}], ",", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{
                  "myFillSize", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], ",", "1"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "@", "myDataResample"}], ",", "1"}], "}"}]}], 
           "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "myDataResample"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7165605573051414`*^9, 3.716560608545072*^9}, {
  3.716561843233692*^9, 3.716561867770096*^9}, {3.7165619129386787`*^9, 
  3.7165619648906507`*^9}, {3.716562014898511*^9, 3.7165620674995193`*^9}, {
  3.7165622401223927`*^9, 3.71656230388504*^9}, {3.719179683469322*^9, 
  3.7191797314300656`*^9}, {3.719179788574334*^9, 3.719179792402553*^9}, {
  3.7191798644536743`*^9, 3.719179906585084*^9}, {3.719179950272583*^9, 
  3.7191799523847036`*^9}, {3.7191799877867284`*^9, 3.7191800430728903`*^9}, {
  3.7191811621428976`*^9, 3.7191811691833005`*^9}, {3.7191812719011755`*^9, 
  3.719181400047505*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"c3bd4d71-e2b2-4e3a-9f2d-2a49eec62e74"],

Cell[CellGroupData[{

Cell[BoxData["myAllBlueNum"], "Input",
 CellChangeTimes->{{3.719180074599694*^9, 3.7191800776318674`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"1f77646d-7270-4017-b508-3bd48f3b51b1"],

Cell[BoxData["myAllBlueNum"], "Output",
 CellChangeTimes->{
  3.7191800780388904`*^9, 3.7192753228915844`*^9, 3.7252118495064116`*^9, 
   3.7260063497186265`*^9, 3.7260070878273478`*^9, 3.726247784369128*^9, 
   3.728338992439767*^9, 3.736200003225463*^9, 3.745620574213305*^9, 
   3.745640352872652*^9, 3.745687378085417*^9, 3.745690964364935*^9, 
   3.745854100419186*^9, 3.7458694667481403`*^9, 3.746118326567072*^9, 
   3.7463683510627203`*^9, 3.7464602397446127`*^9, 3.7464603007696037`*^9, {
   3.7469601717871428`*^9, 3.746960174067828*^9}, 3.7470575884842076`*^9, 
   3.7470593606397443`*^9, 3.7470606742834063`*^9, 3.7495574737992806`*^9, 
   3.753118054210923*^9, 3.753124497721923*^9, 3.756116367350814*^9, 
   3.756237613705349*^9, 3.756466970684753*^9, 3.766575545971999*^9, 
   3.76675182497735*^9, 3.766828096087236*^9, 3.767011236005966*^9, 
   3.767286478765334*^9, 3.767289431669959*^9, 3.7672913796441298`*^9, 
   3.7672916477690496`*^9, 3.76731319319464*^9, 3.7673634918958187`*^9, 
   3.7673679136817007`*^9, 3.7698620266662207`*^9, 3.770644175021098*^9, 
   3.770644401724271*^9, 3.7723060453724537`*^9, 3.776007791480048*^9, 
   3.7774003615819397`*^9, 3.777716201975178*^9, 3.778350257013785*^9, 
   3.7789505706069117`*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"2e8366ff-e036-44c8-a29f-4479adb4be66"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShiftingDataPointsMin", "[", 
  RowBox[{"myAllBlueNum", ",", "myOffset", ",", "10", ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7191801413095093`*^9, 3.7191801424475746`*^9}, {
  3.719180303829805*^9, 3.7191803089981003`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"bd1d6538-d42a-4e3f-9424-948d4a8949fe"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.719180143055609*^9, {3.7191803061819396`*^9, 3.7191803093571215`*^9}, 
   3.719275322900585*^9, 3.7252118495064116`*^9, 3.726006349734264*^9, 
   3.7260070878273478`*^9, 3.726247784369128*^9, 3.728338992489366*^9, 
   3.736200003254571*^9, 3.745620574244454*^9, 3.745640352924589*^9, 
   3.7456873781010385`*^9, 3.745690964592389*^9, 3.7458541004877157`*^9, 
   3.7458694668140583`*^9, 3.746118326608968*^9, 3.746368351091117*^9, 
   3.746460239794429*^9, 3.7464603008367863`*^9, {3.7469601717871428`*^9, 
   3.7469601740834513`*^9}, 3.7470575884842076`*^9, 3.7470593606553645`*^9, 
   3.7470606742990265`*^9, 3.749557473814934*^9, 3.753118054210923*^9, 
   3.753124497721923*^9, 3.756116367397667*^9, 3.756237613744094*^9, 
   3.756466970758513*^9, 3.76657554604876*^9, 3.766751825325519*^9, 
   3.76682809617318*^9, 3.7670112361054983`*^9, 3.767286478897257*^9, 
   3.767289431789711*^9, 3.767291379709796*^9, 3.767291647868293*^9, 
   3.767313193301786*^9, 3.7673634920048103`*^9, 3.7673679138005123`*^9, 
   3.7698620267992563`*^9, 3.770644175151127*^9, 3.770644401933263*^9, 
   3.772306045461174*^9, 3.776007791570219*^9, 3.7774003616697083`*^9, 
   3.777716202056287*^9, 3.778350257112856*^9, 3.778950570672058*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"86c78f2f-e077-4ffb-9988-e67fdf2f6823"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShiftingDataPointsMean", "[", 
  RowBox[{"myAllBlueNum", ",", "myOffset", ",", "10", ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7191800920226903`*^9, 3.7191801038313656`*^9}, {
  3.719180266734683*^9, 3.719180273886092*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"1796b896-ae10-4e06-ad2d-04806815503e"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.7191801046694136`*^9, {3.7191802686637936`*^9, 3.7191802742191114`*^9}, 
   3.7191811789278574`*^9, 3.719181244954634*^9, 3.719181406637882*^9, 
   3.7192753229105854`*^9, 3.7252118495220275`*^9, 3.72600634974986*^9, 
   3.7260070878429756`*^9, 3.726247784384755*^9, 3.728338992551738*^9, 
   3.736200003298065*^9, 3.7456205742802343`*^9, 3.745640352991301*^9, 
   3.7456873781166325`*^9, 3.745690964803339*^9, 3.7458541005538177`*^9, 
   3.745869466865551*^9, 3.746118326657343*^9, 3.746368351132181*^9, 
   3.7464602398466673`*^9, 3.7464603008861103`*^9, {3.7469601718027554`*^9, 
   3.7469601740990715`*^9}, 3.747057588499829*^9, 3.747059360686607*^9, 
   3.747060674314649*^9, 3.7495574738305225`*^9, 3.7531180542265453`*^9, 
   3.753124497737546*^9, 3.756116367450803*^9, 3.7562376137947683`*^9, 
   3.7564669708231783`*^9, 3.76657554613103*^9, 3.7667518256737537`*^9, 
   3.766828096256023*^9, 3.7670112362106256`*^9, 3.767286478981819*^9, 
   3.767289432020241*^9, 3.767291379781727*^9, 3.767291647969185*^9, 
   3.767313193398588*^9, 3.767363492249834*^9, 3.76736791394934*^9, 
   3.769862026932776*^9, 3.770644175266389*^9, 3.770644402059039*^9, 
   3.772306045542301*^9, 3.776007791648512*^9, 3.777400361767928*^9, 
   3.7777162021335077`*^9, 3.7783502572145452`*^9, 3.778950570741067*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"30443928-51f2-4128-83be-0752e609f883"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "-", 
       RowBox[{"Round", "@", 
        RowBox[{"Mean", "@", "#"}]}]}], ")"}], "+", "1"}], "&"}], "@", 
   RowBox[{"Round", "@", 
    RowBox[{"(", 
     RowBox[{"10", "*", "myOffset"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.719179582229532*^9, 3.7191795903429956`*^9}, {
  3.7191796645742416`*^9, 3.719179665504295*^9}, {3.7191801959186325`*^9, 
  3.7191801962156496`*^9}, {3.719180399238262*^9, 3.7191803998402967`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"f987b871-80ae-4e3f-a1e6-8c6803e22702"],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{"Round", "[", 
   RowBox[{"10", " ", "myOffset"}], "]"}], "-", 
  RowBox[{"Round", "[", 
   RowBox[{"Mean", "[", 
    RowBox[{"Round", "[", 
     RowBox[{"10", " ", "myOffset"}], "]"}], "]"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.719179587760848*^9, 3.71917959076902*^9}, 
   3.719179665886317*^9, 3.7191801966906767`*^9, 3.7191804002473197`*^9, 
   3.719275322919586*^9, 3.7252118495376215`*^9, 3.7260063497655153`*^9, 
   3.7260070878429756`*^9, 3.726247784384755*^9, 3.7283389926062393`*^9, 
   3.736200003381874*^9, 3.745620574334796*^9, 3.745640353039254*^9, 
   3.745687378132283*^9, 3.7456909650225697`*^9, 3.745854100621584*^9, 
   3.745869466931879*^9, 3.746118326707086*^9, 3.746368351181869*^9, 
   3.746460239900758*^9, 3.746460300935925*^9, {3.7469601718183594`*^9, 
   3.746960174114694*^9}, 3.747057588499829*^9, 3.7470593607022285`*^9, 
   3.7470606743302703`*^9, 3.7495574738305225`*^9, 3.753118054242199*^9, 
   3.7531244977844367`*^9, 3.756116367498448*^9, 3.756237613861005*^9, 
   3.756466970872776*^9, 3.76657554621235*^9, 3.766751826091177*^9, 
   3.766828096353676*^9, 3.767011236285325*^9, 3.767286479079185*^9, 
   3.7672894322403708`*^9, 3.767291379843109*^9, 3.767291648069682*^9, 
   3.767313193495719*^9, 3.767363492337679*^9, 3.767367914062825*^9, 
   3.769862027066536*^9, 3.77064417538414*^9, 3.770644402167122*^9, 
   3.772306045650926*^9, 3.7760077917028646`*^9, 3.777400361864357*^9, 
   3.777716202206551*^9, 3.778350257309814*^9, 3.778950570803384*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"133f708d-1a82-48d9-af42-47f9911a102e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"myData", "=", "myAllBlueNum"}], ";"}]], "Input",
 CellChangeTimes->{{3.719180438472506*^9, 3.719180459119687*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"0834d9fb-d15c-4436-b3f2-f5d1b1c86891"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myDataInterpolFunc", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Interpolation", "[", 
      RowBox[{"#", ",", 
       RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], "&"}], "/@", 
    "myData"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7191804712213793`*^9, 3.7191804737265224`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"a1185b1c-cd29-471c-9feb-3caada403169"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myDataInterpol", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Array", "[", 
      RowBox[{"#", ",", 
       RowBox[{"1", "+", 
        RowBox[{"10", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{
            "myData", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], "-", "1"}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "@", 
          RowBox[{
          "myData", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], "&"}], "/@", 
    "myDataInterpolFunc"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7191804803899035`*^9, 3.719180491302528*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"04a5f8d7-1018-4924-bd2a-f86b55ff02b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myStart", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"#", "-", 
       RowBox[{"Round", "@", 
        RowBox[{"Mean", "@", "#"}]}]}], ")"}], "+", "1"}], "&"}], "@", 
   RowBox[{"Round", "@", 
    RowBox[{"(", 
     RowBox[{"10", "*", "myOffset"}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7191805015741153`*^9, 3.7191805059663663`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"0a2fd8ac-1106-4e26-aa37-de5febab040f"],

Cell[BoxData[
 RowBox[{"1", "+", 
  RowBox[{"Round", "[", 
   RowBox[{"10", " ", "myOffset"}], "]"}], "-", 
  RowBox[{"Round", "[", 
   RowBox[{"Mean", "[", 
    RowBox[{"Round", "[", 
     RowBox[{"10", " ", "myOffset"}], "]"}], "]"}], "]"}]}]], "Output",
 CellChangeTimes->{{3.7191805019321356`*^9, 3.719180506498397*^9}, 
   3.7192753229485874`*^9, 3.7252118495688753`*^9, 3.7260063498436193`*^9, 
   3.7260070878742123`*^9, 3.726247784416008*^9, 3.72833899275616*^9, 
   3.7362000034779778`*^9, 3.745620574461401*^9, 3.7456403532236643`*^9, 
   3.7456873781791515`*^9, 3.7456909653543386`*^9, 3.7458541008028803`*^9, 
   3.745869467095934*^9, 3.746118326852355*^9, 3.7463683513332233`*^9, 
   3.746460240090251*^9, 3.746460301053913*^9, {3.7469601718652515`*^9, 
   3.74696017416158*^9}, 3.7470575885310717`*^9, 3.7470593607490916`*^9, 
   3.747060674345891*^9, 3.7495574738774157`*^9, 3.753118054273436*^9, 
   3.7531244978156524`*^9, 3.756116367610251*^9, 3.7562376139941053`*^9, 
   3.756466970941443*^9, 3.766575546338675*^9, 3.766751826468144*^9, 
   3.766828096487406*^9, 3.7670112363814173`*^9, 3.7672864792119637`*^9, 
   3.7672894323921747`*^9, 3.7672913800418863`*^9, 3.7672916481935787`*^9, 
   3.767313193644421*^9, 3.767363492484223*^9, 3.767367914230981*^9, 
   3.7698620274493227`*^9, 3.77064417554624*^9, 3.7706444022968903`*^9, 
   3.7723060458204327`*^9, 3.776007791832016*^9, 3.777400362005588*^9, 
   3.777716202374916*^9, 3.778350257740924*^9, 3.778950570882495*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"d3a54ae9-09e0-4de6-8bcc-aa43ac6cd15f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"myDataResample", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "myStart", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        "<", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{
           "myDataInterpol", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{
              RowBox[{"Abs", "@", 
               RowBox[{
               "myStart", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "+", "1"}]}], "]"}]}], "]"}], 
         ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"myDataInterpol", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{
          "myStart", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ";;"}]}], "\[RightDoubleBracket]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", "myDataInterpol"}], ",", "1"}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7191805189151073`*^9, 3.719180548408794*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"d0197ce1-6dd4-4904-86bb-47eb224d29db"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"myDataResample", "\[LeftDoubleBracket]", 
   RowBox[{"All", ",", 
    RowBox[{";;", "All", ";;", "10"}]}], "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.719180590590207*^9, 3.7191805950374613`*^9}, {
  3.7191806311665277`*^9, 3.719180647382455*^9}, {3.7191809433513837`*^9, 
  3.71918094433644*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"11d1a37c-326a-4a18-9a41-ec472ac4fce6"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.7191805953744802`*^9, {3.7191806317475605`*^9, 3.719180647763477*^9}, 
   3.719180944709461*^9, 3.7192753229645886`*^9, 3.725211849600129*^9, 
   3.7260063498592725`*^9, 3.726007087905453*^9, 3.726247784431635*^9, 
   3.728338992839879*^9, 3.736200003536768*^9, 3.745620574510653*^9, 
   3.745640353406433*^9, 3.745687378210391*^9, 3.745690965657482*^9, 
   3.745854100915267*^9, 3.745869467214436*^9, 3.746118326907565*^9, 
   3.746368351414913*^9, 3.746460240139345*^9, 3.746460301137061*^9, {
   3.746960171896496*^9, 3.74696017419283*^9}, 3.7470575885623436`*^9, 
   3.7470593607959557`*^9, 3.747060674361512*^9, 3.749557473893008*^9, 
   3.7531180543203025`*^9, 3.753124497846925*^9, 3.7561163676801653`*^9, 
   3.756237614724886*^9, 3.756466971010027*^9, 3.766575546427216*^9, 
   3.766751826888214*^9, 3.7668280965807667`*^9, 3.767011236501833*^9, 
   3.767286479321067*^9, 3.767289432524386*^9, 3.7672913801474133`*^9, 
   3.76729164832066*^9, 3.767313193798411*^9, 3.767363492569736*^9, 
   3.7673679143653812`*^9, 3.769862027654887*^9, 3.7706441756766853`*^9, 
   3.77064440243292*^9, 3.772306045950704*^9, 3.776007791933436*^9, 
   3.77740036211656*^9, 3.777716202550758*^9, 3.7783502578815002`*^9, 
   3.778950570972329*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"d11676ce-9848-4769-9f90-2f40625074f9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myFillSize", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Max", "@", "#"}], "-", "#"}], "&"}], "@", 
   RowBox[{"(", 
    RowBox[{"Length", "/@", "test"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.7191809637905526`*^9, 3.7191809659096737`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"0b91f865-10d7-4725-bc74-cc89c66e4048"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.7191809663016963`*^9, 3.7192753229725895`*^9, 3.725211849600129*^9, 
   3.726006349874901*^9, 3.726007087905453*^9, 3.726247784431635*^9, 
   3.728338992888412*^9, 3.73620000358176*^9, 3.745620574547423*^9, 
   3.745640353456942*^9, 3.7456873782260103`*^9, 3.74569096587051*^9, 
   3.745854100972188*^9, 3.74586946728242*^9, 3.74611832693771*^9, 
   3.746368351482728*^9, 3.7464602401784143`*^9, 3.746460301186686*^9, {
   3.7469601719120893`*^9, 3.746960174208421*^9}, 3.7470575885623436`*^9, 
   3.747059360811578*^9, 3.7470606743771334`*^9, 3.74955747392428*^9, 
   3.7531180543203025`*^9, 3.753124497846925*^9, 3.756116367733719*^9, 
   3.7562376149422617`*^9, 3.756466971073748*^9, 3.766575546486051*^9, 
   3.7667518272244883`*^9, 3.766828096699567*^9, 3.767011236607152*^9, 
   3.767286479404825*^9, 3.767289432641433*^9, 3.7672913802317953`*^9, 
   3.767291648437303*^9, 3.767313193918482*^9, 3.767363492641821*^9, 
   3.767367914484692*^9, 3.769862027854802*^9, 3.770644175800643*^9, 
   3.7706444025578213`*^9, 3.772306046028008*^9, 3.7760077919868927`*^9, 
   3.7774003622847757`*^9, 3.777716202710676*^9, 3.778350258000252*^9, 
   3.778950571039447*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"5dc07fc5-c24d-46a2-b849-632316292536"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myDataResample", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "test", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "}"}], ",", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{
          "myFillSize", "\[LeftDoubleBracket]", "i", 
           "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], ",", "1"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "@", "test"}], ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.719180990174062*^9, 3.719181003766839*^9}, {
  3.7191811294150257`*^9, 3.7191811316221523`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"60a91ba6-2690-4121-a9db-47cf2f9f8a95"],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.7191810043928747`*^9, 3.719181132144182*^9, 3.7192753229815893`*^9, 
   3.7252118496157556`*^9, 3.726006349890498*^9, 3.7260070879211035`*^9, 
   3.726247784447261*^9, 3.728338992938911*^9, 3.7362000036327887`*^9, 
   3.7456205746520767`*^9, 3.745640353502809*^9, 3.7456873782416315`*^9, 
   3.745690966089075*^9, 3.74585410103689*^9, 3.745869467348103*^9, 
   3.746118326990377*^9, 3.746368351533526*^9, 3.746460240228816*^9, 
   3.74646030123709*^9, {3.7469601719277077`*^9, 3.746960174224042*^9}, 
   3.7470575885779667`*^9, 3.747059360811578*^9, 3.747060674408382*^9, 
   3.74955747392428*^9, 3.753118054351543*^9, 3.7531244978625298`*^9, 
   3.756116367781649*^9, 3.7562376150251083`*^9, 3.7564669711397133`*^9, 
   3.766575546565319*^9, 3.7667518276078587`*^9, 3.766828096790447*^9, 
   3.767011236725171*^9, 3.76728647948742*^9, 3.767289432757269*^9, 
   3.767291380317336*^9, 3.7672916485539083`*^9, 3.767313194015554*^9, 
   3.7673634927291517`*^9, 3.767367914599737*^9, 3.769862028056961*^9, 
   3.7706441759131393`*^9, 3.770644402772463*^9, 3.772306046109076*^9, 
   3.776007792055029*^9, 3.777400362684556*^9, 3.7777162029569197`*^9, 
   3.778350258105091*^9, 3.7789505711066732`*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"ff4f9973-4bc7-42da-96b8-1fb4cf0ee6b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ConstantArray", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ","}], "]"}]], "Input",
 CellChangeTimes->{{3.7191810874156237`*^9, 3.7191810930729475`*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"3667e09e-d1b4-417f-93f9-ad54707e79ef"],

Cell[BoxData[
 TemplateBox[{
  "ConstantArray","ilsmn",
   "\"Single or list of non-negative machine-sized integers expected at \
position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \
\\!\\(\\*RowBox[{\\\"ConstantArray\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
\\\"}\\\"}], \\\",\\\", \\\"Null\\\"}], \\\"]\\\"}]\\).\"",2,72,1,
   24917679018144896077,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.719275323011591*^9, 3.725211849647009*^9, 3.7260063499061527`*^9, 
   3.7260070879211035`*^9, 3.7262477844785147`*^9, 3.728338992986616*^9, 
   3.7362000036846333`*^9, 3.745620574699279*^9, 3.745640353556386*^9, 
   3.7456873782572517`*^9, 3.74569096632825*^9, 3.745854101151834*^9, 
   3.745869467411209*^9, 3.746118327038941*^9, 3.7463683515810223`*^9, 
   3.746460240277898*^9, 3.746460301284185*^9, {3.746960171990221*^9, 
   3.746960174224042*^9}, 3.7470575885935574`*^9, 3.7470593608428197`*^9, 
   3.747060674408382*^9, 3.749557473986769*^9, 3.753118054382786*^9, 
   3.75312449787814*^9, 3.756116367861102*^9, 3.756237615115184*^9, 
   3.756466971191866*^9, 3.766575546645941*^9, 3.766751827954184*^9, 
   3.766828096881035*^9, 3.7670112369395638`*^9, 3.7672864795686913`*^9, 
   3.767289432872527*^9, 3.767291380462735*^9, 3.7672916488210783`*^9, 
   3.767313194111906*^9, 3.767363492802207*^9, 3.767367914765903*^9, 
   3.769862028236608*^9, 3.770644176032722*^9, 3.770644402967527*^9, 
   3.772306046188452*^9, 3.7760077921319942`*^9, 3.777400363383391*^9, 
   3.777716203141399*^9, 3.778350258218224*^9, 3.778950571173223*^9},
 CellLabel->
  "During evaluation of \
In[72]:=",ExpressionUUID->"5d759a2c-a1fd-46aa-be53-239708154690"],

Cell[BoxData[
 RowBox[{"ConstantArray", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", "Null"}], "]"}]], "Output",
 CellChangeTimes->{
  3.7192753230305924`*^9, 3.725211849647009*^9, 3.7260063499061527`*^9, 
   3.7260070879211035`*^9, 3.7262477844785147`*^9, 3.728338993000333*^9, 
   3.7362000036961927`*^9, 3.745620574714101*^9, 3.745640353571281*^9, 
   3.7456873782572517`*^9, 3.745690966338451*^9, 3.7458541011665573`*^9, 
   3.745869467426255*^9, 3.746118327050578*^9, 3.746368351592461*^9, 
   3.746460240290688*^9, 3.746460301295782*^9, {3.746960171990221*^9, 
   3.746960174224042*^9}, 3.7470575885935574`*^9, 3.7470593608428197`*^9, 
   3.747060674408382*^9, 3.749557473986769*^9, 3.753118054382786*^9, 
   3.75312449787814*^9, 3.756116367873333*^9, 3.7562376151260653`*^9, 
   3.7564669712025146`*^9, 3.766575546660413*^9, 3.766751827965795*^9, 
   3.766828096895114*^9, 3.767011236955143*^9, 3.767286479583088*^9, 
   3.767289432889263*^9, 3.767291380478056*^9, 3.767291648834526*^9, 
   3.767313194125938*^9, 3.767363492816634*^9, 3.767367914776456*^9, 
   3.769862028256521*^9, 3.770644176044957*^9, 3.77064440297959*^9, 
   3.772306046204256*^9, 3.7760077921461687`*^9, 3.777400363395871*^9, 
   3.7777162031515913`*^9, 3.778350258231948*^9, 3.778950571190213*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"d31b9b0d-5e24-4aad-a154-8246ef9471e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"test", "\[LeftDoubleBracket]", "10", "\[RightDoubleBracket]"}],
       "}"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{
       "myFillSize", "\[LeftDoubleBracket]", "10", 
        "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.719181021471852*^9, 3.719181039160864*^9}, {
  3.719181108247815*^9, 3.7191811206005216`*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"86f83144-0603-4806-9225-be745e61f51b"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"10\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \\\
\"}\\\"}]\\) does not exist.\"",2,73,2,24917679018144896077,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.719275323051594*^9, 3.725211849662652*^9, 3.726006349921779*^9, 
   3.7260070879367075`*^9, 3.7262477844941416`*^9, 3.7283389930531273`*^9, 
   3.7362000037453613`*^9, 3.745620574766884*^9, 3.7456403536191177`*^9, 
   3.7456873782728467`*^9, 3.7456909665577183`*^9, 3.745854101247531*^9, 
   3.745869467495902*^9, 3.746118327105432*^9, 3.7463683516305447`*^9, 
   3.74646024034455*^9, 3.746460301350342*^9, {3.7469601720214357`*^9, 
   3.746960174239662*^9}, 3.7470575885935574`*^9, 3.747059360858442*^9, 
   3.747060674423997*^9, 3.7495574740023594`*^9, 3.75311805439841*^9, 
   3.75312449789376*^9, 3.756116367915468*^9, 3.756237615209784*^9, 
   3.756466971273246*^9, 3.7665755467269917`*^9, 3.766751828324357*^9, 
   3.766828096979422*^9, 3.767011237041915*^9, 3.767286479669848*^9, 
   3.767289433008812*^9, 3.767291380612379*^9, 3.767291649286881*^9, 
   3.7673131942122393`*^9, 3.767363492884243*^9, 3.767367914883391*^9, 
   3.769862028457325*^9, 3.770644176166995*^9, 3.770644403092269*^9, 
   3.7723060462771482`*^9, 3.776007792214562*^9, 3.7774003660853853`*^9, 
   3.777716203243044*^9, 3.778350258350892*^9, 3.778950571261675*^9},
 CellLabel->
  "During evaluation of \
In[73]:=",ExpressionUUID->"621ca8b2-30b7-414a-89f5-2e8e012fca64"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"10\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \\\
\"}\\\"}]\\) does not exist.\"",2,73,3,24917679018144896077,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.719275323051594*^9, 3.725211849662652*^9, 3.726006349921779*^9, 
   3.7260070879367075`*^9, 3.7262477844941416`*^9, 3.7283389930531273`*^9, 
   3.7362000037453613`*^9, 3.745620574766884*^9, 3.7456403536191177`*^9, 
   3.7456873782728467`*^9, 3.7456909665577183`*^9, 3.745854101247531*^9, 
   3.745869467495902*^9, 3.746118327105432*^9, 3.7463683516305447`*^9, 
   3.74646024034455*^9, 3.746460301350342*^9, {3.7469601720214357`*^9, 
   3.746960174239662*^9}, 3.7470575885935574`*^9, 3.747059360858442*^9, 
   3.747060674423997*^9, 3.7495574740023594`*^9, 3.75311805439841*^9, 
   3.75312449789376*^9, 3.756116367915468*^9, 3.756237615209784*^9, 
   3.756466971273246*^9, 3.7665755467269917`*^9, 3.766751828324357*^9, 
   3.766828096979422*^9, 3.767011237041915*^9, 3.767286479669848*^9, 
   3.767289433008812*^9, 3.767291380612379*^9, 3.767291649286881*^9, 
   3.7673131942122393`*^9, 3.767363492884243*^9, 3.767367914883391*^9, 
   3.769862028457325*^9, 3.770644176166995*^9, 3.770644403092269*^9, 
   3.7723060462771482`*^9, 3.776007792214562*^9, 3.7774003660853853`*^9, 
   3.777716203243044*^9, 3.778350258350892*^9, 3.77895057127426*^9},
 CellLabel->
  "During evaluation of \
In[73]:=",ExpressionUUID->"76b8e4f6-b8cb-4f07-bdf9-591cd1d0b813"],

Cell[BoxData[
 TemplateBox[{
  "ConstantArray","ilsmn",
   "\"Single or list of non-negative machine-sized integers expected at \
position \\!\\(\\*RowBox[{\\\"2\\\"}]\\) of \
\\!\\(\\*RowBox[{\\\"ConstantArray\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
\\\"}\\\"}], \\\",\\\", RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"10\\\", \\\"\[RightDoubleBracket]\\\"}]}], \
\\\"]\\\"}]\\).\"",2,73,4,24917679018144896077,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.719275323051594*^9, 3.725211849662652*^9, 3.726006349921779*^9, 
   3.7260070879367075`*^9, 3.7262477844941416`*^9, 3.7283389930531273`*^9, 
   3.7362000037453613`*^9, 3.745620574766884*^9, 3.7456403536191177`*^9, 
   3.7456873782728467`*^9, 3.7456909665577183`*^9, 3.745854101247531*^9, 
   3.745869467495902*^9, 3.746118327105432*^9, 3.7463683516305447`*^9, 
   3.74646024034455*^9, 3.746460301350342*^9, {3.7469601720214357`*^9, 
   3.746960174239662*^9}, 3.7470575885935574`*^9, 3.747059360858442*^9, 
   3.747060674423997*^9, 3.7495574740023594`*^9, 3.75311805439841*^9, 
   3.75312449789376*^9, 3.756116367915468*^9, 3.756237615209784*^9, 
   3.756466971273246*^9, 3.7665755467269917`*^9, 3.766751828324357*^9, 
   3.766828096979422*^9, 3.767011237041915*^9, 3.767286479669848*^9, 
   3.767289433008812*^9, 3.767291380612379*^9, 3.767291649286881*^9, 
   3.7673131942122393`*^9, 3.767363492884243*^9, 3.767367914883391*^9, 
   3.769862028457325*^9, 3.770644176166995*^9, 3.770644403092269*^9, 
   3.7723060462771482`*^9, 3.776007792214562*^9, 3.7774003660853853`*^9, 
   3.777716203243044*^9, 3.778350258350892*^9, 3.7789505712816267`*^9},
 CellLabel->
  "During evaluation of \
In[73]:=",ExpressionUUID->"aa637914-95a4-41f3-a2b3-963c64309282"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "10", 
    "\[RightDoubleBracket]"}], ",", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "10", 
      "\[RightDoubleBracket]"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7191810396638927`*^9, {3.7191811113849945`*^9, 3.719181121031546*^9}, 
   3.7192753231005964`*^9, 3.7252118496782618`*^9, 3.726006349921779*^9, 
   3.7260070879367075`*^9, 3.7262477844941416`*^9, 3.72833899310808*^9, 
   3.7362000037755213`*^9, 3.745620574793692*^9, 3.745640353647273*^9, 
   3.745687378288494*^9, 3.745690966582155*^9, 3.745854101279737*^9, 
   3.745869467563044*^9, 3.746118327130233*^9, 3.746368351678739*^9, 
   3.746460240372416*^9, 3.746460301376113*^9, {3.7469601720214357`*^9, 
   3.746960174239662*^9}, 3.7470575886091795`*^9, 3.747059360858442*^9, 
   3.747060674439622*^9, 3.749557474017988*^9, 3.753118054414034*^9, 
   3.75312449789376*^9, 3.7561163679414*^9, 3.756237615232829*^9, 
   3.756466971298394*^9, 3.766575546757132*^9, 3.7667518283487673`*^9, 
   3.7668280970102*^9, 3.76701123707929*^9, 3.7672864797002907`*^9, 
   3.7672894330413113`*^9, 3.767291380642653*^9, 3.767291649311215*^9, 
   3.767313194242585*^9, 3.76736349291614*^9, 3.7673679149057302`*^9, 
   3.7698620285008993`*^9, 3.77064417619243*^9, 3.770644403116234*^9, 
   3.772306046311112*^9, 3.776007792245345*^9, 3.777400366118969*^9, 
   3.777716203264113*^9, 3.7783502583778753`*^9, 3.778950571289283*^9},
 CellLabel->"Out[73]=",ExpressionUUID->"62ed3d95-b80f-4517-9190-c8f23bcacfe9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myDataResample", "\[LeftDoubleBracket]", "10", 
  "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.719180521905278*^9, 3.7191805658947945`*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"b0c8e533-83a9-4c59-affd-870861592960"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"10\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \\\
\"}\\\"}]\\) does not exist.\"",2,74,5,24917679018144896077,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7192753231095967`*^9, 3.7252118496782618`*^9, 3.7260063499374027`*^9, 
   3.7260070879523573`*^9, 3.7262477845097694`*^9, 3.728338993186907*^9, 
   3.736200003857588*^9, 3.745620574831542*^9, 3.745640353706699*^9, 
   3.745687378304113*^9, 3.745690966803678*^9, 3.745854101334794*^9, 
   3.745869467627819*^9, 3.746118327170274*^9, 3.74636835173044*^9, 
   3.746460240411277*^9, 3.7464603014336653`*^9, {3.7469601720214357`*^9, 
   3.746960174255285*^9}, 3.7470575886091795`*^9, 3.747059360874062*^9, 
   3.747060674455242*^9, 3.749557474033637*^9, 3.753118054414034*^9, 
   3.7531244979093804`*^9, 3.7561163679751062`*^9, 3.756237615375411*^9, 
   3.756466971374776*^9, 3.76657554682962*^9, 3.766751828687779*^9, 
   3.766828097091898*^9, 3.767011237171554*^9, 3.767286479781527*^9, 
   3.767289433254506*^9, 3.7672913808498087`*^9, 3.767291649468981*^9, 
   3.767313194326262*^9, 3.767363492981385*^9, 3.767367915097062*^9, 
   3.7698620287284946`*^9, 3.770644176380327*^9, 3.770644403220935*^9, 
   3.772306046388445*^9, 3.776007792307571*^9, 3.777400366551276*^9, 
   3.7777162033717337`*^9, 3.778350258496832*^9, 3.7789505713500547`*^9},
 CellLabel->
  "During evaluation of \
In[74]:=",ExpressionUUID->"dedf4cc3-cf1d-4954-abcf-d1fd70f96bea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", "}"}], "\[LeftDoubleBracket]", "10", 
  "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{{3.7191805337029533`*^9, 3.719180578008487*^9}, 
   3.719275323125598*^9, 3.7252118496782618`*^9, 3.7260063499374027`*^9, 
   3.7260070879523573`*^9, 3.7262477845097694`*^9, 3.728338993200878*^9, 
   3.736200003873865*^9, 3.745620574844439*^9, 3.745640353721243*^9, 
   3.745687378304113*^9, 3.745690966814579*^9, 3.7458541013498287`*^9, 
   3.745869467642983*^9, 3.7461183271812267`*^9, 3.7463683517431*^9, 
   3.746460240423414*^9, 3.746460301445447*^9, {3.746960172037056*^9, 
   3.746960174255285*^9}, 3.747057588624838*^9, 3.747059360874062*^9, 
   3.747060674455242*^9, 3.749557474033637*^9, 3.753118054414034*^9, 
   3.7531244979093804`*^9, 3.756116367986932*^9, 3.756237615386787*^9, 
   3.756466971391405*^9, 3.76657554684586*^9, 3.766751828699856*^9, 
   3.7668280971066837`*^9, 3.76701123718853*^9, 3.767286479796699*^9, 
   3.767289433266324*^9, 3.767291380861067*^9, 3.767291649481934*^9, 
   3.7673131943402348`*^9, 3.767363492995932*^9, 3.767367915108946*^9, 
   3.769862028771256*^9, 3.770644176392578*^9, 3.770644403236908*^9, 
   3.7723060464050407`*^9, 3.776007792322411*^9, 3.7774003665658503`*^9, 
   3.777716203388171*^9, 3.7783502585102654`*^9, 3.7789505713652*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"a48cde0b-3d38-42a8-9cca-b2d36cc223be"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Analysis", "Section",
 CellChangeTimes->{{3.6483041433283873`*^9, 
  3.6483041519288793`*^9}},ExpressionUUID->"860d800a-0d7e-4fc6-8216-\
3e73d1323d23"],

Cell[CellGroupData[{

Cell["Creating Transformation Function", "Subsection",
 CellChangeTimes->{{3.6515232012801285`*^9, 
  3.6515232091525784`*^9}},ExpressionUUID->"10d8d7c0-839c-43b9-8f4f-\
73b4113bd9eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dirBeads", "=", 
   RowBox[{
    RowBox[{"DirectoryName", "[", "mymovie", "]"}], "<>", "\"\<Beads\>\""}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.6515233788132825`*^9, 3.651523475464811*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"e94eeece-631a-4ad9-b4ca-de1d66332ebc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myFiles", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.tif\>\"", ",", "dirBeads"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myBeadsImgs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Import", "@", 
      RowBox[{
      "myFiles", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "myFiles", "]"}], ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myDims", "=", 
   RowBox[{"ImageDimensions", "@", 
    RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
     RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ColorCombine", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
        RowBox[{"data", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
        RowBox[{"data", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"ConstantImage", "[", 
        RowBox[{"0", ",", "myDims"}], "]"}]}], "}"}], "]"}], "//", 
    "ImageAdjust"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{
    "\"\<Choose an image to calculate the transformation function and CLICK\>\
\"", ",", 
     RowBox[{"nRefImg", "=", "data"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"data", ",", "1", ",", 
     RowBox[{"Length", "[", "myFiles", "]"}], ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6472842488313336`*^9, 3.6472842802491302`*^9}, {
  3.6472843380484366`*^9, 3.6472843498251104`*^9}, {3.6472843849931216`*^9, 
  3.6472846989050765`*^9}, {3.6476199272898703`*^9, 3.6476200105786343`*^9}, {
  3.6476207275146403`*^9, 3.6476207335459857`*^9}, {3.6476207720271864`*^9, 
  3.647620795722542*^9}, {3.6484024981878595`*^9, 3.6484025788674746`*^9}, {
  3.648402631659494*^9, 3.648402640107977*^9}, {3.64840269085988*^9, 
  3.6484027018515086`*^9}, {3.6485688255122385`*^9, 3.648568839433035*^9}, {
  3.6515234645531864`*^9, 3.6515234936248493`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"ade421ea-6fa5-447e-8c07-65a464f32180"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRefBeadsRedImg", "=", 
   RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
    RowBox[{"nRefImg", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myRefBeadsGreenImg", "=", 
   RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
    RowBox[{"nRefImg", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"GraphicsRow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myRefBeadsRedImg", "//", 
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", "thresholdRed"}], "]"}], "&"}]}], ",", 
       RowBox[{"myRefBeadsGreenImg", "//", 
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", "thresholdGreen"}], "]"}], "&"}]}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Choose thresholds and CLICK\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thRed", "=", "thresholdRed"}], ",", 
       RowBox[{"thGreen", "=", "thresholdGreen"}]}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"thresholdRed", ",", "0.01", ",", "0.5", ",", "0.005"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"thresholdGreen", ",", "0.01", ",", "0.5", ",", "0.001"}], 
    "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.647284738342332*^9, 3.6472847566733804`*^9}, {
   3.6472870495625267`*^9, 3.6472870798832607`*^9}, {3.6476066050868835`*^9, 
   3.6476066416629763`*^9}, {3.647616071455329*^9, 3.6476160716063375`*^9}, {
   3.647620819450899*^9, 3.64762084254622*^9}, {3.648402606340046*^9, 
   3.6484026099952545`*^9}, {3.6484045377655168`*^9, 3.648404538013531*^9}, {
   3.648404585229232*^9, 3.648404587589367*^9}, {3.648568868680708*^9, 
   3.6485689240248733`*^9}, 3.648568962481073*^9, {3.65524317128572*^9, 
   3.6552431720297623`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"90bb152d-a5a5-44dd-8aa1-e9b4abfa9a3a"],

Cell[BoxData[
 TemplateBox[{
  "Binarize","imginv",
   "\"Expecting an image or graphics instead of \
\\!\\(\\*RowBox[{\\\"myRefBeadsRedImg\\\"}]\\).\"",2,139,31,
   24917679018144896077,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.778950838626896*^9},
 CellLabel->"",ExpressionUUID->"d99ffe17-c273-4545-aa31-dba8486c5f0a"],

Cell[BoxData[
 TemplateBox[{
  "Binarize","imginv",
   "\"Expecting an image or graphics instead of \
\\!\\(\\*RowBox[{\\\"myRefBeadsGreenImg\\\"}]\\).\"",2,139,32,
   24917679018144896077,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.778950838726569*^9},
 CellLabel->"",ExpressionUUID->"eb3001ff-a601-49cb-8a47-ee96f1291825"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7458931440165577`*^9, 
  3.745893146848906*^9}},ExpressionUUID->"76353c37-1165-40b4-8af1-\
268c6b899143"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRedPosGuess", "=", 
   RowBox[{
    RowBox[{"ComponentMeasurements", "[", 
     RowBox[{
      RowBox[{"ImageMultiply", "[", 
       RowBox[{"myRefBeadsRedImg", ",", 
        RowBox[{"Binarize", "[", 
         RowBox[{"myRefBeadsRedImg", ",", "thRed"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "\"\<IntensityCentroid\>\"", "}"}]}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myGreenPosGuess", "=", 
   RowBox[{
    RowBox[{"ComponentMeasurements", "[", 
     RowBox[{
      RowBox[{"ImageMultiply", "[", 
       RowBox[{"myRefBeadsGreenImg", ",", 
        RowBox[{"Binarize", "[", 
         RowBox[{"myRefBeadsGreenImg", ",", "thGreen"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "\"\<IntensityCentroid\>\"", "}"}]}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"StringForm", "[", 
  RowBox[{
  "\"\<   `` red particles and `` green particles were found.\>\"", ",", 
   RowBox[{"Length", "@", "myRedPosGuess"}], ",", 
   RowBox[{"Length", "@", "myGreenPosGuess"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6472871195535297`*^9, 3.6472871600828476`*^9}, {
  3.6472872536111975`*^9, 3.647287254323238*^9}, {3.647291607334216*^9, 
  3.647291611030427*^9}, {3.64760669330293*^9, 3.647606693582946*^9}, {
  3.647606739886594*^9, 3.6476068095835805`*^9}, {3.6476161035591655`*^9, 
  3.6476161113906136`*^9}, {3.647616714199092*^9, 3.64761671451111*^9}, {
  3.6476208578180933`*^9, 3.647620903682717*^9}, {3.648383804191662*^9, 
  3.648383913465254*^9}, {3.648384596706857*^9, 3.648384602902068*^9}, {
  3.648388533593933*^9, 3.648388542173948*^9}, {3.648388651943741*^9, 
  3.648388653191743*^9}, {3.6484031152761555`*^9, 3.648403123347617*^9}, {
  3.6485687322569046`*^9, 3.64856879756064*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"e74b475d-98df-4edd-ae39-344df8384cd1"],

Cell[BoxData[
 InterpretationBox["\<\"   \\!\\(\\*RowBox[{\\\"22\\\"}]\\) red particles and \
\\!\\(\\*RowBox[{\\\"21\\\"}]\\) green particles were found.\"\>",
  StringForm["   `` red particles and `` green particles were found.", 22, 21],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.648568985201372*^9, 3.6515235201513667`*^9, 3.653246218124297*^9, 
   3.6532527077294817`*^9, 3.6532552039882593`*^9, 3.653256957552557*^9, 
   3.6550425296257057`*^9, 3.6550575945573378`*^9, 3.655068691610053*^9, 
   3.655217274388502*^9, 3.655228553207613*^9, {3.6552432007644053`*^9, 
   3.6552432154442453`*^9}, 3.6553857869982815`*^9, 3.655646328235388*^9, 
   3.655820969340288*^9, 3.6559035980123777`*^9, 3.6563471108824816`*^9, 
   3.6563627214073524`*^9, 3.6573794707367115`*^9, 3.66351859333272*^9, 
   3.6655118560080605`*^9, 3.665946320648436*^9, 3.665946353678325*^9, 
   3.66594638978139*^9, 3.6659464553431396`*^9, {3.6670006452102585`*^9, 
   3.6670006780331354`*^9}, {3.6761452388342323`*^9, 3.676145321048935*^9}, 
   3.6761453609462166`*^9, 3.6761464958351283`*^9, 3.6783201265379095`*^9, 
   3.6948904851569242`*^9, 3.69489480001072*^9, 3.6948948690496683`*^9, 
   3.6950661244739184`*^9, 3.705513893111534*^9, 3.7156094320359945`*^9, 
   3.7456873201146727`*^9, 3.745687362807741*^9, 3.745893143104892*^9, {
   3.7458932142972527`*^9, 3.7458932359689093`*^9}, {3.746960254127122*^9, 
   3.7469602624063935`*^9}, 3.746960687847863*^9, 3.749557657209644*^9, 
   3.766575876856557*^9, {3.777716366252481*^9, 3.777716391388254*^9}},
 CellLabel->
  "Out[102]=",ExpressionUUID->"1d2d7eee-db6b-4bfd-9e50-6e527132462b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRedAbsPos", "=", 
   RowBox[{"BeadsFitting", "[", 
    RowBox[{"myRefBeadsRedImg", ",", "myRedPosGuess", ",", "7"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myGreenAbsPos", "=", 
   RowBox[{"BeadsFitting", "[", 
    RowBox[{"myRefBeadsGreenImg", ",", "myGreenPosGuess", ",", "7"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "myTfFuncError", ",", "myTfFunc", ",", "distanceRaw", ",", 
     "distanceCorrected"}], "}"}], "=", 
   RowBox[{"BeadsTransform", "[", 
    RowBox[{"myRedAbsPos", ",", "myGreenAbsPos", ",", "5"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"myTfFuncError", ",", "myTfFunc", ",", 
   RowBox[{
    RowBox[{"Insert", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"distanceRaw", ",", "distanceCorrected"}], "}"}], "//", 
       "Transpose"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "\"\<Distance Before Correction\>\"", ",", 
        "\"\<Distance After Correction\>\""}], "}"}], ",", "1"}], "]"}], "//",
     "TableForm"}]}], "}"}]}], "Input",
 CellChangeTimes->{{3.6472917775439515`*^9, 3.6472918674140916`*^9}, {
   3.6472919395192156`*^9, 3.6472921294710803`*^9}, {3.64729216005583*^9, 
   3.647292204343363*^9}, {3.64729223768727*^9, 3.6472922638717675`*^9}, {
   3.6472923420242376`*^9, 3.647292344791396*^9}, {3.647292377799284*^9, 
   3.647292382471551*^9}, {3.647292597439847*^9, 3.6472926420633993`*^9}, {
   3.6476167011113434`*^9, 3.6476168305597477`*^9}, 3.647619593401773*^9, {
   3.6476200713801117`*^9, 3.647620079346567*^9}, {3.647620137890916*^9, 
   3.6476201587781105`*^9}, {3.6476209285711403`*^9, 3.647620985123375*^9}, {
   3.647621041082576*^9, 3.647621051891194*^9}, {3.647710782554494*^9, 
   3.647710782794508*^9}, {3.648384062470116*^9, 3.6483840627509165`*^9}, {
   3.6483842823091035`*^9, 3.6483842897503166`*^9}, {3.64838861160007*^9, 
   3.6483886246104927`*^9}, {3.648389210430524*^9, 3.6483892208045425`*^9}, {
   3.6483912901037827`*^9, 3.6483913257040453`*^9}, {3.6483913568583*^9, 
   3.648391371119725*^9}, {3.648391426798223*^9, 3.648391471012701*^9}, {
   3.6483917247137585`*^9, 3.6483917651700726`*^9}, {3.6484010898193054`*^9, 
   3.6484011325947523`*^9}, {3.6484011932102194`*^9, 3.64840120301078*^9}, {
   3.6485690330251074`*^9, 3.648569059400616*^9}, {3.6485690926485176`*^9, 
   3.6485690984008465`*^9}, {3.6485691294816246`*^9, 3.648569207153067*^9}, {
   3.6485692641953297`*^9, 3.648569271000719*^9}, {3.6485693716974783`*^9, 
   3.648569381953065*^9}, {3.6515236902010927`*^9, 3.6515237054009624`*^9}, {
   3.651524094618224*^9, 3.6515240992494893`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"a4a77e60-f2c9-46b0-a765-5fc776066a8e"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*SuperscriptBox[\\\"0.001460547163686561`\\\", \
\\\"109.5`\\\"]\\) is too small to represent as a normalized machine number; \
precision may be lost.\"",2,103,15,24909589397500600085,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7665758794197493`*^9, 3.777716393113242*^9},
 CellLabel->
  "During evaluation of \
In[103]:=",ExpressionUUID->"0c046e53-e113-4903-98a0-cf55505d5833"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.14588700374343191`", ",", 
   RowBox[{"TransformationFunction", "[", 
    RowBox[{"(", 
     TagBox[GridBox[{
        {"1.0015303401102738`", 
         RowBox[{"-", "0.005357946087999945`"}], "1.6543413421246964`"},
        {"0.0033353072944265288`", "1.0027916110636983`", 
         RowBox[{"-", "1.1775312822213029`"}]},
        {"1.323003346904933`*^-6", 
         RowBox[{"-", "1.9703826566492245`*^-6"}], "1.`"}
       },
       AutoDelete->False,
       GridBoxDividers->{
        "Columns" -> {{False}}, "ColumnsIndexed" -> {-2 -> True}, 
         "Rows" -> {{False}}, "RowsIndexed" -> {-2 -> True}},
       GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
      #& ], ")"}], "]"}], ",", 
   TagBox[GridBox[{
      {"\<\"Distance Before Correction\"\>", "\<\"Distance After Correction\"\
\>"},
      {"1.3065416134819055`", "0.26835674512856245`"},
      {"1.1155156400010315`", "0.1692221624133739`"},
      {"1.1885301174747462`", "0.12356967468950308`"},
      {"1.1920922659529523`", "0.18413101663669218`"},
      {"0.8874955730195004`", "0.10667161795733948`"},
      {"1.4889763741118565`", "0.13740110129191127`"},
      {"1.3980619975393018`", "0.13889430490619734`"},
      {"0.926870986425446`", "0.11676989730108836`"},
      {"0.6729558322797179`", "0.09754159459910776`"},
      {"1.511029751677255`", "0.06534671381290429`"},
      {"0.48527009244537794`", "0.2149859856553303`"},
      {"0.8114386428603668`", "0.176469424633265`"},
      {"1.3639243367893439`", "0.13259154435325254`"},
      {"0.46905813130465585`", "0.11697159356685159`"},
      {"0.8991347190661686`", "0.15767611629116973`"},
      {"1.6277067215395529`", "0.08884002035002528`"},
      {"1.34893443428951`", "0.13735525531337855`"},
      {"1.7063816253418986`", "0.12189823288842265`"},
      {"1.751084515463526`", "0.12170314600182469`"},
      {"1.9351220645557416`", "0.24783058815759773`"},
      {"2.11636234691639`", "0.13940034266427206`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[2.0999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6635185995400753`*^9, 3.665511858304192*^9, 3.6659463234365954`*^9, 
   3.6659463606367235`*^9, 3.6659464052352743`*^9, 3.665946457019236*^9, 
   3.6670006489394712`*^9, 3.6670006805312786`*^9, 3.676145241122363*^9, {
   3.676145278987529*^9, 3.6761453621992884`*^9}, 3.676146497711236*^9, 
   3.6783201296460867`*^9, 3.6948949578997507`*^9, 3.6950661264430313`*^9, 
   3.7055138950846467`*^9, 3.7156094340631104`*^9, {3.745687322520357*^9, 
   3.7456873303779087`*^9}, {3.7456873650259886`*^9, 3.745687382693679*^9}, 
   3.7458932386249037`*^9, 3.746960264484029*^9, 3.746960690019199*^9, 
   3.749557660849393*^9, 3.766575880779931*^9, 3.7777163938615713`*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"0295189a-1112-4e9f-80b5-aef4123655e5"]
}, Closed]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DirectoryName", "[", "mymovie", "]"}], "<>", 
     "\"\<TransformationFunction.m\>\""}], ",", "myTfFunc"}], "]"}], 
  ";"}]], "Input",
 CellLabel->
  "In[107]:=",ExpressionUUID->"94080c6c-ecc1-4051-b372-9b32ce24b2c8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Checking Transformation Function", "Subsection",
 CellChangeTimes->{{3.6483887123676476`*^9, 
  3.6483887334296846`*^9}},ExpressionUUID->"eb1ec07a-65cd-4173-812e-\
08e5601c40f9"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ColorCombine", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
        RowBox[{"data", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
        RowBox[{"data", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"ConstantImage", "[", 
        RowBox[{"0", ",", "myDims"}], "]"}]}], "}"}], "]"}], "//", 
    "ImageAdjust"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{
    "\"\<Choose an image to check the transformation function and CLICK\>\"", 
     ",", 
     RowBox[{"nCheckImg", "=", "data"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"data", ",", "1", ",", 
     RowBox[{"Length", "[", "myFiles", "]"}], ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.648404118652545*^9, 3.648404125492936*^9}, {
  3.64856940301727*^9, 3.6485694140098987`*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"6caa1fc4-21e6-416e-b9d2-e4646cd9e831"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"myCheckBeadsRedImg", "=", 
   RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
    RowBox[{"nCheckImg", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myCheckBeadsGreenImg", "=", 
   RowBox[{"myBeadsImgs", "\[LeftDoubleBracket]", 
    RowBox[{"nCheckImg", ",", "2"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"GraphicsRow", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"myCheckBeadsRedImg", "//", 
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", "thresholdRed"}], "]"}], "&"}]}], ",", 
       RowBox[{"myCheckBeadsGreenImg", "//", 
        RowBox[{
         RowBox[{"Binarize", "[", 
          RowBox[{"#", ",", "thresholdGreen"}], "]"}], "&"}]}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{"\"\<Choose thresholds and CLICK\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"thcRed", "=", "thresholdRed"}], ",", 
       RowBox[{"thcGreen", "=", "thresholdGreen"}]}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"thresholdRed", ",", "0.01", ",", "0.5", ",", "0.005"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"thresholdGreen", ",", "0.01", ",", "0.3", ",", "0.005"}], 
    "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6483887532573195`*^9, 3.648388796801996*^9}, {
   3.648390090354471*^9, 3.6483900905260715`*^9}, {3.648401539475024*^9, 
   3.648401539675036*^9}, {3.648401584090576*^9, 3.648401584226584*^9}, {
   3.6484016287071285`*^9, 3.6484016531065235`*^9}, {3.648404129261152*^9, 
   3.648404129388159*^9}, {3.648404642357499*^9, 3.6484046502619514`*^9}, {
   3.6485694291687655`*^9, 3.648569447672824*^9}, 3.7252125981805935`*^9},
 CellLabel->
  "In[109]:=",ExpressionUUID->"47d7dd18-7c01-4b01-88c8-d387b204238e"],

Cell[BoxData[
 TemplateBox[{
  "Binarize","imginv",
   "\"Expecting an image or graphics instead of \
\\!\\(\\*RowBox[{\\\"myCheckBeadsRedImg\\\"}]\\).\"",2,139,29,
   24917679018144896077,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.778950838421446*^9},
 CellLabel->"",ExpressionUUID->"c919cbee-7ae4-4039-9106-7c9c98f465b4"],

Cell[BoxData[
 TemplateBox[{
  "Binarize","imginv",
   "\"Expecting an image or graphics instead of \
\\!\\(\\*RowBox[{\\\"myCheckBeadsGreenImg\\\"}]\\).\"",2,139,30,
   24917679018144896077,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.778950838513426*^9},
 CellLabel->"",ExpressionUUID->"5705c2ac-32a8-425e-948e-128bfe4b267f"],

Cell[BoxData[
 TemplateBox[{
  "Binarize","imginv",
   "\"Expecting an image or graphics instead of \
\\!\\(\\*RowBox[{\\\"myCheckBeadsRedImg\\\"}]\\).\"",2,345,90,
   24917679018144896077,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.778954502063995*^9},
 CellLabel->"",ExpressionUUID->"764a3274-0a87-4ba8-ba89-8d8a0d0988f0"],

Cell[BoxData[
 TemplateBox[{
  "Binarize","imginv",
   "\"Expecting an image or graphics instead of \
\\!\\(\\*RowBox[{\\\"myCheckBeadsGreenImg\\\"}]\\).\"",2,345,91,
   24917679018144896077,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7789545020877237`*^9},
 CellLabel->"",ExpressionUUID->"357e44f4-c765-486d-a48d-4c1147e88c1f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRedCheckPosGuess", "=", 
   RowBox[{
    RowBox[{"ComponentMeasurements", "[", 
     RowBox[{
      RowBox[{"ImageMultiply", "[", 
       RowBox[{"myCheckBeadsRedImg", ",", 
        RowBox[{"Binarize", "[", 
         RowBox[{"myCheckBeadsRedImg", ",", "thcRed"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", "\"\<IntensityCentroid\>\"", "}"}]}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myGreenCheckPosGuess", "=", 
   RowBox[{
    RowBox[{"ComponentMeasurements", "[", 
     RowBox[{
      RowBox[{"ImageMultiply", "[", 
       RowBox[{"myCheckBeadsGreenImg", ",", 
        RowBox[{"Binarize", "[", 
         RowBox[{"myCheckBeadsGreenImg", ",", "thcGreen"}], "]"}]}], "]"}], 
      ",", 
      RowBox[{"{", "\"\<IntensityCentroid\>\"", "}"}]}], "]"}], 
    "\[LeftDoubleBracket]", 
    RowBox[{"All", ",", "2", ",", "1"}], "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"StringForm", "[", 
  RowBox[{
  "\"\<   `` red particles and `` green particles were found.\>\"", ",", 
   RowBox[{"Length", "@", "myRedCheckPosGuess"}], ",", 
   RowBox[{"Length", "@", "myGreenCheckPosGuess"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.648388871717328*^9, 3.648388885414152*^9}, {
  3.648388936491642*^9, 3.648388950095866*^9}, {3.648390120868125*^9, 
  3.6483901256573334`*^9}, {3.6484015647394695`*^9, 3.6484015650184855`*^9}, {
  3.6484016700824947`*^9, 3.6484016702105017`*^9}, {3.64840316133979*^9, 
  3.6484031700442877`*^9}, {3.648569478513588*^9, 3.6485694871920843`*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"c4fa2874-5404-4379-a90f-1bc56c72c75a"],

Cell[BoxData[
 InterpretationBox["\<\"   \\!\\(\\*RowBox[{\\\"11\\\"}]\\) red particles and \
\\!\\(\\*RowBox[{\\\"12\\\"}]\\) green particles were found.\"\>",
  StringForm["   `` red particles and `` green particles were found.", 11, 12],
  Editable->False]], "Output",
 CellChangeTimes->{
  3.6485694876981134`*^9, 3.651523578047678*^9, 3.6522146179874964`*^9, 
   3.6783201839781947`*^9, 3.694895532823634*^9, 3.712937007844342*^9, 
   3.725212575349823*^9, {3.7252126130101366`*^9, 3.725212635684445*^9}, 
   3.736200343981908*^9, {3.736200411088559*^9, 3.736200431285804*^9}, {
   3.7456874120951447`*^9, 3.7456874274977674`*^9}, 3.7458932656489887`*^9, 
   3.745893312513974*^9, 3.7458933444776697`*^9, {3.746960295820396*^9, 
   3.7469603057868285`*^9}, {3.746960713060676*^9, 3.746960737664225*^9}, {
   3.749557671987419*^9, 3.7495577447516937`*^9}, 3.766575920577342*^9, 
   3.7777164306078863`*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"200cfa07-1008-4963-9e2b-12258305df6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRedCheckAbsPos", "=", 
   RowBox[{"BeadsFitting", "[", 
    RowBox[{"myCheckBeadsRedImg", ",", "myRedCheckPosGuess", ",", "7"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myGreenCheckAbsPos", "=", 
   RowBox[{"BeadsFitting", "[", 
    RowBox[{"myCheckBeadsGreenImg", ",", "myGreenCheckPosGuess", ",", "7"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BeadsCheck", "[", 
  RowBox[{"myRedCheckAbsPos", ",", "myGreenCheckAbsPos", ",", "5"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.648401215122473*^9, 3.648401263490239*^9}, {
  3.6484014630346527`*^9, 3.6484014855149384`*^9}, {3.648401597930368*^9, 
  3.6484016073389063`*^9}, {3.648569513968616*^9, 3.648569544265349*^9}, {
  3.651524125722003*^9, 3.6515241367216325`*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"ac664e94-458a-411c-aad7-36df24bf98e5"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*SuperscriptBox[\\\"0.0013694761434064606`\\\", \\\"109.5`\\\"]\
\\) is too small to represent as a normalized machine number; precision may \
be lost.\"",2,115,16,24909589397500600085,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766575922589863*^9, 3.777716432856303*^9},
 CellLabel->
  "During evaluation of \
In[115]:=",ExpressionUUID->"3fac17f0-4da3-4b19-95a1-5fb9e993323c"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*SuperscriptBox[\\\"0.0011679834515395168`\\\", \\\"109.5`\\\"]\
\\) is too small to represent as a normalized machine number; precision may \
be lost.\"",2,115,17,24909589397500600085,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766575922589863*^9, 3.7777164329486523`*^9},
 CellLabel->
  "During evaluation of \
In[115]:=",ExpressionUUID->"f1598ad7-dd50-4f36-a539-382b596af5a6"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*FractionBox[\\\"1.789683532878107`*^-307\\\", \
\\\"109.5`\\\"]\\) is too small to represent as a normalized machine number; \
precision may be lost.\"",2,115,18,24909589397500600085,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766575922589863*^9, 3.7777164330615883`*^9},
 CellLabel->
  "During evaluation of \
In[115]:=",ExpressionUUID->"df80a445-b7a3-48bd-9c1d-564c26e05633"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,115,19,24909589397500600085,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.766575922589863*^9, 3.777716433176928*^9},
 CellLabel->
  "During evaluation of \
In[115]:=",ExpressionUUID->"b0b2ad97-ed5c-4b9e-95cf-ff1139b9d440"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"Distance Before Correction\"\>", "\<\"Distance After \
Correction\"\>"},
    {"1.0694009169960246`", "0.21142071713645927`"},
    {"0.706499680962412`", "0.31071032268694865`"},
    {"0.4867207650613786`", "0.3604484240042812`"},
    {"1.0522907036131952`", "0.25267503442314593`"},
    {"0.14891197250979973`", "0.35972515238387825`"},
    {"1.1351549675185324`", "0.16009942706282249`"},
    {"0.640941720853355`", "0.18110781919964197`"},
    {"1.3620031347517003`", "0.33430632191397497`"},
    {"1.737768546821146`", "0.19566569711993193`"},
    {"1.3833056811759226`", "0.14708941744621512`"},
    {"1.5178582199702524`", "0.21589453650018772`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.766575923718411*^9, 3.777716433589967*^9},
 CellLabel->
  "Out[117]//TableForm=",ExpressionUUID->"d7d23d73-3727-455a-af17-\
f43f5e7a824e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Reading in Images ",
 FontColor->RGBColor[0, 0, 1]]], "Subsection",
 CellChangeTimes->{{3.5831236302316623`*^9, 3.5831236326916656`*^9}, {
   3.6097111426870265`*^9, 3.6097111439581537`*^9}, {3.6422513183492937`*^9, 
   3.642251333965187*^9}, {3.6783136569918723`*^9, 3.6783136621191654`*^9}, 
   3.678316094481289*^9},ExpressionUUID->"9941b58d-7e7c-4224-a1e8-\
6b4033eb2f0d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"FileNameSetter", "[", 
    RowBox[{"Dynamic", "[", "mymovie", "]"}], "]"}], ",", 
   RowBox[{"Dynamic", "[", "mymovie", "]"}]}], "}"}]], "Input",
 CellChangeTimes->{{3.651503548625061*^9, 3.651503549729124*^9}, {
  3.6515036971455555`*^9, 3.6515037273852854`*^9}, {3.6515038052497387`*^9, 
  3.651503807864888*^9}, {3.6515048066830177`*^9, 3.6515048169146028`*^9}, {
  3.6515052946509275`*^9, 3.651505295114954*^9}, {3.6515053260127215`*^9, 
  3.651505326890772*^9}, {3.651521020023368*^9, 3.651521093823589*^9}, {
  3.745887055217946*^9, 3.745887056933818*^9}},
 CellLabel->
  "In[8503]:=",ExpressionUUID->"badab3d9-cd4b-4486-9e38-fd300449e881"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TemplateBox[{Dynamic[$CellContext`mymovie],"Open",All},
    "FileNameSetterBoxes"], ",", 
   DynamicBox[ToBoxes[$CellContext`mymovie, StandardForm],
    ImageSizeCache->{252., {3., 7.}}]}], "}"}]], "Output",
 CellChangeTimes->{3.7800684926133137`*^9, 3.780074988134063*^9, 
  3.780077699513287*^9},
 CellLabel->
  "Out[8503]=",ExpressionUUID->"3df6dc1b-4e63-46b0-b19e-e75d54d05f89"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myColMovie0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Import", "[", "mymovie", "]"}], "//", 
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"#", ",", "3"}], "]"}], "&"}]}], "//", "Transpose"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"DirectoryQ", "@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"DirectoryName", "[", "mymovie", "]"}], "<>", 
        "\"\<Analysis/\>\""}], ")"}]}], "\[Equal]", "False"}], ",", 
    RowBox[{"CreateDirectory", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"DirectoryName", "[", "mymovie", "]"}], "<>", 
       "\"\<Analysis/\>\""}], ")"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"analysisFolder", "=", 
   RowBox[{
    RowBox[{"DirectoryName", "[", "mymovie", "]"}], "<>", "\"\<Analysis/\>\"",
     "<>", 
    RowBox[{"StringDrop", "[", 
     RowBox[{
      RowBox[{"StringDelete", "[", 
       RowBox[{"mymovie", ",", 
        RowBox[{"DirectoryName", "[", "mymovie", "]"}]}], "]"}], ",", 
      RowBox[{"-", "4"}]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.747057173207282*^9, 3.747057233927333*^9}, 
   3.7531183358398347`*^9, {3.756118210563323*^9, 3.7561182186881227`*^9}, {
   3.7800685026556063`*^9, 3.780068503481077*^9}},
 CellLabel->
  "In[8504]:=",ExpressionUUID->"b3d55916-828b-4ff0-b676-bd795db8647b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myColMovie", " ", "=", " ", "myColMovie0"}], ";"}]], "Input",
 CellChangeTimes->{{3.7531183470297184`*^9, 3.7531183771899996`*^9}, {
  3.756117273049182*^9, 3.756117281371438*^9}},
 CellLabel->
  "In[8507]:=",ExpressionUUID->"da1d0482-049f-45ff-bd35-3fb42eb0d629"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Reading in Parameters (if parameters exist)",
 FontColor->RGBColor[0, 0, 1]]], "Subsection",
 CellChangeTimes->{{3.678552493212551*^9, 3.6785525007159805`*^9}, {
  3.6786508024734793`*^9, 
  3.678650831977167*^9}},ExpressionUUID->"a63de3f6-2296-4fc9-b9c4-\
bc2f8e1b64bb"],

Cell[CellGroupData[{

Cell["basic parameters", "Subsubsection",
 CellChangeTimes->{{3.7165763190136595`*^9, 
  3.7165763212457867`*^9}},ExpressionUUID->"82ee28b9-fa8e-4173-a984-\
9746a0a66d60"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myTfFunc", "=", 
   RowBox[{"<<", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryName", "@", "mymovie"}], "<>", 
      "\"\<TransformationFunction.m\>\""}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7163145602459183`*^9, 3.7163146140289946`*^9}, 
   3.74568302520059*^9},
 CellLabel->
  "In[8171]:=",ExpressionUUID->"1aeeb6b5-7b77-43fe-a679-1117084e1168"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mymask", "=", 
   RowBox[{"Import", "@", 
    RowBox[{"(", 
     RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.714760381291838*^9, 3.7147604017140064`*^9}},
 CellLabel->
  "In[8172]:=",ExpressionUUID->"c77a89ae-8dfe-4ab4-a1b4-a6715c3743da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"avgFrameN", "=", 
   RowBox[{"<<", 
    RowBox[{"(", 
     RowBox[{"analysisFolder", "<>", "\"\<_avgFrameN.dat\>\""}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myMaxN", "=", 
   RowBox[{
    RowBox[{"Length", "@", 
     RowBox[{
     "myColMovie", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    "-", "avgFrameN", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myColMovieRunAv", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"avgFrameN", "\[Equal]", "1"}], ",", "myColMovie", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"MovingAverage", "[", 
        RowBox[{"#", ",", "avgFrameN"}], "]"}], "&"}], "/@", "myColMovie"}]}],
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.715368132861471*^9, 3.7153681554617643`*^9}, 
   3.716828019728117*^9, {3.7458541273120403`*^9, 3.74585413741486*^9}},
 CellLabel->
  "In[8173]:=",ExpressionUUID->"91ef6b2c-884e-4ca5-ab97-b198eaa863a4"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Make Mask ", "Subsection",
 CellChangeTimes->{{3.678650616049817*^9, 3.6786506203690643`*^9}, {
  3.678650695665371*^9, 
  3.678650698023505*^9}},ExpressionUUID->"6cd64787-d841-4250-be0b-\
e66ae3f124ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FileExistsQ", "[", 
      RowBox[{"analysisFolder", "<>", "\"\<_avg.tif\>\""}], "]"}], "\[Equal]",
      "True"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"avgImg", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"analysisFolder", "<>", "\"\<_avg.tif\>\""}], "]"}]}], ";"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"avgImg", "=", 
      RowBox[{"Mean", "/@", "myColMovie"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"analysisFolder", "<>", "\"\<_avg.tif\>\""}], ",", "avgImg"}], 
      "]"}]}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FileExistsQ", "[", 
      RowBox[{"analysisFolder", "<>", "\"\<_max.tif\>\""}], "]"}], "\[Equal]",
      "True"}], ",", "\[IndentingNewLine]", 
    RowBox[{"maxImg", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"analysisFolder", "<>", "\"\<_max.tif\>\""}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"maxImg", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ImageApply", "[", 
         RowBox[{"Max", ",", "#"}], "]"}], "&"}], "/@", "myColMovie"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{
       RowBox[{"analysisFolder", "<>", "\"\<_max.tif\>\""}], ",", "maxImg"}], 
      "]"}]}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7055111477125063`*^9, 3.7055111969763236`*^9}, {
  3.7058709149805884`*^9, 3.7058710723565903`*^9}, {3.7058711497490163`*^9, 
  3.705871156053377*^9}},
 CellLabel->
  "In[8177]:=",ExpressionUUID->"662f04b8-8194-46ed-a3e6-820436f2a674"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"maxImg", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
    "//", 
    RowBox[{
     RowBox[{"ImageAdjust", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"threshold1", ",", "threshold2"}], "}"}]}], "]"}], "&"}]}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"Button", "[", 
    RowBox[{
    "\"\<Choose threshold such that the shape of the cell can be visualized \
and CLICK\>\"", ",", 
     RowBox[{"thtemp", "=", 
      RowBox[{"{", 
       RowBox[{"threshold1", ",", "threshold2"}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"threshold1", ",", "0", ",", "0.2", ",", "0.001"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"threshold2", ",", "0.1"}], "}"}], ",", "0", ",", "0.2", ",", 
     "0.001"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6783132865946865`*^9, 3.6783132885147963`*^9}, {
   3.678313358820818*^9, 3.6783133636430936`*^9}, {3.6955748346476974`*^9, 
   3.6955748638173656`*^9}, {3.6955749357044773`*^9, 3.695574948016182*^9}, {
   3.6957650148163805`*^9, 3.6957650240079064`*^9}, {3.7055112034406934`*^9, 
   3.705511216979468*^9}, {3.705513699339451*^9, 3.705513724942915*^9}, {
   3.705513771595584*^9, 3.7055137717225904`*^9}, {3.715278915078506*^9, 
   3.715278915238515*^9}, {3.715609597615465*^9, 3.715609597765474*^9}, 
   3.7252130113655095`*^9, 3.7262685022778225`*^9, 3.728339337562832*^9, 
   3.736200983157465*^9, {3.746960806179348*^9, 3.746960806288908*^9}, {
   3.7669404565656023`*^9, 3.766940459657839*^9}},
 CellLabel->
  "In[8179]:=",ExpressionUUID->"d3e78193-2054-48a1-8a3a-42b463d4ab8a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.776008620628232*^9, 
  3.7777164475725803`*^9},ExpressionUUID->"59c8f760-559a-4c2e-a9cd-\
6b0b7372d607"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mymask", "=", 
   GraphicsBox[
    TagBox[RasterBox[CompressedData["
1:eJzt0s2uVVUQRWGwZdNX8C3s2rSL8QEgIrGDCZgY315UoiJc7vlZVWPWWuNL
zk52cho7c9TXL3559tMXT548efvlu8ez5799++bN89+//+rdyw+v3/786vXL
H797/evLVy/ffPPiz789+eL9T5IkSZIkSZIkSZIkSZIkSZIkSZIkSZIkSZIk
SZIkSZIkSZIkSZIkSZIkSZIkSZIkHezpQ+gPU6UHs3sCe7sovCewnyvDewLb
uLm8JzDe/e09gKkWtfcABlrZ3gOYZXl7D2CMmvb2n6CuvQeQrri9BxCso739
M3W19wDytLb3ALL0x/cAgjD57Z8Bqu8BRODq2z8Amd8DwLH57Q+D89ufRef3
AFB0/Kf2B9Hp/0avcCw6/Hv0DKeiu/+DHuJMdPV/0UsciY7+X/QWB6KTf4Ae
4zx08Q/RaxyHDv5/9B6HoXN/jF7kJHTrT6JHOQdd+gH0LKegOz+IHuYMdOWH
0cscgY78OfQ2B6ATfx69zvbowI+h99kcnfdx9EJbo+Negt5oX3TZC9Ez7Yru
ejF6qD3RVa9AT7Ujuuk16K02RCe9Dr3Wduig16L32gyd83r0YluhY96C3mwj
dMrb0Kttgw55I3q2bdAhb0Xvtgu6483o4fZAV7wDPd0W6Ij3oLfbAJ3wPvR6
89EF70OvNx9d8E70fNPR/e5GDzgcne9+9IKj0fFWoDecjG63BD3iYHS6JegR
56LLLULPOBYdbhl6yJnoauvQS85EV1uHXnImutpC9JQT0c1WoreciG62Er3l
QHSypegxB6KTLUWPORCdbCl6zHnoYmvRa85DF1uMnnMcOthi9JzT0L1Wo/ec
hu61Gr3nMHSu5ehBh6FzLUcPOgydazl60FnoWuvRi85C1ypATzoJ3aoCvekk
dKsK9KaT0K0q0JtOQreqQG86CJ2qBD3qIHSqEvSog9CpStCjDkKnKkGPOgid
qga96hx0qRr0qnPQpWrQq85Bl6pBrzoGHaoIPesYdKgi9Kxj0KGq0LtOQXeq
Qu86Bd2pCr3rFHSnKvSuU9CdqtC7TkF3qkLvOgXdqQw97BB0pjL0sEPQmcrQ
ww5BZypDDzsEnakMPewQdKYy9LBD0JnK0MMOQWeqQy87A12pDr3sDHSlOvSy
M9CV6tDLzkBXqkMvOwNdqQ697Ax0pTr0sjPQlQrR045ARypETzsCHakQPe0I
dKRC9LQj0JEK0dOOQEcqRE87Ah2pED3tCHSkSvS2E9CNKtHbTkA3qkRvOwHd
qBK97QR0o1L0uAPQiUrR4w5AJypFjzsAnagUPe4AdKJS9LgD0Ilq0evmowvV
otfNRxeqRa8bjw5UjJ43Hh2oGD1vPDpQNXrfdHSfavS+6eg+1eh909F9qtH7
hqPzlKMHDkfnKUcPHI7OU49eOBtdpx69cDQ6TgN64mh0nAb0xNHoOA3oiZPR
bVrQIwej07SgRw5Gp2lBj5yLLtODXjkXXaYHvXIuukwPeuVYdJgu9M6p6C5d
6J1T0V260Dunort0oXdORXfpQu+ciu7Shd45Fd2lC71zKDpLH3rpTHSVPvTS
megqfeilM9FV+tBLZ6Kr9KGXzkRX6UMvnYmu0oieOhIdpRE9dSQ6SiN66kh0
lEb01JHoKI3oqSPRURrRU0eio3Sit05EN+lEb52IbtKJ3joR3aQTvXUiukkn
eutIdJRG9NSR6Cid6K0T0U060Vsnopt0ordORDfpRG+diG7Sid46Ed2kFT12
IDpJK3rsQHSSVvTYiegmneitE9FNOtFbJ6KbtKLHDkQnaUWPHYhO0ooeOxCd
pBU9diA6SSt67EB0klb02IHoJL3otfPQRXrRa+ehi/Si185DF+lFr52HLtKL
XjsQnaQXvXYeukgveu08dJFe9Np56CK96LXz0EV60WvnoYv0otfOQxfpRa+d
hy7SjJ47Dh2kGT13HDpIM3ruOHSQZvTcceggzei589BFetFr56GL9KLXzkMX
6UWvnYcu0oteOw9dpBk9dxw6SDN67jh0kGb03HHoIM3ouePQQZrRc8ehgzSj
545DB2lGz52HLtKLXjsPXaQXvXYeukgveu1AdJJW9NiB6CSt6LET0U060Vsn
opt0ordORDfpRG8diY7SiJ46Eh2lET11JDpKI3rqTHSVPvTSmegqfeilM9FV
+tBLh6KztKGHDkVnaUMPnYru0oXeORXdpQu9cyq6Sxd651h0mCb0zLHoME3o
mXPRZXrQK+eiy/SgV85Fl+lBrxyMTtOCHjkYnaYFPXIyuk0HeuNodJwG9MTR
6DgN6Imz0XXq0QuHo/OUowcOR+cpRw+cju5Tjd43Hh2oFr1uPrpQLXrdAehE
pehxJ6AbVaK3nYBuVInedgQ6UiF62hnoSnXoZWegK9Whlx2CzlSGHnYKulMV
etcx6FBF6FnHoEPVoFcdhE5Vgh51ErpVBXrTUehYBehJR6FjFaAnnYWutR69
6DB0ruXoQYehcy1HDzoN3Ws1es9x6GCL0XOOQwdbjJ5zHrrYUvSYE9HNVqK3
nIhuthK95Uh0tIXoKUeioy1ETzkTXW0desmZ6Grr0EsORWdbhd5xKrrbKvSO
Y9HhFqFnHIsOtwa94mB0uiXoEQej0y1BjzgZ3W4FesPR6Hj3oxccjs53N3rA
4eh8d6MHnI7udyd6vvnogveh19sAnfAu9Hg7oBvegZ5uD3TF29HLbYLOeDN6
uE3QGW9GD7cLuuON6Nn2QZe8CT3aTuiWt6A32wod83r0Ypuhc16NHmw3dM8r
0XPthy56HXqtDdFJr0FvtSU66hXoqfZEV70YPdSm6KwXo4faFd31QvRM+6LL
XoZeaWN02kvQG22NjnsBeqK90XUfRQ+0O7rvI+h5jkLH/hi9iD7F/Kcz/+nM
fzrzH878pzP/6cx/OPOfzvyns/7hzH868x/O/Kcz/+HMfzjzn878hzP/6cx/
OuufzvzHM//prC/bH8/2+ovxJUmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmSJEmS
JEkq8Af0uRLF
      "], {{0, 512}, {512, 0}}, {0, 1},
      ColorFunction->GrayLevel],
     BoxForm`ImageTag["Bit", ColorSpace -> Automatic, Interleaving -> None],
     Selectable->False],
    DefaultBaseStyle->"ImageGraphics",
    ImageSizeRaw->{512, 512},
    PlotRange->{{0, 512}, {0, 512}}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"mymask", "//", "ImageDimensions"}], ")"}], " ", "\[Equal]", " ", 
  RowBox[{"{", 
   RowBox[{"512", ",", "512"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ",", "mymask"}], 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.695765046835212*^9, 3.6957650613840446`*^9}, {
   3.7055137992181635`*^9, 3.705513800518238*^9}, {3.7136419255917816`*^9, 
   3.713641926390827*^9}, {3.7152789467933197`*^9, 3.7152789476543694`*^9}, {
   3.7156096401608987`*^9, 3.7156096508625107`*^9}, {3.715638199950425*^9, 
   3.715638201410509*^9}, 3.7252128758351655`*^9, 3.7252130505101843`*^9, 
   3.72624929985633*^9, 3.726268538250348*^9, 3.728339377387267*^9, 
   3.7362009936807404`*^9, 3.736201025016438*^9, 3.745621114589943*^9, 
   3.7456874872493486`*^9, 3.7456908895110893`*^9, 3.74589352732777*^9, 
   3.746460613883065*^9, 3.7469609789198914`*^9, {3.7469709834997196`*^9, 
   3.74697101636721*^9}, 3.749558045290985*^9, 3.7531184849806414`*^9, 
   3.7561167810151987`*^9, 3.756131865140008*^9, 3.7561511908545017`*^9, 
   3.766778864472311*^9, 3.7669404845827303`*^9, 3.766950156186182*^9, 
   3.7706455677459917`*^9, 3.776008625175475*^9, 3.777716486603675*^9, 
   3.7800750366144457`*^9},
 CellLabel->
  "In[121]:=",ExpressionUUID->"1eb56e54-7682-4a2b-bdb8-6438471cc158"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.7469709884985394`*^9, 3.746971017241741*^9}, 
   3.7495580462594757`*^9, 3.7495582010000076`*^9, 3.7531184857148433`*^9, 
   3.756116782511545*^9, 3.756117309885975*^9, {3.756131839921267*^9, 
   3.756131866741757*^9}, 3.756151159700171*^9, 3.756151194483179*^9, 
   3.7667788681795588`*^9, 3.766940485942823*^9, {3.766950129336791*^9, 
   3.766950159284655*^9}, 3.770645569059595*^9, 3.776008625732408*^9, 
   3.777716487002164*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"cffe8e98-4459-4aaa-9df7-30d583394c0e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"mymask", "=", 
     RowBox[{"Image", "@", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", 
        RowBox[{"ImageDimensions", "@", "avgImg"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ",", "mymask"}], 
     "]"}], ";"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.69506642241996*^9, 3.6950664612671824`*^9}},
 CellLabel->
  "In[3766]:=",ExpressionUUID->"77637e42-ec40-45ba-885a-f72d58c695ab"]
}, Closed]],

Cell[CellGroupData[{

Cell["Running z-average  ", "Subsection",
 CellChangeTimes->{{3.642337220641624*^9, 3.642337230681198*^9}, {
   3.678313774559597*^9, 3.6783137753366413`*^9}, 3.6783160899130273`*^9, 
   3.728339149222464*^9},ExpressionUUID->"eae67b72-7777-48ff-a074-\
96457dba0921"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"avgFrameN", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"avgFrameN", ">>", 
   RowBox[{"analysisFolder", "<>", "\"\<_avgFrameN.dat\>\""}]}], ";", 
  RowBox[{"myMaxN", "=", 
   RowBox[{
    RowBox[{"Length", "@", 
     RowBox[{
     "myColMovie", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    "-", "avgFrameN", "+", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6423382732288284`*^9, 3.6423382777220855`*^9}, {
   3.642338308730859*^9, 3.6423383088428655`*^9}, {3.6423386993952036`*^9, 
   3.6423387003632593`*^9}, {3.6423387599876695`*^9, 3.642338760298687*^9}, {
   3.642338798179854*^9, 3.6423388086594534`*^9}, {3.6483102143678484`*^9, 
   3.6483102325378737`*^9}, {3.6515228854160624`*^9, 
   3.6515228856970778`*^9}, {3.678313684729459*^9, 3.6783136848644667`*^9}, {
   3.678313715858239*^9, 3.6783137159772463`*^9}, {3.678648513961624*^9, 
   3.6786485140406284`*^9}, {3.6786530916647177`*^9, 
   3.6786530917427177`*^9}, {3.6956781456757503`*^9, 
   3.6956781481148896`*^9}, {3.695678411442951*^9, 3.695678438243484*^9}, {
   3.6957538378230934`*^9, 3.695753838743146*^9}, {3.6957638950063314`*^9, 
   3.69576389515834*^9}, {3.7137100659231853`*^9, 3.713710086960389*^9}, 
   3.71689814039779*^9},
 CellLabel->
  "In[8180]:=",ExpressionUUID->"361e11ee-6ba0-460e-b781-c2310a313351"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myColMovieRunAv", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"avgFrameN", "\[Equal]", "1"}], ",", "myColMovie", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"MovingAverage", "[", 
        RowBox[{"#", ",", "avgFrameN"}], "]"}], "&"}], "/@", "myColMovie"}]}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6956781416385193`*^9, 3.695678158387477*^9}, {
   3.6956782375380044`*^9, 3.695678284475689*^9}, {3.695753807128338*^9, 
   3.695753821922184*^9}, {3.695763975719948*^9, 3.6957639916228576`*^9}, 
   3.7055139286475663`*^9, 3.7168280275835657`*^9},
 CellLabel->
  "In[8182]:=",ExpressionUUID->"ed5f0e19-7737-4f7b-b8b9-ee6391e1efe8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"myColMovieRunAv", "\[LeftDoubleBracket]", 
     RowBox[{"channel", ",", "frame"}], "\[RightDoubleBracket]"}], "//", 
    RowBox[{
     RowBox[{"ImageAdjust", "[", 
      RowBox[{"#", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "threshold"}], "}"}]}], "]"}], "&"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"channel", ",", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "myColMovieRunAv"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"frame", ",", "1", ",", "myMaxN", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"threshold", ",", "0", ",", "0.3", ",", "0.001"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6423394014173574`*^9, 3.6423395160839157`*^9}, {
   3.642339667932601*^9, 3.642339669964717*^9}, {3.642730012083584*^9, 
   3.6427300144273615`*^9}, {3.6440626622445326`*^9, 
   3.6440626650956955`*^9}, {3.648470544066861*^9, 3.6484705464579983`*^9}, {
   3.6484720136119146`*^9, 3.648472071787242*^9}, {3.6515229410892463`*^9, 
   3.6515229458695197`*^9}, 3.6806250245689616`*^9, 3.6833957314826455`*^9, {
   3.695066507491826*^9, 3.695066550452283*^9}, {3.6957640277119217`*^9, 
   3.6957640278319283`*^9}, 3.745687496591072*^9, 3.745854157921322*^9},
 CellLabel->
  "In[8183]:=",ExpressionUUID->"3592ebf2-dcdd-4012-b976-1780745bc7c6"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`channel$$ = 1, $CellContext`frame$$ = 
    1, $CellContext`threshold$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`channel$$], {1, 2, 3}}, {
      Hold[$CellContext`frame$$], 1, 20, 1}, {
      Hold[$CellContext`threshold$$], 0, 0.3, 0.001}}, Typeset`size$$ = {
    384., {190., 194.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`channel$871332$$ = 
    0, $CellContext`frame$871333$$ = 0, $CellContext`threshold$871334$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`channel$$ = 1, $CellContext`frame$$ = 
        1, $CellContext`threshold$$ = 0}, "ControllerVariables" :> {
        Hold[$CellContext`channel$$, $CellContext`channel$871332$$, 0], 
        Hold[$CellContext`frame$$, $CellContext`frame$871333$$, 0], 
        Hold[$CellContext`threshold$$, $CellContext`threshold$871334$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> (ImageAdjust[#, {0, 0, 1}, {0, $CellContext`threshold$$}]& )[
        Part[$CellContext`myColMovieRunAv, $CellContext`channel$$, \
$CellContext`frame$$]], 
      "Specifications" :> {{$CellContext`channel$$, {1, 2, 
         3}}, {$CellContext`frame$$, 1, 20, 1}, {$CellContext`threshold$$, 0, 
         0.3, 0.001}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{419., {248., 252.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.766778876635742*^9, 3.766940497226729*^9, 
  3.766950165872242*^9, 3.770645571968853*^9, 3.7760086337907057`*^9, 
  3.777716490608139*^9, 3.780075044254648*^9},
 CellLabel->
  "Out[8183]=",ExpressionUUID->"62cfef38-4a16-48a7-b010-a410d5dea319"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Setting Threshold", "Subsection",
 CellChangeTimes->{{3.7130439866561804`*^9, 
  3.71304400658432*^9}},ExpressionUUID->"2cc0d5a6-c198-4d08-b066-\
ecb68447ec5d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"FileExistsQ", "@", 
    RowBox[{"(", 
     RowBox[{"analysisFolder", "<>", "\"\<_mask.tif\>\""}], ")"}]}], ",", 
   "\"\<Mask File Exists\>\"", ",", "\"\<You Need to Make a Mask\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7131874135617304`*^9, 3.7131874792914896`*^9}, {
  3.713187512676399*^9, 3.7131875140914803`*^9}},
 CellLabel->
  "In[8184]:=",ExpressionUUID->"d6c1f599-511c-4902-80c1-a00cd460faf5"],

Cell[BoxData["\<\"Mask File Exists\"\>"], "Output",
 CellChangeTimes->{{3.7131874950963936`*^9, 3.713187514667513*^9}, 
   3.7132082611541443`*^9, 3.7132102731242228`*^9, 3.713641959744735*^9, 
   3.713657629588999*^9, 3.713723475188517*^9, 3.7152789771580567`*^9, 
   3.715638237957599*^9, 3.7157361010940504`*^9, 3.7162064614460206`*^9, 
   3.7165760978640103`*^9, 3.716667930716549*^9, 3.7456875412210035`*^9, 
   3.745690916473575*^9, 3.745894572974011*^9, 3.7464606306864853`*^9, 
   3.7469609840593057`*^9, 3.7469621697175236`*^9, 3.7495580591002436`*^9, 
   3.7495582054677153`*^9, 3.7531184938731966`*^9, 3.7561167924461117`*^9, 
   3.7561173823101873`*^9, 3.756131880707259*^9, 3.7561512004382887`*^9, 
   3.766778876747561*^9, 3.7669404973093224`*^9, 3.766950165939578*^9, 
   3.767286750880859*^9, 3.770645572049745*^9, 3.776008633871131*^9, 
   3.7777164906573553`*^9, 3.7789505874575243`*^9, 3.780075048774556*^9},
 CellLabel->
  "Out[8184]=",ExpressionUUID->"4d3bb348-ba59-4803-91eb-e9ac5f194cc7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"MyThresholding", "[", 
  RowBox[{"myColMovieRunAv", ",", "analysisFolder"}], "]"}]], "Input",
 CellChangeTimes->{{3.713115515893419*^9, 3.7131155268860474`*^9}, {
   3.713117412803916*^9, 3.713117414540015*^9}, 3.7166680862224436`*^9, 
   3.7168981514864235`*^9, {3.7667788817180653`*^9, 3.7667788830809183`*^9}},
 CellLabel->
  "In[8189]:=",ExpressionUUID->"1fbc2d76-0e7b-44fd-87d2-d232b7daf75c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Setting Threshold for Binarization", "Subsection",
 CellChangeTimes->{{3.7131099018533144`*^9, 3.7131099109658356`*^9}, {
  3.7131101185817103`*^9, 
  3.7131101194047575`*^9}},ExpressionUUID->"cad77bf7-d4ae-4257-bfa5-\
925ac7a27c63"],

Cell[BoxData[
 RowBox[{"MyBinarization", "[", 
  RowBox[{"myColMovieRunAv", ",", "analysisFolder"}], "]"}]], "Input",
 CellChangeTimes->{{3.7131188291479263`*^9, 3.713118859584667*^9}, {
   3.7131836841294193`*^9, 3.713183698416236*^9}, {3.713184199073872*^9, 
   3.7131841992168803`*^9}, {3.713184696506324*^9, 3.713184696665333*^9}, {
   3.713187330148959*^9, 3.7131873342991967`*^9}, {3.7131877433565936`*^9, 
   3.7131877434836006`*^9}, 3.7131879096671057`*^9, 3.7131882847335587`*^9, 
   3.713208276253008*^9, 3.716668711232192*^9, 3.716670213233102*^9},
 CellLabel->
  "In[8188]:=",ExpressionUUID->"5ea186c7-410a-4096-ac26-eaa4b85afcab"]
}, Closed]],

Cell[CellGroupData[{

Cell["Tracking each particles w/ Click-and-Track function", "Subsection",
 CellChangeTimes->{{3.7165761125008473`*^9, 
  3.716576130148857*^9}},ExpressionUUID->"48b610b5-3bb5-41c8-8d3a-\
d6cfed64e1e8"],

Cell[BoxData[
 RowBox[{"ClickAndTrack", "[", 
  RowBox[{"myColMovie", ",", "myColMovieRunAv", ",", "analysisFolder"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.716804151572936*^9, 3.7168041516989436`*^9}, {
   3.716804191195203*^9, 3.7168041912992086`*^9}, {3.716805949692783*^9, 
   3.716805949852792*^9}, {3.716806897637002*^9, 3.7168068977730103`*^9}, {
   3.716806987543144*^9, 3.7168069876691513`*^9}, {3.7168070775272913`*^9, 
   3.71680708694983*^9}, 3.7169294613592463`*^9, 3.745693951685309*^9, {
   3.756211551195969*^9, 3.756211556680859*^9}},
 CellLabel->
  "In[8190]:=",ExpressionUUID->"debcfb97-67eb-46f7-8663-60e899357a14"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
ClicknTrack
\tFit and export {X,Y} of white, yel, purp, and red example tracks \
\>", "Section",
 CellChangeTimes->{{3.716218263423055*^9, 3.7162182721115522`*^9}, {
   3.725058392901122*^9, 3.7250584243076277`*^9}, {3.747057666450421*^9, 
   3.7470576728551598`*^9}, 3.75312607333889*^9, {3.7800794885891647`*^9, 
   3.780079511684465*^9}},ExpressionUUID->"1a561502-414f-4895-ba84-\
17fbb3acbeef"],

Cell[CellGroupData[{

Cell["Red Tracks", "Subsubsection",
 CellChangeTimes->{{3.7186525251060815`*^9, 
  3.718652528541296*^9}},ExpressionUUID->"afc9d1dc-46a7-41bb-82da-\
3e231a59b336"],

Cell["Run \[OpenCurlyDoubleQuote]red tracks\[CloseCurlyDoubleQuote] once per \
track: ", "Text",
 CellChangeTimes->{{3.7800804617551737`*^9, 
  3.7800804707466497`*^9}},ExpressionUUID->"9e1e017f-02be-409f-a7bc-\
e2d952be3490"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRNAtrackFiles", "=", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<TA*_myTrack_red_13.dat\>\"", ",", 
     RowBox[{"DirectoryName", "@", "analysisFolder"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TableForm", "@", "myRNAtrackFiles"}]}], "Input",
 CellChangeTimes->{{3.7174428116969347`*^9, 3.7174428964557824`*^9}, {
   3.7250574113076153`*^9, 3.7250574128691654`*^9}, {3.725057572203596*^9, 
   3.7250575732451053`*^9}, {3.725057892604388*^9, 3.725057892782369*^9}, {
   3.725128714828462*^9, 3.725128718251053*^9}, {3.725151718822136*^9, 
   3.725151720040748*^9}, {3.7260059979943924`*^9, 3.7260059985567904`*^9}, {
   3.7260064095219584`*^9, 3.726006409787553*^9}, 3.7262496754271717`*^9, 
   3.745691633985319*^9, 3.7459792909580517`*^9, {3.746118402342894*^9, 
   3.746118415771879*^9}, {3.7463710557728443`*^9, 3.746371057818632*^9}, {
   3.7463729990118847`*^9, 3.746372999384076*^9}, {3.746373636587435*^9, 
   3.746373637003173*^9}, {3.7463740470018044`*^9, 3.746374047308469*^9}, 
   3.7464695357440577`*^9, {3.7470574935224185`*^9, 3.7470574940223417`*^9}, {
   3.747061077297844*^9, 3.747061083546625*^9}, 3.75312016363301*^9, 
   3.7531243708194675`*^9, 3.753124402631455*^9, {3.756215466082324*^9, 
   3.75621547216838*^9}, {3.7562383528998737`*^9, 3.7562383532914963`*^9}, {
   3.7562384318042183`*^9, 3.756238432208309*^9}, {3.756238519674706*^9, 
   3.756238519986455*^9}, {3.756238607485219*^9, 3.7562386077321463`*^9}, {
   3.7562386949011917`*^9, 3.756238695138153*^9}, {3.756239855326673*^9, 
   3.756239855652288*^9}, {3.7562399217745323`*^9, 3.7562399220038023`*^9}, {
   3.7562399582115507`*^9, 3.756239981067268*^9}, {3.756240608330106*^9, 
   3.756240610358889*^9}, {3.7562407159281807`*^9, 3.75624074239084*^9}, {
   3.756240777024364*^9, 3.7562407771167088`*^9}, {3.756240858508078*^9, 
   3.756240858697991*^9}, {3.756240898640505*^9, 3.756240898794495*^9}, {
   3.756466990608111*^9, 3.756467001274939*^9}, {3.756467038907638*^9, 
   3.7564670393867702`*^9}, {3.756468210123147*^9, 3.756468218303355*^9}, {
   3.756468535157032*^9, 3.756468539031722*^9}, {3.7564687073967447`*^9, 
   3.756468709318272*^9}, {3.766753468266219*^9, 3.766753472038219*^9}, {
   3.766753735753029*^9, 3.766753735842202*^9}, {3.7667538257205*^9, 
   3.766753825806332*^9}, {3.7667539380662317`*^9, 3.766753938154311*^9}, {
   3.766761174153694*^9, 3.766761174702135*^9}, {3.766761409963854*^9, 
   3.766761410039401*^9}, {3.766773374385994*^9, 3.7667733744778013`*^9}, {
   3.7667741395701103`*^9, 3.7667741418055067`*^9}, 3.766777160846766*^9, {
   3.7667773818524513`*^9, 3.766777381895994*^9}, {3.766777455104157*^9, 
   3.766777456029029*^9}, {3.766840180827249*^9, 3.766840191375215*^9}, 
   3.76684092807517*^9, 3.766842029970427*^9, {3.7668452705581627`*^9, 
   3.766845270851219*^9}, {3.766849494955743*^9, 3.766849495792204*^9}, 
   3.766849558173759*^9, 3.766849669746955*^9, {3.766849789953061*^9, 
   3.7668497902568893`*^9}, {3.7668502833974752`*^9, 3.76685028379712*^9}, {
   3.766850771912078*^9, 3.7668507723841352`*^9}, 3.766851656317625*^9, 
   3.766851979424698*^9, {3.766911981700821*^9, 3.76691198232568*^9}, 
   3.7669132697197857`*^9, 3.7669135017199097`*^9, {3.766914140241418*^9, 
   3.766914140329196*^9}, 3.766914374154859*^9, {3.766916361414804*^9, 
   3.766916362041828*^9}, {3.766943603136141*^9, 3.766943606632711*^9}, 
   3.766943854234311*^9, {3.766944096790403*^9, 3.766944096885085*^9}, {
   3.766944845848724*^9, 3.76694484598851*^9}, {3.766945275271748*^9, 
   3.766945276897188*^9}, {3.76694560624191*^9, 3.766945606317341*^9}, {
   3.766946136846353*^9, 3.766946136933913*^9}, {3.766946622475716*^9, 
   3.766946622738229*^9}, 3.766947097963746*^9, {3.766947508509807*^9, 
   3.7669475085781507`*^9}, {3.7669487285460863`*^9, 3.766948728591548*^9}, {
   3.766948918725569*^9, 3.766948918796451*^9}, {3.76695126621931*^9, 
   3.766951269520419*^9}, 3.766951809526705*^9, {3.7669875637428217`*^9, 
   3.7669875639099293`*^9}, {3.766987984738132*^9, 3.766987984903245*^9}, 
   3.76699020868616*^9, {3.767011863940542*^9, 3.7670118773758907`*^9}, {
   3.767108517835719*^9, 3.7671085180189657`*^9}, {3.7672915488876457`*^9, 
   3.7672915490294333`*^9}, {3.767292560826179*^9, 3.767292560984438*^9}, 
   3.767292847527712*^9, {3.767313451719356*^9, 3.767313478089013*^9}, {
   3.767313956855008*^9, 3.767313956932822*^9}, {3.7673144346637793`*^9, 
   3.767314435550171*^9}, {3.7673161558289413`*^9, 3.7673161710814943`*^9}, {
   3.76812728892925*^9, 3.768127292256714*^9}, {3.769862062522685*^9, 
   3.769862069303451*^9}, {3.7698625477871227`*^9, 3.769862548875046*^9}, {
   3.769863519247602*^9, 3.769863520495637*^9}, {3.770644158116762*^9, 
   3.770644161557889*^9}, {3.770646077374146*^9, 3.7706460788119583`*^9}, {
   3.77115558772154*^9, 3.77115559585851*^9}, {3.77115628616293*^9, 
   3.771156286198923*^9}, {3.7711694814923162`*^9, 3.77116948636973*^9}, {
   3.771169796698779*^9, 3.771169796795595*^9}, {3.776009887851389*^9, 
   3.776009893727182*^9}, 3.776010795980413*^9, {3.776017279431871*^9, 
   3.776017281787537*^9}, {3.777716816410116*^9, 3.777716819644775*^9}, 
   3.777717281078928*^9, {3.778351737268766*^9, 3.778351752094657*^9}, 
   3.778955139805305*^9, {3.780068529189529*^9, 3.780068529373509*^9}, 
   3.7800753136193132`*^9, {3.780075347209663*^9, 3.7800753483364973`*^9}, {
   3.780075600376892*^9, 3.7800756419669733`*^9}, {3.780075677277317*^9, 
   3.7800756773662663`*^9}},
 CellLabel->
  "In[8312]:=",ExpressionUUID->"c7a9f6aa-d1c0-440d-b758-a65ad343a3a2"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {"\<\"/Volumes/BITTY/ExampleTACell_Fig1/Analysis/TA10b_myTrack_red_13.\
dat\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7800756422340317`*^9, 3.780075685199918*^9}},
 CellLabel->
  "Out[8313]//TableForm=",ExpressionUUID->"6835a3c1-5cdc-456a-bb58-\
fdcde5019344"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"analysisFolder2", " ", "=", " ", 
  RowBox[{
   RowBox[{"StringDrop", "[", 
    RowBox[{
     RowBox[{"myRNAtrackFiles", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"-", "4"}]}], "]"}], "<>", " ", "\"\<_pur\>\"", " ", 
   RowBox[{"(*", 
    RowBox[{
    "Manually", " ", "change", " ", "this", " ", "name", " ", "to", " ", 
     "\"\<wht, red, pur, yel\>\"", " ", "etc", " ", "or", " ", "however", " ",
      "you", " ", "want", " ", "to", " ", "classify", " ", "your", " ", 
     "spots"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.756237063232648*^9, 3.75623709630138*^9}, {
  3.7800755676434927`*^9, 3.780075605437614*^9}, {3.780075648639996*^9, 
  3.7800756497854*^9}, {3.78007568020142*^9, 3.7800756823225307`*^9}, {
  3.780080472158193*^9, 3.780080492040378*^9}},
 CellLabel->
  "In[8654]:=",ExpressionUUID->"df6947f1-2957-4d0f-97b5-da1192fac769"],

Cell[BoxData["\<\"/Volumes/BITTY/ExampleTACell_Fig1/Analysis/TA10b_myTrack_\
red_10_wht_myRedClickTracksCoordinates_pur\"\>"], "Output",
 CellChangeTimes->{{3.756237073807259*^9, 3.756237096558292*^9}, 
   3.7562383155376883`*^9, 3.756238356063095*^9, {3.7562384389551163`*^9, 
   3.756238443773035*^9}, 3.75623852455551*^9, 3.756238610571478*^9, 
   3.7562386979049273`*^9, {3.756239857911377*^9, 3.756239860633787*^9}, 
   3.7562399255274754`*^9, 3.756239986945348*^9, 3.75624061318653*^9, 
   3.7562407460048227`*^9, 3.756240780508711*^9, 3.756240863506735*^9, 
   3.756240901217339*^9, {3.756467043928584*^9, 3.756467048630472*^9}, 
   3.756468544090699*^9, 3.7564687123979063`*^9, 3.756468827505487*^9, 
   3.766753475948606*^9, 3.7667537383767242`*^9, 3.766753828553982*^9, 
   3.766753940890071*^9, 3.7667611789291353`*^9, 3.76676141234389*^9, 
   3.7667733764559*^9, 3.766774145085643*^9, 3.766777163651936*^9, 
   3.766777384910389*^9, {3.7667774495638447`*^9, 3.7667774591075478`*^9}, 
   3.766840199037949*^9, {3.7668409324904222`*^9, 3.766840955725004*^9}, 
   3.766842033708665*^9, 3.766845272851962*^9, 3.766845362089686*^9, 
   3.76684949888209*^9, 3.766849560302655*^9, 3.766849671992128*^9, 
   3.766849792750394*^9, 3.766850776265375*^9, 3.7668516596630783`*^9, 
   3.766851981685031*^9, 3.766911984480486*^9, 3.766913272344955*^9, 
   3.766913504713461*^9, 3.7669141434395447`*^9, 3.766914377132*^9, 
   3.766916364420477*^9, 3.766943610209282*^9, 3.76694385650637*^9, 
   3.766944100626945*^9, 3.766944848053842*^9, 3.766945279492879*^9, 
   3.766945610017992*^9, {3.766946138611608*^9, 3.76694615063943*^9}, 
   3.766946625192768*^9, 3.7669471004107027`*^9, 3.766947510763698*^9, {
   3.766948732343854*^9, 3.766948744718524*^9}, {3.766948921104885*^9, 
   3.7669489296372337`*^9}, 3.766951272561852*^9, 3.766951813120338*^9, 
   3.766987566726907*^9, 3.76698798686122*^9, {3.76699021131262*^9, 
   3.766990231342352*^9}, {3.7670118664467993`*^9, 3.767011880780048*^9}, 
   3.7670119832205563`*^9, 3.767012160524584*^9, 3.767108520175452*^9, 
   3.767285572344993*^9, 3.767286523914145*^9, 3.7672914019227867`*^9, 
   3.767291524235182*^9, {3.767291558004505*^9, 3.767291561705665*^9}, 
   3.767292563889345*^9, 3.767292854197813*^9, 3.767313481205103*^9, {
   3.767313964650237*^9, 3.767313982459406*^9}, {3.767314438452958*^9, 
   3.767314444036059*^9}, 3.767314967280594*^9, {3.7681272976581984`*^9, 
   3.768127302056847*^9}, 3.769862073279312*^9, 3.769862120313291*^9, 
   3.76986255143636*^9, 3.769863523148348*^9, 3.769883875464218*^9, 
   3.770644164625586*^9, 3.770644361167453*^9, 3.770646082717614*^9, 
   3.771155544576844*^9, 3.771155598914855*^9, 3.771156288763693*^9, 
   3.771169492323238*^9, 3.7711695470404043`*^9, 3.771169621794574*^9, 
   3.771169799366407*^9, 3.776009896549575*^9, 3.776010798236764*^9, {
   3.776017285239094*^9, 3.776017287397748*^9}, 3.777716824659239*^9, 
   3.777717284203351*^9, 3.7783502467393436`*^9, 3.7783517540677977`*^9, 
   3.778352370172202*^9, 3.778950600134343*^9, {3.778955141780245*^9, 
   3.7789551473334103`*^9}, 3.7800685381576767`*^9, 3.780075350455524*^9, {
   3.7800755771968946`*^9, 3.780075652479795*^9}, 3.780075685322044*^9, 
   3.780080492600971*^9},
 CellLabel->
  "Out[8654]=",ExpressionUUID->"026dd2c0-e171-4fa0-8224-7cec23bf7bd9"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myRNAtracks", "=", 
   RowBox[{"Get", "/@", "myRNAtrackFiles"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myRNAtracks", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"#", ",", 
       RowBox[{"x_", "/;", 
        RowBox[{
         RowBox[{"x", "\[LeftDoubleBracket]", 
          RowBox[{"3", ",", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"0.", ",", "0."}], "}"}]}]}]}], "]"}], "&"}], "/@", 
    "myRNAtracks"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.716744337427763*^9, 3.7167443457092366`*^9}, {
   3.717442795976035*^9, 3.717442797144102*^9}, {3.7174429032401705`*^9, 
   3.7174429544601*^9}, 3.717443091865959*^9, {3.717770563934351*^9, 
   3.7177705640613585`*^9}, {3.7251505154499483`*^9, 3.725150524527112*^9}, {
   3.747060772947809*^9, 3.7470607866634045`*^9}, {3.7531245864962907`*^9, 
   3.753124601764052*^9}},
 CellLabel->
  "In[8315]:=",ExpressionUUID->"f45da79b-a3a1-4cde-9a37-bf8cdde1e814"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"mytemplocs", " ", "=", " ", 
    RowBox[{"myRNAtracks", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "All", ",", "3", ",", "1"}], "]"}], "]"}]}], " ", 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"mytemptimes", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"i", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "@", 
         RowBox[{"myRNAtracks", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "All", ",", "3", ",", "1"}], "]"}], "]"}]}], ",",
         "1"}], "}"}]}], "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frames", " ", "=", " ", 
   RowBox[{"Length", "@", 
    RowBox[{"myRNAtracks", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"int", " ", "=", " ", "1"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mytemptimes", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"frames", "*", "int"}], ")"}], "-", "1"}], ",", "int"}], 
      "}"}]}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myTimeList", "=", 
   RowBox[{"mytemptimes", " ", "+", "1"}]}], " ", ";"}]}], "Input",
 CellChangeTimes->{{3.7470593062463064`*^9, 3.747059324304555*^9}, {
   3.7470604894834013`*^9, 3.7470605447202125`*^9}, {3.7531202926484504`*^9, 
   3.7531203130725603`*^9}, {3.7531203498761997`*^9, 
   3.7531203865693483`*^9}, {3.753124429695521*^9, 3.7531244778746953`*^9}, {
   3.7531246066085725`*^9, 3.753124610515955*^9}, 3.753124990680402*^9, {
   3.753126079433011*^9, 3.7531260969355164`*^9}, 3.75312616452597*^9, {
   3.756215486104492*^9, 3.756215486224526*^9}, {3.7562383220983133`*^9, 
   3.756238322172227*^9}, 3.766753509611215*^9, {3.7669441062031403`*^9, 
   3.766944106323749*^9}, 3.7669513145654593`*^9, {3.766990267514649*^9, 
   3.7669902676557293`*^9}, {3.767012334608407*^9, 3.767012345121264*^9}, 
   3.767286561733741*^9, {3.767291484568396*^9, 3.7672914859694967`*^9}, {
   3.780080439901815*^9, 3.780080454192675*^9}},
 CellLabel->
  "In[8649]:=",ExpressionUUID->"0dd1832f-089b-46c1-a68f-1709b4893779"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"myRNAfits", ",", "myRedCroppedData", ",", "myRedCenters"}], 
     "}"}], "=", 
    RowBox[{"MyParticleFitter", "[", 
     RowBox[{"myColMovie", ",", "1", ",", "myRNAtracks", ",", "5", ",", "1"}],
      "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "The", " ", "centriod", " ", "fits", " ", "to", " ", "the", " ", "center", 
    " ", "movie", " ", "of", " ", "the", " ", "average", " ", 
    RowBox[{"(", "rolling", ")"}], " ", "frame"}], "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "RNAFits", " ", "adds", " ", "in", " ", "fitted", " ", "information", " ", 
    "and", " ", "confidence", " ", "interval", " ", "about", " ", "the", " ", 
    "centroid", " ", "that", " ", "we", " ", "are", " ", "fitting"}], "*)"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.7470576417060766`*^9, 3.7470576546563253`*^9}, {
   3.7470591632635717`*^9, 3.7470591834306965`*^9}, {3.7470593369579935`*^9, 
   3.7470593398635364`*^9}, {3.747060550875186*^9, 3.7470605558894324`*^9}, {
   3.747060755514273*^9, 3.7470607577483454`*^9}, 3.7531245217089157`*^9},
 CellLabel->
  "In[8322]:=",ExpressionUUID->"c73a817a-6d22-4709-a696-4e5817b48b9b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "/@", "myRNAfits"}]], "Input",
 CellChangeTimes->{{3.725128752670037*^9, 3.7251287617325125`*^9}},
 CellLabel->
  "In[8323]:=",ExpressionUUID->"f6fd445b-0a7e-473d-ba89-87e24c6440f9"],

Cell[BoxData[
 RowBox[{"{", "20", "}"}]], "Output",
 CellChangeTimes->{
  3.725128763113805*^9, 3.7260064978435516`*^9, 3.726006559084358*^9, 
   3.7260071078919616`*^9, 3.726249694616482*^9, 3.745854238545135*^9, {
   3.745869456852117*^9, 3.745869483804077*^9}, 3.745887078405512*^9, 
   3.745895450448226*^9, 3.7458964346778793`*^9, 3.7459793543576183`*^9, 
   3.746118425374789*^9, 3.746371070273847*^9, 3.746373006779736*^9, 
   3.746373150840469*^9, {3.746373688965497*^9, 3.746373709405889*^9}, 
   3.746374052182857*^9, 3.746469546388463*^9, 3.747061098449107*^9, 
   3.753120185231558*^9, 3.753120394038546*^9, 3.7531245273209753`*^9, 
   3.753125160991218*^9, 3.756215502094741*^9, 3.756237626488497*^9, 
   3.7562383164314957`*^9, 3.756238357153459*^9, 3.756238444997499*^9, 
   3.756238525658277*^9, 3.756238611630034*^9, 3.756238699190515*^9, 
   3.756239861398781*^9, 3.756239926568605*^9, 3.756240747059043*^9, 
   3.756240781564958*^9, 3.756240864552066*^9, 3.756240902279566*^9, 
   3.7564670502308083`*^9, 3.756468546351769*^9, 3.756468715182694*^9, 
   3.7564688295569553`*^9, 3.766753526696577*^9, 3.766753739838578*^9, 
   3.766753830190938*^9, 3.766753942578992*^9, 3.766761180557865*^9, 
   3.766761414797462*^9, 3.766773378135098*^9, 3.766774147302168*^9, 
   3.766777165702839*^9, 3.766777386714095*^9, {3.766777451225793*^9, 
   3.7667774605458603`*^9}, 3.766840201473724*^9, {3.766840934085641*^9, 
   3.766840957255987*^9}, 3.766842035182675*^9, 3.766845274492093*^9, 
   3.7668453637118587`*^9, 3.766845436424676*^9, 3.766849500492495*^9, 
   3.766849561920639*^9, 3.766849673811623*^9, 3.7668497944501457`*^9, 
   3.766850777873856*^9, 3.766851661441763*^9, 3.766851983752926*^9, 
   3.766911986683138*^9, 3.7669132737871103`*^9, 3.7669135065540857`*^9, 
   3.766914145857723*^9, 3.766914378787671*^9, 3.766916366108341*^9, 
   3.76694361171931*^9, 3.766943857934393*^9, {3.7669441020208807`*^9, 
   3.766944114545372*^9}, 3.7669448495443897`*^9, 3.766945280748188*^9, 
   3.766945611551084*^9, {3.766946140077107*^9, 3.7669461522266912`*^9}, 
   3.7669466268918343`*^9, 3.766947101817203*^9, 3.766947513851433*^9, {
   3.766948733863446*^9, 3.766948746155611*^9}, {3.766948922389276*^9, 
   3.766948930971387*^9}, 3.766951273953197*^9, 3.76695181447087*^9, 
   3.766987568358876*^9, 3.766987988216626*^9, {3.7669902129970293`*^9, 
   3.766990232824478*^9}, 3.7669902758668118`*^9, {3.7670118669365807`*^9, 
   3.7670118821596622`*^9}, 3.767011984827839*^9, 3.767012161793779*^9, 
   3.767108530755452*^9, 3.7672915258314734`*^9, 3.767291563378263*^9, 
   3.7672928569319696`*^9, 3.76731349434949*^9, 3.767313983733067*^9, 
   3.767314445334786*^9, 3.768127304694119*^9, 3.769862073729434*^9, 
   3.769862122617125*^9, 3.76986255288521*^9, 3.7698635244193277`*^9, {
   3.770644167277162*^9, 3.7706441789922247`*^9}, 3.770646084563698*^9, 
   3.771155547130056*^9, 3.77115560049977*^9, 3.771156290717167*^9, 
   3.771169502185919*^9, 3.7711695489351883`*^9, 3.771169623468657*^9, 
   3.77116966827875*^9, 3.771169800924377*^9, 3.776009904471553*^9, 
   3.776010799067092*^9, 3.776017288153496*^9, 3.777716826063828*^9, 
   3.7777172852531643`*^9, 3.778350308651244*^9, 3.778351833706991*^9, 
   3.778352378168804*^9, 3.778955148177125*^9, 3.78007535769873*^9, {
   3.780075585269434*^9, 3.7800756533629417`*^9}, 3.7800756868160763`*^9},
 CellLabel->
  "Out[8323]=",ExpressionUUID->"4f267b1d-e3a7-46b3-9b0f-fafa2a53e0ca"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Red Crops", "Subsubsection",
 CellChangeTimes->{{3.718652542669969*^9, 
  3.718652544569147*^9}},ExpressionUUID->"4a187534-7e07-487c-9f58-\
794c5bf650b7"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"n", "=", "38"}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mytemplocs", "[", 
     RowBox[{"[", "n", "]"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"myRedCenterList0", "[", 
     RowBox[{"[", "n", "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.767313550514819*^9, 3.767313598405628*^9}, {
  3.7673136317907753`*^9, 3.767313631873267*^9}},
 EmphasizeSyntaxErrors->True,
 CellLabel->
  "In[8324]:=",ExpressionUUID->"7c7ee121-2ce0-4e5f-962f-ce9a45bd7494"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"myi", "=", "1"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "You", " ", "have", " ", "to", " ", "change", " ", "this", " ", 
    "depending", " ", "on", " ", "what", " ", "track", " ", "you", " ", "are",
     " ", "analyzing"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.718650617888496*^9, 3.718650619874649*^9}, {
  3.718651671799266*^9, 3.7186516719305077`*^9}, {3.718655944933744*^9, 
  3.7186559450341854`*^9}, {3.718656317127987*^9, 3.7186563174288836`*^9}, {
  3.718656401271369*^9, 3.7186564015033607`*^9}, {3.7186564930370646`*^9, 
  3.718656493156679*^9}, {3.7186608271268854`*^9, 3.718660828243493*^9}, {
  3.718660894500016*^9, 3.7186608945998545`*^9}, {3.725057874447357*^9, 
  3.725057933254077*^9}, {3.7251287238899984`*^9, 3.7251287240307*^9}, {
  3.756215537823812*^9, 3.756215537923699*^9}, {3.756215574406207*^9, 
  3.756215574486526*^9}},
 CellLabel->
  "In[8324]:=",ExpressionUUID->"851f3030-7166-45eb-8b38-587456e18c81"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"myRNAfits", "\[LeftDoubleBracket]", 
    RowBox[{"myi", ",", " ", "All", ",", " ", "4", ",", " ", "1"}], 
    "\[RightDoubleBracket]"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"first", " ", "track"}], ",", " ", 
    RowBox[{"all", " ", "time", " ", "points"}], ",", " ", 
    RowBox[{"fit", " ", "information"}], ",", " ", 
    RowBox[{"coordinates", " ", "of", " ", "the", " ", "centroid"}]}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.7180284041055117`*^9, 3.7180284993522353`*^9}, {
   3.7180285516169147`*^9, 3.7180285541484547`*^9}, {3.718650591158169*^9, 
   3.7186505912934513`*^9}, {3.7186506234613895`*^9, 3.7186506285102262`*^9}, 
   3.718652127668214*^9, {3.725050396356909*^9, 3.7250503986291757`*^9}, {
   3.725058184651145*^9, 3.725058195932625*^9}, 3.725140690302657*^9, {
   3.725150741180786*^9, 3.7251507500731087`*^9}, {3.726008649553758*^9, 
   3.726008724783388*^9}, {3.745854257177894*^9, 3.745854258278647*^9}},
 CellLabel->
  "In[8325]:=",ExpressionUUID->"2e550924-8f66-4783-b45d-6e9ea461268a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myRedCenterList0", "=", 
   RowBox[{"Ceiling", "@", 
    RowBox[{"myRNAfits", "\[LeftDoubleBracket]", 
     RowBox[{"myi", ",", " ", "All", ",", " ", "4", ",", "1"}], " ", 
     "\[RightDoubleBracket]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.756238775425709*^9, 3.756238780018839*^9}, 
   3.76694412516121*^9},
 CellLabel->
  "In[8326]:=",ExpressionUUID->"3255377e-3500-4cc0-8674-f5220ebd86af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myRedTrack", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"mytemptimes", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
        RowBox[{"myRedCenterList0", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], ",", "  ", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"Length", "@", "mytemptimes"}], " ", "-", "1"}], ",", "1"}], 
      "}"}]}], "]"}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.766849888313718*^9, 3.766849895668285*^9}, {
  3.766912000112512*^9, 3.766912059839128*^9}, {3.7669121623818607`*^9, 
  3.766912193558024*^9}, {3.766912244799746*^9, 3.766912272699718*^9}, {
  3.766912306232643*^9, 3.7669123215565443`*^9}, {3.766912363344676*^9, 
  3.76691236927738*^9}, {3.766912428782392*^9, 3.766912441393667*^9}, {
  3.766943903271039*^9, 3.766943903918418*^9}, {3.766990326406938*^9, 
  3.7669903287990026`*^9}, {3.767011901520669*^9, 3.767011904292027*^9}},
 CellLabel->
  "In[8327]:=",ExpressionUUID->"2863e8a4-c7f2-4844-bd51-d177fca3d58f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPointPlot3D", "[", 
    RowBox[{
     RowBox[{"Flatten", "/@", 
      RowBox[{"Thread", "@", 
       RowBox[{"{", "myRedTrack", "}"}]}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{"{", 
     RowBox[{"Red", ",", 
      RowBox[{"Line", "[", 
       RowBox[{"Flatten", "/@", 
        RowBox[{"Thread", "@", 
         RowBox[{"{", "myRedTrack", "}"}]}]}], "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"BoxRatios", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"6", ",", "1", ",", "1"}], "}"}]}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.76691244577628*^9, 3.7669124616682453`*^9}},
 CellLabel->
  "In[8328]:=",ExpressionUUID->"4d10a361-e9ac-4596-8e35-157f252ebac4"],

Cell[BoxData[
 Graphics3DBox[{{
    {RGBColor[1, 0, 0], PointSize[
      NCache[
       Rational[7, 360], 0.019444444444444445`]], Point3DBox[CompressedData["
1:eJxTTMoPSmViYGAQBmJmBjTQkOUApgsqITTDB3sU8QSYOAOEdoCKT4CJc0Bp
qHgDTFwAVT1cXARqLrq4BKo43D0yOMQVHLC7XwlVHG6+CoRegK5eDVUcrl4D
h3otHOp1cIjr4XCPAao4PDwNcYgbYYgDAGZcNbU=
      "]]}, {}, {}, {}, {}}, 
   {RGBColor[1, 0, 0], 
    Line3DBox[{{0, 212, 407}, {1, 212, 406}, {2, 210, 409}, {3, 208, 408}, {4,
      210, 408}, {5, 211, 408}, {6, 211, 407}, {7, 211, 407}, {8, 212, 407}, {
     9, 212, 408}, {10, 213, 407}, {11, 213, 408}, {12, 213, 407}, {13, 213, 
     408}, {14, 213, 408}, {15, 212, 408}, {16, 212, 409}, {17, 212, 409}, {
     18, 212, 409}}]}},
  Axes->True,
  AxesLabel->{None, None, None},
  BoxRatios->{6, 1, 1},
  DisplayFunction->Identity,
  FaceGrids->None,
  FaceGridsStyle->Automatic,
  ImageSize->800,
  PlotRange->{All, All, All},
  PlotRangePadding->{{Automatic, Automatic}, {Automatic, Automatic}, {
    Automatic, Automatic}},
  Ticks->{Automatic, Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.767285595753009*^9, 3.7672856016334133`*^9}, 
   3.767291502565094*^9, 3.767291567678993*^9, 3.767292576691114*^9, 
   3.767292860572267*^9, 3.767293161542266*^9, 3.767293436566628*^9, 
   3.767313498750475*^9, 3.767314015686842*^9, 3.767314451732481*^9, 
   3.767314981347879*^9, 3.769862074975459*^9, 3.769862126530888*^9, 
   3.769862553268903*^9, 3.7698635280587397`*^9, 3.770646094959729*^9, 
   3.771155604540246*^9, 3.7711562946363487`*^9, 3.771169502781348*^9, 
   3.771169554273758*^9, 3.7711696699425507`*^9, 3.77116980356432*^9, 
   3.776009908471517*^9, {3.7760108038816833`*^9, 3.776010827274971*^9}, 
   3.776017292705757*^9, 3.777716831204124*^9, 3.777717290569151*^9, 
   3.778350314018415*^9, 3.778352384117652*^9, 3.778950634638311*^9, 
   3.778955392742482*^9, 3.780068555941724*^9, 3.780075377253208*^9, {
   3.78007558945039*^9, 3.780075656379249*^9}, 3.780075688872613*^9},
 CellLabel->
  "Out[8328]=",ExpressionUUID->"9a3a7826-c738-4365-9d6e-62db81e7228b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myRedCenterList", " ", "=", "   ", "myRedCenterList0", 
  "   "}]], "Input",
 CellChangeTimes->{{3.756215699722352*^9, 3.7562157050872*^9}, {
  3.766849189375473*^9, 3.766849192304104*^9}, {3.766849235238922*^9, 
  3.766849237286991*^9}, {3.766849898717317*^9, 3.7668499870031843`*^9}, {
  3.766850036788423*^9, 3.766850037457675*^9}, {3.7668500784066353`*^9, 
  3.766850096304657*^9}, {3.766850162390169*^9, 3.766850166457878*^9}},
 CellLabel->
  "In[8329]:=",ExpressionUUID->"891bb5df-c83c-49b6-8be9-f704b0fb598c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"212", ",", "407"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"212", ",", "406"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"210", ",", "409"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"208", ",", "408"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"210", ",", "408"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"211", ",", "408"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"211", ",", "407"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"211", ",", "407"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"212", ",", "407"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"212", ",", "408"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"213", ",", "407"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"213", ",", "408"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"213", ",", "407"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"213", ",", "408"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"213", ",", "408"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"212", ",", "408"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"212", ",", "409"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"212", ",", "409"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"212", ",", "409"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"212", ",", "409"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.78006855979451*^9, 3.7800753774108067`*^9, {3.780075589585835*^9, 
   3.780075656529058*^9}, 3.7800756889997396`*^9},
 CellLabel->
  "Out[8329]=",ExpressionUUID->"b793d463-4afd-484a-8e6e-a68b0cac4480"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"myRedCenterList", " ", ">>", " ", 
  RowBox[{
  "analysisFolder2", "<>", 
   "\"\<_myRedClickTracksCoordinates.dat\>\""}]}]], "Input",
 CellChangeTimes->{{3.725056863947229*^9, 3.7250568766045003`*^9}, {
  3.725128522489712*^9, 3.7251285414355764`*^9}, {3.7251288798119497`*^9, 
  3.7251288819411306`*^9}, {3.7251289911277447`*^9, 3.7251290005334644`*^9}, {
  3.725140674806173*^9, 3.7251406770527477`*^9}, {3.766944162533967*^9, 
  3.766944176166566*^9}, {3.778955390330925*^9, 3.77895539039662*^9}, {
  3.7789554338711433`*^9, 3.778955434012875*^9}},
 CellLabel->
  "In[8330]:=",ExpressionUUID->"12aa4a0d-aa7c-4dba-9732-39697feec562"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Make ",
 StyleBox["VIDEO",
  FontWeight->"Bold"],
 " crops of each track \n",
 StyleBox["(",
  FontSize->16],
 StyleBox["Centered",
  FontSize->16,
  FontWeight->"Bold"],
 StyleBox[" or ",
  FontSize->16],
 StyleBox["tracked",
  FontSize->16,
  FontWeight->"Bold"],
 StyleBox[") ",
  FontSize->16]
}], "Section",
 CellChangeTimes->{
  3.767014144710579*^9, 3.767292833536171*^9, {3.767293457144418*^9, 
   3.767293476282745*^9}},ExpressionUUID->"2ab11bc8-2e24-4715-a4fc-\
6e8501caf25c"],

Cell[CellGroupData[{

Cell["Import", "Subsubsection",
 CellChangeTimes->{{3.7671086328028517`*^9, 
  3.767108633491222*^9}},ExpressionUUID->"89f0b741-971b-469c-97c5-\
8232d07a0f38"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myRNAtrackFiles", "=", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"FileNames", "[", 
     RowBox[{
      RowBox[{"\"\<TA10b_myTrack_red_*\>\"", " ", "<>", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<wht*\>\"", ",", "\"\<yel*\>\"", ",", "\"\<pur*\>\"", ",", 
          "\"\<_red*\>\""}], "}"}], "[", 
        RowBox[{"[", "color", "]"}], "]"}]}], " ", ",", 
      RowBox[{"DirectoryName", "@", "analysisFolder"}]}], "]"}], " ", ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"color", ",", " ", "1", ",", "4", ",", "1"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.780075811816393*^9, 3.780075941933856*^9}, {
  3.780075993952326*^9, 3.780076024023604*^9}, {3.7800760543976183`*^9, 
  3.780076073077194*^9}},
 CellLabel->
  "In[8349]:=",ExpressionUUID->"140ac8f1-cc8a-41d6-a199-f3be757a0f4e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
   "{", "\<\"/Volumes/BITTY/ExampleTACell_Fig1/Analysis/TA10b_myTrack_red_10_\
wht_myRedClickTracksCoordinates.dat\"\>", "}"}], ",", 
   RowBox[{
   "{", "\<\"/Volumes/BITTY/ExampleTACell_Fig1/Analysis/TA10b_myTrack_red_12_\
yel_myRedClickTracksCoordinates.dat\"\>", "}"}], ",", 
   RowBox[{
   "{", "\<\"/Volumes/BITTY/ExampleTACell_Fig1/Analysis/TA10b_myTrack_red_13_\
pur_myRedClickTracksCoordinates.dat\"\>", "}"}], ",", 
   RowBox[{
   "{", "\<\"/Volumes/BITTY/ExampleTACell_Fig1/Analysis/TA10b_myTrack_red_14_\
red_myRedClickTracksCoordinates.dat\"\>", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.780075839240834*^9, {3.780075908502098*^9, 3.780075914529397*^9}, 
   3.780075945282052*^9, {3.780075995857378*^9, 3.780076034121192*^9}, {
   3.7800760739096003`*^9, 3.780076078558902*^9}},
 CellLabel->
  "Out[8349]=",ExpressionUUID->"a9125823-00c7-49f8-ad3c-5816ba37d7eb"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"myTfFunc", "=", 
   RowBox[{"<<", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"DirectoryName", "@", "mymovie"}], "<>", 
      "\"\<TransformationFunction.m\>\""}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7174428116969347`*^9, 3.7174428964557824`*^9}, {
   3.7250574113076153`*^9, 3.7250574128691654`*^9}, {3.725057572203596*^9, 
   3.7250575732451053`*^9}, {3.725057892604388*^9, 3.725057892782369*^9}, {
   3.725128714828462*^9, 3.725128718251053*^9}, {3.725151718822136*^9, 
   3.725151720040748*^9}, {3.7260059979943924`*^9, 3.7260059985567904`*^9}, {
   3.7260064095219584`*^9, 3.726006409787553*^9}, 3.7262496754271717`*^9, 
   3.745691633985319*^9, 3.7459792909580517`*^9, {3.746118402342894*^9, 
   3.746118415771879*^9}, {3.7463710557728443`*^9, 3.746371057818632*^9}, {
   3.7463729990118847`*^9, 3.746372999384076*^9}, {3.746373636587435*^9, 
   3.746373637003173*^9}, {3.7463740470018044`*^9, 3.746374047308469*^9}, 
   3.7464695357440577`*^9, {3.7470574935224185`*^9, 3.7470574940223417`*^9}, {
   3.747061077297844*^9, 3.747061083546625*^9}, 3.75312016363301*^9, 
   3.7531243708194675`*^9, 3.753124402631455*^9, {3.756215466082324*^9, 
   3.75621547216838*^9}, {3.7562383528998737`*^9, 3.7562383532914963`*^9}, {
   3.7562384318042183`*^9, 3.756238432208309*^9}, {3.756238519674706*^9, 
   3.756238519986455*^9}, {3.756238607485219*^9, 3.7562386077321463`*^9}, {
   3.7562386949011917`*^9, 3.756238695138153*^9}, {3.756239855326673*^9, 
   3.756239855652288*^9}, {3.7562399217745323`*^9, 3.7562399220038023`*^9}, {
   3.7562399582115507`*^9, 3.756239981067268*^9}, {3.756240608330106*^9, 
   3.756240610358889*^9}, {3.7562407159281807`*^9, 3.75624074239084*^9}, {
   3.756240777024364*^9, 3.7562407771167088`*^9}, {3.756240858508078*^9, 
   3.756240858697991*^9}, {3.756240898640505*^9, 3.756240898794495*^9}, {
   3.756466990608111*^9, 3.756467001274939*^9}, {3.756467038907638*^9, 
   3.7564670393867702`*^9}, {3.756468210123147*^9, 3.756468218303355*^9}, {
   3.756468535157032*^9, 3.756468539031722*^9}, {3.7564687073967447`*^9, 
   3.756468709318272*^9}, {3.766753468266219*^9, 3.766753472038219*^9}, {
   3.766753735753029*^9, 3.766753735842202*^9}, {3.7667538257205*^9, 
   3.766753825806332*^9}, {3.7667539380662317`*^9, 3.766753938154311*^9}, {
   3.766761174153694*^9, 3.766761174702135*^9}, {3.766761409963854*^9, 
   3.766761410039401*^9}, {3.766773374385994*^9, 3.7667733744778013`*^9}, {
   3.7667741395701103`*^9, 3.7667741418055067`*^9}, 3.766777160846766*^9, {
   3.7667773818524513`*^9, 3.766777381895994*^9}, {3.766777455104157*^9, 
   3.766777456029029*^9}, {3.766840180827249*^9, 3.766840191375215*^9}, 
   3.76684092807517*^9, 3.766842029970427*^9, {3.7668452705581627`*^9, 
   3.766845270851219*^9}, {3.766849494955743*^9, 3.766849495792204*^9}, 
   3.766849558173759*^9, 3.766849669746955*^9, {3.766849789953061*^9, 
   3.7668497902568893`*^9}, {3.7668502833974752`*^9, 3.76685028379712*^9}, {
   3.766850771912078*^9, 3.7668507723841352`*^9}, 3.766851656317625*^9, 
   3.766851979424698*^9, {3.766911981700821*^9, 3.76691198232568*^9}, 
   3.7669132697197857`*^9, 3.7669135017199097`*^9, {3.766914140241418*^9, 
   3.766914140329196*^9}, 3.766914374154859*^9, {3.766916361414804*^9, 
   3.766916362041828*^9}, {3.766943603136141*^9, 3.766943606632711*^9}, 
   3.766943854234311*^9, {3.766944096790403*^9, 3.766944096885085*^9}, {
   3.766944845848724*^9, 3.76694484598851*^9}, {3.766945275271748*^9, 
   3.766945276897188*^9}, {3.76694560624191*^9, 3.766945606317341*^9}, {
   3.766946136846353*^9, 3.766946136933913*^9}, {3.766946622475716*^9, 
   3.766946622738229*^9}, 3.766947097963746*^9, {3.766947508509807*^9, 
   3.7669475085781507`*^9}, {3.7669487285460863`*^9, 3.766948728591548*^9}, {
   3.766948918725569*^9, 3.766948918796451*^9}, {3.76695126621931*^9, 
   3.766951269520419*^9}, 3.766951809526705*^9, {3.7669875637428217`*^9, 
   3.7669875639099293`*^9}, {3.766987984738132*^9, 3.766987984903245*^9}, 
   3.76699020868616*^9, {3.767011863940542*^9, 3.7670118773758907`*^9}, {
   3.767014315813023*^9, 3.767014316003639*^9}, {3.767108458304014*^9, 
   3.7671084585613823`*^9}, 3.7672855444433393`*^9, {3.767288962279907*^9, 
   3.767288962958074*^9}, {3.767289455073023*^9, 3.767289455608109*^9}, {
   3.7672916208474293`*^9, 3.767291620936804*^9}, 3.767292541519409*^9, 
   3.767292875593082*^9, {3.7672931402988253`*^9, 3.767293140366561*^9}, {
   3.767293413764864*^9, 3.767293413920393*^9}, {3.7673133945796623`*^9, 
   3.767313419770967*^9}, {3.767313939160121*^9, 3.7673139392373123`*^9}, {
   3.76731447487624*^9, 3.767314476048359*^9}, {3.767314730928032*^9, 
   3.7673147460315447`*^9}, {3.767314839509818*^9, 3.7673148512298107`*^9}, {
   3.7673149245948133`*^9, 3.767314949251258*^9}, {3.767315363129847*^9, 
   3.767315388536398*^9}, {3.767315757934371*^9, 3.767315759024249*^9}, {
   3.7673161937839212`*^9, 3.7673161952732773`*^9}, {3.7673164297410383`*^9, 
   3.767316430858028*^9}, {3.767363474039377*^9, 3.767363482338809*^9}, {
   3.76736850591433*^9, 3.7673685091010303`*^9}, {3.767369368187935*^9, 
   3.767369368573483*^9}, {3.7681271905214167`*^9, 3.768127190624044*^9}, {
   3.77230581489089*^9, 3.772305869724662*^9}, {3.772305918462369*^9, 
   3.772305932776972*^9}, {3.7723060252129498`*^9, 3.77230602551338*^9}, {
   3.772306335262723*^9, 3.7723063537967043`*^9}, {3.772310254761965*^9, 
   3.772310255439844*^9}, {3.776009784492251*^9, 3.776009827105029*^9}, {
   3.777399931560247*^9, 3.7773999480865593`*^9}, {3.777399992046865*^9, 
   3.7774001389438267`*^9}, {3.7774001705732517`*^9, 3.7774001910646467`*^9}, 
   3.777400336182954*^9, {3.7774003791194773`*^9, 3.777400380513461*^9}, {
   3.777400419848196*^9, 3.7774004301649837`*^9}, {3.777400709637402*^9, 
   3.777400710849985*^9}, {3.777717033888262*^9, 3.777717049048957*^9}, {
   3.780076091032466*^9, 3.780076102773346*^9}},
 CellLabel->
  "In[8359]:=",ExpressionUUID->"c7b28fad-72f7-4056-ad9e-779bd27650bf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "@", 
  RowBox[{"myRNAtrackFiles", "[", 
   RowBox[{"[", 
    RowBox[{"i", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7800765598003473`*^9, 3.78007657406879*^9}},
 CellLabel->
  "In[8370]:=",ExpressionUUID->"04246849-e550-425c-9c83-3911b338066f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"220", ",", "232"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"221", ",", "232"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"222", ",", "230"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"223", ",", "231"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"224", ",", "231"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"222", ",", "230"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"223", ",", "230"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"223", ",", "230"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"223", ",", "230"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"223", ",", "230"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"222", ",", "231"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"220", ",", "230"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"220", ",", "230"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"221", ",", "231"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"222", ",", "233"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"221", ",", "232"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"221", ",", "231"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"221", ",", "230"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"222", ",", "230"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"220", ",", "231"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.780076549236436*^9, 3.780076574279722*^9}},
 CellLabel->
  "Out[8370]=",ExpressionUUID->"b2d07cd5-55c4-4831-9bd2-a0ddbde63a5c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"myRedCenterList", " ", "=", 
  RowBox[{"Table", "[", " ", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"myRNAtrackFiles", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"myTimeList", " ", "=", " ", 
  RowBox[{"Range", "[", 
   RowBox[{"1", ",", 
    RowBox[{"Length", "@", 
     RowBox[{"myRedCenterList", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.78007654292837*^9, 3.780076595698619*^9}, {
  3.7800766462738037`*^9, 3.780076672953807*^9}},
 CellLabel->
  "In[8392]:=",ExpressionUUID->"47ed8997-864e-4fbc-9eee-80bc15423215"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"220", ",", "232"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"221", ",", "232"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"222", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"223", ",", "231"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"224", ",", "231"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"222", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"223", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"223", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"223", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"223", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"222", ",", "231"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"220", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"220", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"221", ",", "231"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"222", ",", "233"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"221", ",", "232"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"221", ",", "231"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"221", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"222", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"220", ",", "231"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"337", ",", "227"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"340", ",", "227"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"339", ",", "228"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"340", ",", "228"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"340", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"338", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"340", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"339", ",", "227"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"338", ",", "228"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"340", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"343", ",", "232"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"341", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"341", ",", "231"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"344", ",", "230"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"345", ",", "229"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"345", ",", "231"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"345", ",", "231"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"345", ",", "229"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"343", ",", "229"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"343", ",", "231"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"212", ",", "407"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"212", ",", "406"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"210", ",", "409"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"208", ",", "408"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"210", ",", "408"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"211", ",", "408"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"211", ",", "407"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"211", ",", "407"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"212", ",", "407"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"212", ",", "408"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"213", ",", "407"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"213", ",", "408"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"213", ",", "407"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"213", ",", "408"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"213", ",", "408"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"212", ",", "408"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"212", ",", "409"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"212", ",", "409"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"212", ",", "409"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"212", ",", "409"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"360", ",", "279"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"360", ",", "280"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"359", ",", "281"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"362", ",", "280"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"362", ",", "281"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"362", ",", "281"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"360", ",", "287"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"363", ",", "285"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"364", ",", "286"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"364", ",", "285"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"365", ",", "286"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"365", ",", "285"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"368", ",", "282"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"366", ",", "278"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"367", ",", "279"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"366", ",", "279"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"365", ",", "280"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"364", ",", "285"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"365", ",", "288"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"363", ",", "288"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7800761655451202`*^9, {3.7800765439162703`*^9, 3.780076552092566*^9}, {
   3.78007658548872*^9, 3.780076596535159*^9}, {3.780076647004518*^9, 
   3.780076673227613*^9}},
 CellLabel->
  "Out[8392]=",ExpressionUUID->"bbd3a7df-e6ea-4927-8d09-51082252287e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", 
   ",", "9", ",", "10", ",", "11", ",", "12", ",", "13", ",", "14", ",", "15",
    ",", "16", ",", "17", ",", "18", ",", "19", ",", "20"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7800761655451202`*^9, {3.7800765439162703`*^9, 3.780076552092566*^9}, {
   3.78007658548872*^9, 3.780076596535159*^9}, {3.780076647004518*^9, 
   3.780076673239401*^9}},
 CellLabel->
  "Out[8393]=",ExpressionUUID->"a400453f-ec56-4cba-885e-e35765cee109"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"myColorList", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<White\>\"", ",", "\"\<Yellow\>\"", ",", "\"\<Purple\>\"", ",", 
     "\"\<Red\>\""}], "}"}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.780076602584132*^9, 3.780076635365068*^9}, {
  3.7800766701500463`*^9, 3.7800766702968483`*^9}},
 CellLabel->
  "In[8394]:=",ExpressionUUID->"f018d8ec-d0f2-4b49-986a-2e150bc6b02a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Determine Variables: ", "Subsubsection",
 CellChangeTimes->{{3.76721360712989*^9, 
  3.767213612022813*^9}},ExpressionUUID->"b02b1286-abec-439a-9054-\
e842760fbcfc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"myPad", " ", "=", " ", "512"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"myRescaleFactor", " ", "=", " ", "1"}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.7672136169303093`*^9, 3.76721364132716*^9}, 
   3.767286189052228*^9, {3.767287051356185*^9, 3.7672870566271257`*^9}, {
   3.7672901811438828`*^9, 3.767290181272407*^9}, {3.7673635345276947`*^9, 
   3.76736353475393*^9}, {3.767368085910159*^9, 3.7673680933489647`*^9}, {
   3.767368240792177*^9, 3.767368242784916*^9}, {3.767369383949482*^9, 
   3.7673693989449053`*^9}, {3.76986282063992*^9, 3.7698628495506287`*^9}, {
   3.769863637298468*^9, 3.769863644342235*^9}, {3.770644235518561*^9, 
   3.770644235814365*^9}, {3.770646172357745*^9, 3.770646178895659*^9}, {
   3.772306137847756*^9, 3.772306137982037*^9}, {3.780076685054335*^9, 
   3.780076712770246*^9}},
 CellLabel->
  "In[8401]:=",ExpressionUUID->"c37a5ab8-e2d8-401c-832c-5d2c77deaec4"],

Cell[BoxData[
 RowBox[{"MyThresholdingCrop", "[", 
  RowBox[{"myColMovie", ",", "analysisFolder2", ",", 
   RowBox[{"myRedCenterList", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", " ", "myPad"}], " ", 
  RowBox[{"(*", 
   RowBox[{"pad", " ", "size"}], "*)"}], "]"}]], "Input",
 CellChangeTimes->{
  3.7672861086247587`*^9, {3.767289546374872*^9, 3.7672895480799513`*^9}, {
   3.767291660945389*^9, 3.767291677785276*^9}, 3.767368694577368*^9, {
   3.7800767261585693`*^9, 3.780076726786178*^9}},
 CellLabel->
  "In[8508]:=",ExpressionUUID->"6296baca-1f6f-4820-9c71-f4effd275921"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MyThresholdingCrop", "[", 
   RowBox[{"myColMovie", ",", "analysisFolder", ",", 
    RowBox[{"myRedCenterList", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", " ", "myPad"}], " ", 
   RowBox[{"(*", 
    RowBox[{"pad", " ", "size"}], "*)"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mythresholds", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"thredcrop", ",", " ", "thgreencrop", ",", " ", "thbluecrop"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myColMovieAdjusted", " ", "=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"ImageAdjust", "[", 
      RowBox[{
       RowBox[{"myColMovie", "[", 
        RowBox[{"[", 
         RowBox[{"th", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"mythresholds", "[", 
        RowBox[{"[", "th", "]"}], "]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"th", ",", " ", "1", ",", " ", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", 
        RowBox[{"myRedCenterList", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", "1"}], "}"}]}], "]"}]}], " ", 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7670137204488173`*^9, 3.767013748762808*^9}, {
   3.7670138135344067`*^9, 3.7670139453783283`*^9}, {3.767014005602054*^9, 
   3.767014009843042*^9}, 3.767014053929346*^9, {3.7672890594558277`*^9, 
   3.767289064746539*^9}, {3.767289639924094*^9, 3.767289643744816*^9}, {
   3.767292979946271*^9, 3.7672929817984247`*^9}, {3.7777171117888517`*^9, 
   3.777717112620736*^9}, {3.780076766385388*^9, 3.78007676677792*^9}, {
   3.780076918910737*^9, 3.780076919308279*^9}},
 CellLabel->
  "In[8545]:=",ExpressionUUID->"3dac94cd-760a-4ca6-a772-a514cdc070e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myColMovieRGB", " ", "=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"ColorCombine", "[", 
      RowBox[{"myColMovieAdjusted", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "i"}], "]"}], "]"}], "  ", "]"}], " ", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", 
        RowBox[{"myColMovieAdjusted", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myColMovieChannelsAndRGB", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Table", "[", " ", 
     RowBox[{
      RowBox[{"Flatten", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"myColMovieAdjusted", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}], ",", 
         RowBox[{"myColMovieRGB", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], " ", ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "@", 
         RowBox[{"myColMovieAdjusted", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.767289133695199*^9, 3.767289138699852*^9}},
 CellLabel->
  "In[8548]:=",ExpressionUUID->"9f85138c-4369-47be-a28e-d5e6b423c052"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Make a video with White, Yellow, Purple and Red only spots called out with \
targets \
\>", "Subsubsection",
 CellChangeTimes->{{3.767103415032227*^9, 3.767103456672254*^9}, {
  3.767213681373827*^9, 3.767213683717911*^9}, {3.780076925358032*^9, 
  3.780076938659155*^9}},ExpressionUUID->"f0d15249-e704-4cf5-ab60-\
e32078c48b54"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"myPad", " ", "=", " ", "512"}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.7673636495032177`*^9, 3.767363652942586*^9}, {
  3.767368838351429*^9, 3.7673688532608347`*^9}, {3.767369552692531*^9, 
  3.767369552778243*^9}, {3.7698629544451733`*^9, 3.769862964800741*^9}, {
  3.769863786982586*^9, 3.769863787057098*^9}, {3.7706444799385777`*^9, 
  3.770644496692507*^9}, {3.770646246275839*^9, 3.770646247349255*^9}, {
  3.7774013281546087`*^9, 3.777401328453171*^9}, {3.777717180344203*^9, 
  3.777717180413097*^9}, {3.780076798102586*^9, 3.780076798321382*^9}},
 CellLabel->
  "In[8533]:=",ExpressionUUID->"b3c4eeec-333f-458f-9874-4bba37e278ae"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mytemplocs", " ", "=", " ", 
   RowBox[{"myRedCenterList", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"mytemplocs", "//", "Length"}]}], "Input",
 CellChangeTimes->{{3.767289712197967*^9, 3.7672897127067623`*^9}, {
  3.767289757995206*^9, 3.7672897668118896`*^9}, {3.7774033098935013`*^9, 
  3.77740331687668*^9}, {3.780076803971627*^9, 3.7800768050634623`*^9}},
 CellLabel->
  "In[8534]:=",ExpressionUUID->"c32356a4-4129-4566-8ca3-372c4f5261e6"],

Cell[BoxData["20"], "Output",
 CellChangeTimes->{{3.777403314906671*^9, 3.777403317235634*^9}, {
   3.777717184849669*^9, 3.777717201445567*^9}, 3.77771745173276*^9, {
   3.780076800151394*^9, 3.7800768052688923`*^9}, 3.780077223734542*^9, 
   3.780077256962755*^9, 3.780077296252359*^9, 3.780077773179572*^9, 
   3.78007789903463*^9},
 CellLabel->
  "Out[8535]=",ExpressionUUID->"82a219a8-d5bd-482f-9fde-a1c98b7c4da2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"myCenterofCrop", " ", "=", " ", 
  RowBox[{"Ceiling", "/@", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"myRedCenterList", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "//", "Median"}], " ", ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"myRedCenterList", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "//", "Median"}]}], "  ", 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"myCenterofVideoCropped", " ", "=", " ", 
   RowBox[{"Table", "[", "  ", 
    RowBox[{
     RowBox[{
      RowBox[{"mytemplocs", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "-", " ", "myCenterofCrop", " ", 
      "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"myPad", " ", "+", " ", "0.1"}], ",", 
        RowBox[{"myPad", " ", "+", " ", "0.1"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", "mytemplocs"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.767103472735588*^9, 3.76710351625648*^9}, {
  3.767213923043984*^9, 3.76721392581323*^9}, {3.767287907143629*^9, 
  3.767287908720407*^9}, {3.767289334661654*^9, 3.7672893370171328`*^9}, {
  3.7672893875219507`*^9, 3.767289390868062*^9}, {3.767289751057938*^9, 
  3.767289771862282*^9}},
 CellLabel->
  "In[8536]:=",ExpressionUUID->"cbd98a4e-8d51-43d1-b0be-7fc8ca2b6463"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"279", ",", "256"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"281", ",", "256"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.767103469235895*^9, 3.767103516589013*^9}, 
   3.767104818557259*^9, 3.767109146974988*^9, 3.767196920887607*^9, 
   3.767210489041852*^9, 3.767211670023423*^9, 3.767213686954829*^9, {
   3.767213916347089*^9, 3.767213926035138*^9}, 3.767214561782528*^9, 
   3.767286227100534*^9, 3.76728632379613*^9, 3.767287202638466*^9, 
   3.767287277392497*^9, 3.767287432245174*^9, 3.767287909589356*^9, 
   3.767288113936552*^9, 3.7672890967674828`*^9, 3.767289397070404*^9, {
   3.767289751776928*^9, 3.767289772073484*^9}, 3.767289954042821*^9, 
   3.767289989583232*^9, 3.7672902317255383`*^9, 3.767291783265026*^9, 
   3.767292734640211*^9, 3.767293031230878*^9, 3.767293247241321*^9, 
   3.7672936737903137`*^9, 3.767313771185852*^9, 3.767314137457494*^9, 
   3.767314581109614*^9, 3.7673152340880957`*^9, 3.767315638370208*^9, 
   3.76731590123623*^9, 3.767316297908349*^9, 3.76731655682874*^9, {
   3.767363637176525*^9, 3.767363661654146*^9}, 3.767368724585112*^9, {
   3.7673688431250887`*^9, 3.767368856965149*^9}, {3.767369542957337*^9, 
   3.767369561125413*^9}, 3.769862217656364*^9, {3.769862939814733*^9, 
   3.769862957023499*^9}, 3.769863789465303*^9, 3.770644275859604*^9, {
   3.770644475249523*^9, 3.7706445003083553`*^9}, 3.7706445715148087`*^9, 
   3.770646250109058*^9, 3.770646682342558*^9, 3.771156135497759*^9, 
   3.771156531807434*^9, 3.771156872693426*^9, 3.7774008718002663`*^9, 
   3.7774009311099987`*^9, 3.777401333628148*^9, 3.777401495659452*^9, {
   3.777717184923464*^9, 3.7777172023769693`*^9}, 3.777717451818465*^9, 
   3.780076806984769*^9, 3.780077223822507*^9, 3.780077257060246*^9, 
   3.780077296349141*^9, 3.780077773281417*^9, 3.780077899140688*^9},
 CellLabel->
  "Out[8536]=",ExpressionUUID->"13dc5db5-05d4-4ebd-b34b-2f28d21cb569"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Test", " ", "to", " ", "see", " ", "if", " ", "any", " ", "of", " ", 
    "the", " ", "numbers", " ", "GO", " ", "OUTSIDE", " ", "the", " ", 
    RowBox[{"pad", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"mymessage", " ", "=", "  ", 
    RowBox[{"If", " ", "[", "  ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Cases", "[", "  ", 
        RowBox[{
         RowBox[{"Flatten", "@", "myCenterofVideoCropped"}], ",", "  ", 
         RowBox[{"x_", "/;", 
          RowBox[{
           RowBox[{"x", " ", "\[GreaterEqual]", " ", 
            RowBox[{"2", "*", "myPad"}]}], "  ", "||", " ", 
           RowBox[{"x", "<", "0"}]}]}]}], " ", "]"}], "   ", "==", " ", 
       RowBox[{"{", "}"}]}], " ", ",", " ", "\[IndentingNewLine]", 
      "\"\<GOOD: points are within pad size \n\>\"", ",", " ", 
      "\[IndentingNewLine]", 
      "\"\<Warning: Some of the spots go out of the frame! \n\>\""}], "]"}]}],
    "\n"}]}]], "Input",
 CellChangeTimes->{{3.7672902721556883`*^9, 3.767290276050562*^9}},
 CellLabel->
  "In[8538]:=",ExpressionUUID->"fe08797f-f381-44cf-bb73-c4f6e4486f74"],

Cell[BoxData["\<\"GOOD: points are within pad size \\n\"\>"], "Output",
 CellChangeTimes->{{3.767290273693832*^9, 3.767290276962714*^9}, 
   3.7672917833641768`*^9, 3.76729273471972*^9, 3.767293031379115*^9, 
   3.7672932473541307`*^9, 3.767293673883376*^9, 3.767313771269246*^9, 
   3.767314137710712*^9, 3.767314581205765*^9, 3.767315234174395*^9, 
   3.767315638456382*^9, 3.767315901336549*^9, 3.7673162979890003`*^9, 
   3.767316556930862*^9, {3.767363637249197*^9, 3.76736366173446*^9}, 
   3.767368724665649*^9, {3.767368843207061*^9, 3.7673688570487413`*^9}, {
   3.767369543037134*^9, 3.767369561209332*^9}, 3.769862217753365*^9, {
   3.769862939910348*^9, 3.7698629571210546`*^9}, 3.769863789550063*^9, 
   3.7706442759532127`*^9, {3.7706444753456793`*^9, 3.7706445004321136`*^9}, 
   3.770644571596773*^9, 3.770646250183579*^9, 3.770646682533373*^9, 
   3.7711561355831137`*^9, 3.771156531893165*^9, 3.771156872796277*^9, 
   3.7774008718628683`*^9, 3.777400931194685*^9, 3.7774013337285013`*^9, 
   3.7774014957404413`*^9, {3.7777171850045347`*^9, 3.7777172036046124`*^9}, 
   3.777717451902335*^9, 3.7800768089812517`*^9, 3.780077223941209*^9, 
   3.780077257152247*^9, 3.7800772964706907`*^9, 3.780077773413128*^9, 
   3.7800778992533903`*^9},
 CellLabel->
  "Out[8538]=",ExpressionUUID->"adc71403-b303-4d2a-ba5b-41123b4089b6"]
}, Open  ]],

Cell["\<\
RGB color combine dynamic image with tracking ring 
Image of the WHOLE CELL: \
\>", "Text",
 CellChangeTimes->{{3.7669161923037577`*^9, 3.76691620776446*^9}, {
   3.767289882505427*^9, 3.7672898910082893`*^9}, 
   3.767290618611946*^9},ExpressionUUID->"f82e8340-a398-4228-8481-\
7e6547399544"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myLabel", " ", "=", " ", 
   RowBox[{"Text", "@", "\"\<iv.\>\""}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7800785507358103`*^9, 3.7800785571920223`*^9}, {
  3.7800786113571863`*^9, 3.780078614649413*^9}, {3.7800786478491793`*^9, 
  3.780078668329021*^9}},
 CellLabel->
  "In[8591]:=",ExpressionUUID->"b880e5da-7218-41a0-acf3-c26725fd89aa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myRedCenterList", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "frame"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{3.780078811428318*^9},
 CellLabel->
  "In[8600]:=",ExpressionUUID->"16fb619b-b0e5-4f27-8fe2-2cc274b4cd22"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"224", ",", "231"}], "}"}]], "Output",
 CellChangeTimes->{{3.7800788067671957`*^9, 3.780078811751403*^9}},
 CellLabel->
  "Out[8600]=",ExpressionUUID->"30bfe2a7-d255-4817-a663-f6653c97339b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"myRedCenterList", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "frame"}], "]"}], "]"}], " ", "+", " ", 
  RowBox[{"{", 
   RowBox[{"5", ",", "5"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.780078957640748*^9, 3.7800789627072287`*^9}},
 CellLabel->
  "In[8611]:=",ExpressionUUID->"403a0f89-c0e8-4737-859d-82ec79bf77de"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"229", ",", "236"}], "}"}]], "Output",
 CellChangeTimes->{3.780078963024609*^9},
 CellLabel->
  "Out[8611]=",ExpressionUUID->"e40c7a75-38fb-4cf1-88fa-b9afe878f5da"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"circle", " ", "=", " ", 
   RowBox[{"Graphics", "[", " ", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"Text", "[", " ", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<iv.\>\"", ",", "Large", ",", "Red", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Arial Narrow\>\""}]}], "]"}], 
        ",", " ", 
        RowBox[{
         RowBox[{"myRedCenterList", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "frame"}], "]"}], "]"}], "+", " ", 
         RowBox[{"{", 
          RowBox[{"9", ",", "9"}], "}"}]}]}], " ", "]"}], ",", "Blue", ",", 
      " ", "Thick", ",", 
      RowBox[{"Circle", "[", "  ", 
       RowBox[{
        RowBox[{"myRedCenterList", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "frame"}], "]"}], "]"}], ",", "7"}], "]"}]}], 
     "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.7800786897718763`*^9, {3.780078748117841*^9, 3.780078815709674*^9}, {
   3.7800788623549128`*^9, 3.780078917667495*^9}, {3.78007895177282*^9, 
   3.7800790267753563`*^9}},
 CellLabel->
  "In[8621]:=",ExpressionUUID->"5a3a9155-a687-4ffe-90a1-66fdbec12aba"],

Cell[BoxData[
 GraphicsBox[{InsetBox[
    StyleBox["\<\"iv.\"\>",
     StripOnInput->False,
     LineColor->RGBColor[1, 0, 0],
     FrontFaceColor->RGBColor[1, 0, 0],
     BackFaceColor->RGBColor[1, 0, 0],
     GraphicsColor->RGBColor[1, 0, 0],
     FontFamily->"Arial Narrow",
     FontSize->Large,
     FontColor->RGBColor[1, 0, 0]], {233, 240}], 
   {RGBColor[0, 0, 1], Thickness[Large], 
    CircleBox[{224, 231}, 7]}}]], "Output",
 CellChangeTimes->{
  3.7800786901661053`*^9, {3.7800787469226437`*^9, 3.7800787649781427`*^9}, 
   3.780078816594047*^9, {3.780078865657516*^9, 3.780078921150668*^9}, {
   3.780078968400494*^9, 3.7800790270121183`*^9}},
 CellLabel->
  "Out[8621]=",ExpressionUUID->"5b45390c-5107-45b0-a6ac-ce925d1dc2b2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mytempspotvideotracked", " ", "=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"myColMovieAdjCrop", "[", 
        RowBox[{"[", "frame", "]"}], "]"}], "   ", ",", "   ", 
       "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", " ", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"Text", "[", " ", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<i.\>\"", ",", "Large", ",", "White", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Arial Narrow\>\""}]}], 
             "]"}], ",", " ", 
            RowBox[{
             RowBox[{"myRedCenterList", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "frame"}], "]"}], "]"}], "+", " ", 
             RowBox[{"{", 
              RowBox[{"9", ",", "9"}], "}"}]}]}], " ", "]"}], ",", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             GraphicsBox[{
               {GrayLevel[0], RectangleBox[{0, 0}]}, 
               {GrayLevel[0], RectangleBox[{1, -1}]}, 
               {GrayLevel[1], RectangleBox[{0, -1}, {2, 1}]}},
              AspectRatio->1,
              DefaultBaseStyle->"ColorSwatchGraphics",
              Frame->True,
              FrameStyle->GrayLevel[0.6666666666666666],
              FrameTicks->None,
              
              ImageSize->
               Dynamic[{
                Automatic, 1.35 CurrentValue["FontCapHeight"]/
                 AbsoluteCurrentValue[Magnification]}],
              PlotRangePadding->None],
             StyleBox[
              RowBox[{"GrayLevel", "[", "1", "]"}], NumberMarks -> False]],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = GrayLevel[1]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["GrayLevelColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           GrayLevel[1],
           Editable->False,
           Selectable->False], ",", " ", "Thick", ",", 
          RowBox[{"Circle", "[", "  ", 
           RowBox[{
            RowBox[{"myRedCenterList", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "frame"}], "]"}], "]"}], ",", "7"}], "]"}]}], 
         "}"}], "]"}], " ", ",", " ", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Text", "[", " ", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<ii.\>\"", ",", "Large", ",", "White", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Arial Narrow\>\""}]}], 
             "]"}], ",", " ", 
            RowBox[{
             RowBox[{"myRedCenterList", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "frame"}], "]"}], "]"}], "+", " ", 
             RowBox[{"{", 
              RowBox[{"9", ",", "9"}], "}"}]}]}], " ", "]"}], ",", "   ", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             GraphicsBox[{
               {GrayLevel[0], RectangleBox[{0, 0}]}, 
               {GrayLevel[0], RectangleBox[{1, -1}]}, 
               {GrayLevel[1], RectangleBox[{0, -1}, {2, 1}]}},
              AspectRatio->1,
              DefaultBaseStyle->"ColorSwatchGraphics",
              Frame->True,
              FrameStyle->GrayLevel[0.6666666666666666],
              FrameTicks->None,
              
              ImageSize->
               Dynamic[{
                Automatic, 1.35 CurrentValue["FontCapHeight"]/
                 AbsoluteCurrentValue[Magnification]}],
              PlotRangePadding->None],
             StyleBox[
              RowBox[{"GrayLevel", "[", "1", "]"}], NumberMarks -> False]],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = GrayLevel[1]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["GrayLevelColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           GrayLevel[1],
           Editable->False,
           Selectable->False], ",", "Thick", ",", " ", 
          RowBox[{"Circle", "[", "  ", 
           RowBox[{
            RowBox[{"myRedCenterList", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "frame"}], "]"}], "]"}], ",", "7"}], "]"}]}], 
         "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Text", "[", " ", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<iii.\>\"", ",", "Large", ",", "White", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Arial Narrow\>\""}]}], 
             "]"}], ",", " ", 
            RowBox[{
             RowBox[{"myRedCenterList", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "frame"}], "]"}], "]"}], "+", " ", 
             RowBox[{"{", 
              RowBox[{"9", ",", "9"}], "}"}]}]}], " ", "]"}], ",", "  ", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             GraphicsBox[{
               {GrayLevel[0], RectangleBox[{0, 0}]}, 
               {GrayLevel[0], RectangleBox[{1, -1}]}, 
               {GrayLevel[1], RectangleBox[{0, -1}, {2, 1}]}},
              AspectRatio->1,
              DefaultBaseStyle->"ColorSwatchGraphics",
              Frame->True,
              FrameStyle->GrayLevel[0.6666666666666666],
              FrameTicks->None,
              
              ImageSize->
               Dynamic[{
                Automatic, 1.35 CurrentValue["FontCapHeight"]/
                 AbsoluteCurrentValue[Magnification]}],
              PlotRangePadding->None],
             StyleBox[
              RowBox[{"GrayLevel", "[", "1", "]"}], NumberMarks -> False]],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = GrayLevel[1]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["GrayLevelColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           GrayLevel[1],
           Editable->False,
           Selectable->False], ",", "Thick", ",", "  ", 
          RowBox[{"Circle", "[", "  ", 
           RowBox[{
            RowBox[{"myRedCenterList", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "frame"}], "]"}], "]"}], ",", "7"}], "]"}]}], 
         "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Text", "[", " ", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<iv.\>\"", ",", "Large", ",", "White", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Arial Narrow\>\""}]}], 
             "]"}], ",", " ", 
            RowBox[{
             RowBox[{"myRedCenterList", "[", 
              RowBox[{"[", 
               RowBox[{"4", ",", "frame"}], "]"}], "]"}], "+", " ", 
             RowBox[{"{", 
              RowBox[{"9", ",", "9"}], "}"}]}]}], " ", "]"}], ",", "   ", 
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             GraphicsBox[{
               {GrayLevel[0], RectangleBox[{0, 0}]}, 
               {GrayLevel[0], RectangleBox[{1, -1}]}, 
               {GrayLevel[1], RectangleBox[{0, -1}, {2, 1}]}},
              AspectRatio->1,
              DefaultBaseStyle->"ColorSwatchGraphics",
              Frame->True,
              FrameStyle->GrayLevel[0.6666666666666666],
              FrameTicks->None,
              
              ImageSize->
               Dynamic[{
                Automatic, 1.35 CurrentValue["FontCapHeight"]/
                 AbsoluteCurrentValue[Magnification]}],
              PlotRangePadding->None],
             StyleBox[
              RowBox[{"GrayLevel", "[", "1", "]"}], NumberMarks -> False]],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = GrayLevel[1]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["GrayLevelColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           GrayLevel[1],
           Editable->False,
           Selectable->False], ",", "Thick", ",", " ", 
          RowBox[{"Circle", "[", "  ", 
           RowBox[{
            RowBox[{"myRedCenterList", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "frame"}], "]"}], "]"}], ",", "7"}], "]"}]}], 
         "}"}], "]"}], " ", ",", " ", "\[IndentingNewLine]", "     ", 
       RowBox[{"ImageSize", "\[Rule]", " ", 
        RowBox[{"512", "*", "2"}]}]}], "]"}], " ", ",", " ", 
     RowBox[{"{", 
      RowBox[{"frame", ",", "1", ",", "20", ",", "1"}], "}"}]}], "]"}]}], 
  "   ", ";"}]], "Input",
 CellChangeTimes->{{3.78007859149473*^9, 3.780078601792715*^9}, {
   3.780078730223678*^9, 3.780078732977906*^9}, {3.78007883652334*^9, 
   3.780078838064646*^9}, {3.780078928407295*^9, 3.780078938308091*^9}, 
   3.780078988177002*^9, {3.780079057717689*^9, 3.780079267313308*^9}},
 CellLabel->
  "In[8640]:=",ExpressionUUID->"e690ea06-6e7d-4a0a-968a-438e667017b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "video", " ", "of", " ", "spot", " ", "in", " ", "whole", " ", "cell"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"myColMovieAdjCrop", "[", 
       RowBox[{"[", "frame", "]"}], "]"}], "   ", ",", " ", 
      RowBox[{"Graphics", "[", " ", 
       RowBox[{"{", 
        RowBox[{"White", ",", " ", "Thick", ",", 
         RowBox[{"Circle", "[", "  ", 
          RowBox[{
           RowBox[{"myRedCenterList", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "frame"}], "]"}], "]"}], ",", "7"}], "]"}]}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", " ", 
       RowBox[{"{", 
        RowBox[{"Yellow", ",", "Thick", ",", " ", 
         RowBox[{"Circle", "[", "  ", 
          RowBox[{
           RowBox[{"myRedCenterList", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "frame"}], "]"}], "]"}], ",", "7"}], "]"}]}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", " ", 
       RowBox[{"{", 
        RowBox[{
         InterpretationBox[
          ButtonBox[
           TooltipBox[
            GraphicsBox[{
              {GrayLevel[0], RectangleBox[{0, 0}]}, 
              {GrayLevel[0], RectangleBox[{1, -1}]}, 
              {RGBColor[0.63, 0, 1], RectangleBox[{0, -1}, {2, 1}]}},
             AspectRatio->1,
             DefaultBaseStyle->"ColorSwatchGraphics",
             Frame->True,
             
             FrameStyle->RGBColor[
              0.42000000000000004`, 0., 0.6666666666666666],
             FrameTicks->None,
             
             ImageSize->
              Dynamic[{
               Automatic, 1.35 CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification]}],
             PlotRangePadding->None],
            StyleBox[
             RowBox[{"RGBColor", "[", 
               RowBox[{"0.63`", ",", "0", ",", "1"}], "]"}], NumberMarks -> 
             False]],
           Appearance->None,
           BaseStyle->{},
           BaselinePosition->Baseline,
           ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
             If[
              Not[
               AbsoluteCurrentValue["Deployed"]], 
              SelectionMove[Typeset`box$, All, Expression]; 
              FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
              FrontEnd`Private`$ColorSelectorInitialColor = 
               RGBColor[0.63, 0, 1]; 
              FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
              MathLink`CallFrontEnd[
                FrontEnd`AttachCell[Typeset`box$, 
                 FrontEndResource["RGBColorValueSelector"], {
                 0, {Left, Bottom}}, {Left, Top}, 
                 "ClosingActions" -> {
                  "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
           DefaultBaseStyle->{},
           Evaluator->Automatic,
           Method->"Preemptive"],
          RGBColor[0.63, 0, 1],
          Editable->False,
          Selectable->False], ",", "Thick", ",", "  ", 
         RowBox[{"Circle", "[", "  ", 
          RowBox[{
           RowBox[{"myRedCenterList", "[", 
            RowBox[{"[", 
             RowBox[{"3", ",", "frame"}], "]"}], "]"}], ",", "7"}], "]"}]}], 
        "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", " ", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Thick", ",", " ", 
         RowBox[{"Circle", "[", "  ", 
          RowBox[{
           RowBox[{"myRedCenterList", "[", 
            RowBox[{"[", 
             RowBox[{"4", ",", "frame"}], "]"}], "]"}], ",", "7"}], "]"}]}], 
        "}"}], "]"}], "    ", ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", " ", 
       RowBox[{"512", "*", "2"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"frame", ",", "1", ",", 
      RowBox[{"Length", "@", "myTimeList"}], ",", "1"}], "}"}]}], "  ", "]"}],
   " "}]], "Input",
 CellChangeTimes->{
  3.766914861085959*^9, {3.7669161577379627`*^9, 3.766916174659494*^9}, 
   3.767103607254635*^9, {3.767213703082855*^9, 3.767213716066874*^9}, 
   3.767286358246908*^9, 3.767287966032269*^9, {3.767288587760077*^9, 
   3.76728858947514*^9}, 3.767290236868431*^9, 3.767314282786023*^9, 
   3.7673144142244377`*^9, {3.767356968231121*^9, 3.767356968749733*^9}, 
   3.777401559315321*^9, {3.777717212499296*^9, 3.777717212797739*^9}, {
   3.780076814327222*^9, 3.780076835254043*^9}, {3.780076958893052*^9, 
   3.780077095780398*^9}, {3.780077150263301*^9, 3.78007717925465*^9}, {
   3.7800783581844807`*^9, 3.780078375617661*^9}},
 CellLabel->
  "In[8572]:=",ExpressionUUID->"daf23a6f-fe95-4a47-9553-cc4a6e1e213d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.780078229513509*^9, 3.780078249256805*^9}, 
   3.780078293624741*^9, {3.780078467149868*^9, 3.78007846771653*^9}},
 CellLabel->
  "In[8576]:=",ExpressionUUID->"b56bde44-4827-4da5-b421-19185e9b8604"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mytempspotvideotracked", " ", "=", " ", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"myColMovieAdjCrop", "[", 
        RowBox[{"[", "frame", "]"}], "]"}], "   ", ",", " ", 
       RowBox[{"Graphics", "[", " ", 
        RowBox[{"{", 
         RowBox[{"White", ",", " ", "Thick", ",", 
          RowBox[{"Circle", "[", "  ", 
           RowBox[{
            RowBox[{"myRedCenterList", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "frame"}], "]"}], "]"}], ",", "7"}], "]"}]}], 
         "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", " ", 
        RowBox[{"{", 
         RowBox[{"Yellow", ",", "Thick", ",", " ", 
          RowBox[{"Circle", "[", "  ", 
           RowBox[{
            RowBox[{"myRedCenterList", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "frame"}], "]"}], "]"}], ",", "7"}], "]"}]}], 
         "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", " ", 
        RowBox[{"{", 
         RowBox[{
          InterpretationBox[
           ButtonBox[
            TooltipBox[
             GraphicsBox[{
               {GrayLevel[0], RectangleBox[{0, 0}]}, 
               {GrayLevel[0], RectangleBox[{1, -1}]}, 
               {RGBColor[0.63, 0, 1], RectangleBox[{0, -1}, {2, 1}]}},
              AspectRatio->1,
              DefaultBaseStyle->"ColorSwatchGraphics",
              Frame->True,
              
              FrameStyle->RGBColor[
               0.42000000000000004`, 0., 0.6666666666666666],
              FrameTicks->None,
              
              ImageSize->
               Dynamic[{
                Automatic, 1.35 CurrentValue["FontCapHeight"]/
                 AbsoluteCurrentValue[Magnification]}],
              PlotRangePadding->None],
             StyleBox[
              RowBox[{"RGBColor", "[", 
                RowBox[{"0.63`", ",", "0", ",", "1"}], "]"}], NumberMarks -> 
              False]],
            Appearance->None,
            BaseStyle->{},
            BaselinePosition->Baseline,
            ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
              If[
               Not[
                AbsoluteCurrentValue["Deployed"]], 
               SelectionMove[Typeset`box$, All, Expression]; 
               FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
               FrontEnd`Private`$ColorSelectorInitialColor = 
                RGBColor[0.63, 0, 1]; 
               FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
               MathLink`CallFrontEnd[
                 FrontEnd`AttachCell[Typeset`box$, 
                  FrontEndResource["RGBColorValueSelector"], {
                  0, {Left, Bottom}}, {Left, Top}, 
                  "ClosingActions" -> {
                   "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
            DefaultBaseStyle->{},
            Evaluator->Automatic,
            Method->"Preemptive"],
           RGBColor[0.63, 0, 1],
           Editable->False,
           Selectable->False], ",", "Thick", ",", "  ", 
          RowBox[{"Circle", "[", "  ", 
           RowBox[{
            RowBox[{"myRedCenterList", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "frame"}], "]"}], "]"}], ",", "7"}], "]"}]}], 
         "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Graphics", "[", " ", 
        RowBox[{"{", 
         RowBox[{"Red", ",", "Thick", ",", " ", 
          RowBox[{"Circle", "[", "  ", 
           RowBox[{
            RowBox[{"myRedCenterList", "[", 
             RowBox[{"[", 
              RowBox[{"4", ",", "frame"}], "]"}], "]"}], ",", "7"}], "]"}]}], 
         "}"}], "]"}], "    ", ",", " ", 
       RowBox[{"ImageSize", "\[Rule]", " ", 
        RowBox[{"512", "*", "2"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"frame", ",", "1", ",", 
       RowBox[{"Length", "@", "myTimeList"}], ",", "1"}], "}"}]}], "  ", 
    "]"}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.7800781112704687`*^9, 3.780078116064993*^9}, {
  3.780078398162075*^9, 3.7800783996320333`*^9}},
 CellLabel->
  "In[8573]:=",ExpressionUUID->"98c6e468-b4ef-4d30-a456-e0ae5add83e7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Export", "[", " ", 
  RowBox[{
   RowBox[{"analysisFolder", " ", "<>", " ", "\"\<_tracked_video.tiff\>\""}], 
   ",", " ", "mytempspotvideotracked"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", " ", 
  RowBox[{
   RowBox[{
   "analysisFolder", " ", "<>", " ", "\"\<_tracked_video_wholecell.avi\>\""}],
    ",", " ", "mytempspotvideotracked", ",", " ", 
   RowBox[{"\"\<FrameRate\>\"", " ", "\[Rule]", " ", "4"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.767014284661562*^9, {3.7670147866613703`*^9, 3.7670147929977913`*^9}, {
   3.7670148315357227`*^9, 3.767014883793788*^9}, {3.767015478821271*^9, 
   3.7670154798014307`*^9}, {3.767015542150141*^9, 3.7670155425475483`*^9}, {
   3.767105554342115*^9, 3.767105560204776*^9}, {3.767105675639732*^9, 
   3.767105677738924*^9}, {3.767195817300385*^9, 3.767195820895377*^9}, {
   3.777400957559676*^9, 3.777400984847402*^9}, {3.7774011054500017`*^9, 
   3.7774011271244173`*^9}, {3.7774013133029213`*^9, 
   3.7774013216005096`*^9}, {3.777401351768853*^9, 3.7774013571641197`*^9}, {
   3.780076794255938*^9, 3.780076794314558*^9}, {3.780078071019781*^9, 
   3.780078084943119*^9}},
 CellLabel->
  "In[8641]:=",ExpressionUUID->"3d058498-e339-4c89-8b8b-87971105cba2"],

Cell[BoxData["\<\"/Volumes/BITTY/ExampleTACell_Fig1/Analysis/TA10b_tracked_\
video.tiff\"\>"], "Output",
 CellChangeTimes->{
  3.7800781206249104`*^9, {3.7800782347605743`*^9, 3.780078257778035*^9}, 
   3.780078305399076*^9, 3.7800784078622026`*^9, 3.780079275203248*^9},
 CellLabel->
  "Out[8641]=",ExpressionUUID->"2cd05bdb-67e2-420c-b8d6-cbd6ca87f8b6"],

Cell[BoxData["\<\"/Volumes/BITTY/ExampleTACell_Fig1/Analysis/TA10b_tracked_\
video_wholecell.avi\"\>"], "Output",
 CellChangeTimes->{
  3.7800781206249104`*^9, {3.7800782347605743`*^9, 3.780078257778035*^9}, 
   3.780078305399076*^9, 3.7800784078622026`*^9, 3.7800792890916967`*^9},
 CellLabel->
  "Out[8642]=",ExpressionUUID->"b28e8f81-a9aa-410f-a066-2bbd0c475756"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1070, 711},
WindowMargins->{{38, Automatic}, {Automatic, 0}},
Magnification:>0.75 Inherited,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 199, 4, 51, "Section",ExpressionUUID->"3f07c72f-85b6-4681-a408-a4718c8f0c18"],
Cell[782, 28, 733, 12, 84, "Text",ExpressionUUID->"7b09ba0a-f281-4131-9a7c-b1666f34a03b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1552, 45, 255, 4, 51, "Section",ExpressionUUID->"758ecad8-d80b-46fb-82bb-ad2e406fd28c"],
Cell[CellGroupData[{
Cell[1832, 53, 212, 3, 0, "Subsection",ExpressionUUID->"8cb08f85-32ab-4789-b881-6daec01df10a"],
Cell[2047, 58, 2892, 78, 0, "Input",ExpressionUUID->"656dff07-5f80-4e42-88e5-ac9f6caab26e"]
}, Closed]],
Cell[CellGroupData[{
Cell[4976, 141, 229, 4, 0, "Subsection",ExpressionUUID->"e3cd521a-93de-4017-a61c-bfc187e2d2e4"],
Cell[5208, 147, 1099, 29, 0, "Input",ExpressionUUID->"096d0ea6-8ac6-4f77-ad10-03ee9de40601"]
}, Closed]],
Cell[CellGroupData[{
Cell[6344, 181, 157, 3, 0, "Subsection",ExpressionUUID->"f98a213a-716d-497c-9a1d-3bfe197e8d3d"],
Cell[6504, 186, 1662, 45, 0, "Input",ExpressionUUID->"6ad9a377-aa8c-46a3-843e-148a3b2332fd"],
Cell[8169, 233, 51185, 845, 0, "Input",ExpressionUUID->"0d97f3f9-dc4e-4b68-8e09-e30b7d44cd12"]
}, Closed]],
Cell[CellGroupData[{
Cell[59391, 1083, 242, 4, 0, "Subsection",ExpressionUUID->"cf842ced-36be-4bdc-b758-24be0ce41324"],
Cell[59636, 1089, 11234, 249, 0, "Input",ExpressionUUID->"ebb8d511-56d1-43e6-a736-4a22dcafd132"]
}, Closed]],
Cell[CellGroupData[{
Cell[70907, 1343, 218, 4, 0, "Subsection",ExpressionUUID->"23e54ef2-b5fd-46ec-82a1-323bcc760f5a"],
Cell[71128, 1349, 11569, 257, 0, "Input",ExpressionUUID->"4905c452-175f-49d4-962b-384d9e54ac83"]
}, Closed]],
Cell[CellGroupData[{
Cell[82734, 1611, 164, 3, 0, "Subsection",ExpressionUUID->"35bbb725-2dcf-4317-94bc-bb754bd912ad"],
Cell[82901, 1616, 10180, 228, 0, "Input",ExpressionUUID->"c4d25eed-5d8e-45f9-b813-ad989dda868b"],
Cell[93084, 1846, 9276, 224, 0, "Input",ExpressionUUID->"07f33d1a-dbe2-4edb-8ea1-06013e33850e"]
}, Closed]],
Cell[CellGroupData[{
Cell[102397, 2075, 163, 3, 0, "Subsection",ExpressionUUID->"22722800-c48e-4d31-8b6b-ed42c16b1010"],
Cell[102563, 2080, 19082, 420, 0, "Input",ExpressionUUID->"b399d9ed-54ae-4411-9311-94d8b485cd63"],
Cell[121648, 2502, 16329, 378, 0, "Input",ExpressionUUID->"639f7fb2-3c66-48c4-a6e2-855d15efe6d5"]
}, Closed]],
Cell[CellGroupData[{
Cell[138014, 2885, 163, 3, 0, "Subsection",ExpressionUUID->"064717fb-9a60-4b41-b181-4fe59e29cbfc"],
Cell[138180, 2890, 4104, 90, 0, "Input",ExpressionUUID->"bb1218e8-0849-4630-bfe3-ebdc6bec9a65"],
Cell[142287, 2982, 2523, 57, 0, "Input",ExpressionUUID->"bc5e76ee-de19-4bbc-afab-7733a2385851"],
Cell[144813, 3041, 4859, 115, 0, "Input",ExpressionUUID->"fe21cfa8-6986-4eaa-af88-bed3bfaea37e"],
Cell[149675, 3158, 1391, 37, 0, "Input",ExpressionUUID->"ef7a5c03-8cbf-4f18-ac26-cbe5709c0583"],
Cell[151069, 3197, 2738, 72, 0, "Input",ExpressionUUID->"509b1cbd-4f09-4e33-afc4-1224f02defc5"]
}, Closed]],
Cell[CellGroupData[{
Cell[153844, 3274, 398, 8, 0, "Subsection",ExpressionUUID->"5877958b-0478-4e3a-bf3b-d0460736ce6f"],
Cell[154245, 3284, 12033, 226, 0, "Input",ExpressionUUID->"ac00e7fd-158a-4f47-a4cd-a2c4e7124f4e"]
}, Closed]],
Cell[CellGroupData[{
Cell[166315, 3515, 426, 8, 0, "Subsection",ExpressionUUID->"4114f7dc-f275-426d-878f-d33fec46039f"],
Cell[166744, 3525, 3380, 67, 0, "Input",ExpressionUUID->"7723b677-00ac-4bad-a2fc-617d06cf3d1a"],
Cell[170127, 3594, 5197, 124, 0, "Input",ExpressionUUID->"a1db5db6-6304-4051-817a-9848a8dead52"]
}, Closed]],
Cell[CellGroupData[{
Cell[175361, 3723, 292, 4, 0, "Subsection",ExpressionUUID->"82501da8-27d3-41c4-919a-6a91c3668e37"],
Cell[175656, 3729, 2440, 54, 0, "Input",ExpressionUUID->"ce2cb924-fceb-4603-9a5d-7c19ed17c90e"],
Cell[178099, 3785, 1310, 37, 0, "Input",ExpressionUUID->"24c6d2ca-d437-436d-a2ca-e8901fc98d27"],
Cell[179412, 3824, 8891, 203, 0, "Input",ExpressionUUID->"8e2a5c19-7e6c-4da2-82bc-c53f9938adbc"]
}, Closed]],
Cell[CellGroupData[{
Cell[188340, 4032, 259, 4, 0, "Subsection",ExpressionUUID->"42b0c1a2-f5ce-42fd-bae4-0a31b08df29a"],
Cell[188602, 4038, 4233, 95, 0, "Input",ExpressionUUID->"d899a0da-0a23-46c3-9f8f-39815f16a4e3"]
}, Closed]],
Cell[CellGroupData[{
Cell[192872, 4138, 161, 3, 0, "Subsection",ExpressionUUID->"9ee3618b-b7ab-4cda-b98d-b18d656f8d1d"],
Cell[193036, 4143, 506, 10, 0, "Input",ExpressionUUID->"6f5db85a-570c-4bbd-b299-fa7459cda639"],
Cell[193545, 4155, 3866, 96, 0, "Input",ExpressionUUID->"0f2410ff-b202-4ef3-abac-1d744fff5830"]
}, Closed]],
Cell[CellGroupData[{
Cell[197448, 4256, 159, 3, 0, "Subsection",ExpressionUUID->"f7fe15cd-a3df-406c-8d08-e574d4759856"],
Cell[197610, 4261, 513, 9, 0, "Input",ExpressionUUID->"d5b4867a-3176-4d7a-93ad-6894f58bd0b7"],
Cell[198126, 4272, 13272, 294, 0, "Input",ExpressionUUID->"6ff309f0-4fbf-4d46-bce7-0a511ac96dd8"],
Cell[211401, 4568, 440, 10, 0, "Input",ExpressionUUID->"97c8f76c-8fa2-4c2e-9770-016c61a3c9d9"]
}, Closed]],
Cell[CellGroupData[{
Cell[211878, 4583, 165, 3, 0, "Subsection",ExpressionUUID->"db94ffc5-f824-4e2c-8fab-1f05523d3d48"],
Cell[212046, 4588, 643, 12, 0, "Text",ExpressionUUID->"59f65602-4c60-4e55-a84b-747f815ce24a"],
Cell[212692, 4602, 2511, 52, 0, "Input",ExpressionUUID->"55ae7aa6-f29e-4601-ac2c-cd9d1e2f17d0"],
Cell[215206, 4656, 12763, 274, 0, "Input",ExpressionUUID->"b03344ff-129d-41e3-bc45-bc5eaa32f134"],
Cell[227972, 4932, 13085, 280, 0, "Input",ExpressionUUID->"c0d772fb-e2fd-4401-89de-fdda03298174"],
Cell[241060, 5214, 16412, 344, 0, "Input",ExpressionUUID->"c6724af9-01d1-41f0-8e98-973f754b04ba"],
Cell[257475, 5560, 15191, 315, 0, "Input",ExpressionUUID->"cb6ef53a-fb22-45a2-8783-c5a6f004feae"],
Cell[272669, 5877, 13632, 289, 0, "Input",ExpressionUUID->"4b84309d-cddb-42f3-a43e-70e470815b9d"],
Cell[286304, 6168, 14960, 312, 0, "Input",ExpressionUUID->"884cec7f-f0bf-4904-a9eb-666b96f797b7"]
}, Closed]],
Cell[CellGroupData[{
Cell[301301, 6485, 162, 3, 0, "Subsection",ExpressionUUID->"33a59f29-f52d-4f7c-a621-07ba86419f00"],
Cell[301466, 6490, 6870, 163, 0, "Input",ExpressionUUID->"07720052-1098-404b-9512-f354c4295570"],
Cell[308339, 6655, 1889, 48, 0, "Input",ExpressionUUID->"935ebc3d-ee9e-4673-928b-6a14f723c56e"],
Cell[310231, 6705, 1960, 46, 0, "Input",ExpressionUUID->"d9ebd50d-697c-4f41-bc11-60ec0fe9b1ed"],
Cell[312194, 6753, 1802, 45, 0, "Input",ExpressionUUID->"040952a7-0b02-4c3e-99dd-ac7019c63c2c"]
}, Closed]],
Cell[CellGroupData[{
Cell[314033, 6803, 424, 8, 0, "Subsection",ExpressionUUID->"1f951c62-3bf4-4a2a-8a9b-9d0952291a60"],
Cell[314460, 6813, 6591, 156, 0, "Input",ExpressionUUID->"54b810ff-269f-4f68-bd6e-658077341d25"]
}, Closed]],
Cell[CellGroupData[{
Cell[321088, 6974, 312, 7, 0, "Subsection",ExpressionUUID->"d64a05af-02b7-4ca0-be3b-64d174d6ccac"],
Cell[321403, 6983, 2528, 51, 0, "Input",ExpressionUUID->"bc52e14a-58a0-4456-b4b1-ff6212fb5d0c"]
}, Closed]],
Cell[CellGroupData[{
Cell[323968, 7039, 488, 9, 0, "Subsection",ExpressionUUID->"873d5f51-8113-4d1e-b278-68dd833b7d8a"],
Cell[324459, 7050, 4402, 90, 0, "Input",ExpressionUUID->"691d7d1d-e859-4ddb-8b7f-8a35a07af45b"]
}, Closed]],
Cell[CellGroupData[{
Cell[328898, 7145, 306, 5, 0, "Subsection",ExpressionUUID->"603c25a0-0ed6-4734-a846-12ab606ec971"],
Cell[329207, 7152, 14355, 314, 0, "Input",ExpressionUUID->"e179f637-930a-4dfc-a933-3926d8531b1c"],
Cell[343565, 7468, 8667, 202, 0, "Input",ExpressionUUID->"5c288b64-6f54-479c-b0d0-e6d29650f930"],
Cell[352235, 7672, 3615, 85, 0, "Input",ExpressionUUID->"1ef56b29-7824-4b9e-a249-fe0dda430dc0"]
}, Closed]],
Cell[CellGroupData[{
Cell[355887, 7762, 253, 4, 0, "Subsection",ExpressionUUID->"0561d3d1-9341-4bd1-9ba8-231ce873d04b"],
Cell[356143, 7768, 1608, 36, 0, "Input",ExpressionUUID->"21335729-9ca3-4c02-af3e-2789bc6211af"],
Cell[357754, 7806, 1937, 43, 0, "Input",ExpressionUUID->"d0db0273-57ac-44fb-bf1c-a5e037e7c25b"],
Cell[359694, 7851, 6763, 154, 0, "Input",ExpressionUUID->"7b34700f-17c0-4dc6-b161-bb484a8f69d5"]
}, Closed]],
Cell[CellGroupData[{
Cell[366494, 8010, 158, 3, 0, "Subsection",ExpressionUUID->"eced1eb2-4a00-411a-8d3f-ef52922f98d0"],
Cell[366655, 8015, 621, 11, 0, "Input",ExpressionUUID->"5eb3a08a-fc5f-4bac-8dc1-1192c8ee332e"],
Cell[367279, 8028, 8959, 199, 0, "Input",ExpressionUUID->"234ec91a-b7f8-43cb-8dbf-054f9e5c8e7a"]
}, Closed]],
Cell[CellGroupData[{
Cell[376275, 8232, 171, 3, 0, "Subsection",ExpressionUUID->"1edbe8ff-b774-4be2-be35-d8bdd5e58989"],
Cell[376449, 8237, 7650, 175, 0, "Input",ExpressionUUID->"8d74d7e6-aceb-42e6-b4bf-7fa09cb513dd"]
}, Closed]],
Cell[CellGroupData[{
Cell[384136, 8417, 170, 3, 0, "Subsection",ExpressionUUID->"8a082051-d2c7-4845-90e8-2b24805ccc51"],
Cell[384309, 8422, 7846, 169, 0, "Input",ExpressionUUID->"e6f1600d-e7f3-412c-9509-14f7c34d2aaa"],
Cell[392158, 8593, 9481, 194, 0, "Input",ExpressionUUID->"2a597b2c-4228-4cb6-8c5d-7e32887d28c2"],
Cell[401642, 8789, 7252, 163, 0, "Input",ExpressionUUID->"d7b5f399-acd9-4a07-985e-35d99e7e234c"]
}, Closed]],
Cell[CellGroupData[{
Cell[408931, 8957, 163, 3, 0, "Subsection",ExpressionUUID->"1883b62e-bec1-43fc-9774-28798021b6d7"],
Cell[409097, 8962, 40987, 837, 0, "Input",ExpressionUUID->"5b48b1a6-45c5-4743-ab9f-fdfab1fd1a3a"],
Cell[450087, 9801, 40887, 837, 0, "Input",ExpressionUUID->"4a55e1cd-c647-4b18-b8c9-2a10b6ad78f5"]
}, Closed]],
Cell[CellGroupData[{
Cell[491011, 10643, 218, 4, 0, "Subsection",ExpressionUUID->"3d1858ec-3141-4fc1-98d7-0f43f356dbdf"],
Cell[491232, 10649, 4164, 97, 0, "Input",ExpressionUUID->"1ab9bc7e-65db-419e-b9b9-e9430a853082"]
}, Closed]],
Cell[CellGroupData[{
Cell[495433, 10751, 166, 3, 0, "Subsection",ExpressionUUID->"acb548d0-1794-4ea7-b4ed-bb7d76d9a0d5"],
Cell[495602, 10756, 3293, 81, 0, "Input",ExpressionUUID->"2d1c4e11-ce9a-4d7f-b7ca-599602f209eb"]
}, Closed]],
Cell[CellGroupData[{
Cell[498932, 10842, 168, 3, 0, "Subsection",ExpressionUUID->"73f259af-eeef-427c-9ee5-d1d410d3e7ca"],
Cell[499103, 10847, 4746, 118, 0, "Input",ExpressionUUID->"2f1cad17-a302-410c-a38e-b29e1d8a6ab5"],
Cell[503852, 10967, 7152, 175, 0, "Input",ExpressionUUID->"c3bd4d71-e2b2-4e3a-9f2d-2a49eec62e74"],
Cell[CellGroupData[{
Cell[511029, 11146, 185, 2, 0, "Input",ExpressionUUID->"1f77646d-7270-4017-b508-3bd48f3b51b1"],
Cell[511217, 11150, 1327, 19, 6, "Output",ExpressionUUID->"2e8366ff-e036-44c8-a29f-4479adb4be66"]
}, Open  ]],
Cell[CellGroupData[{
Cell[512581, 11174, 339, 6, 0, "Input",ExpressionUUID->"bd1d6538-d42a-4e3f-9424-948d4a8949fe"],
Cell[512923, 11182, 1371, 20, 6, "Output",ExpressionUUID->"86c78f2f-e077-4ffb-9988-e67fdf2f6823"]
}, Open  ]],
Cell[CellGroupData[{
Cell[514331, 11207, 338, 6, 0, "Input",ExpressionUUID->"1796b896-ae10-4e06-ad2d-04806815503e"],
Cell[514672, 11215, 1448, 21, 6, "Output",ExpressionUUID->"30443928-51f2-4128-83be-0752e609f883"]
}, Open  ]],
Cell[CellGroupData[{
Cell[516157, 11241, 622, 15, 0, "Input",ExpressionUUID->"f987b871-80ae-4e3f-a1e6-8c6803e22702"],
Cell[516782, 11258, 1618, 26, 6, "Output",ExpressionUUID->"133f708d-1a82-48d9-af42-47f9911a102e"]
}, Open  ]],
Cell[518415, 11287, 228, 4, 0, "Input",ExpressionUUID->"0834d9fb-d15c-4436-b3f2-f5d1b1c86891"],
Cell[518646, 11293, 409, 10, 0, "Input",ExpressionUUID->"a1185b1c-cd29-471c-9feb-3caada403169"],
Cell[519058, 11305, 826, 23, 0, "Input",ExpressionUUID->"04a5f8d7-1018-4924-bd2a-f86b55ff02b7"],
Cell[CellGroupData[{
Cell[519909, 11332, 475, 13, 0, "Input",ExpressionUUID->"0a2fd8ac-1106-4e26-aa37-de5febab040f"],
Cell[520387, 11347, 1570, 25, 6, "Output",ExpressionUUID->"d3a54ae9-09e0-4de6-8bcc-aa43ac6cd15f"]
}, Open  ]],
Cell[521972, 11375, 1480, 38, 0, "Input",ExpressionUUID->"d0197ce1-6dd4-4904-86bb-47eb224d29db"],
Cell[CellGroupData[{
Cell[523477, 11417, 441, 8, 0, "Input",ExpressionUUID->"11d1a37c-326a-4a18-9a41-ec472ac4fce6"],
Cell[523921, 11427, 1385, 21, 6, "Output",ExpressionUUID->"d11676ce-9848-4769-9f90-2f40625074f9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[525343, 11453, 360, 9, 0, "Input",ExpressionUUID->"0b91f865-10d7-4725-bc74-cc89c66e4048"],
Cell[525706, 11464, 1314, 20, 6, "Output",ExpressionUUID->"5dc07fc5-c24d-46a2-b849-632316292536"]
}, Open  ]],
Cell[CellGroupData[{
Cell[527057, 11489, 889, 24, 0, "Input",ExpressionUUID->"60a91ba6-2690-4121-a9db-47cf2f9f8a95"],
Cell[527949, 11515, 1345, 20, 6, "Output",ExpressionUUID->"ff4f9973-4bc7-42da-96b8-1fb4cf0ee6b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[529331, 11540, 252, 5, 0, "Input",ExpressionUUID->"3667e09e-d1b4-417f-93f9-ad54707e79ef"],
Cell[529586, 11547, 1665, 28, 6, "Message",ExpressionUUID->"5d759a2c-a1fd-46aa-be53-239708154690"],
Cell[531254, 11577, 1356, 21, 6, "Output",ExpressionUUID->"d31b9b0d-5e24-4aad-a154-8246ef9471e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[532647, 11603, 641, 17, 0, "Input",ExpressionUUID->"86f83144-0603-4806-9225-be745e61f51b"],
Cell[533291, 11622, 1509, 25, 6, "Message",ExpressionUUID->"621ca8b2-30b7-414a-89f5-2e8e012fca64"],
Cell[534803, 11649, 1508, 25, 6, "Message",ExpressionUUID->"76b8e4f6-b8cb-4f07-bdf9-591cd1d0b813"],
Cell[536314, 11676, 1773, 29, 6, "Message",ExpressionUUID->"aa637914-95a4-41f3-a2b3-963c64309282"],
Cell[538090, 11707, 1667, 30, 6, "Output",ExpressionUUID->"62ed3d95-b80f-4517-9190-c8f23bcacfe9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[539794, 11742, 257, 4, 0, "Input",ExpressionUUID->"b0c8e533-83a9-4c59-affd-870861592960"],
Cell[540054, 11748, 1508, 25, 6, "Message",ExpressionUUID->"dedf4cc3-cf1d-4954-abcf-d1fd70f96bea"],
Cell[541565, 11775, 1403, 21, 6, "Output",ExpressionUUID->"a48cde0b-3d38-42a8-9cca-b2d36cc223be"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[543029, 11803, 157, 3, 41, "Section",ExpressionUUID->"860d800a-0d7e-4fc6-8216-3e73d1323d23"],
Cell[CellGroupData[{
Cell[543211, 11810, 184, 3, 41, "Subsection",ExpressionUUID->"10d8d7c0-839c-43b9-8f4f-73b4113bd9eb"],
Cell[543398, 11815, 309, 7, 1, "Input",ExpressionUUID->"e94eeece-631a-4ad9-b4ca-de1d66332ebc"],
Cell[543710, 11824, 2299, 54, 10, "Input",ExpressionUUID->"ade421ea-6fa5-447e-8c07-65a464f32180"],
Cell[CellGroupData[{
Cell[546034, 11882, 2074, 48, 8, "Input",ExpressionUUID->"90bb152d-a5a5-44dd-8aa1-e9b4abfa9a3a"],
Cell[548111, 11932, 350, 8, 1, "Message",ExpressionUUID->"d99ffe17-c273-4545-aa31-dba8486c5f0a"],
Cell[548464, 11942, 352, 8, 1, "Message",ExpressionUUID->"eb3001ff-a601-49cb-8a47-ee96f1291825"]
}, Open  ]],
Cell[548831, 11953, 154, 3, 1, "Input",ExpressionUUID->"76353c37-1165-40b4-8af1-268c6b899143"],
Cell[CellGroupData[{
Cell[549010, 11960, 2037, 43, 5, "Input",ExpressionUUID->"e74b475d-98df-4edd-ae39-344df8384cd1"],
Cell[551050, 12005, 1628, 24, 2, "Output",ExpressionUUID->"1d2d7eee-db6b-4bfd-9e50-6e527132462b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[552715, 12034, 2788, 56, 8, "Input",ExpressionUUID->"a4a77e60-f2c9-46b0-a765-5fc776066a8e"],
Cell[555506, 12092, 470, 10, 0, "Message",ExpressionUUID->"0c046e53-e113-4903-98a0-cf55505d5833"],
Cell[555979, 12104, 3288, 67, 9, "Output",ExpressionUUID->"0295189a-1112-4e9f-80b5-aef4123655e5"]
}, Closed]],
Cell[559282, 12174, 306, 9, 1, "Input",ExpressionUUID->"94080c6c-ecc1-4051-b372-9b32ce24b2c8"]
}, Closed]],
Cell[CellGroupData[{
Cell[559625, 12188, 184, 3, 30, "Subsection",ExpressionUUID->"eb1ec07a-65cd-4173-812e-08e5601c40f9"],
Cell[559812, 12193, 1085, 26, 5, "Input",ExpressionUUID->"6caa1fc4-21e6-416e-b9d2-e4646cd9e831"],
Cell[CellGroupData[{
Cell[560922, 12223, 1988, 47, 8, "Input",ExpressionUUID->"47d7dd18-7c01-4b01-88c8-d387b204238e"],
Cell[562913, 12272, 352, 8, 1, "Message",ExpressionUUID->"c919cbee-7ae4-4039-9106-7c9c98f465b4"],
Cell[563268, 12282, 354, 8, 1, "Message",ExpressionUUID->"5705c2ac-32a8-425e-948e-128bfe4b267f"],
Cell[563625, 12292, 352, 8, 1, "Message",ExpressionUUID->"764a3274-0a87-4ba8-ba89-8d8a0d0988f0"],
Cell[563980, 12302, 356, 8, 1, "Message",ExpressionUUID->"357e44f4-c765-486d-a48d-4c1147e88c1f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[564373, 12315, 1735, 39, 6, "Input",ExpressionUUID->"c4fa2874-5404-4379-a90f-1bc56c72c75a"],
Cell[566111, 12356, 993, 16, 2, "Output",ExpressionUUID->"200cfa07-1008-4963-9e2b-12258305df6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[567141, 12377, 883, 19, 5, "Input",ExpressionUUID->"ac664e94-458a-411c-aad7-36df24bf98e5"],
Cell[568027, 12398, 469, 10, 1, "Message",ExpressionUUID->"3fac17f0-4da3-4b19-95a1-5fb9e993323c"],
Cell[568499, 12410, 471, 10, 1, "Message",ExpressionUUID->"f1598ad7-dd50-4f36-a539-382b596af5a6"],
Cell[568973, 12422, 470, 10, 3, "Message",ExpressionUUID->"df80a445-b7a3-48bd-9c1d-564c26e05633"],
Cell[569446, 12434, 470, 10, 1, "Message",ExpressionUUID->"b0b2ad97-ed5c-4b9e-95cf-ff1139b9d440"],
Cell[569919, 12446, 1325, 31, 17, "Output",ExpressionUUID->"d7d23d73-3727-455a-af17-f43f5e7a824e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[571293, 12483, 400, 6, 30, "Subsection",ExpressionUUID->"9941b58d-7e7c-4224-a1e8-6b4033eb2f0d"],
Cell[CellGroupData[{
Cell[571718, 12493, 698, 13, 24, "Input",ExpressionUUID->"badab3d9-cd4b-4486-9e38-fd300449e881"],
Cell[572419, 12508, 425, 10, 38, "Output",ExpressionUUID->"3df6dc1b-4e63-46b0-b19e-e75d54d05f89"]
}, Open  ]],
Cell[572859, 12521, 1422, 39, 57, "Input",ExpressionUUID->"b3d55916-828b-4ff0-b676-bd795db8647b"],
Cell[574284, 12562, 299, 6, 24, "Input",ExpressionUUID->"da1d0482-049f-45ff-bd35-3fb42eb0d629"]
}, Open  ]],
Cell[CellGroupData[{
Cell[574620, 12573, 295, 5, 41, "Subsection",ExpressionUUID->"a63de3f6-2296-4fc9-b9c4-bc2f8e1b64bb"],
Cell[CellGroupData[{
Cell[574940, 12582, 171, 3, 34, "Subsubsection",ExpressionUUID->"82ee28b9-fa8e-4173-a984-9746a0a66d60"],
Cell[575114, 12587, 408, 11, 0, "Input",ExpressionUUID->"1aeeb6b5-7b77-43fe-a679-1117084e1168"],
Cell[575525, 12600, 337, 9, 0, "Input",ExpressionUUID->"c77a89ae-8dfe-4ab4-a1b4-a6715c3743da"],
Cell[575865, 12611, 988, 27, 2, "Input",ExpressionUUID->"91ef6b2c-884e-4ca5-ab97-b198eaa863a4"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[576902, 12644, 209, 4, 41, "Subsection",ExpressionUUID->"6cd64787-d841-4250-be0b-e66ae3f124ab"],
Cell[577114, 12650, 1723, 46, 77, "Input",ExpressionUUID->"662f04b8-8194-46ed-a3e6-820436f2a674"],
Cell[578840, 12698, 1792, 40, 32, "Input",ExpressionUUID->"d3e78193-2054-48a1-8a3a-42b463d4ab8a"],
Cell[580635, 12740, 152, 3, 13, "Input",ExpressionUUID->"59c8f760-559a-4c2e-a9cd-6b0b7372d607"],
Cell[CellGroupData[{
Cell[580812, 12747, 4947, 89, 66, "Input",ExpressionUUID->"1eb56e54-7682-4a2b-bdb8-6438471cc158"],
Cell[585762, 12838, 570, 9, 15, "Output",ExpressionUUID->"cffe8e98-4459-4aaa-9df7-30d583394c0e"]
}, Open  ]],
Cell[586347, 12850, 594, 17, 23, "Input",ExpressionUUID->"77637e42-ec40-45ba-885a-f72d58c695ab"]
}, Closed]],
Cell[CellGroupData[{
Cell[586978, 12872, 266, 4, 30, "Subsection",ExpressionUUID->"eae67b72-7777-48ff-a074-96457dba0921"],
Cell[587247, 12878, 1363, 26, 23, "Input",ExpressionUUID->"361e11ee-6ba0-460e-b781-c2310a313351"],
Cell[588613, 12906, 695, 16, 13, "Input",ExpressionUUID->"ed5f0e19-7737-4f7b-b8b9-ee6391e1efe8"],
Cell[CellGroupData[{
Cell[589333, 12926, 1435, 31, 23, "Input",ExpressionUUID->"3592ebf2-dcdd-4012-b976-1780745bc7c6"],
Cell[590771, 12959, 2505, 47, 289, "Output",ExpressionUUID->"62cfef38-4a16-48a7-b010-a410d5dea319"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[593325, 13012, 166, 3, 30, "Subsection",ExpressionUUID->"2cc0d5a6-c198-4d08-b066-ecb68447ec5d"],
Cell[CellGroupData[{
Cell[593516, 13019, 468, 11, 14, "Input",ExpressionUUID->"d6c1f599-511c-4902-80c1-a00cd460faf5"],
Cell[593987, 13032, 1011, 14, 15, "Output",ExpressionUUID->"4d3bb348-ba59-4803-91eb-e9ac5f194cc7"]
}, Open  ]],
Cell[595013, 13049, 421, 7, 13, "Input",ExpressionUUID->"1fbc2d76-0e7b-44fd-87d2-d232b7daf75c"]
}, Closed]],
Cell[CellGroupData[{
Cell[595471, 13061, 239, 4, 30, "Subsection",ExpressionUUID->"cad77bf7-d4ae-4257-bfa5-925ac7a27c63"],
Cell[595713, 13067, 643, 10, 13, "Input",ExpressionUUID->"5ea186c7-410a-4096-ac26-eaa4b85afcab"]
}, Closed]],
Cell[CellGroupData[{
Cell[596393, 13082, 201, 3, 30, "Subsection",ExpressionUUID->"48b610b5-3bb5-41c8-8d3a-d6cfed64e1e8"],
Cell[596597, 13087, 639, 11, 13, "Input",ExpressionUUID->"debcfb97-67eb-46f7-8663-60e899357a14"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[597285, 13104, 408, 8, 80, "Section",ExpressionUUID->"1a561502-414f-4895-ba84-17fbb3acbeef"],
Cell[CellGroupData[{
Cell[597718, 13116, 163, 3, 34, "Subsubsection",ExpressionUUID->"afc9d1dc-46a7-41bb-82da-3e231a59b336"],
Cell[597884, 13121, 226, 4, 27, "Text",ExpressionUUID->"9e1e017f-02be-409f-a7bc-e2d952be3490"],
Cell[CellGroupData[{
Cell[598135, 13129, 5587, 80, 41, "Input",ExpressionUUID->"c7a9f6aa-d1c0-440d-b758-a65ad343a3a2"],
Cell[603725, 13211, 787, 22, 37, "Output",ExpressionUUID->"6835a3c1-5cdc-456a-bb58-fdcde5019344"]
}, Open  ]],
Cell[CellGroupData[{
Cell[604549, 13238, 899, 19, 41, "Input",ExpressionUUID->"df6947f1-2957-4d0f-97b5-da1192fac769"],
Cell[605451, 13259, 3322, 47, 28, "Output",ExpressionUUID->"026dd2c0-e171-4fa0-8224-7cec23bf7bd9"]
}, Open  ]],
Cell[608788, 13309, 1038, 24, 41, "Input",ExpressionUUID->"f45da79b-a3a1-4cde-9a37-bf8cdde1e814"],
Cell[609829, 13335, 2282, 53, 105, "Input",ExpressionUUID->"0dd1832f-089b-46c1-a68f-1709b4893779"],
Cell[612114, 13390, 1209, 26, 57, "Input",ExpressionUUID->"c73a817a-6d22-4709-a696-4e5817b48b9b"],
Cell[CellGroupData[{
Cell[613348, 13420, 215, 4, 24, "Input",ExpressionUUID->"f6fd445b-0a7e-473d-ba89-87e24c6440f9"],
Cell[613566, 13426, 3449, 50, 27, "Output",ExpressionUUID->"4f267b1d-e3a7-46b3-9b0f-fafa2a53e0ca"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[617064, 13482, 160, 3, 34, "Subsubsection",ExpressionUUID->"4a187534-7e07-487c-9f58-794c5bf650b7"],
Cell[617227, 13487, 525, 13, 32, "Input",ExpressionUUID->"7c7ee121-2ce0-4e5f-962f-ce9a45bd7494"],
Cell[617755, 13502, 987, 19, 13, "Input",ExpressionUUID->"851f3030-7166-45eb-8b38-587456e18c81"],
Cell[618745, 13523, 1079, 21, 13, "Input",ExpressionUUID->"2e550924-8f66-4783-b45d-6e9ea461268a"],
Cell[619827, 13546, 435, 10, 13, "Input",ExpressionUUID->"3255377e-3500-4cc0-8674-f5220ebd86af"],
Cell[620265, 13558, 1144, 25, 13, "Input",ExpressionUUID->"2863e8a4-c7f2-4844-bd51-d177fca3d58f"],
Cell[CellGroupData[{
Cell[621434, 13587, 888, 23, 23, "Input",ExpressionUUID->"4d10a361-e9ac-4596-8e35-157f252ebac4"],
Cell[622325, 13612, 2067, 40, 180, "Output",ExpressionUUID->"9a3a7826-c738-4365-9d6e-62db81e7228b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[624429, 13657, 540, 9, 13, "Input",ExpressionUUID->"891bb5df-c83c-49b6-8be9-f704b0fb598c"],
Cell[624972, 13668, 1539, 47, 24, "Output",ExpressionUUID->"b793d463-4afd-484a-8e6e-a68b0cac4480"]
}, Open  ]],
Cell[626526, 13718, 660, 12, 14, "Input",ExpressionUUID->"12aa4a0d-aa7c-4dba-9732-39697feec562"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[627235, 13736, 504, 21, 69, "Section",ExpressionUUID->"2ab11bc8-2e24-4715-a4fc-6e8501caf25c"],
Cell[CellGroupData[{
Cell[627764, 13761, 159, 3, 34, "Subsubsection",ExpressionUUID->"89f0b741-971b-469c-97c5-8232d07a0f38"],
Cell[CellGroupData[{
Cell[627948, 13768, 882, 22, 41, "Input",ExpressionUUID->"140ac8f1-cc8a-41d6-a199-f3be757a0f4e"],
Cell[628833, 13792, 936, 20, 76, "Output",ExpressionUUID->"a9125823-00c7-49f8-ad3c-5816ba37d7eb"]
}, Open  ]],
Cell[629784, 13815, 5997, 86, 24, "Input",ExpressionUUID->"c7b28fad-72f7-4056-ad9e-779bd27650bf"],
Cell[CellGroupData[{
Cell[635806, 13905, 293, 7, 24, "Input",ExpressionUUID->"04246849-e550-425c-9c83-3911b338066f"],
Cell[636102, 13914, 1463, 45, 44, "Output",ExpressionUUID->"b2d07cd5-55c4-4831-9bd2-a0ddbde63a5c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[637602, 13964, 760, 20, 41, "Input",ExpressionUUID->"47ed8997-864e-4fbc-9eee-80bc15423215"],
Cell[638365, 13986, 5847, 176, 140, "Output",ExpressionUUID->"bbd3a7df-e6ea-4927-8d09-51082252287e"],
Cell[644215, 14164, 553, 11, 27, "Output",ExpressionUUID->"a400453f-ec56-4cba-885e-e35765cee109"]
}, Open  ]],
Cell[644783, 14178, 423, 10, 24, "Input",ExpressionUUID->"f018d8ec-d0f2-4b49-986a-2e150bc6b02a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[645243, 14193, 171, 3, 34, "Subsubsection",ExpressionUUID->"b02b1286-abec-439a-9054-e842760fbcfc"],
Cell[645417, 14198, 989, 19, 23, "Input",ExpressionUUID->"c37a5ab8-e2d8-401c-832c-5d2c77deaec4"],
Cell[646409, 14219, 581, 12, 13, "Input",ExpressionUUID->"6296baca-1f6f-4820-9c71-f4effd275921"],
Cell[646993, 14233, 1827, 42, 32, "Input",ExpressionUUID->"3dac94cd-760a-4ca6-a772-a514cdc070e9"],
Cell[648823, 14277, 1328, 36, 23, "Input",ExpressionUUID->"9f85138c-4369-47be-a28e-d5e6b423c052"]
}, Open  ]],
Cell[CellGroupData[{
Cell[650188, 14318, 339, 7, 19, "Subsubsection",ExpressionUUID->"f0d15249-e704-4cf5-ab60-e32078c48b54"],
Cell[650530, 14327, 694, 12, 13, "Input",ExpressionUUID->"b3c4eeec-333f-458f-9874-4bba37e278ae"],
Cell[CellGroupData[{
Cell[651249, 14343, 522, 10, 23, "Input",ExpressionUUID->"c32356a4-4129-4566-8ca3-372c4f5261e6"],
Cell[651774, 14355, 419, 7, 15, "Output",ExpressionUUID->"82a219a8-d5bd-482f-9fde-a1c98b7c4da2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[652230, 14367, 1427, 37, 32, "Input",ExpressionUUID->"cbd98a4e-8d51-43d1-b0be-7fc8ca2b6463"],
Cell[653660, 14406, 1972, 32, 15, "Output",ExpressionUUID->"13dc5db5-05d4-4ebd-b34b-2f28d21cb569"]
}, Open  ]],
Cell[CellGroupData[{
Cell[655669, 14443, 1182, 27, 77, "Input",ExpressionUUID->"fe08797f-f381-44cf-bb73-c4f6e4486f74"],
Cell[656854, 14472, 1341, 19, 24, "Output",ExpressionUUID->"adc71403-b303-4d2a-ba5b-41123b4089b6"]
}, Open  ]],
Cell[658210, 14494, 303, 7, 25, "Text",ExpressionUUID->"f82e8340-a398-4228-8481-7e6547399544"],
Cell[658516, 14503, 376, 8, 13, "Input",ExpressionUUID->"b880e5da-7218-41a0-acf3-c26725fd89aa"],
Cell[CellGroupData[{
Cell[658917, 14515, 245, 6, 13, "Input",ExpressionUUID->"16fb619b-b0e5-4f27-8fe2-2cc274b4cd22"],
Cell[659165, 14523, 229, 5, 15, "Output",ExpressionUUID->"30bfe2a7-d255-4817-a663-f6653c97339b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[659431, 14533, 353, 9, 13, "Input",ExpressionUUID->"403a0f89-c0e8-4737-859d-82ec79bf77de"],
Cell[659787, 14544, 203, 5, 15, "Output",ExpressionUUID->"e40c7a75-38fb-4cf1-88fa-b9afe878f5da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[660027, 14554, 1155, 30, 23, "Input",ExpressionUUID->"5a3a9155-a687-4ffe-90a1-66fdbec12aba"],
Cell[661185, 14586, 740, 18, 160, "Output",ExpressionUUID->"5b45390c-5107-45b0-a6ac-ce925d1dc2b2"]
}, Open  ]],
Cell[661940, 14607, 11890, 276, 95, "Input",ExpressionUUID->"e690ea06-6e7d-4a0a-968a-438e667017b1"],
Cell[673833, 14885, 4769, 113, 68, "Input",ExpressionUUID->"daf23a6f-fe95-4a47-9553-cc4a6e1e213d"],
Cell[678605, 15000, 247, 4, 13, "Input",ExpressionUUID->"b56bde44-4827-4da5-b421-19185e9b8604"],
Cell[678855, 15006, 4249, 102, 59, "Input",ExpressionUUID->"98c6e468-b4ef-4d30-a456-e0ae5add83e7"],
Cell[CellGroupData[{
Cell[683129, 15112, 1252, 23, 23, "Input",ExpressionUUID->"3d058498-e339-4c89-8b8b-87971105cba2"],
Cell[684384, 15137, 355, 6, 15, "Output",ExpressionUUID->"2cd05bdb-67e2-420c-b8d6-cbd6ca87f8b6"],
Cell[684742, 15145, 366, 6, 15, "Output",ExpressionUUID->"b28e8f81-a9aa-410f-a066-2bbd0c475756"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

